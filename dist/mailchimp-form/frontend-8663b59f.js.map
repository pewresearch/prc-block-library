{"version":3,"sources":["webpack:///external \"React\"","webpack:///external \"wp.domReady\"","webpack:///external \"wp.element\"","webpack:///./src/mailchimp-form/frontend.js","webpack:///external \"ReactDOM\"","webpack:///./src/mailchimp-form/component.js","webpack:///external \"lodash\"","webpack:///external \"wp.apiFetch\""],"names":["module","exports","React","wp","domReady","element","document","querySelector","querySelectorAll","forEach","elm","props","display","interest","getAttribute","className","render","ReactDOM","MailchimpForm","withState","error","loading","emailAddress","dimmerActive","dimmerMessage","setState","Dimmable","as","id","dimmed","onSubmit","e","preventDefault","email","setTimeout","jQuery","ajax","url","window","siteURL","param","interests","type","done","console","info","fail","jqXHR","failState","responseJSON","code","always","Field","Input","placeholder","data-validate","required","onChange","target","value","Button","secondary","content","active","onClickOutside","lodash","apiFetch"],"mappings":";;;;;;;;;;;;;;;;;2IAAAA,EAAOC,QAAUC,O,kBCAjBF,EAAOC,QAAUE,GAAGC,U,iBCApBJ,EAAOC,QAAUE,GAAGE,S,8ECApB,6CAMAD,KAAS,WACDE,SAASC,cAAc,6BACVD,SAASE,iBAAiB,4BAClCC,SAAQ,SAAAC,GACT,IAAMC,EAAQ,CACVC,SAAS,EACTC,SAAUH,EAAII,aAAa,mBAC3BC,UAAWL,EAAII,aAAa,eAEhCE,iBAAO,oBAAC,IAAkBL,GAAWD,U,iBCfjDV,EAAOC,QAAUgB,U,gCCAjB,qCAcMC,GAdN,MAcsBC,YARD,CACjBC,OAAO,EACPC,SAAS,EACTC,aAAc,GACdC,cAAc,EACdC,cAAe,OAGGL,EAClB,YAUO,IATHP,EASE,EATFA,QACAC,EAQE,EARFA,SACAO,EAOE,EAPFA,MACAC,EAME,EANFA,QACAC,EAKE,EALFA,aACAC,EAIE,EAJFA,aACAC,EAGE,EAHFA,cACAC,EAEE,EAFFA,SACAV,EACE,EADFA,UA0DA,OACI,oBAAC,IAAOW,SAAR,CACIC,GAAG,MACHC,GAAG,oBACHC,OAAQN,EACRR,UAAWA,GAEX,oBAAC,IAAD,CACIA,UAAU,YACVK,MAAOA,EACPU,SAlEU,SAAAC,GAGlB,GAFAA,EAAEC,kBAEE,IAASpB,EAAb,CAKA,IAAMqB,EAAQX,EAEdG,EAAS,CAAEJ,SAAS,IAEpBa,YAAW,WACPC,OACKC,KAAK,CACFC,IAAI,GAAD,OACCC,OAAOC,QADR,mDAEwCJ,OAAOK,MAC9C,CACIP,QACAQ,UAAW5B,KAGnB6B,KAAM,SAETC,MAAK,WACFC,QAAQC,KAAK,0BACbpB,EAAS,CACLD,cACI,2DAGXsB,MAAK,SAAAC,GACF,IAAMC,EAAY,CACd5B,OAAO,EACPI,cAAe,IAEf,qBAAuBuB,EAAME,aAAaC,KAC1CF,EAAUxB,cACN,+DAEJwB,EAAUxB,cACN,oGAERC,EAASuB,MAEZG,QAAO,WACJ1B,EAAS,CACLJ,SAAS,EACTC,aAAc,GACdC,cAAc,SAG3B,QAeK,oBAAC,IAAK6B,MAAN,KACI,oBAAC,IAAKC,MAAN,CACIC,YAAY,gBACZZ,KAAK,QACLa,gBAAc,WACdC,UAAQ,EACRC,SAAU,SAAA1B,GACNN,EAAS,CACLH,aAAcS,EAAE2B,OAAOC,SAG/BA,MAAOrC,IAEX,oBAAC,IAAKsC,OAAN,CACIC,WAAS,EACTxC,QAASA,EACTyC,QAAQ,cAKpB,oBAAC,IAAD,CACIC,OAAQxC,EACRyC,eAAgB,WACZvC,EAAS,CAAEF,cAAc,MAG7B,yBAAGR,UAAU,cACRS,EADL,2BASLN,O,iBClIflB,EAAOC,QAAUgE,Q,iBCAjBjE,EAAOC,QAAUE,GAAG+D,U","file":"mailchimp-form/frontend-8663b59f.js","sourcesContent":["module.exports = React;","module.exports = wp.domReady;","module.exports = wp.element;","import { render } from '@wordpress/element';\nimport domReady from '@wordpress/dom-ready';\n\nimport MailchimpForm from './component';\n\n// When the document is fully loaded load the mailchimp-form.\ndomReady(() => {\n    if (document.querySelector('.js-react-mailchimp-form')) {\n        const elms = document.querySelectorAll('.js-react-mailchimp-form');\n        elms.forEach(elm => {\n            const props = {\n                display: true,\n                interest: elm.getAttribute('data-segment-id'),\n                className: elm.getAttribute('data-style'),\n            };\n            render(<MailchimpForm {...props} />, elm);\n        });\n    }\n});\n","module.exports = ReactDOM;","import { withState } from '@wordpress/compose';\nimport apiFetch from '@wordpress/api-fetch';\nimport { Form, Dimmer } from 'semantic-ui-react';\n\nimport './style.scss';\n\nconst defaultState = {\n    error: false,\n    loading: false,\n    emailAddress: '',\n    dimmerActive: false,\n    dimmerMessage: 'n/a',\n};\n\nconst MailchimpForm = withState(defaultState)(\n    ({\n        display,\n        interest,\n        error,\n        loading,\n        emailAddress,\n        dimmerActive,\n        dimmerMessage,\n        setState,\n        className,\n    }) => {\n        const submitHandler = e => {\n            e.preventDefault();\n\n            if (true !== display) {\n                return; // Never allow running this from inside Gutenberg.\n            }\n\n            // Request (POST wp-json/prc-api/v2/mailchimp/subscribe)\n            const email = emailAddress;\n\n            setState({ loading: true });\n\n            setTimeout(() => {\n                jQuery\n                    .ajax({\n                        url: `${\n                            window.siteURL\n                        }/wp-json/prc-api/v2/mailchimp/subscribe?${jQuery.param(\n                            {\n                                email,\n                                interests: interest,\n                            },\n                        )}`,\n                        type: 'POST',\n                    })\n                    .done(() => {\n                        console.info('Succesfully subscribed');\n                        setState({\n                            dimmerMessage:\n                                'You have succesfully subscribed to this newsletter.',\n                        });\n                    })\n                    .fail(jqXHR => {\n                        const failState = {\n                            error: true,\n                            dimmerMessage: '',\n                        };\n                        if ('add-member-error' === jqXHR.responseJSON.code) {\n                            failState.dimmerMessage =\n                                'This email address is already subscribed to this newsletter.';\n                        } else {\n                            failState.dimmerMessage =\n                                'Unfortunatley we could not subscribe you to this newsletter at this time, please try again later.';\n                        }\n                        setState(failState);\n                    })\n                    .always(() => {\n                        setState({\n                            loading: false,\n                            emailAddress: '',\n                            dimmerActive: true,\n                        });\n                    });\n            }, 2000);\n        };\n\n        return (\n            <Dimmer.Dimmable\n                as=\"div\"\n                id=\"js-mailchimp-form\"\n                dimmed={dimmerActive}\n                className={className}\n            >\n                <Form\n                    className=\"mailchimp\"\n                    error={error}\n                    onSubmit={submitHandler}\n                >\n                    <Form.Field>\n                        <Form.Input\n                            placeholder=\"Email address\"\n                            type=\"email\"\n                            data-validate=\"mc-email\"\n                            required\n                            onChange={e => {\n                                setState({\n                                    emailAddress: e.target.value,\n                                });\n                            }}\n                            value={emailAddress}\n                        />\n                        <Form.Button\n                            secondary\n                            loading={loading}\n                            content=\"SIGN UP\"\n                        />\n                    </Form.Field>\n                </Form>\n\n                <Dimmer\n                    active={dimmerActive}\n                    onClickOutside={() => {\n                        setState({ dimmerActive: false });\n                    }}\n                >\n                    <p className=\"sans-serif\">\n                        {dimmerMessage} (Click to close)\n                    </p>\n                </Dimmer>\n            </Dimmer.Dimmable>\n        );\n    },\n);\n\nexport default MailchimpForm;\n","module.exports = lodash;","module.exports = wp.apiFetch;"],"sourceRoot":""}