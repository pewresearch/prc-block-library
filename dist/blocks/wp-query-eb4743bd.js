/*!
 * 
 * prcBlocksLibrary
 * 
 * @author Seth Rubenstein
 * @version 0.1.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2021 Seth Rubenstein
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioprcBlocksLibraryblocksJsonp=window.wpackioprcBlocksLibraryblocksJsonp||[]).push([[25],{0:function(e,t){e.exports=wp.element},1:function(e,t){e.exports=wp.i18n},144:function(e){e.exports=JSON.parse('{"apiVersion":2,"name":"prc-block/wp-query","category":"layout","attributes":{"disableImage":{"type":"boolean","default":false},"formatTermId":{"type":"integer"},"labelTaxonomy":{"type":"string","default":"formats"},"pinned":{"type":"string","default":"[]"},"postsPerPage":{"type":"integer","default":5},"programTermId":{"type":"integer"},"taxQuery":{"type":"object","default":{"relation":"OR","data":[]}}},"providesContext":{"prc-block/wp-query":"pinned"}}')},19:function(e,t){e.exports=moment},2:function(e,t){e.exports=React},23:function(e,t){e.exports=wp.apiFetch},247:function(e,t,n){n(22),e.exports=n(250)},250:function(e,t,n){"use strict";n.r(t);var r=n(5),a=n(6),o=n(1),c=n(144),l=n(12),i=n(0),s=n(7),u=n(3),m=n(4),p=n(93),b=Object(i.createElement)(p.b,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},Object(i.createElement)(p.a,{d:"M13 11.9l3.3-3.4-1.1-1-3.2 3.3-3.2-3.3-1.1 1 3.3 3.4-3.5 3.6 1 1L12 13l3.5 3.5 1-1z"}));function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t=e.index,n=e.label,r=e.taxonomy,a=void 0!==r&&r,c=e.value,l=e.options,i=e.taxQuery,s=e.setAttributes;return React.createElement("div",null,React.createElement(m.Flex,null,React.createElement(m.FlexBlock,null,React.createElement("strong",null,n)),React.createElement(m.FlexItem,null,React.createElement(m.Button,{isLink:!0,icon:b,onClick:function(){var e=i;e.data.splice(t,1),s({taxQuery:d(d({},i),e)})},lable:Object(o.__)("Remove taxonomy argument")}))),!1===a&&React.createElement("div",{style:{margin:"16px"}},React.createElement(m.SelectControl,{value:a,options:l,onChange:function(e){var n=i;n.data[t].taxonomy=e,s({taxQuery:d(d({},i),n)})}})),!1!==a&&null===c&&React.createElement(u.__experimentalLinkControl,{label:Object(o.__)("Term"),value:c,showInitialSuggestions:!0,suggestionsQuery:{type:"term",subtype:a},onChange:function(e){var n=e.id,r=e.title,a=e.url,o=i;o.data[t].terms=n,o.data[t].title=r,o.data[t].value=a,s({taxQuery:d(d({},i),o)})},settings:[]}),React.createElement(m.HorizontalRule,null))},y=function(e){var t=e.taxQuery,n=e.setAttributes,r=t.relation,a=t.data,c=Object(i.useState)([{label:"Select a Taxonomy",value:!1},{label:"Topics",value:"topic"},{label:"Formats",value:"formats"},{label:"Programs",value:"programs"}]),s=Object(l.a)(c,2),u=s[0],p=s[1];return Object(i.useEffect)((function(){var e=a.map((function(e){return e.taxonomy})),t=u.map((function(t){return e.includes(t.value)?t.disabled=!0:t.disabled=!1,t}));p(t)}),[t]),React.createElement(i.Fragment,null,React.createElement("div",null,a.map((function(e,r){var a=e.taxonomy,c=e.value,l=function(e){var t=e.taxonomy,n=e.title,r=!1===t?"Choose Taxonomy":"Choose ".concat(t," Term");return null!==n&&!1!==t&&(r="".concat(t,": ").concat(n)),r.toLowerCase().split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" ")}(e);return React.createElement(g,{index:r,label:Object(o.__)(l),taxonomy:a,value:c,options:u,taxQuery:t,setAttributes:n})})),2<=a.length&&React.createElement("div",{style:{marginTop:"1em",marginBottom:"1em"}},React.createElement(m.ToggleControl,{label:"Query Relation (OR|AND)",help:"AND"===r?"AND (restrictive: restricts content)":"OR (expansive: expands content)",checked:"AND"===r,onChange:function(){var e=t;"OR"===e.relation?e.relation="AND":e.relation="OR",n({taxQuery:d(d({},t),e)})}}))),React.createElement(m.Button,{isSecondary:!0,isSmall:!0,onClick:function(){var e=t;e.data.push({taxonomy:!1,terms:null,value:null}),n({taxQuery:d(d({},t),e)})}},"Add Taxonomy"))},v=n(37),O=n(19),h=n(23),E=n.n(h),j=function(e){return new Promise((function(t){var n=[];console.log("fetchPosts?",e);var r={method:"POST",path:"/prc-api/v2/block/wp-query",data:e};E()(r).then((function(e){console.log(e),e.forEach((function(e){var t,r={id:e.id,title:e.title,excerpt:e.excerpt,date:(t=e.timestamp,O(t).format("MMM D, YYYY")),link:e.link,label:e.label,image:e.image};n.push(r)})),t(n)}))}))},R=function(e){var t=e.attributes,n=e.setAttributes,r=e.wide,a=void 0!==r&&r,c=e.disabled,s=void 0!==c&&c,u=t.formatTermId,p=t.programTermId,b=t.postsPerPage,f=t.labelTaxonomy,d=t.disableImage,g=t.taxQuery,O=Object(i.useState)([]),h=Object(l.a)(O,2),E=h[0],j=h[1],R=Object(i.useState)([]),x=Object(l.a)(R,2),k=x[0],w=x[1],P=function(e,n){console.log("initTerms",t),Object(v.d)(e).then((function(e){var t=Object.keys(e),r=[{value:"any",label:"Any"}];t.forEach((function(t){r.push({value:t,label:e[t].name})})),n(r)}))};return Object(i.useEffect)((function(){0===E.length&&P("Formats",j),0===k.length&&P("Programs",w)}),[]),React.createElement(i.Fragment,null,React.createElement("div",null,React.createElement("h4",{className:"sans-serif"},"Story Item Settings"),React.createElement(m.ToggleControl,{label:"Disable Images",checked:d,onChange:function(){return n({disableImage:!d})}}),React.createElement("div",{style:!0===a?{display:"flex",flexDirection:"row"}:{}},React.createElement("div",{style:!0===a?{flexGrow:"1",paddingRight:"1em"}:{}},React.createElement(m.SelectControl,{label:"Format",value:u,options:E,onChange:function(e){n({formatTermId:parseInt(e)})},disabled:s})),React.createElement("div",{style:!0===a?{display:"flex",alignItems:"flex-end",paddingBottom:"0.2em"}:{}},React.createElement(m.ToggleControl,{label:"Use as Label",checked:"formats"===f,onChange:function(){return n({labelTaxonomy:"formats"===f?"programs":"formats"})}}))),React.createElement("div",{style:!0===a?{display:"flex",flexDirection:"row"}:{}},React.createElement("div",{style:!0===a?{flexGrow:"1",paddingRight:"1em"}:{}},React.createElement(m.SelectControl,{label:"Program",value:p,options:k,onChange:function(e){n({programTermId:parseInt(e)})},disabled:s})),React.createElement("div",{style:!0===a?{display:"flex",alignItems:"flex-end",paddingBottom:"0.2em"}:{}},React.createElement(m.ToggleControl,{label:"Use as Label",checked:"programs"===f,onChange:function(){return n({labelTaxonomy:"programs"===f?"formats":"programs"})}})))),React.createElement(m.HorizontalRule,null),React.createElement("div",null,React.createElement("h4",{className:"sans-serif"},"Query Arguments"),React.createElement(m.RangeControl,{label:Object(o.__)("Number of posts"),value:b,onChange:function(e){return n({postsPerPage:e})},min:3,max:10,required:!0})),React.createElement(m.HorizontalRule,null),React.createElement("div",null,React.createElement("h4",{className:"sans-serif"},"Taxonomy Query Arguments"),React.createElement(y,{taxQuery:g,setAttributes:n})),React.createElement(m.HorizontalRule,null))},x=function(e){var t=e.attributes,n=e.setAttributes,r=e.setPosts,a=e.clientId,c=Object(i.useState)(!1),p=Object(l.a)(c,2),b=p[0],f=p[1],d=Object(s.useSelect)((function(e){return{hasInnerBlocks:0<e("core/block-editor").getBlocks(a).length}}),[a]).hasInnerBlocks,g=function(){f(!0),j(t).then((function(e){setTimeout((function(){f(!1),r(e)}),3600)}))};return React.createElement(i.Fragment,null,React.createElement(u.InspectorControls,null,React.createElement(m.PanelBody,{title:Object(o.__)("Query Arguments")},React.createElement(R,{attributes:t,setAttributes:n,disabled:b}),React.createElement(m.Button,{isBusy:b,isPrimary:!0,onClick:function(){return g()}},"Update"))),!1===d&&React.createElement(m.Placeholder,{label:"Configure Query Args",isColumnLayout:!0},React.createElement("div",null,React.createElement(R,{attributes:t,setAttributes:n,disabled:b,wide:!0}),React.createElement(m.Button,{isBusy:b,isPrimary:!0,onClick:function(){return g()}},"Query Posts"))))},k=["prc-block/story-item"],w=function(e){var t=e.attributes,n=e.setAttributes,r=e.className,o=e.clientId,c=t.pinned,m=t.postsPerPage,p=t.labelTaxonomy,b=t.disableImage,f=Object(u.useBlockProps)({className:r}),d=Object(u.__experimentalUseInnerBlocksProps)({allowedBlocks:k,orientation:"vertical",renderAppender:u.InnerBlocks.ButtonBlockAppender}),g=Object(i.useState)(!1),y=Object(l.a)(g,2),v=y[0],O=y[1],h=Object(s.useDispatch)("core/block-editor").replaceInnerBlocks,E=Object(s.useSelect)((function(e){var t=e("core/block-editor").getBlocks(o);return{innerBlocks:t,hasInnerBlocks:0<t.length}}),[o]),j=E.innerBlocks,R=E.hasInnerBlocks;return Object(i.useEffect)((function(){if(!1!==v){var e=[];v.forEach((function(t){e.push(function(e,t,n){var r={title:e.title,image:e.image,excerpt:e.excerpt,link:e.link,label:e.label,date:e.date,extra:"",postID:e.id,emphasis:!1,isChartArt:!1,imageSlot:"left",imageSize:"A3",horizontal:!0,stacked:!1,enableHeader:!0,enableExcerpt:!0,enableExtra:!1,enableProgramsTaxonomy:!1,headerSize:2,className:"is-style-left"};return!0===t&&(r.imageSlot="disabled",r.className="is-style-disabled",r.enableExcerpt=!1),"programs"===n&&(r.enableProgramsTaxonomy=!0),Object(a.createBlock)("prc-block/story-item",r)}(t,b,p))}));var t=[];JSON.parse(c).forEach((function(n){j.filter((function(t){var r=e.filter((function(e){return e.attributes.postID===n}));return t.attributes.postID===n&&0>=r.length})).forEach((function(e){return t.push(e)}))}));var n=m-t.length;e=e.filter((function(e,t){return t<=n-1}));var r=t.concat(e);h(o,r)}}),[v]),React.createElement("div",f,React.createElement(x,{attributes:t,setAttributes:n,setPosts:O,clientId:o}),!0===R&&React.createElement("div",d))},P=function(){return React.createElement(u.InnerBlocks.Content,null)};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=c.name,S={title:Object(o.__)("Query"),description:Object(o.__)("Query posts by format, topic, region, and/or date. Posts are displayed as Story Items."),edit:w,save:P};Object(a.registerBlockType)(I,B(B({},c),S))},29:function(e,t){e.exports=wp.url},3:function(e,t){e.exports=wp.blockEditor},37:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g}));n(19);var r=n(23),a=n.n(r),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return new Promise((function(n){var r={};a()({path:"/wp/v2/".concat(e,"?per_page=").concat(t)}).then((function(t){for(var a=0;a<t.length;a++){var o=t[a].slug.replace("".concat(e.toLowerCase(),"_"),"");r[t[a].id]={id:t[a].id,name:t[a].name,parent:t[a].parent,slug:o}}n(r)}))}))},c=(n(5),n(1)),l=n(7),i=n(4),s=n(6),u=function(e){var t=e.label,n=void 0===t?"":t,r=e.blockName,a=e.clientId,o=e.attributes,u=void 0===o?{}:o;return React.createElement(i.Button,{label:Object(c.__)(n),tooltipPosition:"bottom",onClick:function(){var e=Object(l.select)("core/block-editor").getBlock(a);console.log("debug info...",e.innerBlocks.length);var t=e.innerBlocks.length-1,n=Object(s.createBlock)(r,u);Object(l.dispatch)("core/block-editor").insertBlock(n,t,a)},className:"block-editor-button-block-appender"},Object(c.__)(n))},m=n(0),p=n(3),b=n(145),f=function(e){var t=e.url,n=e.heading,r=e.headingSize,a=void 0===r?"h2":r,o=e.setAttributes;return React.createElement(m.Fragment,null,React.createElement(p.BlockControls,null,React.createElement(i.ToolbarGroup,null,React.createElement(g,{url:t,onChange:function(e){o({url:e.url})}}))),React.createElement(i.Flex,{style:{paddingBottom:"1em"}},React.createElement(i.FlexItem,null,React.createElement(p.RichText,{tagName:a,value:n,onChange:function(e){return o({heading:e})},placeholder:"Heading...",formattingControls:[],keepPlaceholderOnFocus:!0,className:"sans-serif"})),React.createElement(i.FlexBlock,null,React.createElement(b.a,{name:"chevron right",size:"large",style:{marginLeft:"0.5em"}}))))},d=n(12),g=function(e){var t=e.url,n=e.onChange,r=e.query,a=void 0===r?{type:"term",subtype:"topic"}:r,o=Object(m.useState)(!1),l=Object(d.a)(o,2),s=l[0],u=l[1];return React.createElement(m.Fragment,null,React.createElement(i.ToolbarButton,{"aria-expanded":s,"aria-haspopup":"true",label:Object(c.__)("Set Link"),icon:"admin-links",onClick:function(){return u(!s)},showTooltip:!0}),!0===s&&React.createElement(i.Popover,{position:"bottom center",onClose:function(){return u(!1)}},React.createElement(p.__experimentalLinkControl,{className:"wp-block-navigation-link__inline-link-input",value:{url:t},showInitialSuggestions:!0,suggestionsQuery:a,onChange:function(e){return n(e)},settings:[]})))};n(11),n(46),n(276),n(31),n(29)},4:function(e,t){e.exports=wp.components},48:function(e,t){e.exports=ReactDOM},6:function(e,t){e.exports=wp.blocks},7:function(e,t){e.exports=wp.data},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var r=n(5),a=n(36);var o=n(9),c=n.n(o),l=n(0);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e){return Object(l.createElement)("path",e)},m=function(e){var t=e.className,n=e.isPressed,r=s(s({},function(e,t){if(null==e)return{};var n,r,o=Object(a.a)(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["className","isPressed"])),{},{className:c()(t,{"is-pressed":n})||void 0,role:"img","aria-hidden":!0,focusable:!1});return Object(l.createElement)("svg",r)}}},[[247,0,1,2]]]);
//# sourceMappingURL=wp-query-eb4743bd.js.map