{"version":3,"sources":["webpack:///./src/video-popup/edit.js","webpack:///./src/video-popup/save.js","webpack:///./src/video-popup/index.js","webpack:///external [\"wp\",\"blocks\"]","webpack:///external [\"wp\",\"data\"]","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///external [\"wp\",\"mediaUtils\"]","webpack:///./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack:///external [\"wp\",\"i18n\"]","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///external [\"wp\",\"element\"]","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack:///external [\"wp\",\"components\"]","webpack:///external [\"wp\",\"blockEditor\"]"],"names":["ALLOWED_MEDIA_TYPES","VideoDropZone","attributes","setAttributes","attachmentId","src","useState","isUploading","setIsUploading","media","useSelect","select","getMedia","onUpdate","video","console","log","id","onDrop","filesList","uploadMedia","allowedTypes","onFileChange","onError","message","error","useEffect","title","__","onSelect","value","render","open","className","onClick","naturalWidth","mediaWidth","naturalHeight","mediaHeight","isInline","videoSrc","controls","style","backgroundColor","onFilesDrop","edit","blockProps","isYoutube","isVimeo","isVideoPress","useBlockProps","innerBlocksProps","useInnerBlocksProps","orientation","templateLock","save","Content","name","metadata","settings","registerBlockType","module","exports","window","_defineProperty","obj","key","Object","defineProperty","enumerable","configurable","writable","_slicedToArray","arr","i","arrayWithHoles","_i","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","push","length","err","unsupportedIterableToArray","nonIterableRest","_arrayLikeToArray","len","arr2","Array","path","replace","concat","_unsupportedIterableToArray","o","minLen","n","prototype","toString","slice","constructor","from","test","_arrayWithHoles","isArray","_nonIterableRest","TypeError"],"mappings":"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","file":"blocks/video-popup-c3de3ec0.js","sourcesContent":["/**\n * WordPress Dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { Fragment, useEffect, useState } from '@wordpress/element';\nimport {\n\tInspectorControls,\n\tMediaUpload,\n\tMediaUploadCheck,\n\tuseInnerBlocksProps,\n    useBlockProps,\n} from '@wordpress/block-editor';\nimport {\n    BaseControl,\n    Button,\n    CardDivider,\n\tDropZone,\n    PanelBody,\n\tResponsiveWrapper,\n\tSpinner,\n} from '@wordpress/components';\nimport { useSelect } from '@wordpress/data';\nimport { uploadMedia } from '@wordpress/media-utils';\n\nconst ALLOWED_MEDIA_TYPES = ['video'];\n\nconst VideoDropZone = ({ attributes, setAttributes }) => {\n\tconst {attachmentId, src} = attributes;\n    const [isUploading, setIsUploading] = useState(false);\n\n    const { media } = useSelect(select => {\n        const { getMedia } = select('core');\n        return {\n            media: attachmentId ? getMedia(attachmentId) : null\n        };\n    }, [attachmentId]);\n\n    const onUpdate = video => {\n        console.log(\n            'video update',\n\t\t\tvideo\n        );\n\t\tsetAttributes({\n\t\t\tattachmentId: video.id,\n\t\t\tsrc: '',\n\t\t});\n    };\n\n    const onDrop = filesList => {\n        console.log('onDrop', filesList);\n        uploadMedia({\n            allowedTypes: ALLOWED_MEDIA_TYPES,\n            filesList,\n            onFileChange([video]) {\n                console.log('onFileChange', video);\n                if (!video.id) {\n                    console.log('waiting');\n                    setIsUploading(true);\n                } else {\n                    console.log('found!', video);\n                    onUpdate(video);\n                    setIsUploading(false);\n                }\n            },\n            onError(message) {\n                console.error(message);\n            },\n        });\n    };\n\n\tuseEffect(()=>{\n\t\tif (media) {\n\t\t\tconsole.log('hasMedia!', media, attachmentId);\n\t\t}\n\t}, [media]);\n\n    return (\n        <MediaUploadCheck>\n\t\t\t<MediaUpload\n\t\t\t\ttitle={__(`Video`)}\n\t\t\t\tonSelect={onUpdate}\n\t\t\t\tallowedTypes={ALLOWED_MEDIA_TYPES}\n\t\t\t\tvalue={attachmentId}\n\t\t\t\trender={({ open }) => (\n\t\t\t\t\t<div className=\"prc-video-popup-dropzone\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={open}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{!!attachmentId && media && false === isUploading && (\n\t\t\t\t\t\t\t\t<ResponsiveWrapper\n\t\t\t\t\t\t\t\t\tnaturalWidth={mediaWidth}\n\t\t\t\t\t\t\t\t\tnaturalHeight={mediaHeight}\n\t\t\t\t\t\t\t\t\tisInline\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tThe Video File\n\t\t\t\t\t\t\t\t\t<video src={videoSrc} controls />\n\t\t\t\t\t\t\t\t</ResponsiveWrapper>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{((!!attachmentId && !media) || isUploading) && (\n\t\t\t\t\t\t\t\t<ResponsiveWrapper\n\t\t\t\t\t\t\t\t\tnaturalWidth={240}\n\t\t\t\t\t\t\t\t\tnaturalHeight={139}\n\t\t\t\t\t\t\t\t\tisInline\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\tbackgroundColor: '#f0f0f0',\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Spinner /> Loading...\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</ResponsiveWrapper>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{!attachmentId && __(`Attach Video`)}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<DropZone onFilesDrop={onDrop} />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t/>\n\t\t</MediaUploadCheck>\n    );\n};\n\nconst edit = ({ attributes, className, setAttributes }) => {\n    const { src, attachmentId, isYoutube, isVimeo, isVideoPress } = attributes;\n\n    const blockProps = useBlockProps();\n\n    const innerBlocksProps = useInnerBlocksProps(blockProps, {\n        orientation: 'vertical',\n        templateLock: false,\n    });\n\n    return(\n\t\t<Fragment>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={__('Video Settings')}>\n\t\t\t\t\t<VideoDropZone attachmentId={attachmentId} setAttributes={setAttributes}/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<div {...innerBlocksProps} />\n\t\t</Fragment>\n\t);\n};\n\nexport default edit;\n","/**\n * WordPress Dependencies\n */\nimport { InnerBlocks } from '@wordpress/block-editor';\n\nconst save = () => {\n    return <InnerBlocks.Content />;\n};\n\nexport default save;\n","/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal Dependencies\n */\nimport metadata from './block.json';\nimport edit from './edit';\nimport save from './save';\n\nconst { name } = metadata;\n\nconst settings = {\n    edit,\n    save,\n};\n\nregisterBlockType(name, { ...metadata, ...settings });\n","(function() { module.exports = window[\"wp\"][\"blocks\"]; }());","(function() { module.exports = window[\"wp\"][\"data\"]; }());","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","(function() { module.exports = window[\"wp\"][\"mediaUtils\"]; }());","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","(function() { module.exports = window[\"wp\"][\"i18n\"]; }());","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){var path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[\"__wpackIo\".concat(path)];}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","(function() { module.exports = window[\"wp\"][\"element\"]; }());","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","(function() { module.exports = window[\"wp\"][\"components\"]; }());","(function() { module.exports = window[\"wp\"][\"blockEditor\"]; }());"],"sourceRoot":""}