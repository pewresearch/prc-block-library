/*!
 * 
 * prcBlocksLibrary
 * 
 * @author Seth Rubenstein
 * @version 2.1.9
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2022 Seth Rubenstein
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window.wpackioprcBlocksLibraryblocksJsonp=window.wpackioprcBlocksLibraryblocksJsonp||[]).push([[24],{0:function(e,t){e.exports=window.React},10:function(e,t){e.exports=window.wp.blocks},103:function(e,t){e.exports=window.wp.htmlEntities},12:function(e,t){e.exports=window.wp.data},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var o=n(45),r=n(27),c=n.n(r),i=function(e,t,n){0!==t&&!1!==n&&c()({path:"/prc-api/v2/get-art/?postId=".concat(t)}).then((function(t){!1!==t&&void 0!==t[e]&&!1!==n&&n({image:t[e].rawUrl,isChartArt:t[e].chartArt})}))},a=function e(t){var n=t.post,r=t.imageSize,c=t.isRefresh,i=void 0!==c&&c;console.log(e,n);var a=new Date(n.date),l=o(a).format("MMM D, YYYY"),s={title:n.title.hasOwnProperty("rendered")?n.title.rendered:n.title,excerpt:n.excerpt.hasOwnProperty("rendered")?n.excerpt.rendered:n.excerpt,url:n.link,label:n.hasOwnProperty("label")?n.label:"Report",date:l,postId:n.id};if(!0!==i&&(s.extra=""),n.art){var u=n.art;s.image=u[r].rawUrl,s.isChartArt=u[r].chartArt}return console.log("getAttributesFromPost",n,s),s},l=function(e){var t=e.setAttributes,n=e.postId,o=void 0!==n&&n,r=e.url,i=void 0!==r&&r,l=e.imageSize,s=void 0===l?"A1":l,u=e.isRefresh,d=void 0!==u&&u;!1===o&&!1===i||void 0===t||(!1!==i&&function(e){var t=e.url,n=e.imageSize;return new Promise((function(e,o){c()({path:"/prc-api/v2/blocks/story-item/get-post-by-url",method:"POST",data:{url:t}}).then((function(t){if(console.log("getAttributesFromURL",t),!1!==t){var r=a({post:t,imageSize:n,isRefresh:!1});e(r)}else o(t)})).catch((function(e){console.error(e),o(e)}))}))}({url:i,imageSize:s}).then((function(e){console.log("setPostAttributes -> by url:",e),t(e)})).catch((function(e){console.error(e)})),c()({path:"/wp/v2/stub/".concat(o),method:"GET"}).then((function(e){if(console.log("setPostAttributes -> by id:",o,e),!1!==e){var n=a({post:e,imageSize:s,isRefresh:d});t(n)}})).catch((function(e){return console.error(e)})))}},194:function(e,t,n){"use strict";n.d(t,"a",(function(){return A})),n.d(t,"b",(function(){return v}));var o=n(82),r=n(54),c=n(92),i=n(930),a=n(225),l=n(116),s=n(12),u=n(2),d=n(3),p=n(4),b=n(51);var m,f,h,g,v=function(e,t){var n=Object(u.useState)(e),o=Object(r.a)(n,2),c=o[0],i=o[1];return Object(u.useEffect)((function(){var n=setTimeout((function(){i(e)}),t);return function(){clearTimeout(n)}}),[e,t]),c},O=n(27),y=n.n(O),j=n(36),k=n(103),w=Object(l.a)(p.Button)(m||(m=Object(c.a)(["\n\t&:hover {\n\t\t/* Add opacity background to support future color changes */\n\t\t/* Reduce background from #ddd to 0.05 for text contrast  */\n\t\tbackground-color: rgba(0, 0, 0, 0.05);\n\n\t\t.block-editor-link-control__search-item-type {\n\t\t\tcolor: black;\n\t\t}\n\t}\n\n\t.block-editor-link-control__search-item-type {\n\t\tbackground-color: rgba(0, 0, 0, 0.05);\n\t}\n"]))),x=function(e){var t=e.suggestion,n=e.onClick,o=e.searchTerm,r=e.isSelected,c=e.id,i=e.contentTypes,a=t.type&&i.length>1;return React.createElement(p.Tooltip,{text:Object(k.decodeEntities)(t.title)},React.createElement(w,{id:c,onClick:n,className:"block-editor-link-control__search-item is-entity ".concat(r&&"is-selected"),style:{borderRadius:"0",boxSizing:"border-box"}},React.createElement("span",{className:"block-editor-link-control__search-item-header"},React.createElement("span",{className:"block-editor-link-control__search-item-title",style:{paddingRight:a?null:0}},React.createElement(p.TextHighlight,{text:Object(k.decodeEntities)(t.title),highlight:o})),React.createElement("span",{"aria-hidden":!0,className:"block-editor-link-control__search-item-info",style:{paddingRight:a?null:0}},Object(j.filterURLForDisplay)(Object(j.safeDecodeURI)(t.url))||"")),a&&React.createElement("span",{className:"block-editor-link-control__search-item-type"},"post_tag"===t.type?"tag":t.type)))},R="prc-content-search",E={},_=function(e){var t=e.onSelectItem,n=e.placeholder,o=e.label,i=e.style,a=void 0===i?"search":i,l=e.contentTypes,s=e.mode,m=e.excludeItems,h=e.perPage,g=Object(u.useState)(""),O=Object(r.a)(g,2),j=O[0],k=O[1],w=v(j,500),_=Object(u.useState)(!1),P=Object(r.a)(_,2),S=P[0],I=P[1],C=Object(u.useState)([]),N=Object(r.a)(C,2),T=N[0],D=N[1],A=Object(u.useState)(!1),B=Object(r.a)(A,2),L=B[0],z=B[1],F=Object(u.useState)(null),U=Object(r.a)(F,2),H=U[0],M=U[1],Y=Object(u.useRef)(),V=Object(u.useRef)(!0),J=function(e){return void 0!==e&&new Promise((function(t,n){y()({path:"/prc-api/v2/utils/get-post-by-url",method:"POST",data:{url:e}}).then((function(e){console.log("getPostByUrl",e),t(e)})).catch((function(e){return n(e)}))}))},G=function(e){return e.filter((function(e){var t=!0;return m.length&&(t=m.every((function(t){return t.id!==e.id}))),t}))},q=!!w.length,K=!!T.length;Object(u.useEffect)((function(){return function(){V.current=!1}}),[]),Object(u.useEffect)((function(){if(""!==w){var e=w.match(/^(http|https):\/\//);I(e),function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Y.current&&Y.current.abort(),""===e.trim())return z(!1),D([]),void(Y.current=null);Y.current=new AbortController,z(!0);var n="wp/v2/search/?search=".concat(e,"&subtype=").concat(l.join(","),"&type=").concat(s,"&_embed&per_page=").concat(h);E[n]?(Y.current=null,D(G(E[n])),z(!1)):t?(console.log("isUrl",e),J(e).then((function(e){if(V.current){var t=e.ID,o=e.post_title,r=e.post_type,c=e.permalink;Y.current=null;var i=[{id:t,subtype:r,title:o,type:"post",url:c}];console.log("this is where we should do our stuff...",i,e),E[n]=i,D(G(i)),z(!1)}})).catch((function(t,n){console.log("Hey this is a url error, we didnt find a matching post... now what?",e),z(!1)}))):y()({path:n,signal:Y.current.signal}).then((function(e){!1!==V.current&&(console.log("search Results",e),Y.current=null,E[n]=e,D(G(e)),z(!1))})).catch((function(e,t){"fetch_error"!==e.code&&(D([]),Y.current=null,z(!1))}))}(w,e)}}),[w]);var Q=Object(b.a)(f||(f=Object(c.a)(["\n\t\t/* stylelint-disable */\n\t\tmax-height: 350px;\n\t\toverflow-y: auto;\n\t"])));return Object(b.b)(p.NavigableMenu,{onNavigate:function(e){0===e&&M(null),M(e)},orientation:"vertical"},Object(b.b)("div",{style:{display:"flex"}},Object(b.b)("div",{style:{flexGrow:"1"}},"minimal"===a&&Object(b.b)(p.TextControl,{label:o,value:j,onChange:function(e){return k(e)},placeholder:n,autoComplete:"off"}),"search"===a&&Object(b.b)(p.SearchControl,{value:j,onChange:function(e){return k(e)},placeholder:n})),L&&Object(b.b)("div",{style:{position:"absolute",right:"minimal"===a?"8px":"50px",marginTop:"minimal"===a?"27px":"10px"}},Object(b.b)(p.Spinner,null))),q?Object(b.b)("ul",{className:"".concat(R,"-list"),style:{marginTop:"0",marginBottom:"0",marginLeft:"0",paddingLeft:"0",listStyle:"none"},css:Q},!L&&!K&&!1===S&&Object(b.b)("li",{className:"".concat(R,"-list-item components-button"),style:{color:"inherit",cursor:"default",paddingLeft:"3px"}},Object(d.__)("Nothing found.","prc-block-components")),!L&&!K&&S&&Object(b.b)("li",{className:"".concat(R,"-list-item components-button"),style:{color:"inherit",cursor:"default",paddingLeft:"3px"}},Object(d.__)("Press enter to change url.","prc-block-components")),!L&&T.map((function(e,n){return e.title.length?Object(b.b)("li",{key:e.id,className:"".concat(R,"-list-item"),style:{marginBottom:"0"}},Object(b.b)(x,{onClick:function(){return function(e){D([]),k(""),t(e)}(e)},searchTerm:w,suggestion:e,contentTypes:l,isSelected:H===n+1})):null}))):null)},P=n(121),S=Object(P.c)((function(){return React.createElement("svg",{style:{marginRight:"5px",cursor:"grab",flexShrink:0},width:"18",height:"18",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",role:"img","aria-hidden":"true",focusable:"false"},React.createElement("path",{d:"M5 4h2V2H5v2zm6-2v2h2V2h-2zm-6 8h2V8H5v2zm6 0h2V8h-2v2zm-6 6h2v-2H5v2zm6 0h2v-2h-2v2z"}))})),I=Object(l.a)("div")(h||(h=Object(c.a)(["\n\tbutton {\n\t\tdisplay: block;\n\t\tpadding: 2px 8px 6px 8px;\n\t\tmargin-left: auto;\n\t\tfont-size: 2em;\n\t\tcursor: pointer;\n\t\tborder: none;\n\t\tbackground-color: transparent;\n\n\t\t&:hover {\n\t\t\tbackground-color: #ccc;\n\t\t}\n\t}\n"]))),C=function(e){var t=e.item,n=e.isOrderable,o=void 0!==n&&n,r=e.handleItemDelete,c=e.mode,i="post"===c?"postType":"taxonomy",a=Object(s.useSelect)((function(e){var n=e("core"),o=n.getEntityRecord,r=n.hasFinishedResolution,a=[i,t.type,t.id],l=o.apply(void 0,a);if(l){console.log("Has Item",l);var s={title:"post"===c?l.title.rendered:l.name,url:l.link,id:l.id};return t.uuid&&(s.uuid=t.uuid),s}if(r("getEntityRecord",a))return null}),[t.id,i]);return Object(u.useEffect)((function(){null===a&&r(t)}),[t,r,a]),a?React.createElement(I,{style:{border:"2px dashed #ddd",paddingTop:"10px",paddingBottom:"10px",paddingLeft:o?"3px":"8px"},className:"block-editor-link-control__search-item is-entity"},o?React.createElement(S,null):"",React.createElement("span",{className:"block-editor-link-control__search-item-header"},React.createElement("span",{className:"block-editor-link-control__search-item-title"},Object(k.decodeEntities)(a.title)),React.createElement("span",{"aria-hidden":!0,className:"block-editor-link-control__search-item-info"},Object(j.filterURLForDisplay)(Object(j.safeDecodeURI)(a.url))||"")),React.createElement("button",{type:"button",onClick:function(){r(a)},"aria-label":Object(d.__)("Delete item","10up-block-components")},"Ã—")):React.createElement("div",null)},N=Object(P.a)((function(e){var t=e.items,n=e.isOrderable,o=e.handleItemDelete,r=e.mode,c=e.ChildComponent,i=void 0!==c&&c,a=!1!==i?n?Object(P.b)(i):i:n?Object(P.b)(C):C;return React.createElement("div",{style:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif'}},t.map((function(e,c){var i=e.uuid?e.uuid:e.id;return React.createElement(a,{isOrderable:!!(n&&t.length>1)&&n,key:"item-".concat(i),index:c,handleItemDelete:o,sortIndex:c,item:e,mode:r,totalItems:t.length})})))})),T=Object(l.a)("div")(g||(g=Object(c.a)(["\n\t& .block-editor-link-control__search-item {\n\t\tborder: none !important;\n\t\tcursor: default;\n\n\t\t&:hover {\n\t\t\tbackground: transparent;\n\t\t}\n\t}\n"]))),D=function(e){var t,n=e.label,c=e.placeholder,l=e.mode,p=void 0===l?"post":l,b=e.contentTypes,m=void 0===b?["post","page"]:b,f=e.onPickChange,h=void 0===f?function(e){console.log("Content picker list change",e)}:f,g=e.maxContentItems,v=void 0===g?1:g,O=e.isOrderable,y=void 0!==O&&O,j=e.singlePickedLabel,k=void 0===j?Object(d.__)("You have selected the following item:","prc-block-components"):j,w=e.multiPickedLabel,x=void 0===w?Object(d.__)("You have selected the following items:","prc-block-components"):w,R=e.value,E=void 0===R?[]:R,P=e.uniqueContentItems,S=void 0===P||P,I=e.excludeCurrentPost,C=void 0===I||I,D=e.perPage,A=void 0===D?50:D,B=e.PickedItemChild,L=void 0!==B&&B,z=e.searchStyle,F=void 0===z?"search":z,U=Object(u.useState)(E),H=Object(r.a)(U,2),M=H[0],Y=H[1],V=null===(t=Object(s.select)("core/editor"))||void 0===t?void 0:t.getCurrentPostId();Object(u.useEffect)((function(){console.log("Init content state",E)}),[]),Object(u.useEffect)((function(){M!==E&&0!==M.length&&(console.log("useEffect onPickChange->",M),h(M))}),[M]);var J=Object(u.useMemo)((function(){var e=S?Object(o.a)(M):[];return C&&V&&e.push({id:V}),e}),[M,V,C,S]);return React.createElement("div",{className:"".concat("prc-content-picker")},(!M.length||M.length&&M.length<v)&&React.createElement(_,{placeholder:c,label:n,excludeItems:J,onSelectItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("handleSelect->",e,t),Y(!0===t?function(t){return[{uuid:Object(i.a)(),type:"subtype"in e?e.subtype:e.type,url:e.url}].concat(Object(o.a)(t))}:function(t){return[{id:e.id,uuid:Object(i.a)(),type:"subtype"in e?e.subtype:e.type,url:e.url}].concat(Object(o.a)(t))})},contentTypes:m,mode:p,perPage:A,style:F}),Boolean(null==M?void 0:M.length)>0&&React.createElement(T,null,React.createElement("span",{style:{marginTop:"15px",marginBottom:"2px",display:"block"}},M.length>1?x:k),React.createElement(N,{items:M,useDragHandle:!0,handleItemDelete:function(e){Y((function(t){return t.filter((function(t){var n=t.id,o=t.uuid;return e.uuid?o!==e.uuid:n!==e.id}))}))},isOrderable:y,mode:p,onSortEnd:function(e){var t=e.oldIndex,n=e.newIndex,r=Object(o.a)(Object(a.default)(M,t,n));console.log("newContent?",r),Y(r)},ChildComponent:L})))},A=function(e){var t=e.blockProps,n=e.onChange,o=e.onSkip,r=e.mode,c=void 0===r?"post":r,i=e.contentTypes,a=void 0===i?["stub"]:i,l=e.label,s=void 0===l?Object(d.__)("Search for a post","prc-block-components"):l,b=e.placeholder,m=void 0===b?Object(d.__)("Search for a post or pate in a url...","prc-block-components"):b,f=e.value,h=void 0===f?[]:f,g=e.loadingComponent,v=void 0!==g&&g,O=e.children;return React.createElement("div",t,React.createElement(p.Placeholder,{label:"".concat(s,":"),isColumnLayout:!0},!1!==v&&React.createElement("div",{style:{textAlign:"center"}},React.createElement(p.Spinner,null),React.createElement("p",{className:"sans-serif"},"Loading object...")),!1===v&&React.createElement(u.Fragment,null,O,React.createElement(D,{onPickChange:function(e){console.log("Step1:",e),n(e)},mode:c,label:"".concat(s," or enter a url:"),placeholder:m,contentTypes:a,value:h}),React.createElement(p.Button,{isLink:!0,onClick:function(){o()},text:Object(d.__)("Skip"),style:{paddingLeft:"9px"}}))))}},2:function(e,t){e.exports=window.wp.element},24:function(e,t){e.exports=window.wp.primitives},27:function(e,t){e.exports=window.wp.apiFetch},3:function(e,t){e.exports=window.wp.i18n},321:function(e){e.exports=JSON.parse('{"apiVersion":2,"name":"prc-block/popular-listing","description":"A popular post, must be placed in a group block for numbers to appear.","title":"Popular Listing","category":"layout","attributes":{"title":{"type":"string"},"url":{"type":"string"},"postId":{"type":"integer"},"blockIndexAttr":{"type":"integer"},"enableNumber":{"type":"boolean"}},"supports":{"html":false}}')},36:function(e,t){e.exports=window.wp.url},4:function(e,t){e.exports=window.wp.components},45:function(e,t){e.exports=moment},6:function(e,t){e.exports=window.wp.blockEditor},66:function(e,t){e.exports=window.ReactDOM},869:function(e,t,n){n(23),e.exports=n(927)},927:function(e,t,n){"use strict";n.r(t);var o=n(14),r=n(3),c=n(10),i=n(411),a=n(321),l=n(6),s=n(2),u=n(12),d=(n(4),n(19)),p=n(194),b=n(141);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=e.setAttributes,n=e.blockProps,o=Object(s.useState)(!1),c=Object(d.a)(o,2),i=c[0],a=c[1];return React.createElement(p.a,{onChange:function(e){var n,o;e.length>0&&void 0!==e[0].id&&(a(!0),n=e[0].id,o=e[0].title,Object(b.b)({postId:n,title:o,setAttributes:t}))},onSkip:function(){t({postId:0})},label:Object(r.__)("Search for a popular post","prc-block-library"),blockProps:f(f({},n),{},{style:{marginBottom:"16px"}}),loadingComponent:i})},g=function(e){var t=e.attributes,n=e.setAttributes,o=e.isSelected,r=e.clientId,c=t.title,i=t.postId,a=Object(l.useBlockProps)(),d=Object(u.useSelect)((function(e){var t,n=e("core/block-editor").getBlockRootClientId(r);return null==n||"string"==typeof n&&0===n.length?{blockIndex:null,numberEnabled:!1}:("core/group"===e("core/block-editor").getBlock(n).name&&(t=e("core/block-editor").getBlockIndex(r,n)),{blockIndex:t,numberEnabled:!0})}),[r]),p=d.blockIndex,b=d.numberEnabled;return Object(s.useEffect)((function(){n({blockIndexAttr:p}),n(1==b?{enableNumber:!0}:{enableNumber:!1})}),[p]),void 0===i?React.createElement(h,{setAttributes:n,blockProps:a}):React.createElement("div",a,b&&p>=0&&React.createElement("span",{className:"big-number"},p+1),!0!==o&&React.createElement(l.RichText.Content,{className:"title",tagName:"h2",value:c}),!0===o&&React.createElement(l.RichText,{tagName:"h2",value:c,allowedFormats:["core/bold","core/italic"],onChange:function(e){return n({title:e})},placeholder:"Joe Biden does something about climate change...",keepPlaceholderOnFocus:!0,className:"title"}))},v=function(){return React.createElement(s.Fragment,null)};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=a.name,k={icon:i.a,edit:g,save:v};Object(c.registerBlockType)(j,y(y({},a),k))}},[[869,0,57]]]);
//# sourceMappingURL=popular-listing-84e0585b.js.map