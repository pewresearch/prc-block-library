{"version":3,"sources":["webpack:///external \"wp.element\"","webpack:///external \"wp.i18n\"","webpack:///external \"lodash\"","webpack:///external \"wp.blockEditor\"","webpack:///external \"wp.components\"","webpack:///external \"wp.blocks\"","webpack:///external \"wp.data\"","webpack:///external \"regeneratorRuntime\"","webpack:///external \"wp.url\"","webpack:///./src/menu-link/edit.js","webpack:///./src/menu-link/index.js","webpack:///./src/menu-link/save.js"],"names":["module","exports","wp","element","i18n","lodash","blockEditor","components","blocks","data","regeneratorRuntime","url","getSuggestionsQuery","type","subtype","compose","withSelect","select","ownProps","getClientIdsOfDescendants","getBlockAttributes","hasSelectedInnerBlock","getSelectedBlockClientId","getBlockParentsByBlockName","clientId","getSettings","hasDescendants","length","isParentOfSelectedBlock","isImmediateParentOfSelectedBlock","selectedBlockHasDescendants","userCanCreatePages","canUser","userCanCreatePosts","withDispatch","dispatch","registry","insertLinkBlock","insertBlock","navItems","insertionPoint","createBlock","attributes","isSelected","setAttributes","insertBlocksAfter","mergeBlocks","onReplace","label","opensInNewTab","description","rel","title","link","saveEntityRecord","useDispatch","useState","isLinkOpen","setIsLinkOpen","listItemRef","useRef","isDraggingWithin","elementRef","setIsDraggingWithin","useEffect","ownerDocument","current","handleDragStart","event","handleDragEnter","handleDragEnd","contains","target","addEventListener","removeEventListener","useIsDraggingWithin","itemLabelPlaceholder","__","ref","isDraggingBlocks","useSelect","isURL","prependHTTP","test","focus","selection","defaultView","getSelection","range","createRange","selectNodeContents","removeAllRanges","addRange","selectLabelText","placeCaretAtHorizontalEdge","userCanCreate","pageTitle","a","postType","status","page","id","rendered","blockProps","useBlockProps","className","classnames","innerBlocksProps","useInnerBlocksProps","allowedBlocks","renderAppender","InnerBlocks","DefaultAppender","__experimentalAppenderTagName","bindGlobal","shortcuts","rawShortcut","primary","name","icon","linkIcon","shortcut","displayShortcut","onClick","value","onChange","descriptionValue","help","titleValue","autoComplete","relValue","identifier","labelValue","onMerge","__unstableOnSplitAtEnd","aria-label","placeholder","keepPlaceholderOnFocus","withoutInteractiveFormatting","allowedFormats","position","onClose","showInitialSuggestions","withCreateSuggestion","createSuggestion","createSuggestionButtonText","searchTerm","format","createInterpolateElement","sprintf","mark","noDirectEntry","noURLSuggestion","suggestionsQuery","normalizedTitle","normalizedURL","newTitle","newURL","newOpensInNewTab","encodeURI","replace","escape","metadata","settings","variations","isDefault","postIcon","pageIcon","categoryIcon","tagIcon","__experimentalLabel","merge","leftAttributes","rightLabel","edit","save","Content","deprecated","isEligible","nofollow","default","migrate","registerBlockType"],"mappings":"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","file":"menu-link/main-c2f6890c.js","sourcesContent":["module.exports = wp.element;","module.exports = wp.i18n;","module.exports = lodash;","module.exports = wp.blockEditor;","module.exports = wp.components;","module.exports = wp.blocks;","module.exports = wp.data;","module.exports = regeneratorRuntime;","module.exports = wp.url;","/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { escape, get, head, find } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { createBlock } from '@wordpress/blocks';\nimport {\n\tuseSelect,\n\tuseDispatch,\n\twithDispatch,\n\twithSelect,\n} from '@wordpress/data';\nimport {\n\tKeyboardShortcuts,\n\tPanelBody,\n\tPopover,\n\tTextControl,\n\tTextareaControl,\n\tToolbarButton,\n\tToolbarGroup,\n} from '@wordpress/components';\nimport { rawShortcut, displayShortcut } from '@wordpress/keycodes';\nimport { __, sprintf } from '@wordpress/i18n';\nimport {\n\tBlockControls,\n\tInnerBlocks,\n\t__experimentalUseInnerBlocksProps as useInnerBlocksProps,\n\tInspectorControls,\n\tRichText,\n\t__experimentalLinkControl as LinkControl,\n\tuseBlockProps,\n} from '@wordpress/block-editor';\nimport { isURL, prependHTTP } from '@wordpress/url';\nimport {\n\tFragment,\n\tuseState,\n\tuseEffect,\n\tuseRef,\n\tcreateInterpolateElement,\n} from '@wordpress/element';\nimport { placeCaretAtHorizontalEdge } from '@wordpress/dom';\nimport { link as linkIcon } from '@wordpress/icons';\n\n/**\n * A React hook to determine if it's dragging within the target element.\n *\n * @typedef {import('@wordpress/element').RefObject} RefObject\n *\n * @param {RefObject<HTMLElement>} elementRef The target elementRef object.\n *\n * @return {boolean} Is dragging within the target element.\n */\nconst useIsDraggingWithin = ( elementRef ) => {\n\tconst [ isDraggingWithin, setIsDraggingWithin ] = useState( false );\n\n\tuseEffect( () => {\n\t\tconst { ownerDocument } = elementRef.current;\n\n\t\tfunction handleDragStart( event ) {\n\t\t\t// Check the first time when the dragging starts.\n\t\t\thandleDragEnter( event );\n\t\t}\n\n\t\t// Set to false whenever the user cancel the drag event by either releasing the mouse or press Escape.\n\t\tfunction handleDragEnd() {\n\t\t\tsetIsDraggingWithin( false );\n\t\t}\n\n\t\tfunction handleDragEnter( event ) {\n\t\t\t// Check if the current target is inside the item element.\n\t\t\tif ( elementRef.current.contains( event.target ) ) {\n\t\t\t\tsetIsDraggingWithin( true );\n\t\t\t} else {\n\t\t\t\tsetIsDraggingWithin( false );\n\t\t\t}\n\t\t}\n\n\t\t// Bind these events to the document to catch all drag events.\n\t\t// Ideally, we can also use `event.relatedTarget`, but sadly that\n\t\t// doesn't work in Safari.\n\t\townerDocument.addEventListener( 'dragstart', handleDragStart );\n\t\townerDocument.addEventListener( 'dragend', handleDragEnd );\n\t\townerDocument.addEventListener( 'dragenter', handleDragEnter );\n\n\t\treturn () => {\n\t\t\townerDocument.removeEventListener( 'dragstart', handleDragStart );\n\t\t\townerDocument.removeEventListener( 'dragend', handleDragEnd );\n\t\t\townerDocument.removeEventListener( 'dragenter', handleDragEnter );\n\t\t};\n\t}, [] );\n\n\treturn isDraggingWithin;\n};\n\n/**\n * Given the Link block's type attribute, return the query params to give to\n * /wp/v2/search.\n *\n * @param {string} type Link block's type attribute.\n * @return {{ type?: string, subtype?: string }} Search query params.\n */\nfunction getSuggestionsQuery( type ) {\n\tswitch ( type ) {\n\t\tcase 'post':\n\t\tcase 'page':\n\t\t\treturn { type: 'post', subtype: type };\n\t\tcase 'topic':\n\t\t\treturn { type: 'term', subtype: 'topic' };\n\t\tcase 'feature':\n\t\t\treturn { type: 'term', subtype: 'feature' };\n\t\tcase 'program':\n\t\t\treturn { type: 'term', subtype: 'program' };\n\t\tdefault:\n\t\t\treturn {};\n\t}\n}\n\nfunction NavigationLinkEdit( {\n\tattributes,\n\thasDescendants,\n\tisSelected,\n\tisImmediateParentOfSelectedBlock,\n\tisParentOfSelectedBlock,\n\tsetAttributes,\n\tinsertLinkBlock,\n\tselectedBlockHasDescendants,\n\tuserCanCreatePages = false,\n\tuserCanCreatePosts = false,\n\tinsertBlocksAfter,\n\tmergeBlocks,\n\tonReplace,\n} ) {\n\tconst {\n\t\tlabel,\n\t\ttype,\n\t\topensInNewTab,\n\t\turl,\n\t\tdescription,\n\t\trel,\n\t\ttitle,\n\t} = attributes;\n\tconst link = {\n\t\turl,\n\t\topensInNewTab,\n\t};\n\tconst { saveEntityRecord } = useDispatch( 'core' );\n\tconst [ isLinkOpen, setIsLinkOpen ] = useState( false );\n\tconst listItemRef = useRef( null );\n\tconst isDraggingWithin = useIsDraggingWithin( listItemRef );\n\tconst itemLabelPlaceholder = __( 'Add link…' );\n\tconst ref = useRef();\n\n\tconst isDraggingBlocks = useSelect(\n\t\t( select ) => select( 'core/block-editor' ).isDraggingBlocks(),\n\t\t[]\n\t);\n\n\t// Show the LinkControl on mount if the URL is empty\n\t// ( When adding a new menu item)\n\t// This can't be done in the useState call because it conflicts\n\t// with the autofocus behavior of the BlockListBlock component.\n\tuseEffect( () => {\n\t\tif ( ! url ) {\n\t\t\tsetIsLinkOpen( true );\n\t\t}\n\t}, [] );\n\n\t/**\n\t * The hook shouldn't be necessary but due to a focus loss happening\n\t * when selecting a suggestion in the link popover, we force close on block unselection.\n\t */\n\tuseEffect( () => {\n\t\tif ( ! isSelected ) {\n\t\t\tsetIsLinkOpen( false );\n\t\t}\n\t}, [ isSelected ] );\n\n\t// If the LinkControl popover is open and the URL has changed, close the LinkControl and focus the label text.\n\tuseEffect( () => {\n\t\tif ( isLinkOpen && url ) {\n\t\t\t// Does this look like a URL and have something TLD-ish?\n\t\t\tif (\n\t\t\t\tisURL( prependHTTP( label ) ) &&\n\t\t\t\t/^.+\\.[a-z]+/.test( label )\n\t\t\t) {\n\t\t\t\t// Focus and select the label text.\n\t\t\t\tselectLabelText();\n\t\t\t} else {\n\t\t\t\t// Focus it (but do not select).\n\t\t\t\tplaceCaretAtHorizontalEdge( ref.current, true );\n\t\t\t}\n\t\t}\n\t}, [ url ] );\n\n\t/**\n\t * Focus the Link label text and select it.\n\t */\n\tfunction selectLabelText() {\n\t\tref.current.focus();\n\t\tconst { ownerDocument } = ref.current;\n\t\tconst { defaultView } = ownerDocument;\n\t\tconst selection = defaultView.getSelection();\n\t\tconst range = ownerDocument.createRange();\n\t\t// Get the range of the current ref contents so we can add this range to the selection.\n\t\trange.selectNodeContents( ref.current );\n\t\tselection.removeAllRanges();\n\t\tselection.addRange( range );\n\t}\n\n\tlet userCanCreate = false;\n\tif ( ! type || type === 'page' ) {\n\t\tuserCanCreate = userCanCreatePages;\n\t} else if ( type === 'post' ) {\n\t\tuserCanCreate = userCanCreatePosts;\n\t}\n\n\tasync function handleCreate( pageTitle ) {\n\t\tconst postType = type || 'page';\n\n\t\tconst page = await saveEntityRecord( 'postType', postType, {\n\t\t\ttitle: pageTitle,\n\t\t\tstatus: 'publish',\n\t\t} );\n\n\t\treturn {\n\t\t\tid: page.id,\n\t\t\tpostType,\n\t\t\ttitle: page.title.rendered,\n\t\t\turl: page.link,\n\t\t};\n\t}\n\n\tconst blockProps = useBlockProps( {\n\t\tref: listItemRef,\n\t\tclassName: classnames( {\n\t\t\t'is-editing':\n\t\t\t\t( isSelected || isParentOfSelectedBlock ) &&\n\t\t\t\t// Don't show the element as editing while dragging.\n\t\t\t\t! isDraggingBlocks,\n\t\t\t// Don't select the element while dragging.\n\t\t\t'is-selected': isSelected && ! isDraggingBlocks,\n\t\t\t'is-dragging-within': isDraggingWithin,\n\t\t\t'has-link': !! url,\n\t\t\t'has-child': hasDescendants,\n\t\t} ),\n\t} );\n\n\tconst innerBlocksProps = useInnerBlocksProps(\n\t\t{\n\t\t\tclassName: classnames( 'wp-block-navigation__container', {\n\t\t\t\t'is-parent-of-selected-block':\n\t\t\t\t\tisParentOfSelectedBlock &&\n\t\t\t\t\t// Don't select as parent of selected block while dragging.\n\t\t\t\t\t! isDraggingBlocks,\n\t\t\t} ),\n\t\t},\n\t\t{\n\t\t\tallowedBlocks: [ 'prc-block/menu-link' ],\n\t\t\trenderAppender:\n\t\t\t\t( isSelected && hasDescendants ) ||\n\t\t\t\t( isImmediateParentOfSelectedBlock &&\n\t\t\t\t\t! selectedBlockHasDescendants ) ||\n\t\t\t\t// Show the appender while dragging to allow inserting element between item and the appender.\n\t\t\t\t( isDraggingBlocks && hasDescendants )\n\t\t\t\t\t? InnerBlocks.DefaultAppender\n\t\t\t\t\t: false,\n\t\t\t__experimentalAppenderTagName: 'li',\n\t\t}\n\t);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<BlockControls>\n\t\t\t\t<ToolbarGroup>\n\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\tbindGlobal\n\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t[ rawShortcut.primary( 'k' ) ]: () =>\n\t\t\t\t\t\t\t\tsetIsLinkOpen( true ),\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\tname=\"link\"\n\t\t\t\t\t\ticon={ linkIcon }\n\t\t\t\t\t\ttitle={ __( 'Link' ) }\n\t\t\t\t\t\tshortcut={ displayShortcut.primary( 'k' ) }\n\t\t\t\t\t\tonClick={ () => setIsLinkOpen( true ) }\n\t\t\t\t\t/>\n\t\t\t\t</ToolbarGroup>\n\t\t\t</BlockControls>\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Link settings' ) }>\n\t\t\t\t\t<TextareaControl\n\t\t\t\t\t\tvalue={ description || '' }\n\t\t\t\t\t\tonChange={ ( descriptionValue ) => {\n\t\t\t\t\t\t\tsetAttributes( { description: descriptionValue } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlabel={ __( 'Description' ) }\n\t\t\t\t\t\thelp={ __(\n\t\t\t\t\t\t\t'The description will be displayed in the menu if the current theme supports it.'\n\t\t\t\t\t\t) }\n\t\t\t\t\t/>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tvalue={ title || '' }\n\t\t\t\t\t\tonChange={ ( titleValue ) => {\n\t\t\t\t\t\t\tsetAttributes( { title: titleValue } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlabel={ __( 'Link title' ) }\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t/>\n\t\t\t\t\t<TextControl\n\t\t\t\t\t\tvalue={ rel || '' }\n\t\t\t\t\t\tonChange={ ( relValue ) => {\n\t\t\t\t\t\t\tsetAttributes( { rel: relValue } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tlabel={ __( 'Link rel' ) }\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t\t<li { ...blockProps }>\n\t\t\t\t<div className=\"wp-block-navigation-link__content\">\n\t\t\t\t\t<RichText\n\t\t\t\t\t\tref={ ref }\n\t\t\t\t\t\tidentifier=\"label\"\n\t\t\t\t\t\tclassName=\"wp-block-navigation-link__label\"\n\t\t\t\t\t\tvalue={ label }\n\t\t\t\t\t\tonChange={ ( labelValue ) =>\n\t\t\t\t\t\t\tsetAttributes( { label: labelValue } )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonMerge={ mergeBlocks }\n\t\t\t\t\t\tonReplace={ onReplace }\n\t\t\t\t\t\t__unstableOnSplitAtEnd={ () =>\n\t\t\t\t\t\t\tinsertBlocksAfter(\n\t\t\t\t\t\t\t\tcreateBlock( 'prc-block/menu-link' )\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t\taria-label={ __( 'Navigation link text' ) }\n\t\t\t\t\t\tplaceholder={ itemLabelPlaceholder }\n\t\t\t\t\t\tkeepPlaceholderOnFocus\n\t\t\t\t\t\twithoutInteractiveFormatting\n\t\t\t\t\t\tallowedFormats={ [\n\t\t\t\t\t\t\t'core/bold',\n\t\t\t\t\t\t\t'core/italic',\n\t\t\t\t\t\t\t'core/image',\n\t\t\t\t\t\t\t'core/strikethrough',\n\t\t\t\t\t\t] }\n\t\t\t\t\t/>\n\t\t\t\t\t{ isLinkOpen && (\n\t\t\t\t\t\t<Popover\n\t\t\t\t\t\t\tposition=\"bottom center\"\n\t\t\t\t\t\t\tonClose={ () => setIsLinkOpen( false ) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<LinkControl\n\t\t\t\t\t\t\t\tclassName=\"wp-block-navigation-link__inline-link-input\"\n\t\t\t\t\t\t\t\tvalue={ link }\n\t\t\t\t\t\t\t\tshowInitialSuggestions={ true }\n\t\t\t\t\t\t\t\twithCreateSuggestion={ userCanCreate }\n\t\t\t\t\t\t\t\tcreateSuggestion={ handleCreate }\n\t\t\t\t\t\t\t\tcreateSuggestionButtonText={ ( searchTerm ) => {\n\t\t\t\t\t\t\t\t\tlet format;\n\t\t\t\t\t\t\t\t\tif ( type === 'post' ) {\n\t\t\t\t\t\t\t\t\t\t/* translators: %s: search term. */\n\t\t\t\t\t\t\t\t\t\tformat = __(\n\t\t\t\t\t\t\t\t\t\t\t'Create post: <mark>%s</mark>'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t/* translators: %s: search term. */\n\t\t\t\t\t\t\t\t\t\tformat = __(\n\t\t\t\t\t\t\t\t\t\t\t'Create page: <mark>%s</mark>'\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn createInterpolateElement(\n\t\t\t\t\t\t\t\t\t\tsprintf( format, searchTerm ),\n\t\t\t\t\t\t\t\t\t\t{ mark: <mark /> }\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tnoDirectEntry={ !! type }\n\t\t\t\t\t\t\t\tnoURLSuggestion={ !! type }\n\t\t\t\t\t\t\t\tsuggestionsQuery={ getSuggestionsQuery( type ) }\n\t\t\t\t\t\t\t\tonChange={ ( {\n\t\t\t\t\t\t\t\t\ttitle: newTitle = '',\n\t\t\t\t\t\t\t\t\turl: newURL = '',\n\t\t\t\t\t\t\t\t\topensInNewTab: newOpensInNewTab,\n\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t} = {} ) =>\n\t\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t\turl: encodeURI( newURL ),\n\t\t\t\t\t\t\t\t\t\tlabel: ( () => {\n\t\t\t\t\t\t\t\t\t\t\tconst normalizedTitle = newTitle.replace(\n\t\t\t\t\t\t\t\t\t\t\t\t/http(s?):\\/\\//gi,\n\t\t\t\t\t\t\t\t\t\t\t\t''\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tconst normalizedURL = newURL.replace(\n\t\t\t\t\t\t\t\t\t\t\t\t/http(s?):\\/\\//gi,\n\t\t\t\t\t\t\t\t\t\t\t\t''\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\tnewTitle !== '' &&\n\t\t\t\t\t\t\t\t\t\t\t\tnormalizedTitle !==\n\t\t\t\t\t\t\t\t\t\t\t\t\tnormalizedURL &&\n\t\t\t\t\t\t\t\t\t\t\t\tlabel !== newTitle\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn escape( newTitle );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( label ) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn label;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t// If there's no label, add the URL.\n\t\t\t\t\t\t\t\t\t\t\treturn escape( normalizedURL );\n\t\t\t\t\t\t\t\t\t\t} )(),\n\t\t\t\t\t\t\t\t\t\topensInNewTab: newOpensInNewTab,\n\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Popover>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<ul { ...innerBlocksProps } />\n\t\t\t</li>\n\t\t</Fragment>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, ownProps ) => {\n\t\tconst {\n\t\t\tgetBlockAttributes,\n\t\t\tgetClientIdsOfDescendants,\n\t\t\thasSelectedInnerBlock,\n\t\t\tgetBlockParentsByBlockName,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetSettings,\n\t\t} = select( 'core/block-editor' );\n\t\tconst { clientId } = ownProps;\n\t\tconst hasDescendants = !! getClientIdsOfDescendants( [ clientId ] )\n\t\t\t.length;\n\t\tconst isParentOfSelectedBlock = hasSelectedInnerBlock( clientId, true );\n\t\tconst isImmediateParentOfSelectedBlock = hasSelectedInnerBlock(\n\t\t\tclientId,\n\t\t\tfalse\n\t\t);\n\t\tconst selectedBlockId = getSelectedBlockClientId();\n\t\tconst selectedBlockHasDescendants = !! getClientIdsOfDescendants( [\n\t\t\tselectedBlockId,\n\t\t] )?.length;\n\n\t\treturn {\n\t\t\tisParentOfSelectedBlock,\n\t\t\tisImmediateParentOfSelectedBlock,\n\t\t\thasDescendants,\n\t\t\tselectedBlockHasDescendants,\n\t\t\tuserCanCreatePages: select( 'core' ).canUser( 'create', 'pages' ),\n\t\t\tuserCanCreatePosts: select( 'core' ).canUser( 'create', 'posts' ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps, registry ) => {\n\t\treturn {\n\t\t\tinsertLinkBlock() {\n\t\t\t\tconst { clientId } = ownProps;\n\n\t\t\t\tconst { insertBlock } = dispatch( 'core/block-editor' );\n\n\t\t\t\tconst { getClientIdsOfDescendants } = registry.select(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\t\t\t\tconst navItems = getClientIdsOfDescendants( [ clientId ] );\n\t\t\t\tconst insertionPoint = navItems.length ? navItems.length : 0;\n\n\t\t\t\tconst blockToInsert = createBlock( 'prc-block/menu-link' );\n\n\t\t\t\tinsertBlock( blockToInsert, insertionPoint, clientId );\n\t\t\t},\n\t\t};\n\t} ),\n] )( NavigationLinkEdit );\n","/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport {\n\tcategory as categoryIcon,\n\tmapMarker as linkIcon,\n\tpage as pageIcon,\n\tpostTitle as postIcon,\n\ttag as tagIcon,\n} from '@wordpress/icons';\nimport { InnerBlocks } from '@wordpress/block-editor';\nimport { registerBlockType } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport metadata from './block.json';\nimport edit from './edit';\nimport save from './save';\n\nconst { name } = metadata;\n\nexport const settings = {\n\ttitle: __( 'Link' ),\n\n\ticon: linkIcon,\n\n\tdescription: __( 'Add a page, link, or another item to your navigation.' ),\n\n\tvariations: [\n\t\t{\n\t\t\tname: 'link',\n\t\t\tisDefault: true,\n\t\t\ttitle: __( 'Link' ),\n\t\t\tdescription: __( 'A link to a URL.' ),\n\t\t\tattributes: {},\n\t\t},\n\t\t{\n\t\t\tname: 'post',\n\t\t\ticon: postIcon,\n\t\t\ttitle: __( 'Post Link' ),\n\t\t\tdescription: __( 'A link to a post.' ),\n\t\t\tattributes: { type: 'post' },\n\t\t},\n\t\t{\n\t\t\tname: 'page',\n\t\t\ticon: pageIcon,\n\t\t\ttitle: __( 'Page Link' ),\n\t\t\tdescription: __( 'A link to a page.' ),\n\t\t\tattributes: { type: 'page' },\n\t\t},\n\t\t{\n\t\t\tname: 'topic',\n\t\t\ticon: categoryIcon,\n\t\t\ttitle: __( 'Topic Page Link' ),\n\t\t\tdescription: __( 'A link to a topic.' ),\n\t\t\tattributes: { type: 'topic' },\n\t\t},\n\t\t{\n\t\t\tname: 'feature',\n\t\t\ticon: tagIcon,\n\t\t\ttitle: __( 'Feature Link' ),\n\t\t\tdescription: __( 'A link to a feature.' ),\n\t\t\tattributes: { type: 'feature' },\n\t\t},\n\t\t{\n\t\t\tname: 'program',\n\t\t\ticon: tagIcon,\n\t\t\ttitle: __( 'Program Link' ),\n\t\t\tdescription: __( 'A link to a program.' ),\n\t\t\tattributes: { type: 'program' },\n\t\t},\n\t],\n\n\t__experimentalLabel: ( { label } ) => label,\n\n\tmerge( leftAttributes, { label: rightLabel = '' } ) {\n\t\treturn {\n\t\t\t...leftAttributes,\n\t\t\tlabel: leftAttributes.label + rightLabel,\n\t\t};\n\t},\n\n\tedit,\n\n\tsave,\n\n\tdeprecated: [\n\t\t{\n\t\t\tisEligible( attributes ) {\n\t\t\t\treturn attributes.nofollow;\n\t\t\t},\n\n\t\t\tattributes: {\n\t\t\t\tlabel: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\ttype: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\tnofollow: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t},\n\t\t\t\tdescription: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\tid: {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t},\n\t\t\t\topensInNewTab: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: false,\n\t\t\t\t},\n\t\t\t\turl: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tmigrate( { nofollow, ...rest } ) {\n\t\t\t\treturn {\n\t\t\t\t\trel: nofollow ? 'nofollow' : '',\n\t\t\t\t\t...rest,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tsave() {\n\t\t\t\treturn <InnerBlocks.Content />;\n\t\t\t},\n\t\t},\n\t],\n};\n\nregisterBlockType( name, {...metadata, ...settings});","/**\n * WordPress dependencies\n */\nimport { InnerBlocks } from '@wordpress/block-editor';\n\nexport default function save() {\n\treturn <InnerBlocks.Content />;\n}\n"],"sourceRoot":""}