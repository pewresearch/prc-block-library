/*!
 * 
 * prcBlocksLibrary
 * 
 * @author Seth Rubenstein
 * @version 0.1.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2021 Seth Rubenstein
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]=window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]||[]).push([[3],{0:function(e,t){e.exports=React},120:function(e){e.exports=JSON.parse('{"name":"prc-block/fact-sheet-collection","apiVersion":2,"category":"layout","attributes":{"altPostLabel":{"type":"string"},"enableFlags":{"type":"boolean","default":false},"pdfId":{"type":"integer","default":0}},"supports":{"html":false,"multiple":false},"styles":[{"name":"dropdown","label":"Dropdown","isDefault":true},{"name":"list","label":"List"}]}')},123:function(e,t){e.exports=lodash},130:function(e,t){e.exports=wp.blocks},137:function(e,t){e.exports=wp.htmlEntities},154:function(e,t,n){n(125),e.exports=n(167)},165:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var a=n(55),c=n(31),r=n(130),o=n(120),l=n(106),i=n(6),s=n(27),u=n(23),p=n(76),f=(n(71),n(83)),d=n.n(f),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return new Promise((function(n){var a={};d()({path:"/wp/v2/".concat(e,"?per_page=").concat(t)}).then((function(t){for(var c=0;c<t.length;c++){var r=t[c].slug.replace("".concat(e.toLowerCase(),"_"),"");a[t[c].id]={id:t[c].id,name:t[c].name,parent:t[c].parent,slug:r}}n(a)}))}))},b=(n(28),n(140),n(181),n(115),n(75),n(165),n(79),n(137)),g=n(182),h=n(138),O=(Object(g.a)({termsData:[],excludeData:[],includeData:[]})((function(e){var t=e.termsData,n=e.excludeData,a=e.includeData,c=e.setState,r=e.exclude,o=e.include,l=(e.letter,e.taxonomy),s=e.setAttributes,p=e.isSelected,f=function(){(function(e,t){return new Promise((function(n){d()({path:"/prc-api/v2/blocks/helpers/get-taxonomy-by-letter/?taxonomy=".concat(e,"&letter=").concat(t)}).then((function(e){n(e)}))}))})(l,100).then((function(e){c({termsData:e}),function(e){var t={};if(0!==e.length&&0!==r.length&&(t.excludeData=JSON.parse(r)),0!==e.length&&0===o.length){var n=[];e.map((function(e){n.push({id:e.term_id,name:e.name,slug:e.slug})})),s({include:JSON.stringify(n)}),t.includeData=n}else 0!==e.length&&0!==o.length&&(t.includeData=JSON.parse(o));c(t)}(e)}))};!1!==s&&Object(h.a)((function(){0===t.length&&f()}));var m=0!==o.length&&!1===s&&JSON.parse(o);return React.createElement("div",{className:"ui link list"},!1!==m&&React.createElement(i.Fragment,null,m.map((function(e){return React.createElement("a",{className:"item",href:"/".concat(l.toLowerCase(),"/").concat(e.slug)},e.name)}))),!1!==s&&React.createElement(i.Fragment,null,t.map((function(e){var t=r.includes(e.term_id);return React.createElement("div",{className:"item"},React.createElement(u.CheckboxControl,{label:Object(b.decodeEntities)(e.name),checked:t,onChange:function(t){var c,r,o,l,i,u,p;c=t,r=e.term_id,o=e.name,l=e.slug,u=n,p=a,!0===c?(u.push(r),-1!==(i=p.findIndex((function(e){return e.id===r})))&&p.splice(i,1)):(p.push({id:r,name:o,slug:l}),function(){var e=u.indexOf(r);-1!==e&&u.splice(e,1)}()),s({exclude:JSON.stringify(u),include:JSON.stringify(p)})},"data-termid":e.term_id,"data-term":e.name}),React.createElement("div",{style:{height:"15px",marginTop:"-5px"}},!0===p&&React.createElement("pre",{style:{fontSize:"11px",margin:0}},"(",e.slug,")")))}))))})),function(e){var t=e.label,n=e.setAttributes;return React.createElement(i.Fragment,null,React.createElement(u.TextControl,{label:"Alternate Post Label",value:t,onChange:function(e){return n({altPostLabel:e})}}))}),v=function(e){var t=e.termId,n=e.enableFlags,a=e.setAttributes,c=Object(i.useState)(!1),r=Object(l.a)(c,2),o=r[0],s=r[1],f=Object(p.useDispatch)("core/editor").editPost;return Object(i.useEffect)((function(){var e;(e="collection",new Promise((function(t){m(e).then((function(e){var n=[],a=Object.keys(e).map((function(t){return e[t]}));a.filter((function(e){return 0===e.parent})).forEach((function(e){var t=a.filter((function(t){return t.parent===e.id})),c=[];t.forEach((function(e){c.push({name:e.name,id:e.id})})),n.push({name:e.name,id:e.id,children:c})})),t(n)}))}))).then((function(e){s(e)}))}),[]),React.createElement(i.Fragment,null,!1!==o&&React.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end"}},React.createElement("div",{style:{flexGrow:1}},React.createElement(u.TreeSelect,{label:"Select Collection",noOptionLabel:"No Collection",onChange:function(e){return f({collection:parseFloat(e)})},selectedId:t,tree:o})),React.createElement("div",{style:{paddingLeft:"1em"}},React.createElement(u.ToggleControl,{label:"Enable Flags",checked:n,onChange:function(){return a({enableFlags:!n})}}))))},y=function(e){var t=e.attachmentId,n=e.setAttributes;return React.createElement(s.MediaUploadCheck,null,React.createElement(s.MediaUpload,{title:"Upload PDF",allowedTypes:["application/pdf"],value:t,onSelect:function(e){return n({pdfId:e.id})},render:function(e){var a=e.open;return React.createElement(u.ButtonGroup,null,React.createElement(u.Button,{isPrimary:!0,onClick:a},0===t?"Upload PDF":"Change PDF"),0!==t&&React.createElement(u.Button,{isSecondary:!0,onClick:function(){return n({pdfId:0})}},"Clear PDF"))}}))},E=function(e){var t=e.attributes,n=e.className,a=e.setAttributes,r=Object(s.useBlockProps)({className:n}),o=t.altPostLabel,l=t.enableFlags,i=t.pdfId,f=Object(p.useSelect)((function(e){return{termId:e("core/editor").getEditedPostAttribute("collection")}}),[]).termId;return React.createElement("div",r,React.createElement(u.Placeholder,{label:Object(c.__)("Configure Factsheet Collection"),isColumnLayout:!0},!isNaN(f)&&React.createElement(O,{label:o,setAttributes:a}),React.createElement(v,{termId:f,enableFlags:l,setAttributes:a}),React.createElement(y,{attachmentId:i,setAttributes:a})))},x=function(){var e=s.useBlockProps.save();return React.createElement(i.Fragment,e)};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=o.name,P={title:Object(c.__)("Fact Sheet Collection"),icon:"format-aside",description:Object(c.__)("Set and display a collection of Fact Sheet's. Set a report PDF or alternate language post."),keywords:[Object(c.__)("prc"),Object(c.__)("factsheet"),Object(c.__)("fact sheet"),Object(c.__)("collection")],example:{attributes:{altLangPostId:61623,collectionId:12812,reportPdfUrl:""}},edit:E,save:x};Object(r.registerBlockType)(R,j(j({},o),P))},23:function(e,t){e.exports=wp.components},27:function(e,t){e.exports=wp.blockEditor},31:function(e,t){e.exports=wp.i18n},6:function(e,t){e.exports=wp.element},62:function(e,t){e.exports=ReactDOM},71:function(e,t){e.exports=moment},75:function(e,t){e.exports=wp.url},76:function(e,t){e.exports=wp.data},83:function(e,t){e.exports=wp.apiFetch}},[[154,0,1,5]]]);
//# sourceMappingURL=main-6fb9099c.js.map