/*!
 * 
 * prcBlocksLibrary
 * 
 * @author Seth Rubenstein
 * @version 0.1.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2021 Seth Rubenstein
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]=window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]||[]).push([[3],{0:function(e,t){e.exports=React},100:function(e,t){e.exports=wp.htmlEntities},112:function(e,t,n){n(84),e.exports=n(125)},123:function(e,t,n){},125:function(e,t,n){"use strict";n.r(t);var c=n(37),a=n(31),r=n(92),l=n(77),o=n(68),i=n(4),s=n(22),u=n(29),p=n(53),d=n(52),f=n.n(d),m=n(142),b=(n(48),function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(t){var n={};f()({path:"/wp/v2/".concat(e)}).then((function(c){for(var a=0;a<c.length;a++){var r=c[a].slug.replace("".concat(e.toLowerCase(),"_"),"");n[c[a].id]={id:c[a].id,name:c[a].name,parent:c[a].parent,slug:r}}t(n)}))}))}),g=(n(20),n(103),n(140),n(74),n(97),n(123),n(82),n(100)),h=n(141),O=n(101),E=(Object(h.a)({termsData:[],excludeData:[],includeData:[]})((function(e){var t=e.termsData,n=e.excludeData,c=e.includeData,a=e.setState,r=e.exclude,l=e.include,o=(e.letter,e.taxonomy),s=e.setAttributes,p=e.isSelected,d=function(){(function(e,t){return new Promise((function(n){f()({path:"/prc-api/v2/blocks/helpers/get-taxonomy-by-letter/?taxonomy=".concat(e,"&letter=").concat(t)}).then((function(e){n(e)}))}))})(o,100).then((function(e){a({termsData:e}),function(e){var t={};if(0!==e.length&&0!==r.length&&(t.excludeData=JSON.parse(r)),0!==e.length&&0===l.length){var n=[];e.map((function(e){n.push({id:e.term_id,name:e.name,slug:e.slug})})),s({include:JSON.stringify(n)}),t.includeData=n}else 0!==e.length&&0!==l.length&&(t.includeData=JSON.parse(l));a(t)}(e)}))};!1!==s&&Object(O.a)((function(){0===t.length&&d()}));var m=0!==l.length&&!1===s&&JSON.parse(l);return React.createElement("div",{className:"ui link list"},!1!==m&&React.createElement(i.Fragment,null,m.map((function(e){return React.createElement("a",{className:"item",href:"/".concat(o.toLowerCase(),"/").concat(e.slug)},e.name)}))),!1!==s&&React.createElement(i.Fragment,null,t.map((function(e){var t=r.includes(e.term_id);return React.createElement("div",{className:"item"},React.createElement(u.CheckboxControl,{label:Object(g.decodeEntities)(e.name),checked:t,onChange:function(t){var a,r,l,o,i,u,p;a=t,r=e.term_id,l=e.name,o=e.slug,u=n,p=c,!0===a?(u.push(r),-1!==(i=p.findIndex((function(e){return e.id===r})))&&p.splice(i,1)):(p.push({id:r,name:l,slug:o}),function(){var e=u.indexOf(r);-1!==e&&u.splice(e,1)}()),s({exclude:JSON.stringify(u),include:JSON.stringify(p)})},"data-termid":e.term_id,"data-term":e.name}),React.createElement("div",{style:{height:"15px",marginTop:"-5px"}},!0===p&&React.createElement("pre",{style:{fontSize:"11px",margin:0}},"(",e.slug,")")))}))))})),function(e){var t=e.label,n=(e.isSelected,e.setAttributes);return React.createElement(i.Fragment,null,React.createElement(u.TextControl,{label:"Alt Post Label",value:t,onChange:function(e){return n({altPostLabel:e})}}))}),v=function(e){var t=e.termId,n=e.enableFlags,c=(e.isSelected,e.setAttributes),a=Object(i.useState)(!1),r=Object(o.a)(a,2),l=r[0],s=r[1],d=Object(p.useDispatch)("core/editor").editPost;return Object(i.useEffect)((function(){var e;(e="collection",new Promise((function(t){b(e).then((function(e){var n=[],c=Object.keys(e).map((function(t){return e[t]}));c.filter((function(e){return 0===e.parent})).forEach((function(e){var t=c.filter((function(t){return t.parent===e.id})),a=[];t.forEach((function(e){a.push({name:e.name,id:e.id})})),n.push({name:e.name,id:e.id,children:a})})),t(n)}))}))).then((function(e){s(e)}))}),[]),React.createElement(i.Fragment,null,!1!==l&&React.createElement(i.Fragment,null,React.createElement(u.TreeSelect,{label:"Select Collection",noOptionLabel:"No Collection",onChange:function(e){console.log("Collection Selected",e),d({collection:parseFloat(e)})},selectedId:t,tree:l}),React.createElement(u.ToggleControl,{label:"Enable Flags",checked:n,onChange:function(){return c({enableFlags:!n})}})))},y=function(e){var t=e.attachmentId,n=(e.isSelected,e.setAttributes);return React.createElement(i.Fragment,null,React.createElement(s.MediaUploadCheck,null,React.createElement(s.MediaUpload,{title:"Upload PDF",allowedTypes:["application/pdf"],value:t,onSelect:function(e){return n({pdfId:e.id})},render:function(e){var n=e.open;return React.createElement(i.Fragment,null,null===t&&React.createElement("a",{onClick:n,style:{cursor:"pointer"}},React.createElement("i",{class:"icon file pdf outline"}),"Upload a PDF version of this fact sheet"),null!==t&&React.createElement("a",{onClick:n,style:{cursor:"pointer"}},React.createElement("i",{class:"icon file pdf outline"}),"Change the PDF version of this fact sheet"))}})))},x=function(e){var t=e.attributes,n=e.className,c=e.setAttributes,a=e.isSelected,r=(e.clientId,Object(s.useBlockProps)({className:n})),l=t.altPostLabel,o=t.enableFlags,i=t.pdfId,u=Object(p.useSelect)((function(e){return{termId:e("core/editor").getEditedPostAttribute("collection")}}),[]).termId;return React.createElement("div",r,React.createElement(m.a,{color:"beige",inverted:!0},React.createElement(v,{termId:u,enableFlags:o,isSelected:a,setAttributes:c}),!isNaN(u)&&React.createElement(E,{label:l,isSelected:a,setAttributes:c}),React.createElement(y,{attachmentId:i,isSelected:a,setAttributes:c})))},R=function(e){e.attributes;return React.createElement(i.Fragment,null)};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=l.name,P={title:Object(a.__)("Fact Sheet Collection"),icon:"format-aside",description:Object(a.__)("Set and display a collection of Fact Sheet's. Set a report PDF or alternate language post."),keywords:[Object(a.__)("prc"),Object(a.__)("factsheet"),Object(a.__)("fact sheet"),Object(a.__)("collection")],example:{attributes:{altLangPostId:61623,collectionId:12812,reportPdfUrl:""}},edit:x,save:R};Object(r.registerBlockType)(S,w(w({},l),P))},22:function(e,t){e.exports=wp.blockEditor},29:function(e,t){e.exports=wp.components},31:function(e,t){e.exports=wp.i18n},4:function(e,t){e.exports=wp.element},48:function(e,t){e.exports=moment},52:function(e,t){e.exports=wp.apiFetch},53:function(e,t){e.exports=wp.data},56:function(e,t){e.exports=ReactDOM},77:function(e){e.exports=JSON.parse('{"name":"prc-block/fact-sheet-collection","apiVersion":2,"category":"layout","attributes":{"altPostLabel":{"type":"string"},"enableFlags":{"type":"boolean","default":true},"pdfId":{"type":"integer"}},"supports":{"html":false}}')},81:function(e,t){e.exports=lodash},92:function(e,t){e.exports=wp.blocks},97:function(e,t){e.exports=wp.url}},[[112,0,1,4]]]);
//# sourceMappingURL=main-8b1cc9d7.js.map