/*!
 * 
 * prcBlocksLibrary
 * 
 * @author Seth Rubenstein
 * @version 0.1.0
 * @link UNLICENSED
 * @license UNLICENSED
 * 
 * Copyright (c) 2021 Seth Rubenstein
 * 
 * This software is released under the UNLICENSED License
 * https://opensource.org/licenses/UNLICENSED
 * 
 * Compiled with the help of https://wpack.io
 * A zero setup Webpack Bundler Script for WordPress
 */
(window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]=window["wpackioprcBlocksLibraryfact-sheet-collectionJsonp"]||[]).push([[2],{0:function(e,t){e.exports=React},100:function(e,t){e.exports=wp.htmlEntities},111:function(e,t,n){n(76),e.exports=n(125)},122:function(e,t,n){},125:function(e,t,n){"use strict";n.r(t);var c=n(37),a=n(24),r=n(92),o=n(78),l=n(56),i=n(5),s=n(19),u=n(23),p=n(52),f=n(51),m=n.n(f),d=n(141),b=(n(48),function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(t){var n={};m()({path:"/wp/v2/".concat(e)}).then((function(c){for(var a=0;a<c.length;a++){var r=c[a].slug.replace("".concat(e.toLowerCase(),"_"),"");n[c[a].id]={id:c[a].id,name:c[a].name,parent:c[a].parent,slug:r}}t(n)}))}))}),h=(n(21),n(102),n(139),n(74),n(97),n(122),n(83),n(100)),g=n(140),O=n(101),v=(Object(g.a)({termsData:[],excludeData:[],includeData:[]})((function(e){var t=e.termsData,n=e.excludeData,c=e.includeData,a=e.setState,r=e.exclude,o=e.include,l=(e.letter,e.taxonomy),s=e.setAttributes,p=e.isSelected,f=function(){(function(e,t){return new Promise((function(n){m()({path:"/prc-api/v2/blocks/helpers/get-taxonomy-by-letter/?taxonomy=".concat(e,"&letter=").concat(t)}).then((function(e){n(e)}))}))})(l,100).then((function(e){a({termsData:e}),function(e){var t={};if(0!==e.length&&0!==r.length&&(t.excludeData=JSON.parse(r)),0!==e.length&&0===o.length){var n=[];e.map((function(e){n.push({id:e.term_id,name:e.name,slug:e.slug})})),s({include:JSON.stringify(n)}),t.includeData=n}else 0!==e.length&&0!==o.length&&(t.includeData=JSON.parse(o));a(t)}(e)}))};!1!==s&&Object(O.a)((function(){0===t.length&&f()}));var d=0!==o.length&&!1===s&&JSON.parse(o);return React.createElement("div",{className:"ui link list"},!1!==d&&React.createElement(i.Fragment,null,d.map((function(e){return React.createElement("a",{className:"item",href:"/".concat(l.toLowerCase(),"/").concat(e.slug)},e.name)}))),!1!==s&&React.createElement(i.Fragment,null,t.map((function(e){var t=r.includes(e.term_id);return React.createElement("div",{className:"item"},React.createElement(u.CheckboxControl,{label:Object(h.decodeEntities)(e.name),checked:t,onChange:function(t){var a,r,o,l,i,u,p;a=t,r=e.term_id,o=e.name,l=e.slug,u=n,p=c,!0===a?(u.push(r),-1!==(i=p.findIndex((function(e){return e.id===r})))&&p.splice(i,1)):(p.push({id:r,name:o,slug:l}),function(){var e=u.indexOf(r);-1!==e&&u.splice(e,1)}()),s({exclude:JSON.stringify(u),include:JSON.stringify(p)})},"data-termid":e.term_id,"data-term":e.name}),React.createElement("div",{style:{height:"15px",marginTop:"-5px"}},!0===p&&React.createElement("pre",{style:{fontSize:"11px",margin:0}},"(",e.slug,")")))}))))})),function(e){var t=e.url,n=e.setAttributes,c=Object(i.useState)(!1),r=Object(l.a)(c,2),o=r[0],p=r[1];return React.createElement(s.BlockControls,null,React.createElement(u.ToolbarGroup,null,React.createElement(u.ToolbarButton,{"aria-expanded":o,"aria-haspopup":"true",label:Object(a.__)("Set Link"),icon:"admin-links",onClick:function(){return p(!o)},showTooltip:!0}),!0===o&&React.createElement(u.Popover,{position:"bottom center",onClose:function(){return p(!1)}},React.createElement(s.__experimentalLinkControl,{className:"wp-block-navigation-link__inline-link-input",value:{url:t},showInitialSuggestions:!0,suggestionsQuery:{type:"post",subtype:"fact-sheets"},onChange:function(e){n({altPostUrl:e.url})},settings:[]}))))}),E=function(e){var t=e.url,n=e.label,c=(e.isSelected,e.setAttributes);return React.createElement(i.Fragment,null,React.createElement(u.TextControl,{label:"Alt Post Label",value:n,onChange:function(e){return c({altPostLabel:e})}}),React.createElement(v,{url:t,setAttributes:c}))},y=function(e){e.type,e.isSelected,e.setAttributes;var t=Object(i.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(p.useSelect)((function(e){return{termId:e("core/editor").getEditedPostAttribute("collection")}}),[]).termId,o=Object(p.useDispatch)("core/editor").editPost;return Object(i.useEffect)((function(){var e;(e="collection",new Promise((function(t){b(e).then((function(e){var n=[],c=Object.keys(e).map((function(t){return e[t]}));c.filter((function(e){return 0===e.parent})).forEach((function(e){var t=c.filter((function(t){return t.parent===e.id})),a=[];t.forEach((function(e){a.push({name:e.name,id:e.id})})),n.push({name:e.name,id:e.id,children:a})})),t(n)}))}))).then((function(e){a(e)}))}),[]),React.createElement(i.Fragment,null,!1!==c&&React.createElement(u.TreeSelect,{label:"Select Collection",noOptionLabel:"No Collection",onChange:function(e){console.log("Collection Selected",e),o({collection:parseFloat(e)})},selectedId:r,tree:c}))},x=function(e){var t=e.attachmentId,n=(e.isSelected,e.setAttributes);return React.createElement(i.Fragment,null,React.createElement(s.MediaUploadCheck,null,React.createElement(s.MediaUpload,{title:"Upload PDF",allowedTypes:["application/pdf","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ms-powerpoint","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],value:t,onSelect:function(e){return n({pdfId:e.id})},render:function(e){var n=e.open;return React.createElement(i.Fragment,null,null===t&&React.createElement("a",{onClick:n},React.createElement("i",{class:"icon file pdf outline"}),"Upload a PDF version of this fact sheet"),null!==t&&React.createElement("a",{onClick:n},React.createElement("i",{class:"icon file pdf outline"}),"Change the PDF version of this fact sheet"))}})))},R=function(e){var t=e.attributes,n=e.className,c=e.setAttributes,a=e.isSelected,r=(e.clientId,Object(s.useBlockProps)({className:n})),o=t.altPostUrl,l=t.altPostLabel,i=t.collectionType,u=t.pdfId;return React.createElement("div",r,React.createElement(d.a,{color:"beige",inverted:!0},React.createElement(E,{url:o,label:l,isSelected:a,setAttributes:c}),React.createElement(y,{type:i,isSelected:a,setAttributes:c}),React.createElement(x,{attachmentId:u,isSelected:a,setAttributes:c})))},w=function(e){e.attributes;return React.createElement(i.Fragment,null)};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=o.name,k={title:Object(a.__)("Fact Sheet Collection"),icon:"format-aside",description:Object(a.__)("Set and display a collection of Fact Sheet's. Set a report PDF or alternate language post."),keywords:[Object(a.__)("prc"),Object(a.__)("factsheet"),Object(a.__)("fact sheet"),Object(a.__)("collection")],example:{attributes:{altLangPostId:61623,collectionId:12812,reportPdfUrl:""}},edit:R,save:w};Object(r.registerBlockType)(P,S(S({},o),k))},19:function(e,t){e.exports=wp.blockEditor},23:function(e,t){e.exports=wp.components},24:function(e,t){e.exports=wp.i18n},48:function(e,t){e.exports=moment},5:function(e,t){e.exports=wp.element},51:function(e,t){e.exports=wp.apiFetch},52:function(e,t){e.exports=wp.data},55:function(e,t){e.exports=ReactDOM},78:function(e){e.exports=JSON.parse('{"name":"prc-block/fact-sheet-collection","apiVersion":2,"category":"layout","attributes":{"altPostUrl":{"type":"string"},"altPostLabel":{"type":"string"},"collectionType":{"type":"string","default":"flag"},"pdfId":{"type":"integer"}},"supports":{"html":false}}')},82:function(e,t){e.exports=lodash},92:function(e,t){e.exports=wp.blocks},97:function(e,t){e.exports=wp.url}},[[111,0,3]]]);
//# sourceMappingURL=main-1735ae73.js.map