{"version":3,"sources":["webpack:///external [\"wp\",\"blocks\"]","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/mailchimp-opt-down/edit.js","webpack:///./src/mailchimp-opt-down/save.js","webpack:///./src/mailchimp-opt-down/settings.js","webpack:///./src/mailchimp-opt-down/index.js","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./src/mailchimp-opt-down/component.js","webpack:///external [\"wp\",\"i18n\"]","webpack:///external [\"wp\",\"element\"]","webpack:///external [\"wp\",\"compose\"]"],"names":["module","exports","window","_arrayLikeToArray","arr","len","length","i","arr2","Array","edit","props","_props","interests","prcMailchimpForm","save","settings","title","__","description","icon","category","keywords","supports","html","registerBlockType","isArray","iter","Symbol","iterator","from","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","test","TypeError","MailchimpOptDown","withState","error","loading","list_id","choice","dimmerActive","dimmerMessage","emailAddress","setState","console","log","JSON","stringify","style","fontFamily","color","hidden","className","Field","Input","label","placeholder","data-validate","required","value","onChange","e","target","size","map","d","Checkbox","inline","readonly","defaultChecked","disabled","document","querySelector","onClick","preventDefault","email","validate_email","updated_interests","jQuery","each","extend","this","val","is","setTimeout","ajax","url","siteURL","param","type","fail","responseJSON","data","status","done","info"],"mappings":"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","file":"mailchimp-opt-down/main-cc052682.js","sourcesContent":["(function() { module.exports = window[\"wp\"][\"blocks\"]; }());","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import MailchimpOptDown from './component';\n\n\nconst edit = props => {\n\n  const _props = {\n\n      interests: window.prcMailchimpForm.interests,\n  };\n\n  return (\n    <MailchimpOptDown {..._props} />\n  );\n};\n\n\nexport default edit;\n","import MailchimpOptDown from './component';\n\n\nconst save = props => {\n  const _props = {\n\n      interests: window.prcMailchimpForm.interests,\n  };\n\n  return (\n    <MailchimpOptDown {..._props} />\n  );\n};\n\n\nexport default save;\n","import { __ } from '@wordpress/i18n';\nimport edit from './edit';\nimport save from './save';\n\nconst settings = [\n    'prc-block/mailchimp-opt-down',\n    {\n        // Block name. Block names must be string that contains a namespace prefix. Example: my-plugin/my-custom-block.\n        title: __('Mailchimp Opt-down Form'), // Block title.\n        description: __('Unsubscribe email address from all newsletter products EXCEPT the Quarterly Update'),\n        icon: 'feedback', // Block icon from Dashicons → https://developer.wordpress.org/resource/dashicons/.\n        category: 'widgets', // Block category — Group blocks together based on common traits E.g. common, formatting, layout widgets, embed.\n        keywords: [\n            __('prc'),\n            __('mailchimp'),\n            __('newsletter'),\n            __('newsletter signup'),\n        ],\n        supports: {\n            html: false, // We do not want to give people the ability to edit the raw html of this block.\n        },\n        edit,\n        save,\n    },\n];\n\nexport default settings;\n","import { registerBlockType } from '@wordpress/blocks';\nimport settings from './settings';\n\nregisterBlockType(...settings);\n","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import { Component, Fragment, RawHTML } from '@wordpress/element';\nimport { withState } from '@wordpress/compose';\nimport { Form, Input, Dimmer, Button, Message } from 'semantic-ui-react';\n\nconst defaultState = {\n    error: false,\n    loading: false,\n    list_id: 'a33430a835', // Mailchimp ID for Quarterly Update newsletter\n    choice: true,\n    dimmerActive: false,\n    dimmerMessage: '',\n};\n\nconst MailchimpOptDown = withState(defaultState)(({\n        list_id,\n        interests,\n        error,\n        loading,\n        choice,\n        emailAddress,\n        dimmerActive,\n        dimmerMessage,\n        setState,\n    }) => {\n\n        const validate_email = e => {\n          return /^.+@.+\\..+$/.test(e);\n        };\n\n        const submitHandler = e => {\n          e.preventDefault();\n          setState({\n            loading:true,\n            dimmerActive: false\n          });\n          const email = emailAddress;\n          if (!validate_email(email)) {\n            console.log('email error');\n            setState({\n              dimmerMessage: 'Please enter a valid email address.' ,\n              error: true,\n              loading:false,\n              dimmerActive: true\n            });\n\n            return;\n          }\n          let updated_interests = {};\n\n          jQuery.each(jQuery(\"input[name='interests']\"), function(){\n              jQuery.extend(updated_interests, {[jQuery(this).val()] : jQuery(this).is(\":checked\") ? true : false });\n          });\n\n          setTimeout(() => {\n              jQuery\n                  .ajax({\n                      url: `${\n                          window.siteURL\n                      }/wp-json/prc-api/v2/mailchimp/update?${jQuery.param(\n                          {\n                              email,\n                              interests: updated_interests,\n                          })}`,\n                      type: 'POST',\n                  })\n                  .fail( e => {\n                    console.log(e);\n                    if (e.responseJSON.data.status == '404') {\n                      setState({\n                          dimmerMessage:\n                              'We could not find that email address in our records.',\n                          error: true,\n                          loading:false,\n                          dimmerActive: true\n                      });\n                    }\n                  })\n                  .done(() => {\n                      console.info('Succesfully subscribed');\n                      setState({\n                          dimmerMessage:\n                              'You have succesfully updated your preferences.',\n                          error: false,\n                          loading:false,\n                          dimmerActive: true\n                      });\n                  })\n          });\n\n        };\n\n\n        console.log(JSON.stringify(interests));\n        console.log(emailAddress);\n\n        return (\n          <>\n            <Message\n              style={{fontFamily: 'franklin-gothic-urw'}}\n              color={ error ? 'red' : 'green'}\n              hidden={!dimmerActive }>\n              {dimmerMessage}\n            </Message>\n            <Form className=\"mailchimp-opt-down\">\n              <Form.Field>\n              <Form.Input\n                label=\"Email\"\n                placeholder=\"Your email address\"\n                name=\"email\"\n                data-validate=\"mc-email\"\n                required\n                value={emailAddress}\n                onChange={ e => { setState({emailAddress: e.target.value}) } }\n                size=\"big\"\n                />\n                </Form.Field>\n                { interests.map( (d,i) =>\n                  <Form.Field>\n                    <Form.Checkbox\n                      inline\n                      name=\"interests\"\n                      label={<label style={{fontFamily: 'franklin-gothic-urw'}}> {d.value === list_id ? `Send me quarterly updates and unsubscribe from all other newsletters.` : d.label }</label>}\n                      value={d.value}\n                      readonly={d.value !== list_id ? true : false }\n                      defaultChecked={d.value === list_id ? true : false }\n                      style={{ 'display' : d.value !== list_id ? `none` : `inherit` }}\n                      onChange={ e => { setState({choice: !choice }) } }\n                    />\n                  </Form.Field>\n                )}\n              <Button disabled={ !choice || document.querySelector('body.wp-admin') } onClick={submitHandler} loading={loading}>Update preferences</Button>\n            </Form>\n          </>\n        );\n    },\n);\n\nexport default MailchimpOptDown;\n","(function() { module.exports = window[\"wp\"][\"i18n\"]; }());","(function() { module.exports = window[\"wp\"][\"element\"]; }());","(function() { module.exports = window[\"wp\"][\"compose\"]; }());"],"sourceRoot":""}