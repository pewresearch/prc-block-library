import{getContext as e,getElement as o,store as i,withScope as n,withSyncEvent as t}from"@wordpress/interactivity";const{actions:s,state:l}=i("prc-block/dialog",{state:{get id(){const o=e();return o?.id},get activationTimerDuration(){const{id:o}=e();return l.dialogs[o].activationTimerDuration},get animationDuration(){const{id:o}=e();return l.dialogs[o].animationDuration},get dialogElement(){const{id:o}=e();return document.getElementById(o)},get isOpen(){const{id:o}=e();return l.dialogs[o].isOpen},get isClosing(){const{id:o}=e();return l[o].isClosing},get enableDeepLink(){const{id:o}=e();return l.dialogs[o].enableDeepLink}},actions:{closeAll:()=>{const{dialogs:e}=l;Object.keys(e).forEach(o=>{"object"==typeof e[o]&&e[o].hasOwnProperty("isOpen")&&(l.dialogs[o].isOpen=!1,window.dispatchEvent(new CustomEvent("dialogClosed",{detail:{id:o}})))})},onClickOpen:t(e=>{e.preventDefault();const{id:o}=l;s.open(o)}),onClickClose:t(e=>{e.preventDefault();const{id:o}=l;s.close(o)}),open:(e=!1)=>{let o=e;o||(o=l.id),o?(l.dialogs[o].isOpen=!0,l.dialogs[o].closingModal=!1,window.dispatchEvent(new CustomEvent("dialogOpened",{detail:{id:o}}))):console.error("No id found to open dialog.")},close:(e=!1)=>{let o=e;o||(o=l.id),o?(l.dialogs[o].isOpen=!1,window.dispatchEvent(new CustomEvent("dialogClosed",{detail:{id:o}}))):console.error("No id found to close dialog.")}},callbacks:{onESCKey:e=>{const{id:o,isOpen:i}=l;o&&"Escape"===e.key&&(console.log("onESCKey:::id",o),!0===i&&(e.preventDefault(),s.close(o)))},onOpen:()=>{const{dialogElement:e,isOpen:o,id:i,enableDeepLink:n}=l;i&&e&&o&&(n&&function(e){const o=new URL(window.location.href);o.searchParams.set("dialogId",e),window.history.replaceState({},"",o)}(i),e?.showModal())},onClose:()=>{const{dialogElement:e,isOpen:o,id:i,animationDuration:t}=l;i&&e&&(o||(l.dialogs[i].isClosing=!0,setTimeout(n(()=>{e?.close(),function(){const e=new URL(window.location.href);e.searchParams.delete("dialogId"),window.history.replaceState({},"",e)}();const o=new CustomEvent("prc-block-dialog-closed",{detail:{id:i}});document.dispatchEvent(o),l.dialogs[i].isClosing=!1,l.dialogs[i].isOpen=!1}),t)))},onBackdropClick:t(e=>{const{ref:i}=o(),n=i.getBoundingClientRect();if(e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom)return;if(!0!==l.isOpen)return;const{id:t}=l;s.close(t)}),onAutoActivation:()=>{const{id:e,activationTimerDuration:o,dialogs:i}=l;if(!e&&!o&&-1!==o)return;console.log("onAutoActivation:::id",e,o);const t=Object.keys(i);for(let e=0;e<t.length;e++)if(i[t[e]].isOpen)return;1<=o&&setTimeout(n(()=>{s.closeAll(),s.open(e)}),o)}}});
//# sourceMappingURL=view.js.map