import{getContext as e,getElement as t,store as i,withScope as n,withSyncEvent as o}from"@wordpress/interactivity";const{actions:s,state:l}=i("prc-block/dialog",{state:{get id(){const t=e();return t?.id},get activationTimerDuration(){const{id:t}=e();return l.dialogs[t].activationTimerDuration},get animationDuration(){const{id:t}=e();return l.dialogs[t].animationDuration},get dialogElement(){const{id:t}=e();return document.getElementById(t)},get isOpen(){const{id:t}=e();return l.dialogs[t].isOpen},get isClosing(){const{id:t}=e();return l[t].isClosing},get enableDeepLink(){const{id:t}=e();return l.dialogs[t].enableDeepLink}},actions:{closeAll:()=>{const{dialogs:e}=l;Object.keys(e).forEach(t=>{"object"==typeof e[t]&&e[t].hasOwnProperty("isOpen")&&(l.dialogs[t].isOpen=!1)})},onClickOpen:o(e=>{e.preventDefault();const{id:t}=l;s.open(t)}),onClickClose:o(e=>{e.preventDefault();const{id:t}=l;s.close(t)}),open:(e=!1)=>{let t=e;t||(t=l.id),t&&(l.dialogs[t].isOpen=!0,l.dialogs[t].closingModal=!1)},close:(e=!1)=>{let t=e;t||(t=l.id),t&&(l.dialogs[t].isOpen=!1)}},callbacks:{onESCKey:e=>{const{id:t,isOpen:i}=l;t&&"Escape"===e.key&&!0===i&&(e.preventDefault(),s.close(t))},onOpen:()=>{const{dialogElement:e,isOpen:t,id:i,enableDeepLink:n}=l;i&&e&&t&&(n&&function(e){const t=new URL(window.location.href);t.searchParams.set("dialogId",e),window.history.replaceState({},"",t)}(i),e?.showModal())},onClose:()=>{const{dialogElement:e,isOpen:t,id:i,animationDuration:o}=l;i&&e&&(t||(l.dialogs[i].isClosing=!0,setTimeout(n(()=>{e?.close(),function(){const e=new URL(window.location.href);e.searchParams.delete("dialogId"),window.history.replaceState({},"",e)}();const t=new CustomEvent("prc-block-dialog-closed",{detail:{id:i}});document.dispatchEvent(t),l.dialogs[i].isClosing=!1,l.dialogs[i].isOpen=!1}),o)))},onBackdropClick:o(e=>{const{ref:i}=t(),n=i.getBoundingClientRect();if(e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom)return;if(!0!==l.isOpen)return;const{id:o}=l;s.close(o)}),onAutoActivation:()=>{const{id:e,activationTimerDuration:t,dialogs:i}=l;if(!e&&!t&&-1!==t)return;const o=Object.keys(i);for(let e=0;e<o.length;e++)if(i[o[e]].isOpen)return;1<=t&&setTimeout(n(()=>{s.closeAll(),s.open(e)}),t)}}});
//# sourceMappingURL=view.js.map