import{getContext as e,getElement as o,store as n,withScope as i,withSyncEvent as t}from"@wordpress/interactivity";const{actions:s,state:l}=n("prc-block/dialog",{state:{get id(){const o=e();return o?.id},get activationTimerDuration(){const{id:o}=e();return l.dialogs[o].activationTimerDuration},get animationDuration(){const{id:o}=e();return l.dialogs[o].animationDuration},get dialogElement(){const{id:o}=e();return document.getElementById(o)},get isOpen(){const{id:o}=e();return l.dialogs[o].isOpen},get isClosing(){const{id:o}=e();return l[o].isClosing},get enableDeepLink(){const{id:o}=e();return l.dialogs[o].enableDeepLink}},actions:{closeAll:()=>{const{dialogs:e}=l;Object.keys(e).forEach(o=>{"object"==typeof e[o]&&e[o].hasOwnProperty("isOpen")&&(l.dialogs[o].isOpen=!1,window.dispatchEvent(new CustomEvent("dialogClosed",{detail:{id:o}})))})},onClickOpen:t(e=>{e.preventDefault();const{id:o}=l;s.open(o)}),onClickClose:t(e=>{e.preventDefault();const{id:o}=l;s.close(o)}),open:(e=!1)=>{let o=e;o||(o=l.id),o?(l.dialogs[o].isOpen=!0,l.dialogs[o].closingModal=!1,window.dispatchEvent(new CustomEvent("dialogOpened",{detail:{id:o}}))):console.error("No id found to open dialog.")},close:(e=!1)=>{let o=e;o||(o=l.id),o?(l.dialogs[o].isOpen=!1,window.dispatchEvent(new CustomEvent("dialogClosed",{detail:{id:o}}))):console.error("No id found to close dialog.")}},callbacks:{onESCKey:e=>{const{id:o,isOpen:n}=l;o&&"Escape"===e.key&&(console.log("onESCKey:::id",o),!0===n&&(e.preventDefault(),s.close(o)))},onOpen:()=>{const{dialogElement:e,isOpen:o,id:n,enableDeepLink:i}=l;n&&e&&o&&(i&&function(e){const o=new URL(window.location.href);o.searchParams.set("dialogId",e),window.history.replaceState({},"",o)}(n),console.log("onOpen:::dialogElement",e),e?.showModal())},onClose:()=>{const{dialogElement:e,isOpen:o,id:n,animationDuration:t}=l;n&&e&&(o||(l.dialogs[n].isClosing=!0,setTimeout(i(()=>{e?.close(),function(){const e=new URL(window.location.href);e.searchParams.delete("dialogId"),window.history.replaceState({},"",e)}();const o=new CustomEvent("prc-block-dialog-closed",{detail:{id:n}});document.dispatchEvent(o),l.dialogs[n].isClosing=!1,l.dialogs[n].isOpen=!1}),t)))},onBackdropClick:t(e=>{const{ref:n}=o(),i=n.getBoundingClientRect();if(e.clientX>=i.left&&e.clientX<=i.right&&e.clientY>=i.top&&e.clientY<=i.bottom)return;if(!0!==l.isOpen)return;const{id:t}=l;s.close(t)}),onAutoActivation:()=>{const{id:e,activationTimerDuration:o,dialogs:n}=l;if(!e&&!o&&-1!==o)return;const t=Object.keys(n);for(let e=0;e<t.length;e++)if(n[t[e]].isOpen)return;1<=o&&setTimeout(i(()=>{s.closeAll(),s.open(e)}),o)}}});
//# sourceMappingURL=view.js.map