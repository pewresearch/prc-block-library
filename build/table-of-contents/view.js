import{getContext as t,getElement as e,store as o}from"@wordpress/interactivity";const{actions:n,state:c}=o("prc-block/table-of-contents",{state:{get isActive(){const e=t(),{part:o,chapter:c,section:i}={...e},r=n.getContextClue(e);return"part"===r?o.is_active:"chapter"===r?c.is_active:"section"===r&&i.is_active}},actions:{onClick:e=>{e.preventDefault();const o=t();o.isDropdownOpen=!o.isDropdownOpen},getInternalChaptersList:()=>{const{ref:t}=e();return t.querySelector(".wp-block-prc-block-table-of-contents__list .is-top-level")?t.querySelector(".wp-block-prc-block-table-of-contents__list"):t.querySelector(".wp-block-prc-block-table-of-contents__list .wp-block-prc-block-table-of-contents__list")},initSmoothScrollClickHandler:()=>{const t=n.getInternalChaptersList();if(!t)return;const e=t.querySelectorAll("a");e&&e.forEach(t=>{t.addEventListener("click",e=>{const o=t.getAttribute("href");if(0===o.indexOf("#")){const t=document.getElementById(o.replace("#",""));t&&(t.scrollIntoView({behavior:"smooth"},!0),window.history.pushState(null,null,o))}})})},onDropdownClick:e=>{e.preventDefault();const o=t();o.isDropdownOpen=!o.isDropdownOpen},getContextClue:t=>!t.part||t.chapter||t.section?t.chapter&&!t.section?"chapter":t.section?"section":void 0:"part"},callbacks:{mapFoundSectionsToChapters:()=>{const{sectionsFound:e,postId:o,partsEnabled:n}=c;if(!e)return;const i=Object.entries(e).map(([t,e])=>({key:t,label:e,url:`#${t}`,items:[],chapters:[],is_active:!1})),{items:r}=t(),s=r.findIndex(t=>t.key===`unattachedPackagePart_${o}`);if(-1!==s)r[s].sections=i;else if(n){const t=r.findIndex(t=>t.chapters.find(t=>!0===t.is_active));if(-1===t)return;const e=r[t].chapters.findIndex(t=>!0===t.is_active);r[t].chapters[e].sections=i}else{const t=r.findIndex(t=>!0===t.is_active);r[t].sections=i}},hasListItems(){const e=t(),{part:o,chapter:n}={...e};return void 0===n&&void 0!==o?o.sections.length>0:void 0!==n&&n.sections.length>0},isActive(){const e=t(),{part:o,chapter:c,section:i}={...e},r=n.getContextClue(e);return"part"===r?o.is_active:"chapter"===r?c.is_active:"section"===r&&i.is_active},onResizeToggleDropdown:()=>{const o=t(),{autoDropdownEnabled:n,autoDropdownWidth:c}=o;if(!n)return;const{ref:i}=e(),r=i.offsetWidth;o.isDropdown=!!(r<c&&n)},onWindowClickCloseDropdown:o=>{const n=t(),{ref:c}=e();!c.contains(o.target)&&n.isDropdown&&(n.isDropdownOpen=!1)},scrollSmoothly:e=>{const o=t(),{section:n}=o,{key:c}=n;e.preventDefault();const i=document.getElementById(c);i&&(i.scrollIntoView({behavior:"smooth"},!0),window.history.pushState(null,null,`#${c}`)),o.isDropdownOpen=!1},initWatchForSectionScroll:()=>{const e=t(),{highlightCurrentSection:o}=e;!0===o&&(c.enableWatchForSectionScroll=!0)},watchForCurrentSection:()=>{const e=t();if(!c.enableWatchForSectionScroll&&!e.highlightCurrentSection)return;const{key:o}=e.section,{currentSection:n}=c;e.section.is_active=o===n},watchForSectionScroll:()=>{if(!c.enableWatchForSectionScroll)return;const t=c.sectionsFound;if(!t)return;const e=Object.keys(t);if(!e.length)return;const o=window.scrollY;let n=null;for(let t=0;t<e.length;t++){const c=e[t],i=document.getElementById(c);if(i){if(!(i.offsetTop-o<=50))break;n=c}}c.currentSection=n}}});
//# sourceMappingURL=view.js.map