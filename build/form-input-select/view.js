import{getContext as e,store as t,withSyncEvent as n}from"@wordpress/interactivity";const{state:o,actions:r}=t("prc-block/form-input-select",{state:{get activeIndex(){const t=e(),{id:n}=t;return n&&o[n]&&o[n].activeIndex||0},get isOpen(){const t=e(),{id:n}=t;return n&&o[n]&&o[n].isOpen||!1},get formField(){const t=e(),{id:n}=t;if(!n||!o[n])return{};const{name:r,label:i,value:a,required:s,placeholder:l,hidden:c,readonly:u,disabled:p,error:d,options:g}=o[n];return{name:r,label:i,value:a,required:s,placeholder:l,hidden:c,readonly:u,disabled:p,error:d,options:g}},get isInputRequired(){const t=e(),{id:n}=t;return n&&o[n]&&o[n].required||!1},get isInputDisabled(){const t=e(),{id:n}=t;return n&&o[n]&&o[n].isDisabled||!1},get isInputReadonly(){const t=e(),{allowSearch:n}=t;return!n},get inputId(){const t=e(),{id:n}=t;return!(!n||!o[n])&&n},get inputLabel(){const t=e(),{id:n}=t;return!(!n||!o[n])&&(o[n].label||"")},get inputValue(){const t=e(),{id:n}=t;return n&&o[n]&&o[n].value||""},get inputPlaceholder(){const t=e(),{id:n}=t;return!(!n||!o[n])&&(o[n].placeholder||"")},get hasValue(){const t=e(),{id:n}=t;return!(!n||!o[n]||!o[n].value)},get hasClearIcon(){const t=e(),{id:n,hasClearIcon:r}=t;return!(!n||!o[n]||!r||!o[n].value&&!searchTerm)},get inputOptions(){const t=e(),{id:n,searchTerm:r}=t;if(!n||!o[n])return[];let i=o[n].options||[];if(r&&r.length>0&&i){const e=i.filter(e=>e.label.toLowerCase().includes(r.toLowerCase()));e.length>0&&(i=e)}return i}},actions:{hoistValueToTargetState:(e,n)=>{const{state:r}=t(n);if(!r)return;const{formFields:i}=r;if(!i)return;let a=i.find(t=>t.id===e);if(!a)return;const s=o.formField;s&&(a={...a,...s},r.formFields=i.map(t=>t.id===e?a:t))},onInputKeyDown:n(t=>{const{activeIndex:n,id:i,targetNamespace:a,allowSearch:s}=e(),l=["ArrowDown","ArrowUp","Enter","Escape","Tab"].includes(t.key);if("ArrowDown"===t.key||"ArrowUp"===t.key)return t.preventDefault(),void t.stopPropagation();if(!s&&!l)return t.preventDefault(),void t.stopPropagation();if("Enter"===t.key){t.preventDefault(),t.stopPropagation();const{inputOptions:e}=o;if(e&&e[n]){const{label:t,value:s}=e[n];o[i].value=s,o[i].label=t,o[i].isOpen=!1,r.hoistValueToTargetState(i,a)}}}),onInputKeyUp:n(t=>{const n=e(),{id:i,allowSearch:a}=n;return a&&(n.searchTerm=t.target.value),o[i].isOpen||(o[i].isOpen=!0),"ArrowDown"===t.key?(t.preventDefault(),t.stopPropagation(),void r.moveThroughChoices(1,t.target)):"ArrowUp"===t.key?(t.preventDefault(),t.stopPropagation(),void r.moveThroughChoices(-1,t.target)):void("Escape"===t.key&&(o[i].isOpen=!1))}),onLabelClick:n(t=>{const{id:n}=e(),o=document.getElementById(n);o&&o.focus()}),onInputClearButtonClick:n(t=>{const{id:n}=e(),{targetNamespace:i}=e();e().searchTerm="",o[n].value="",o[n].label="",o[n].isOpen=!1,r.hoistValueToTargetState(n,i)}),moveThroughChoices:(t,n)=>{const{inputOptions:r}=o,{activeIndex:i}=e();let a=null;a=null===i||isNaN(i)?0:i+t,a<0&&(a=r.length-1),a>=r.length&&(a=0);const s=r[a].value,l=n.parentElement.parentElement.querySelector(".wp-block-prc-block-form-input-select__list"),c=l.querySelector(`[data-ref-value="${s}"]`);if(c){const e=l.querySelector(".is-selected");e&&e.classList.remove("is-selected"),c.classList.add("is-selected"),c.scrollIntoView({block:"nearest"})}e().activeIndex=a},onInputOptionClick:n(t=>{t.preventDefault();const n=e(),{id:i,targetNamespace:a}=n,{value:s,label:l}=n.option;o[i].value=s,o[i].label=l,r.hoistValueToTargetState(i,a)}),onInputFocus:n(t=>{const n=e(),{id:r}=n;o[r]&&(o[r].isOpen=!0)}),onInputBlur:n(t=>{let n=!1;if(!n){n=!0;const t=e(),{id:r}=t;setTimeout(()=>{o[r]&&(o[r].isOpen=!1),n=!1},150)}}),onDropdownArrowClick:n(t=>{const n=e(),{id:r}=n;o[r]&&(o[r].isOpen=!o[r].isOpen)})},callbacks:{}});
//# sourceMappingURL=view.js.map