import*as e from"@wordpress/interactivity";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const n=(i={getContext:()=>e.getContext,store:()=>e.store,withSyncEvent:()=>e.withSyncEvent},a={},t.d(a,i),a),{state:o,actions:r}=(0,n.store)("prc-block/form-input-select",{state:{get activeIndex(){const e=(0,n.getContext)(),{id:t}=e;return t&&o[t]&&o[t].activeIndex||0},get isOpen(){const e=(0,n.getContext)(),{id:t}=e;return t&&o[t]&&o[t].isOpen||!1},get formField(){const e=(0,n.getContext)(),{id:t}=e;if(!t||!o[t])return{};const{name:r,label:i,value:a,required:s,placeholder:l,hidden:c,readonly:u,disabled:p,error:d,options:g}=o[t];return{name:r,label:i,value:a,required:s,placeholder:l,hidden:c,readonly:u,disabled:p,error:d,options:g}},get isInputRequired(){const e=(0,n.getContext)(),{id:t}=e;return t&&o[t]&&o[t].required||!1},get isInputDisabled(){const e=(0,n.getContext)(),{id:t}=e;return t&&o[t]&&o[t].isDisabled||!1},get isInputReadonly(){const e=(0,n.getContext)(),{allowSearch:t}=e;return!t},get inputId(){const e=(0,n.getContext)(),{id:t}=e;return!(!t||!o[t])&&t},get inputLabel(){const e=(0,n.getContext)(),{id:t}=e;return!(!t||!o[t])&&(o[t].label||"")},get inputValue(){const e=(0,n.getContext)(),{id:t}=e;return t&&o[t]&&o[t].value||""},get inputPlaceholder(){const e=(0,n.getContext)(),{id:t}=e;return!(!t||!o[t])&&(o[t].placeholder||"")},get hasValue(){const e=(0,n.getContext)(),{id:t}=e;return!(!t||!o[t]||!o[t].value)},get hasClearIcon(){const e=(0,n.getContext)(),{id:t,hasClearIcon:r}=e;return!(!t||!o[t]||!r||!o[t].value&&!searchTerm)},get inputOptions(){const e=(0,n.getContext)(),{id:t,searchTerm:r}=e;if(!t||!o[t])return[];let i=o[t].options||[];if(r&&r.length>0&&i){const e=i.filter((e=>e.label.toLowerCase().includes(r.toLowerCase())));e.length>0&&(i=e)}return i}},actions:{hoistValueToTargetState:(e,t)=>{const{state:r}=(0,n.store)(t);if(!r)return;const{formFields:i}=r;if(!i)return;let a=i.find((t=>t.id===e));if(!a)return;const s=o.formField;s&&(a={...a,...s},r.formFields=i.map((t=>t.id===e?a:t)))},onInputKeyDown:(0,n.withSyncEvent)((e=>{const{activeIndex:t,id:i,targetNamespace:a,allowSearch:s}=(0,n.getContext)(),l=["ArrowDown","ArrowUp","Enter","Escape","Tab"].includes(e.key);if("ArrowDown"===e.key||"ArrowUp"===e.key)return e.preventDefault(),void e.stopPropagation();if(!s&&!l)return e.preventDefault(),void e.stopPropagation();if("Enter"===e.key){e.preventDefault(),e.stopPropagation();const{inputOptions:n}=o;if(n&&n[t]){const{label:e,value:s}=n[t];o[i].value=s,o[i].label=e,o[i].isOpen=!1,r.hoistValueToTargetState(i,a)}}})),onInputKeyUp:(0,n.withSyncEvent)((e=>{const t=(0,n.getContext)(),{id:i,allowSearch:a}=t;return a&&(t.searchTerm=e.target.value),o[i].isOpen||(o[i].isOpen=!0),"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),void r.moveThroughChoices(1,e.target)):"ArrowUp"===e.key?(e.preventDefault(),e.stopPropagation(),void r.moveThroughChoices(-1,e.target)):void("Escape"===e.key&&(o[i].isOpen=!1))})),onLabelClick:(0,n.withSyncEvent)((e=>{const{id:t}=(0,n.getContext)(),o=document.getElementById(t);o&&o.focus()})),onInputClearButtonClick:(0,n.withSyncEvent)((e=>{const{id:t}=(0,n.getContext)(),{targetNamespace:i}=(0,n.getContext)();(0,n.getContext)().searchTerm="",o[t].value="",o[t].label="",o[t].isOpen=!1,r.hoistValueToTargetState(t,i)})),moveThroughChoices:(e,t)=>{const{inputOptions:r}=o,{activeIndex:i}=(0,n.getContext)();let a=null;a=null===i||isNaN(i)?0:i+e,a<0&&(a=r.length-1),a>=r.length&&(a=0);const s=r[a].value,l=t.parentElement.parentElement.querySelector(".wp-block-prc-block-form-input-select__list"),c=l.querySelector(`[data-ref-value="${s}"]`);if(c){const e=l.querySelector(".is-selected");e&&e.classList.remove("is-selected"),c.classList.add("is-selected"),c.scrollIntoView({block:"nearest"})}(0,n.getContext)().activeIndex=a},onInputOptionClick:(0,n.withSyncEvent)((e=>{e.preventDefault();const t=(0,n.getContext)(),{id:i,targetNamespace:a}=t,{value:s,label:l}=t.option;o[i].value=s,o[i].label=l,r.hoistValueToTargetState(i,a)})),onInputFocus:(0,n.withSyncEvent)((e=>{const t=(0,n.getContext)(),{id:r}=t;o[r]&&(o[r].isOpen=!0)})),onInputBlur:(0,n.withSyncEvent)((e=>{let t=!1;if(!t){t=!0;const e=(0,n.getContext)(),{id:r}=e;setTimeout((()=>{o[r]&&(o[r].isOpen=!1),t=!1}),150)}}))},callbacks:{}});var i,a;
//# sourceMappingURL=view.js.map