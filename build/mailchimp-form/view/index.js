import*as e from"@wordpress/interactivity";var r={d:(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};const t=(s={getContext:()=>e.getContext,store:()=>e.store},o={},r.d(o,s),o);var s,o;(0,t.store)("prc-block/mailchimp-form",{actions:{subscribe:async e=>{const r=(0,t.getContext)();return new Promise((async(t,s)=>{const{interest:o,NONCE:n}=r;if(!o&&o.length<1)return s({status:"error",message:"No interest id provided"});if(!n)return s({status:"error",message:"No nonce provided"});const a=e.find((e=>["emailAddress","email"].includes(e.name)))?.value,i=e.find((e=>"captchaToken"===e.name))?.value;return async function({emailAddress:e,captchaToken:r=!1,interest:t=!1,NONCE:s=!1}){return console.log("ðŸµ subscribe",{emailAddress:e,captchaToken:r,interest:t,NONCE:s}),new Promise(((o,n)=>{const{apiFetch:a}=window.wp,{isURL:i,buildQueryString:c}=window.wp.url;if(!r)return new Error("ðŸ™ˆ We couldn't verify you're not a robot ðŸ¤–. Please try again.");const l=e,u=document.URL;if(!i(u))return new Error("ðŸ™ˆ Invalid page url",u);const d=c({email:l,captcha_token:r,interests:t,api_key:"mailchimp-form",origin_url:u});a.use(a.createNonceMiddleware(s)),a({path:`/prc-api/v3/mailchimp/subscribe/?${d}`,method:"POST"}).then((e=>e.success?(console.log("ðŸµ MailChimp success",e),o(e)):(console.error("ðŸ™Š MailChimp reject",e),n(e)))).catch((e=>(console.error("ðŸ™Š MailChimp error",e),n(e))))}))}({emailAddress:a,interest:o,captchaToken:i,NONCE:n}).then((e=>t({status:"success",message:"You have been subscribed to the list.",data:e}))).catch((e=>s({status:"error",message:e.message,data:e})))}))}}});
//# sourceMappingURL=index.js.map