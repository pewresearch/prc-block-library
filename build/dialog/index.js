(()=>{"use strict";const e=window.wp.blocks,i=window.wp.data,o=window.wp.i18n,t=window.wp.element,l=window.wp.blockEditor,n=window.wp.components,a={id:null,dialogs:{}},d="prc-block/dialog",r=(0,i.createReduxStore)(d,{reducer:(e=a,i)=>{switch(i.type){case"INIT_DIALOG":{const{id:o}=i;return o?{...e,id:o,dialogs:{...e.dialogs,[o]:{isOpen:!1,closingModal:!1}}}:e}case"DESTROY_DIALOG":{const{id:o}=i;if(!o)return e;const t={...e.dialogs};delete t[o];let l=e.id;return e.id===o&&(l=Object.keys(t)[0]||null),{...e,id:l,dialogs:t}}case"OPEN_DIALOG":{let o=i.id;return o||(o=e.id),o?{...e,dialogs:{...e.dialogs,[o]:{...e.dialogs[o],isOpen:!0,closingModal:!1}}}:e}case"CLOSE_DIALOG":{let o=i.id;return o||(o=e.id),o?{...e,dialogs:{...e.dialogs,[o]:{...e.dialogs[o],isOpen:!1,closingModal:!0}}}:e}default:return e}},actions:{init:e=>({type:"INIT_DIALOG",id:e}),destroy:e=>({type:"DESTROY_DIALOG",id:e}),open:(e=!1)=>({type:"OPEN_DIALOG",id:e}),close:(e=!1)=>({type:"CLOSE_DIALOG",id:e})},selectors:{isOpen:(e,i)=>!(!i||!e.dialogs[i])&&e.dialogs[i].isOpen,isClosingModal:(e,i)=>!(!i||!e.dialogs[i])&&e.dialogs[i].closingModal}}),s=window.ReactJSXRuntime,c=[["prc-block/dialog-trigger",{lock:{move:!0,remove:!1}},[["core/paragraph",{placeholder:(0,o.__)("Start typing to add Dialog trigger text…")}]]],["prc-block/dialog-element",{lock:{move:!0,remove:!0}},[["core/heading",{level:2,placeholder:(0,o.__)("Add a dialog label…"),metadata:{bindings:{content:{source:"prc-block/dialog-element-label"}}}}]]]],g=window.prcIcons,p=[{attributes:{dialogId:{type:"string",default:""},dialogType:{type:"string",enum:["dialog","modal"],default:"modal"},autoActivateOnRender:{type:"boolean",default:!1},animation:{type:"string",enum:["fade","pop","bounce","slide","slide-up","slide-left","slide-right","zoom"],default:"fade"},animationDuration:{type:"number",default:500},autoActivationTimer:{type:"number",default:-1},enableDeepLink:{type:"boolean",default:!1},dialogSize:{type:"string",enum:["small","medium","large"],default:"small"}},migrate(i,o){const{dialogId:t,dialogType:l,autoActivateOnRender:n,animation:a,animationDuration:d,autoActivationTimer:r,enableDeepLink:s,dialogSize:c}=i;return[{dialogId:t},o.map(i=>"prc-block/dialog-element"===i.name?(0,e.createBlock)("prc-block/dialog-element",{...i.attributes,dialogType:l,autoActivateOnRender:n,animation:a,animationDuration:d,autoActivationTimer:r,enableDeepLink:s,dialogSize:c},i.innerBlocks):i)]},save:()=>l.InnerBlocks.Content(),isEligible:e=>!!(e.dialogType||e.autoActivateOnRender||e.animation||e.animationDuration||e.autoActivationTimer||e.enableDeepLink||e.dialogSize)}],u=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-block/dialog","version":"1.0.0","title":"Dialog","description":"Render content in a <dialog/> element modal. Includes a trigger to open the dialog, and dialog element to render content.","category":"media","keywords":["dialog","modal","popup"],"allowedBlocks":["prc-block/dialog-element","prc-block/dialog-trigger"],"attributes":{"dialogId":{"type":"string","default":""}},"supports":{"anchor":false,"html":false,"align":["full","wide","left","right","center"],"typography":{"fontSize":true,"__experimentalFontFamily":true,"__experimentalDefaultControls":{"fontSize":true,"__experimentalFontFamily":true}},"interactivity":true},"providesContext":{"dialog/id":"dialogId"},"textdomain":"dialog","render":"file:./render.php","editorScript":"file:./index.js"}'),{name:m}=u,b={icon:function(){return(0,s.jsx)(g.Icon,{icon:"window-restore"})},edit:function({attributes:e,setAttributes:a,clientId:r}){const{dialogId:g}=e;g||a({dialogId:r});const{dialogElementClientId:p,isDialogOpen:u}=(0,i.useSelect)(e=>{const{getBlock:i}=e(l.store),o=i(r),t=o?.innerBlocks?.find(e=>"prc-block/dialog-element"===e.name),n=t?.clientId;return{dialogElementClientId:n,isDialogOpen:!!n&&e(d).isOpen(n)}},[r]),{open:m,close:b}=(0,i.useDispatch)(d),h=(0,t.useRef)(null),_=(0,l.useBlockProps)({ref:h}),k=(0,l.useInnerBlocksProps)(_,{template:c,templateLock:"insert"}),D=(0,t.useMemo)(()=>u?(0,o.__)("Close Dialog"):(0,o.__)("Edit Dialog"),[u]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.BlockControls,{__experimentalShareWithChildBlocks:!0,children:(0,s.jsx)(n.ToolbarGroup,{children:(0,s.jsx)(n.ToolbarButton,{label:D,onClick:()=>{p?u?(console.log("closing"),b(p)):(console.log("opening"),m(p)):console.warn("No dialog-element block found. Please add a dialog-element block.")},children:D})})}),(0,s.jsx)(l.InspectorControls,{children:(0,s.jsx)(n.PanelBody,{title:(0,o.__)("Dialog Settings"),children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{children:(0,o.__)('The dialog element requires a dialog trigger and a dialog element. You can edit the text of the trigger and the content of the dialog by clicking the "Edit Dialog" button above.')}),(0,s.jsx)(n.TextControl,{label:(0,o.__)("Dialog ID"),value:g,onChange:e=>a({dialogId:e}),help:(0,o.__)("The ID of the dialog element. This should be unique on the page."),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,s.jsx)(n.Button,{__next40pxDefaultSize:!0,variant:"tertiary",onClick:()=>{p&&(u?b(p):m(p))},disabled:!p,accessibleWhenDisabled:!0,children:u?(0,o.__)("Close Dialog"):(0,o.__)("Edit Dialog")})]})})}),(0,s.jsx)("div",{...k})]})},save:function(){return(0,s.jsx)(l.InnerBlocks.Content,{})},deprecated:p};(0,e.registerBlockType)(m,{...u,...b}),(0,i.register)(r)})();
//# sourceMappingURL=index.js.map