{"version":3,"file":"view.js","mappings":"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","sources":["webpack://taxonomy-search/external module \"@wordpress/interactivity\"","webpack://taxonomy-search/webpack/bootstrap","webpack://taxonomy-search/webpack/runtime/make namespace object","webpack://taxonomy-search/./src/view.js"],"sourcesContent":["var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress Dependencies\n */\nimport {\n\tstore,\n\tgetContext,\n\tgetElement,\n\tuseState,\n\tuseEffect,\n} from '@wordpress/interactivity';\n\nconst { apiFetch } = window.wp;\nconst { addQueryArgs } = window.wp.url;\nconst { decodeEntities } = window.wp.htmlEntities;\n\nconst useDebounce = (value, delay) => {\n\t// State and setters for debounced value\n\tconst [debouncedValue, setDebouncedValue] = useState(value);\n\tuseEffect(\n\t\t() => {\n\t\t\t// Update debounced value after delay\n\t\t\tconst handler = setTimeout(() => {\n\t\t\t\tsetDebouncedValue(value);\n\t\t\t}, delay);\n\t\t\t// Cancel the timeout if value changes (also on delay change or unmount)\n\t\t\t// This is how we prevent debounced value from updating if value is changed ...\n\t\t\t// .. within the delay period. Timeout gets cleared and restarted.\n\t\t\treturn () => {\n\t\t\t\tclearTimeout(handler);\n\t\t\t};\n\t\t},\n\t\t[value, delay] // Only re-call effect if value or delay changes\n\t);\n\treturn debouncedValue;\n};\n\nconst { state, actions } = store('prc-block/taxonomy-search', {\n\tactions: {\n\t\tasync doSearch(searchValue, taxonomy, parentTermId = 0) {\n\t\t\tconsole.log('doSearch', searchValue, taxonomy, parentTermId);\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst args = { per_page: 25 };\n\t\t\t\tif ('' !== taxonomy) {\n\t\t\t\t\targs.taxonomy = taxonomy;\n\t\t\t\t}\n\t\t\t\tif ('' !== searchValue) {\n\t\t\t\t\targs.searchValue = searchValue;\n\t\t\t\t}\n\t\t\t\tif (0 !== parentTermId && '' !== parentTermId) {\n\t\t\t\t\t// cast parentTermId as a whole number\n\t\t\t\t\targs.parentTermId = parentTermId;\n\t\t\t\t}\n\t\t\t\tconst request = {\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tpath: addQueryArgs(\n\t\t\t\t\t\t'/prc-api/v3/blocks/taxonomy-search',\n\t\t\t\t\t\targs\n\t\t\t\t\t),\n\t\t\t\t};\n\t\t\t\tconsole.log('doSearch', request);\n\t\t\t\tapiFetch(request).then((d) => {\n\t\t\t\t\tconsole.log('doSearch', d);\n\t\t\t\t\tconst tmpData = d.map((t) => ({\n\t\t\t\t\t\tkey: t.id,\n\t\t\t\t\t\tid: t.id,\n\t\t\t\t\t\turl: t.link,\n\t\t\t\t\t\tdescription: decodeEntities(t.description),\n\t\t\t\t\t\tlabel: decodeEntities(t.name),\n\t\t\t\t\t}));\n\t\t\t\t\tresolve(tmpData);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonInputFocus: (event) => {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isActive = true;\n\t\t},\n\t\tonInputBlur: (event) => {\n\t\t\tconst context = getContext();\n\t\t\tsetTimeout(() => {\n\t\t\t\tcontext.isActive = false;\n\t\t\t}, 300);\n\t\t},\n\t\tonInputChange: (event) => {\n\t\t\tconst { value } = event.target;\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tconst { id } = ref;\n\t\t\t// Store the value in the global state where we store all primitve inputs.\n\t\t\tstate[id].value = value;\n\t\t\t// Also, store the value in this block's context so we can use it in the submitHandler.\n\t\t\tcontext.searchValue = state[id].value;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tshowResults: () => {\n\t\t\tconst context = getContext();\n\t\t\tconsole.log('showResults', context, state);\n\t\t\treturn (\n\t\t\t\tcontext.results &&\n\t\t\t\tcontext.results.length >= 1 &&\n\t\t\t\tcontext.isActive\n\t\t\t);\n\t\t},\n\t\tonSearchValueChange: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { debouncedSearchValue } = context;\n\t\t\tif (debouncedSearchValue) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t'onSearchValueChange',\n\t\t\t\t\tcontext,\n\t\t\t\t\tstate,\n\t\t\t\t\tdebouncedSearchValue\n\t\t\t\t);\n\t\t\t\t// do the search\n\t\t\t\tactions\n\t\t\t\t\t.doSearch(debouncedSearchValue, context.taxonomy)\n\t\t\t\t\t.then((d) => {\n\t\t\t\t\t\tcontext.results = d;\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tdebounceSearchValueChange: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst debouncedSearchValue = useDebounce(context.searchValue, 1000);\n\t\t\tif (debouncedSearchValue.length > 2) {\n\t\t\t\tcontext.debouncedSearchValue = debouncedSearchValue;\n\t\t\t}\n\t\t},\n\t\tonEscKey: (event) => {\n\t\t\tif (27 === event.keyCode) {\n\t\t\t\tconst context = getContext();\n\t\t\t\tcontext.isActive = false;\n\t\t\t}\n\t\t},\n\t},\n});\n"],"names":["store","getContext","getElement","useState","useEffect","apiFetch","window","wp","addQueryArgs","url","decodeEntities","htmlEntities","useDebounce","value","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","state","actions","doSearch","searchValue","taxonomy","parentTermId","console","log","Promise","resolve","args","per_page","request","method","path","then","d","tmpData","map","t","key","id","link","description","label","name","onInputFocus","event","context","isActive","onInputBlur","onInputChange","target","ref","callbacks","showResults","results","length","onSearchValueChange","debouncedSearchValue","debounceSearchValueChange","onEscKey","keyCode"],"sourceRoot":""}