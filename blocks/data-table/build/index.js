(()=>{var t,e={8638:(t,e,o)=>{"use strict";var n={};o.r(n),o.d(n,{CHECKBOX_CHECKED:()=>yh,CHECKBOX_RENDERER_NAMESPACE:()=>vh,CHECKBOX_UNCHECKED:()=>bh,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>ga,CONTEXTMENU_ITEMS_ALIGNMENT:()=>wa,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>Ea,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>ya,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Ca,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>va,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>Ra,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>ba,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>Sa,CONTEXTMENU_ITEMS_BORDERS:()=>Ta,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>Ha,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>ka,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>Ma,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>xa,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>na,CONTEXTMENU_ITEMS_COPY:()=>ia,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>la,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>sa,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>ra,CONTEXTMENU_ITEMS_CUT:()=>aa,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>fa,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>ha,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>Pa,CONTEXTMENU_ITEMS_HIDE_ROW:()=>_a,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>ql,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>Ql,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>ua,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Oa,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>Aa,CONTEXTMENU_ITEMS_NO_ITEMS:()=>Yl,CONTEXTMENU_ITEMS_READ_ONLY:()=>oa,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>ma,CONTEXTMENU_ITEMS_REDO:()=>ea,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Ia,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>Jl,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>pa,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>Zl,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>Kl,CONTEXTMENU_ITEMS_ROW_BELOW:()=>Xl,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>Na,CONTEXTMENU_ITEMS_SHOW_ROW:()=>Da,CONTEXTMENU_ITEMS_UNDO:()=>ta,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>ca,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>da,CONTEXT_MENU_ITEMS_NAMESPACE:()=>Gl,FILTERS_BUTTONS_CANCEL:()=>fh,FILTERS_BUTTONS_CLEAR:()=>dh,FILTERS_BUTTONS_OK:()=>gh,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>ph,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>wh,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>mh,FILTERS_BUTTONS_SELECT_ALL:()=>uh,FILTERS_CONDITIONS_AFTER:()=>eh,FILTERS_CONDITIONS_BEFORE:()=>oh,FILTERS_CONDITIONS_BEGINS_WITH:()=>Ua,FILTERS_CONDITIONS_BETWEEN:()=>Ja,FILTERS_CONDITIONS_BY_VALUE:()=>Ka,FILTERS_CONDITIONS_CONTAINS:()=>Ga,FILTERS_CONDITIONS_EMPTY:()=>Wa,FILTERS_CONDITIONS_ENDS_WITH:()=>$a,FILTERS_CONDITIONS_EQUAL:()=>ja,FILTERS_CONDITIONS_GREATER_THAN:()=>Xa,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>qa,FILTERS_CONDITIONS_LESS_THAN:()=>Qa,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>Za,FILTERS_CONDITIONS_NAMESPACE:()=>Va,FILTERS_CONDITIONS_NONE:()=>Fa,FILTERS_CONDITIONS_NOT_BETWEEN:()=>th,FILTERS_CONDITIONS_NOT_CONTAIN:()=>Ya,FILTERS_CONDITIONS_NOT_EMPTY:()=>Ba,FILTERS_CONDITIONS_NOT_EQUAL:()=>za,FILTERS_CONDITIONS_TODAY:()=>nh,FILTERS_CONDITIONS_TOMORROW:()=>ih,FILTERS_CONDITIONS_YESTERDAY:()=>rh,FILTERS_DIVS_FILTER_BY_CONDITION:()=>sh,FILTERS_DIVS_FILTER_BY_VALUE:()=>lh,FILTERS_LABELS_CONJUNCTION:()=>ah,FILTERS_LABELS_DISJUNCTION:()=>hh,FILTERS_NAMESPACE:()=>La,FILTERS_VALUES_BLANK_CELLS:()=>ch});const i=window.wp.blocks,r=window.React,s=window.wp.element,l=window.wp.blockEditor,a=window.wp.primitives,h=(0,r.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,r.createElement)(a.Path,{d:"M13.824 10.176h-2.88v-2.88H9.536v2.88h-2.88v1.344h2.88v2.88h1.408v-2.88h2.88zM0 17.92V0h20.48v17.92H0zM6.4 1.28H1.28v3.84H6.4V1.28zm6.4 0H7.68v3.84h5.12V1.28zm6.4 0h-5.12v3.84h5.12V1.28zm0 5.056H1.28v9.024H19.2V6.336z"})),c=(0,r.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,r.createElement)(a.Path,{d:"M14.08 12.864V9.216h3.648V7.424H14.08V3.776h-1.728v3.648H8.64v1.792h3.712v3.648zM0 17.92V0h20.48v17.92H0zM6.4 1.28H1.28v3.84H6.4V1.28zm0 5.12H1.28v3.84H6.4V6.4zm0 5.12H1.28v3.84H6.4v-3.84zM19.2 1.28H7.68v14.08H19.2V1.28z"})),u=(window.wp.i18n,window.wp.components),d=window.prcHooks,g=window.wp.data,f=(0,s.createContext)(),p=()=>(0,s.useContext)(f);function m({children:t,clientId:e,tableRef:o}){const n=(({clientId:t,tableRef:e})=>{const{current:o}=e,n=(0,s.useMemo)((()=>(console.log("TableREF?",e),e.current?.hotInstance)),[o]),{data:i,colWidths:r,colHeaders:l,frozenColumns:a}=(0,g.useSelect)((e=>{const o=e("core/block-editor").getBlock(t);return{data:o.attributes.data,colWidths:o.attributes.colWidths,colHeaders:o.attributes.colHeaders,frozenColumns:o.attributes.frozenColumns}}),[t]),[h,c]=(0,s.useState)(i),u=(0,d.useDebounce)(h,100),[f,p]=(0,s.useState)(!1),{updateBlockAttributes:m}=(0,g.useDispatch)("core/block-editor"),w=e=>{m(t,e)},v=()=>{const t=n?.getSelected();return console.log("selected",t),{rowIndex:t[0][0],columnIndex:t[0][1]}},y=(0,s.useMemo)((()=>f),[f]);return(0,s.useEffect)((()=>{void 0!==u&&(console.log("useEffect: updateBlockAttributes...",u),w({data:[...u]}))}),[u]),{loading:y,tableData:h,colHeaders:l,colWidths:r,frozenColumns:a,HOT:n,handleAfterChange:t=>{if(console.log("handleAfterChange",t),null===t)return;const e=(t=>t.map((([t,e,o,n])=>[t,e,n])))(t);console.log("yield...",e,h),void 0===h?c(e):(console.log("changes",t),e.forEach((([t,e,o])=>{h[t][e]=o})),c([...h]))},handleAfterColumnResize:(t,e,o)=>{console.log("currentColumn",e,t,r);const n=void 0===r?[]:[...r];n[e]=t,console.log("newColWidths",n),w({colWidths:n})},handleAfterCreateCol:(t,e,o)=>{console.log("handleAfterCreateCol",t,e,o)},handleAfterCreateRow:(t,e,o)=>{console.log("handleAfterCreateRow",t,e,o)},handleAfterRowMove:(t,e,o,n,i)=>{console.log("movedRows",t),console.log("finalIndex",e),console.log("dropIndex",o),console.log("movePossible",n),console.log("orderChanged",i);const r=[...h],s=r.splice(t[0],t.length);r.splice(e,0,...s),c(r)},handleColumnHeaderRename:(t,e)=>{const o=[...l];o[e]=t,w({colHeaders:o})},handleColumnFreeze:t=>{console.log("handleColumnFreeze",t);const e=a.indexOf(t),o=[...a];-1===e?o.push(t):o.splice(e,1),w({frozenColumns:o})},handleColumnSort:(t,e)=>{if(console.log("handleColumnSort",t,e),0===e.length)return!0;const o=e[0],{column:n,sortOrder:i}=o;return-1===a.indexOf(n)},insertNewRow:()=>{n?.alter("insert_row_below")},insertNewRowBefore:()=>{const t=v().rowIndex;n?.alter("insert_row_above",t)},insertNewRowAfter:()=>{const t=v().rowIndex;n?.alter("insert_row_below",t)},insertNewColumn:()=>{n?.alter("insert_col_start")},insertNewColumnAfter:()=>{const t=v().columnIndex;n?.alter("insert_col_end",t)},insertNewColumnBefore:()=>{const t=v().columnIndex;n?.alter("insert_col_start",t)},getColHeader:t=>n?.getColHeader(t),getSelectedColumn:()=>{const t=n?.getSelected();return console.log("selected",t),t[0][1]},updateAttributes:w,setTableData:c}})({clientId:e,tableRef:o});return(0,r.createElement)(f.Provider,{value:n},t)}const w=window.CSV;var v=o.n(w);function y(t,e){const o=new FileReader;o.onload=()=>{!function(t,e){const o=new(v())(t,{header:!0}).parse();console.log(o);const n=Object.keys(o[0]),i=o.map((t=>Object.values(t).map((t=>void 0===t?"":t))));console.log("TO INIT:",{data:i,colHeaders:n}),e(i,n)}(o.result,e)},Array.from(t).forEach((t=>o.readAsBinaryString(t)))}function b({onChange:t}){const e=(0,s.useRef)(null);return(0,r.createElement)(u.BaseControl,{id:"csv-import",help:"Import a CSV file to populate the table. The first row will be used as column headers. You can also drag and drop a CSV file here."},(0,r.createElement)(u.Button,{variant:"primary",onClick:()=>{e.current.click()}},"CSV Import"),(0,r.createElement)("input",{ref:e,type:"file",accept:"text/csv",onChange:e=>y(e.target.files,t),style:{display:"none"}}),(0,r.createElement)(u.DropZone,{onFilesDrop:e=>y(e,t)}))}function C(){const{updateAttributes:t,setTableData:e}=p();return(0,r.createElement)(l.InspectorControls,null,(0,r.createElement)(u.PanelBody,{title:"CSV Import"},(0,r.createElement)(u.PanelRow,null,(0,r.createElement)(b,{onChange:(o,n)=>{e(o),t({colHeaders:n})}}))))}function S(){const{insertNewColumn:t,insertNewRow:e}=p();return(0,r.createElement)(l.BlockControls,null,(0,r.createElement)(u.ToolbarGroup,null,(0,r.createElement)(u.ToolbarButton,{label:"Insert Row",icon:h,onClick:e}),(0,r.createElement)(u.ToolbarButton,{label:"Insert Column",icon:c,onClick:t})))}function R(){return(0,r.createElement)(s.Fragment,null,(0,r.createElement)(S,null),(0,r.createElement)(C,null))}const E=window.ReactDOM;o(6280),o(4114),o(9848);var T=o(2838);function x(t){return t[0].toUpperCase()+t.substr(1)}function M(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function H(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function k(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o]))}function I(t){return A(`${t}`,{ALLOWED_TAGS:[]})}function A(t,e){return T.sanitize(t,e)}const O=t=>["tabindex",t],P=()=>["role","presentation"],N=t=>["aria-label",t],_=()=>["aria-hidden","true"],D=t=>["aria-haspopup",t],L=t=>["aria-rowcount",t],V=t=>["aria-colcount",t],F=t=>["aria-rowindex",t],W=t=>["aria-colindex",t],B=t=>["aria-expanded",t],j=()=>["aria-readonly","true"],z=()=>["aria-invalid","true"],U=t=>["aria-relevant",t],$=t=>["aria-posinset",t];function G(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,n=null,i=t;for(;null!==i;){if(o===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(o+=1,i=i.parentNode)}return n}function Y(t){return function(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}(t)&&t.parent}function K(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let r=t;for(;null!=r&&r!==o;){const{nodeType:t,nodeName:o}=r;if(t===n&&(e.includes(o)||e.includes(r)))return r;const{host:s}=r;r=s&&t===i?s:r.parentNode}return null}function X(t,e,o){const n=[];let i=t;for(;i&&(i=K(i,e,o),i&&(!o||o.contains(i)));)n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const r=n.length;return r?n[r-1]:null}function q(t,e){let o=t.parentNode,n=[];for("string"==typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);null!==o;){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function Q(t,e,o){const n=o.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function Z(t){return t&&t.length?t.filter((t=>!!t)):[]}function J(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const o=[],n=[];return n.push(...t.filter((t=>{const n=t instanceof RegExp;return n&&e&&o.push(t),!n}))),e?{regexFree:n,regexes:o}:n}function tt(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function et(t,e){"string"==typeof e&&(e=e.split(" ")),(e=Z(e)).length>0&&t.classList.add(...e)}function ot(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:o,regexes:n}=J(e,!0);o=Z(o),o.length>0&&t.classList.remove(...o),n.forEach((e=>{t.classList.forEach((o=>{e.test(o)&&t.classList.remove(o)}))}))}function nt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,o]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function it(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:o,regexes:n}=J(e,!0);o.forEach((e=>{""!==e&&t.removeAttribute(e)})),n.forEach((e=>{t.getAttributeNames().forEach((o=>{e.test(o)&&t.removeAttribute(o)}))}))}function rt(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)rt(e[t])}}function st(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const lt=/(<(.*)>|&(.*);)/;function at(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];lt.test(e)?t.innerHTML=o?A(e):e:ht(t,e)}function ht(t,e){const o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(st(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ct(t){const e=t.ownerDocument.documentElement;let o=t;for(;o!==e;){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return ct(o.host.impl);if(o.host)return ct(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===yt(o).display)return!1;o=o.parentNode}return!0}function ut(t){const e=t.ownerDocument,o=e.defaultView,n=e.documentElement;let i,r,s,l=t;for(i=l.offsetLeft,r=l.offsetTop,s=l;(l=l.offsetParent)&&l!==e.body&&"offsetLeft"in l;)i+=l.offsetLeft,r+=l.offsetTop,s=l;return s&&"fixed"===s.style.position&&(i+=o.pageXOffset||n.scrollLeft,r+=o.pageYOffset||n.scrollTop),{left:i,top:r}}function dt(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function gt(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function ft(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?dt(e):t.scrollTop}function pt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?gt(e):t.scrollLeft}function mt(t){let e=t.ownerDocument,o=e?e.defaultView:void 0;e||(e=t.document?t.document:t,o=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:t,overflowX:e,overflowY:r}=i.style;if([t,e,r].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:r}=o.getComputedStyle(i)),n.includes(t)||n.includes(e)||n.includes(r))return i;if(i.clientHeight<=i.scrollHeight+1&&(n.includes(r)||n.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(e)||n.includes(t)))return i;i=i.parentNode}return o}function wt(t){const e=t.ownerDocument,o=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const t=yt(n,o),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(r)||e.includes(s))return n;n=n.parentNode}return o}function vt(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===o)return"width"===e?`${o.innerWidth}px`:"height"===e?`${o.innerHeight}px`:void 0;const n=t.style[e];if(""!==n&&void 0!==n)return n;const i=yt(t,o);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function yt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function bt(t){return t.offsetWidth}function Ct(t){return t.offsetHeight}function St(t){return t.clientHeight||t.innerHeight}function Rt(t){return t.clientWidth||t.innerWidth}function Et(t){return t.selectionStart?t.selectionStart:0}function Tt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function xt(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,o)}catch(n){const i=t.parentNode,r=i.style.display;i.style.display="block",t.setSelectionRange(e,o),i.style.display=r}}}let Mt;function Ht(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Mt&&(Mt=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const o=t.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(e),(t.body||t.documentElement).appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=o.clientWidth),(t.body||t.documentElement).removeChild(o),n-i}(t)),Mt}function kt(t,e,o){t.style.transform=`translate3d(${e},${o},0)`}function It(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function At(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Ot(t){return At(t)&&!1===t.hasAttribute("data-hot-input")}function Pt(t){return!t.parentNode}function Nt(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=t.ownerDocument,i=n.createRange(),r=n.defaultView.getSelection();nt(t,"contenteditable",!0),o&&nt(t,..._()),e&&et(t,"invisibleSelection"),i.selectNodeContents(t),r.removeAllRanges(),r.addRange(i)}function _t(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),o.removeAllRanges(),e&&ot(t,"invisibleSelection"),t.removeAttribute("contenteditable")}const Dt=window.moment;function Lt(t,e){const o=e.length;let n=0;for(;n<o;)t.push(e[n]),n+=1}function Vt(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const o=t.length,n=t[0].length;for(let i=0;i<o;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Ft(t,e,o,n){let i=-1,r=t,s=o;Array.isArray(t)||(r=Array.from(t));const l=r.length;for(n&&l&&(i+=1,s=r[i]),i+=1;i<l;)s=e(s,r[i],i,r),i+=1;return s}function Wt(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;for(;o<i;){const t=n[o];e(t,o,n)&&(s+=1,r[s]=t),o+=1}return r}function Bt(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,r=[];let s=-1;for(;o<i;){const t=n[o];s+=1,r[s]=e(t,o,n),o+=1}return r}function jt(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;o<i&&!1!==e(n[o],o,n);)o+=1;return t}function zt(t){const e=[];return jt(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function Ut(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let r=n;return jt(i,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function $t(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function Gt(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return Ft(t,((t,e,n)=>t+e.replace(/\r?\n\s*/g,"")+(o[n]?o[n]:"")),"").trim()}function Yt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function Kt(t){return void 0!==t}function Xt(t){return void 0===t}function qt(t){return null===t||""===t||Xt(t)}const Qt="length",Zt=t=>parseInt(t,16),Jt=t=>parseInt(t,10),te=(t,e,o)=>t.substr(e,o),ee=t=>t.codePointAt(0)-65,oe=t=>`${t}`.replace(/\-/g,""),ne=t=>Zt(te(oe(t),Zt("12"),ee("F")))/(Zt(te(oe(t),ee("B"),~~![][Qt]))||9),ie=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let re=!1;const se={invalid:()=>Gt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return Gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},le={invalid:()=>Gt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return Gt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Gt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ae(t){return"function"==typeof t}function he(t){let e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n&&clearTimeout(n),n=setTimeout((()=>{e=t.apply(this,r)}),o),e}}function ce(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,o.concat(n))}}function ue(t,e,o,n,i,r,s,l){return Kt(l)?t.call(e,o,n,i,r,s,l):Kt(s)?t.call(e,o,n,i,r,s):Kt(r)?t.call(e,o,n,i,r):Kt(i)?t.call(e,o,n,i):Kt(n)?t.call(e,o,n):Kt(o)?t.call(e,o):t.call(e)}function de(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Se(t,((t,o)=>{"__children"!==o&&(t&&"object"==typeof t&&!Array.isArray(t)?e[o]=de(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?e[o]=[de(t[0])]:e[o]=[]:e[o]=null)}))),e}function ge(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function fe(t,e,o){const n=Array.isArray(o);return Se(e,((e,i)=>{(!1===n||o.includes(i))&&(t[i]=e)})),t}function pe(t,e){Se(e,((o,n)=>{e[n]&&"object"==typeof e[n]?(t[n]||(Array.isArray(e[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(e[n])?t[n]=e[n]:t[n]={}),pe(t[n],e[n])):t[n]=e[n]}))}function me(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function we(t){const e={};return Se(t,((t,o)=>{e[o]=t})),e}function ve(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return jt(o,(e=>{t.MIXINS.push(e.MIXIN_NAME),Se(e,((e,o)=>{if(void 0!==t.prototype[o])throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if("function"==typeof e)t.prototype[o]=e;else{const n=function(t,e){const o=`_${t}`;return function(){return void 0===this[o]&&(this[o]=(t=>{let e=t;return(Array.isArray(e)||be(e))&&(e=me(e)),e})(e)),this[o]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,o,{get:n(o,e),set:i(o),configurable:!0})}}))})),t}function ye(t,e){return JSON.stringify(t)===JSON.stringify(e)}function be(t){return"[object Object]"===Object.prototype.toString.call(t)}function Ce(t,e,o,n){n.value=o,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(t,e,n)}function Se(t,e){for(const o in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,o))&&!1===e(t[o],o,t))break;return t}function Re(t,e,o){const n=e.split(".");let i=t;n.forEach(((t,e)=>{e!==n.length-1?(xe(i,t)||(i[t]={}),i=i[t]):i[t]=o}))}function Ee(t){if(!be(t))return 0;const e=function(t){let o=0;return be(t)?Se(t,((t,n)=>{"__children"!==n&&(o+=e(t))})):o+=1,o};return e(t)}function Te(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const o=`_${e}`,n={_touched:!1,[o]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[o]},set(t){this._touched=!0,this[o]=t},enumerable:!0,configurable:!0}),n}function xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Me(t){return window.requestAnimationFrame(t)}function He(t){window.cancelAnimationFrame(t)}function ke(){return"ontouchstart"in window}let Ie;o(3110);const Ae=t=>{const e={value:!1,test:(o,n)=>{e.value=t(o,n)}};return e},Oe={chrome:Ae(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Ae((t=>/CriOS/.test(t))),edge:Ae((t=>/Edge/.test(t))),edgeWebKit:Ae((t=>/EdgiOS/.test(t))),firefox:Ae((t=>/Firefox/.test(t))),firefoxWebKit:Ae((t=>/FxiOS/.test(t))),mobile:Ae((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Ae(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Pe={mac:Ae((t=>/^Mac/.test(t))),win:Ae((t=>/^Win/.test(t))),linux:Ae((t=>/^Linux/.test(t))),ios:Ae((t=>/iPhone|iPad|iPod/i.test(t)))};function Ne(){return Oe.chrome.value}function _e(){return Oe.firefox.value}function De(){return Oe.safari.value}function Le(){return Oe.mobile.value}function Ve(){return Pe.ios.value}function Fe(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Pe.mac.value}function We(){return Pe.win.value}function Be(){return Pe.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Se(Oe,(o=>{let{test:n}=o;n(t,e)}))}(),function(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Se(Pe,(e=>{let{test:o}=e;o(t)}))}());const je={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:_e()?182:174,AUDIO_MUTE:_e()?181:173,AUDIO_UP:_e()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},ze=[je.ALT,je.ARROW_DOWN,je.ARROW_LEFT,je.ARROW_RIGHT,je.ARROW_UP,je.AUDIO_DOWN,je.AUDIO_MUTE,je.AUDIO_UP,je.BACKSPACE,je.CAPS_LOCK,je.DELETE,je.END,je.ENTER,je.ESCAPE,je.F1,je.F2,je.F3,je.F4,je.F5,je.F6,je.F7,je.F8,je.F9,je.F10,je.F11,je.F12,je.F13,je.F14,je.F15,je.F16,je.F17,je.F18,je.F19,je.HOME,je.INSERT,je.MEDIA_NEXT,je.MEDIA_PLAY_PAUSE,je.MEDIA_PREV,je.MEDIA_STOP,je.NULL,je.NUM_LOCK,je.PAGE_DOWN,je.PAGE_UP,je.PAUSE,je.SCROLL_LOCK,je.SHIFT,je.TAB];function Ue(t){return ze.includes(t)}function $e(t,e){const o=e.split("|");let n=!1;return jt(o,(e=>{if(t===je[e])return n=!0,!1})),n}function Ge(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ye(t){return!1===t.isImmediatePropagationEnabled}function Ke(t){return 2===t.button}function Xe(t){return 0===t.button}function qe(){Kt(console)&&console.warn(...arguments)}function Qe(){Kt(console)&&console.error(...arguments)}const Ze=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Je=Gt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,to=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),eo=new Map([[]]);class oo{static getSingleton(){return no}constructor(){var t,e,o;t=this,o=void 0,e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e="globalBucket"),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return jt(Ze,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))jt(e,(e=>this.add(t,e,o)));else{to.has(t)&&qe(k(Je,{hookName:t,removedInVersion:to.get(t)})),eo.has(t)&&qe(eo.get(t));const n=this.getBucket(o);if(void 0===n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let o=!1;e.initialHook&&jt(n[t],((i,r)=>{if(i.initialHook)return n[t][r]=e,o=!0,!1})),o||n[t].push(e)}}return this}once(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?jt(e,(e=>this.once(t,e,o))):(e.runOnce=!0,this.add(t,e,o))}remove(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(o);return void 0!==n[t]&&n[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=this.getBucket(e);return!(void 0===o[t]||!o[t].length)}run(t,e,o,n,i,r,s,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=ue(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=ue(a[c],t,o,n,i,r,s,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return o}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Se(this.getBucket(t),((t,e,o)=>o[e].length=0))}register(t){this.isRegistered(t)||Ze.push(t)}deregister(t){this.isRegistered(t)&&Ze.splice(Ze.indexOf(t),1)}isDeprecated(t){return eo.has(t)||to.has(t)}isRegistered(t){return Ze.indexOf(t)>=0}getRegistered(){return Ze}}const no=new oo,io=oo,ro=new Map;function so(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";ro.has(t)||ro.set(t,new Map);const e=ro.get(t);return{register:function(t,o){e.set(t,o)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}const lo=new WeakMap,{register:ao,getItem:ho,hasItem:co,getNames:uo,getValues:go}=so("editors");function fo(t){const e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},io.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function po(t,e){let o;if("function"==typeof t)lo.get(t)||wo(null,t),o=lo.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=ho(t)}if(!o)throw Error(`No editor registered under name "${t}"`);return o.getInstance(e)}function mo(t){if("function"==typeof t)return t;if(!co(t))throw Error(`No registered editor found under "${t}" name`);return ho(t).getConstructor()}function wo(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);const o=new fo(e);"string"==typeof t&&ao(t,o),lo.set(e,o)}let vo=0;const yo=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var e,o,n;e=this,n=void 0,o=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(o="context"),o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){o.call(this,function(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ge(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:i,options:n,eventManager:this}),t.addEventListener(e,i,n),vo+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,o){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;for(;r;)if(r-=1,n=this.context.eventListeners[r],n.event===e&&n.element===t){if(o&&o!==n.callback)continue;if(i&&n.eventManager!==this)continue;this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),vo-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;const o=this.context.eventListeners[e];t&&o.eventManager!==this||(this.context.eventListeners.splice(e,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),vo-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let o=t.document,n=t;o||(o=t.ownerDocument?t.ownerDocument:t,n=o.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;o.createEvent?(r=o.createEvent("MouseEvents"),r.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||o.body.parentNode)):r=o.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}};function bo(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Co(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const So="editorManager.navigation";var Ro=new WeakSet;class Eo{constructor(t,e,o){var n,i;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n=this,i=Ro),i.add(n),bo(this,"hot",void 0),bo(this,"tableMeta",void 0),bo(this,"selection",void 0),bo(this,"eventManager",void 0),bo(this,"destroyed",!1),bo(this,"lock",!1),bo(this,"activeEditor",void 0),bo(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=o,this.eventManager=new yo(t),this.hot.addHook("afterDocumentKeyDown",(t=>Co(Ro,this,To).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,o)=>Co(Ro,this,xo).call(this,t,e,o)))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:o,col:n}=e,i=this.hot.runHooks("modifyGetCellCoords",o,n);let r=o,s=n;if(Array.isArray(i)&&([r,s]=i),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(o,n,!0);if(l){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=po(t,this.hot),this.activeEditor.prepare(o,n,e,l,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const n=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,t,e,o);e instanceof MouseEvent&&"boolean"!=typeof i&&(i=0===this.hot.selection.getLayerLevel()&&n.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:o,col:n}=t.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(o))||r.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves};t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function To(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ye(t))return;const{keyCode:o}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(Ue(o)||function(t){return[je.CONTROL,je.COMMAND_LEFT,je.COMMAND_RIGHT,je.COMMAND_FIREFOX].includes(t)}(o)||n||this.isEditorOpened())){const e=this.hot.getShortcutManager().getContext("editor"),o={runOnlyIf:()=>Kt(this.hot.getSelected()),group:So};e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],o),this.openEditor("",t)}}function xo(t,e){e.isCell()&&this.openEditor(null,t,!0)}const Mo=new WeakMap;Eo.getInstance=function(t,e,o){let n=Mo.get(t);return n||(n=new Eo(t,e,o),Mo.set(t,n)),n};const Ho=Eo;function ko(t,e,o){Io(t,e),e.set(t,o)}function Io(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e){return t.get(Po(t,e))}function Oo(t,e,o){return t.set(Po(t,e),o),o}function Po(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const No=Object.freeze({CELL:"cell",MIXED:"mixed"});var _o=new WeakMap,Do=new WeakMap,Lo=new WeakMap,Vo=new WeakMap,Fo=new WeakMap,Wo=new WeakSet;class Bo{constructor(t){var e,o=this;Io(this,e=Wo),e.add(this),ko(this,_o,void 0),ko(this,Do,void 0),ko(this,Lo,50),ko(this,Vo,null),ko(this,Fo,new Map);const n=t.getSettings();Oo(_o,this,t),Oo(Do,this,n.imeFastEdit?No.MIXED:No.CELL),Ao(_o,this).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Po(Wo,o,$o).call(o,...e)})),Ao(_o,this).addHook("afterSelection",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Po(Wo,o,zo).call(o,...e)})),Ao(_o,this).addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Po(Wo,o,zo).call(o,...e)})),Ao(_o,this).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Po(Wo,o,Uo).call(o,...e)}))}getFocusMode(){return Ao(Do,this)}setFocusMode(t){Object.values(No).includes(t)?Oo(Do,this,t):qe(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return Ao(Lo,this)}setRefocusDelay(t){Oo(Lo,this,t)}setRefocusElementGetter(t){Oo(Vo,this,t)}getRefocusElement(){return"function"==typeof Ao(Vo,this)?Ao(Vo,this).call(this):null===(t=Ao(_o,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){const e=t=>{var e,o;const n=null===(e=Ao(_o,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n)return;let i=Ao(_o,this).runHooks("modifyFocusedElement",n.row,n.col,t);i instanceof HTMLElement||(i=t),!i||null!==(o=Ao(_o,this).getActiveEditor())&&void 0!==o&&o.isOpened()||i.focus({preventScroll:!0})};t?e(t):Po(Wo,this,jo).call(this,(t=>e(t)))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ao(Lo,this);const o=this.getRefocusElement();!Ao(_o,this).getSettings().imeFastEdit||null!==(t=Ao(_o,this).getActiveEditor())&&void 0!==t&&t.isOpened()||!o||(Ao(Fo,this).has(e)||Ao(Fo,this).set(e,he((()=>{o.select()}),e)),Ao(Fo,this).get(e)())}}function jo(t){var e;const o=null===(e=Ao(_o,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!o||!Ao(_o,this).selection.isCellVisible(o))return void t(null);const n=Ao(_o,this).getCell(o.row,o.col,!0);null===n?Ao(_o,this).addHookOnce("afterScroll",(()=>{t(Ao(_o,this).getCell(o.row,o.col,!0))})):t(n)}function zo(){Po(Wo,this,jo).call(this,(t=>{const{activeElement:e}=Ao(_o,this).rootDocument;e&&Ot(e)&&e.blur(),this.focusOnHighlightedCell(t)}))}function Uo(){Po(Wo,this,jo).call(this,(t=>{this.getFocusMode()===No.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()}))}function $o(t){t.imeFastEdit&&this.getFocusMode()!==No.MIXED?this.setFocusMode(No.MIXED):t.imeFastEdit||this.getFocusMode()===No.CELL||this.setFocusMode(No.CELL)}o(9978);const Go={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Yo=new RegExp(Object.keys(Go).map((t=>`(${t})`)).join("|"),"gi");function Ko(t){const e=t.hasColHeaders(),o=t.hasRowHeaders(),n=[e?-1:0,o?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),r=i.length,s=r>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=o?1:0,u=e?1:0;for(let n=0;n<r;n+=1){const r=e&&0===n,l=[];for(let e=0;e<s;e+=1){const s=!r&&o&&0===e;let a="";if(r)a=`<th>${t.getColHeader(e-c)}</th>`;else if(s)a=`<th>${t.getRowHeader(n-u)}</th>`;else{const o=i[n][e],{hidden:r,rowspan:s,colspan:l}=t.getCellMeta(n-u,e-c);if(!r){const t=[];if(s&&t.push(`rowspan="${s}"`),l&&t.push(`colspan="${l}"`),qt(o))a=`<td ${t.join(" ")}></td>`;else{const e=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${t.join(" ")}>${e}</td>`}}}l.push(a)}const d=["<tr>",...l,"</tr>"].join("");r?a.splice(1,0,d):h.splice(-1,0,d)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function Xo(t){const e=t.length,o=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],r=i.length,s=[];0===n&&o.push("<tbody>");for(let t=0;t<r;t+=1){const e=i[t],o=qt(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${o}</td>`)}o.push("<tr>",...s,"</tr>"),n+1===e&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function qo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=typeof t;if("number"===o)return!isNaN(t)&&isFinite(t);if("string"===o){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const o=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===o&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function Qo(t,e,o){let n=-1;for("function"==typeof e?(o=e,e=t):n=t-1;++n<=e&&!1!==o(n););}function Zo(t,e,o){let n=t+1;for("function"==typeof e&&(o=e,e=0);--n>=e&&!1!==o(n););}function Jo(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function tn(t,e,o){return Math.min(t,e)===t?e:Math.max(t,o)===t?o:t}const en="asc",on=new Map([[en,[-1,1]],["desc",[1,-1]]]),nn=t=>`The priority '${t}' is already declared in a map.`,rn=t=>`The priority '${t}' is not a number.`,sn=t=>`The id '${t}' is already declared in a map.`;function ln(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function o(){return[...e]}function n(t){return e.has(t)}return t=ae(t)?t:sn,{addItem:function(o,i){if(n(o))throw new Error(t(o));e.set(o,i)},clear:function(){e.clear()},getId:function(t){const[e]=o().find((e=>{let[o,n]=e;return t===n&&o}))||[null];return e},getItem:function(t){return e.get(t)},getItems:o,hasItem:n,removeItem:function(t){return e.delete(t)}}}const an=t=>`'${t}' value is already declared in a unique set.`,hn=t=>`There is already registered "${t}" plugin.`,cn=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map;return t=ae(t)?t:nn,e=ae(e)?e:rn,{addItem:function(n,i){if(!qo(n))throw new Error(e(n));if(o.has(n))throw new Error(t(n));o.set(n,i)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:en;const[e,n]=on.get(t)||on.get(en);return[...o].sort(((t,o)=>t[0]<o[0]?e:n)).map((t=>t[1]))}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),un=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;return t=ae(t)?t:an,{addItem:function(o){if(e.has(o))throw new Error(t(o));e.add(o)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:hn}),dn=ln({errorIdExists:hn});function gn(){return[...cn.getItems(),...un.getItems()]}function fn(t){const e=x(t);return dn.getItem(e)}function pn(t,e,o){[t,e,o]=function(t,e,o){return"function"==typeof t&&(t=(e=t).PLUGIN_KEY,o=e.PLUGIN_PRIORITY),[t,e,o]}(t,e,o),void 0===fn(t)&&function(t,e,o){const n=x(t);if(dn.hasItem(n))throw new Error(hn(n));void 0===o?un.addItem(n):cn.addItem(o,n),dn.addItem(n,e)}(t,e,o)}const{register:mn,getItem:wn,hasItem:vn,getNames:yn,getValues:bn}=so("renderers");function Cn(t){if("function"==typeof t)return t;if(!vn(t))throw Error(`No registered renderer found under "${t}" name`);return wn(t)}function Sn(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),mn(t,e)}const{register:Rn,getItem:En,hasItem:Tn,getNames:xn,getValues:Mn}=so("validators");function Hn(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),Rn(t,e)}function kn(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function In(t,e){return t.get(On(t,e))}function An(t,e,o){return t.set(On(t,e),o),o}function On(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Pn=new WeakMap,Nn=new WeakMap,Dn=new WeakMap,Ln=new WeakMap,Vn=new WeakMap,Fn=new WeakMap,Wn=new WeakMap,Bn=new WeakMap,jn=new WeakMap,zn=new WeakMap;const Un=class{constructor(t,e,o,n,i,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;kn(this,Pn,void 0),kn(this,Nn,void 0),kn(this,Dn,void 0),kn(this,Ln,void 0),kn(this,Vn,void 0),kn(this,Fn,void 0),kn(this,Wn,void 0),kn(this,Bn,void 0),kn(this,jn,[null,null]),kn(this,zn,[null,null]),An(Pn,this,o),An(Nn,this,e),An(Dn,this,i),An(Ln,this,r),An(Vn,this,s),An(Fn,this,n),An(Wn,this,t),this.registerEvents()}registerEvents(){In(Fn,this).addEventListener(In(Dn,this).holder,"contextmenu",(t=>this.onContextMenu(t))),In(Fn,this).addEventListener(In(Dn,this).TABLE,"mouseover",(t=>this.onMouseOver(t))),In(Fn,this).addEventListener(In(Dn,this).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{In(Fn,this).addEventListener(In(Dn,this).holder,"touchstart",(t=>this.onTouchStart(t))),In(Fn,this).addEventListener(In(Dn,this).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),In(Fn,this).addEventListener(In(Dn,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||In(Pn,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,In(Pn,this).getSetting("onAfterMomentumScroll"))}),200)}))};Le()?t():(ke()&&t(),(()=>{In(Fn,this).addEventListener(In(Dn,this).holder,"mouseup",(t=>this.onMouseUp(t))),In(Fn,this).addEventListener(In(Dn,this).holder,"mousedown",(t=>this.onMouseDown(t)))})())}selectedCellWasTouched(t){const e=this.parentCell(t).coords;if(In(Bn,this)&&e){const[t,o]=[e.row,In(Bn,this).from.row],[n,i]=[e.col,In(Bn,this).from.col];return t===o&&n===i}return!1}parentCell(t){const e={},o=X(t,["TD","TH"],In(Dn,this).TABLE);return o?(e.coords=In(Dn,this).getCoords(o),e.TD=o):tt(t,"wtBorder")&&tt(t,"current")?(e.coords=In(Ln,this).getFocusSelection().cellRange.highlight,e.TD=In(Dn,this).getCell(e.coords)):tt(t,"wtBorder")&&tt(t,"area")&&In(Ln,this).getAreaSelection().cellRange&&(e.coords=In(Ln,this).getAreaSelection().cellRange.to,e.TD=In(Dn,this).getCell(e.coords)),e}onMouseDown(t){const e=In(Nn,this).rootDocument.activeElement,o=ce(G,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||o(0)===e||o(1)===e))return;const i=this.parentCell(n);tt(n,"corner")?In(Pn,this).getSetting("onCellCornerMouseDown",t,n):i.TD&&In(Pn,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(In(zn,this)[0]=i.TD,clearTimeout(In(jn,this)[0]),In(jn,this)[0]=setTimeout((()=>{In(zn,this)[0]=null}),1e3))}onContextMenu(t){if(In(Pn,this).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!In(Pn,this).has("onCellMouseOver"))return;const e=In(Dn,this).TABLE,o=X(t.target,["TD","TH"],e),n=In(Vn,this)||this;o&&o!==n.lastMouseOver&&q(o,e)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",t,In(Dn,this).getCoords(o),o))}onMouseOut(t){if(!In(Pn,this).has("onCellMouseOut"))return;const e=In(Dn,this).TABLE,o=X(t.target,["TD","TH"],e),n=X(t.relatedTarget,["TD","TH"],e),i=In(Vn,this)||this;o&&o!==n&&q(o,e)&&(this.callListener("onCellMouseOut",t,In(Dn,this).getCoords(o),o),null===n&&(i.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&In(Pn,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===In(zn,this)[0]&&e.TD===In(zn,this)[1]?(tt(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),In(zn,this)[0]=null,In(zn,this)[1]=null):e.TD===In(zn,this)[0]&&(In(zn,this)[1]=e.TD,clearTimeout(In(jn,this)[1]),In(jn,this)[1]=setTimeout((()=>{In(zn,this)[1]=null}),500)))}onTouchStart(t){An(Bn,this,In(Ln,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const o=t.target,n=null===(e=this.parentCell(o))||void 0===e?void 0:e.coords,i=Kt(n)&&n.row>=0&&n.col>=0;if(t.cancelable&&i&&In(Pn,this).getSetting("isDataViewInstance")){const e=["A","BUTTON","INPUT"];Ve()&&(Oe.chromeWebKit.value||Oe.firefoxWebKit.value)&&this.selectedCellWasTouched(o)&&!e.includes(o.tagName)?t.preventDefault():this.selectedCellWasTouched(o)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,o,n){const i=In(Pn,this).getSettingPure(t);i&&i(e,o,n,In(Wn,this).call(this))}destroy(){clearTimeout(In(jn,this)[0]),clearTimeout(In(jn,this)[1]),In(Fn,this).destroy()}};function $n(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Gn=class{constructor(t,e,o){$n(this,"offset",void 0),$n(this,"total",void 0),$n(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function Yn(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Kn=class{constructor(t,e,o){Yn(this,"offset",void 0),Yn(this,"total",void 0),Yn(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function Xn(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class qn{constructor(){Xn(this,"currentSize",0),Xn(this,"nextSize",0),Xn(this,"currentOffset",0),Xn(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function Qn(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Zn{constructor(){Qn(this,"size",new qn),Qn(this,"workingSpace",0),Qn(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof qn}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function Jn(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class ti{constructor(t,e,o){Jn(this,"rootNode",void 0),Jn(this,"nodesPool",void 0),Jn(this,"sizeSet",new Zn),Jn(this,"childNodeType",void 0),Jn(this,"visualIndex",0),Jn(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=o.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let o=0;if(this.isSharedViewSet()){let n=t.firstElementChild;for(;n;){if(n.tagName===this.childNodeType)o+=1;else if(e.isPlaceOn(1))break;n=n.nextElementSibling}}else o=t.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,o=this.isSharedViewSet(),{nextSize:n}=e.getViewSize();let i=this.getRenderedChildCount();for(;i<n;){const n=this.nodesPool();!o||o&&e.isPlaceOn(2)?t.appendChild(n):t.insertBefore(n,t.firstChild),i+=1}const r=o&&e.isPlaceOn(1);for(;i>n;)t.removeChild(r?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let o=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(o+=e.sharedSize.nextSize);let n=t.childNodes[o];if(n.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,n),n=e}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class ei extends ti{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}class oi{constructor(t){var e,o,n;e=this,n=void 0,o=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(o="nodeType"),o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function ni(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class ii{constructor(t,e){ni(this,"nodesPool",null),ni(this,"nodeType",void 0),ni(this,"rootNode",void 0),ni(this,"table",null),ni(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new oi(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function ri(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class si extends ii{constructor(){super("TH"),ri(this,"orderViews",new WeakMap),ri(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ei(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:o,rows:n,cells:i}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=n.getRenderedNode(r);this.sourceRowIndex=t;const l=this.obtainOrderView(s),a=i.obtainOrderView(s);l.appendView(a).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<o;n++){l.render();const o=l.getCurrentNode();o.className="",o.removeAttribute("style"),it(o,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&nt(o,[["role","rowheader"],["scope","row"],W(n+1),O(-1)]),e[n](t,o,n)}l.end()}}}class li extends ii{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let o=this.rootNode.firstChild;if(t){const{columnsToRender:n}=this.table,i=n+e;for(let e=0,n=t;e<n;e++){for(o=this.rootNode.childNodes[e],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;this.renderedNodes<i;)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)o.removeChild(o.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&st(o)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&nt(this.rootNode,[["role","rowgroup"]]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:o,rowHeadersCount:n}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&nt(i,[["role","row"],F(e+1)]);for(let r=-1*n;r<o;r+=1){const o=this.table.renderedColumnToSource(r),s=i.childNodes[r+n];s.className="",s.removeAttribute("style"),it(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&nt(s,[W(r+1+this.table.rowHeadersCount),O(-1),["role","columnheader"],...r>=0?[["scope","col"]]:[["role","row"]]]),t[e](o,s,e)}}}}let ai=!1;class hi extends ii{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,o=t+e;for(;this.renderedNodes<o;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>o;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!ai&&t>1e3&&(ai=!0,qe(Gt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){const e=this.table.renderedColumnToSource(t),o=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${o}px`}for(let o=0;o<t;o++){const t=this.table.renderedColumnToSource(o),n=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[o+e].style.width=`${n}px`}const o=this.rootNode.firstChild;o&&et(o,"rowHeader")}}let ci=!1;class ui extends ii{constructor(t){var e,o,n;super("TR",t),e=this,n=void 0,o=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(o="orderView"),o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,this.orderView=new ti(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!ci&&t>1e3&&(ci=!0,qe(Gt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&nt(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(n);var e,o;this.table.isAriaEnabled()&&nt(t,[["role","row"],F(i+(null!==(e=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==e?e:0)+1)])}this.orderView.end()}}function di(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class gi extends ii{constructor(){super("TD"),di(this,"orderViews",new WeakMap),di(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ei(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:o,rowHeaders:n}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),l=o.getRenderedNode(s);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=n.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<e;o++){a.render();const e=a.getCurrentNode(),n=this.table.renderedColumnToSource(o);var i,r;tt(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),it(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled()&&nt(e,[...e.hasAttribute("role")?[]:[["role","gridcell"]],O(-1),W(n+(null!==(i=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==i?i:0)+1)])}a.end()}}}function fi(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class pi{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fi(this,"rootNode",void 0),fi(this,"rootDocument",void 0),fi(this,"rowHeaders",null),fi(this,"columnHeaders",null),fi(this,"colGroup",null),fi(this,"rows",null),fi(this,"cells",null),fi(this,"rowFilter",null),fi(this,"columnFilter",null),fi(this,"rowUtils",null),fi(this,"columnUtils",null),fi(this,"rowsToRender",0),fi(this,"columnsToRender",0),fi(this,"rowHeaderFunctions",[]),fi(this,"rowHeadersCount",0),fi(this,"columnHeaderFunctions",[]),fi(this,"columnHeadersCount",0),fi(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:o,rows:n,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),o.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=o,this.rows=n,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let o=0;o<t;o++){const t=e.getRenderedNode(o);if(t.firstChild){const e=this.renderedRowToSource(o),n=this.rowUtils.getHeight(e);t.firstChild.style.height=n?n-1+"px":""}}}}class mi{constructor(){let{TABLE:t,THEAD:e,COLGROUP:o,TBODY:n,rowUtils:i,columnUtils:r,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new pi(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new si,columnHeaders:new li(e),colGroup:new hi(o),rows:new ui(n),cells:new gi}),this.renderer.setAxisUtils(i,r)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function wi(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function vi(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yi(t,e){return t.get(Ci(t,e))}function bi(t,e,o){return t.set(Ci(t,e),o),o}function Ci(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Si=new WeakMap,Ri=new WeakMap,Ei=new WeakMap,Ti=new WeakMap,xi=new WeakMap;class Mi{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:o,stretchingColumnWidthFn:n,columnWidthFn:i}=t;vi(this,"stretchAllRatio",0),vi(this,"stretchLastWidth",0),vi(this,"stretchAllColumnsWidth",[]),wi(this,Si,0),vi(this,"needVerifyLastColumnWidth",!0),wi(this,Ri,(()=>0)),wi(this,Ei,(t=>t)),wi(this,Ti,(t=>t)),wi(this,xi,(()=>"none")),bi(Ri,this,e),bi(xi,this,o),bi(Ei,this,null!=n?n:yi(Ei,this)),bi(Ti,this,null!=i?i:yi(Ti,this))}refreshStretching(t){if("none"===yi(xi,this).call(this))return;bi(Si,this,t);let e=0;for(let o=0;o<yi(Ri,this).call(this);o++){const n=this._getColumnWidth(o),i=yi(Ei,this).call(this,void 0,o);"number"==typeof i?t-=i:e+=n}const o=t-e;if("all"===yi(xi,this).call(this)&&o>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===yi(xi,this).call(this)&&t!==1/0){const t=this._getColumnWidth(yi(Ri,this).call(this)-1),e=o+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let o=null;return"all"===yi(xi,this).call(this)&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(t,e):"last"===yi(xi,this).call(this)&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(t)),o}_getStretchedAllColumnWidth(t,e){let o=0;if(!this.stretchAllColumnsWidth[t]){const o=Math.round(e*this.stretchAllRatio),n=yi(Ei,this).call(this,o,t);this.stretchAllColumnsWidth[t]=void 0===n?o:isNaN(n)?this._getColumnWidth(t):n}if(this.stretchAllColumnsWidth.length===yi(Ri,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)o+=this.stretchAllColumnsWidth[t];o!==yi(Si,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=yi(Si,this)-o)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===yi(Ri,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=yi(Ti,this).call(this,t);return isNaN(e)&&(e=Mi.DEFAULT_WIDTH),e}}function Hi(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class ki{constructor(t,e){Hi(this,"dataAccessObject",void 0),Hi(this,"wtSettings",void 0),Hi(this,"headerWidths",new Map),Hi(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new Mi({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t);const o=this.stretching.getStretchedColumnWidth(t,e);return o&&(e=o),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==o&&(e=e?Math.max(e,o):o),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){const{wtTable:t,wtViewport:e,cloneSource:o}=this.dataAccessObject,n=o?o.wtTable.holder:t.holder,i=n.offsetHeight<n.scrollHeight?Ht():0;this.stretching.refreshStretching(e.getViewportWidth()-i)}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),e=t.getSetting("onModifyRowHeaderWidth",e),null!=e){const o=t.getSetting("rowHeaders").length,n=t.getSetting("defaultColumnWidth");for(let t=0;t<o;t++){let o=Array.isArray(e)?e[t]:e;o=null==o?n:o,this.headerWidths.set(t,o)}}}}function Ii(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Ai{constructor(t,e){Ii(this,"dataAccessObject",void 0),Ii(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(e=void 0===e?o:Math.max(e,o)),e}}const Oi="top",Pi="bottom",Ni="inline_start",_i="top_inline_start_corner",Di="bottom_inline_start_corner",Li=[Oi,Pi,Ni,_i,Di],Vi=new Map([[Oi,`ht_clone_${Oi}`],[Pi,`ht_clone_${Pi}`],[Ni,`ht_clone_${Ni} ht_clone_left`],[_i,`ht_clone_${_i} ht_clone_top_left_corner`],[Di,`ht_clone_${Di} ht_clone_bottom_left_corner`]]);function Fi(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Wi=class{constructor(t,e,o,n,i){Fi(this,"wtSettings",null),Fi(this,"domBindings",void 0),Fi(this,"TBODY",null),Fi(this,"THEAD",null),Fi(this,"COLGROUP",null),Fi(this,"hasTableHeight",!0),Fi(this,"hasTableWidth",!0),Fi(this,"isTableVisible",!1),Fi(this,"tableOffset",0),Fi(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,rt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new Ai(this.dataAccessObject,this.wtSettings),this.columnUtils=new ki(this.dataAccessObject,this.wtSettings),this.tableRenderer=new mi({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&tt(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",e&&e.insertBefore(o,t),o.appendChild(t)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&nt(o,[P()]),o}createHider(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&tt(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",e&&e.insertBefore(o,t),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&nt(o,[P()]),o}createHolder(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&tt(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",e&&e.insertBefore(o,t),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&nt(o.parentNode,[P()])),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&nt(o,[P()]),o}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,i=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),l=s.length,a=e.getSetting("columnHeaders"),h=a.length;let c=!1,u=t;if(this.isMaster&&(this.holderOffset=ut(this.holder),u=n.createRenderCalculators(u),l&&!e.getSetting("fixedColumnsStart"))){const t=o.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(u=!1)}if(this.isMaster&&(c=o.updateStateOfRendering()),u)this.isMaster&&(n.createVisibleCalculators(),n.createPartiallyVisibleCalculators()),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=ut(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new Kn(t,i,h),this.columnFilter=new Gn(e,r,l);let o=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),o=!0!==t.skipRender}if(o){let t;if(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(Pi)||this.is(Di))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Pi))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtViewport.createPartiallyVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=bt(this.hider),o=bt(this.TABLE);0!==e&&o!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Pi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(d=o.bottomOverlay.resetFixedPosition()||d),d=o.inlineStartOverlay.resetFixedPosition()||d,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),c&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let o=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let i,r,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;o;)o-=1,i=this.getColumnHeaderHeight(o),r=this.getColumnHeader(e,o),r&&(s=St(r),(!i&&n<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=s),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let n=0,i=t.getSetting("columnHeaders").length;n<i;n++)if(o[n]){if(!e[n]||0===e[n].childNodes.length)return;e[n].childNodes[0].style.height=`${o[n]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(Pi))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let o=0;o<t;o++){const t=this.rowFilter.renderedToSource(o);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,o=t.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",e,o);if(n&&Array.isArray(n)&&([e,o]=n),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!r&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,o=null;var n,i;return t<0?(e=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),o=this.TBODY),void 0!==e&&void 0!==o&&!(o.childNodes.length<e+1)&&o.childNodes[e]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.THEAD.childNodes[e];return null==o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const n=t.childNodes[o];n&&e.push(n)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e>=this.wtSettings.getSetting("rowHeaders").length)return;const o=this.rowFilter.sourceToRendered(t),n=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):o,i=(o<0?this.THEAD:this.TBODY).childNodes[n];return null==i?void 0:i.childNodes[e]}getRowHeaders(t){const e=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null==o?void 0:o.childNodes[n];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=K(e,["TD","TH"])),null===e)return null;const o=e.parentNode,n=o.parentNode;let i=function(t){let e=0,o=t;if(o.previousSibling)for(;o=o.previousSibling;)e+=1;return e}(o),r=e.cellIndex;return Q(_i,e,this.wtRootElement)||Q(Oi,e,this.wtRootElement)?"THEAD"===n.nodeName&&(i-=n.childNodes.length):i=Q(Di,e,this.wtRootElement)||Q(Pi,e,this.wtRootElement)?this.wtSettings.getSetting("totalRows")-n.childNodes.length+i:n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),r=Q(_i,e,this.wtRootElement)||Q(Ni,e,this.wtRootElement)||Q(Di,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t,e,o,n,i,r=this.TBODY.childNodes.length;if(r*this.wtSettings.getSetting("defaultRowHeight")!=St(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;r;)r-=1,o=this.rowFilter.renderedToSource(r),t=this.getRowHeight(o),n=this.getTrForRow(o),i=n.querySelector("th"),e=i?St(i):St(n)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=e)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return bt(this.TABLE)}getHeight(){return Ct(this.TABLE)}getTotalWidth(){const t=bt(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Ct(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return ct(this.TABLE)}_modifyRowHeaderWidth(t){let e=ae(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}},Bi={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ce(Bi,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const ji=Bi,zi={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ce(zi,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const Ui=zi;class $i extends Wi{constructor(t,e,o,n){super(t,e,o,n,Oi)}}ve($i,ji),ve($i,Ui);const Gi=$i;function Yi(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Ki=new WeakSet;function Xi(t){const{wtSettings:e,inlineStartOverlay:o,wtTable:n,wtViewport:i,totalColumns:r,rootWindow:s}=this.dataAccessObject;if(o.mainTableScrollableElement===s){let l=null;if(e.getSetting("rtlMode")){const t=n.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(t.right-e)}else l=ut(n.wtRootElement).left;const a=Math.abs(pt(s,s));if(l>a){const e=Rt(s);let n=i.getRowHeaderWidth();for(let i=1;i<=r;i++)if(n+=o.sumCellSizes(i-1,i),l+n-a>=e){t=i-2;break}}}return t}function qi(t){const{topOverlay:e,wtTable:o,wtViewport:n,totalRows:i,rootWindow:r}=this.dataAccessObject;if(e.mainTableScrollableElement===r){const s=ut(o.wtRootElement),l=ft(r,r);if(s.top>l){const o=St(r);let a=n.getColumnHeaderHeight();for(let n=1;n<=i;n++)if(a+=e.sumCellSizes(n-1,n),s.top+a-l>=o){t=n-2;break}}}return t}const Qi=class{constructor(t){var e,o;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e=this,o=Ki),o.add(e),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"dataAccessObject",void 0),this.dataAccessObject=t}scrollViewport(t,e,o,n,i){const r=this.scrollViewportHorizontally(t.col,o,i),s=this.scrollViewportVertically(t.row,e,n);return r||s}scrollViewportHorizontally(t,e,o){const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===o,{fixedColumnsStart:s,inlineStartOverlay:l}=this.dataAccessObject;if(r&&t<s)return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),!Number.isInteger(t)||t<0||t>i)return!1;const a=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(r&&(t<a||t>h)||!r)&&(c=l.scrollTo(t,r?t>=this.getLastPartiallyVisibleColumn():e)),c}scrollViewportVertically(t,e,o){const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const r=void 0===e&&void 0===o,{fixedRowsBottom:s,fixedRowsTop:l,topOverlay:a}=this.dataAccessObject;if(r&&(t<l||t>i-s-1))return!1;if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),!Number.isInteger(t)||t<0||t>i)return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let u=!1;return(r&&(t<h||t>c)||!r)&&(u=a.scrollTo(t,r?t>=this.getLastPartiallyVisibleRow():o)),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Yi(Ki,this,qi).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Yi(Ki,this,qi).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Yi(Ki,this,Xi).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Yi(Ki,this,Xi).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function Zi(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ji(t,e){return t.get(er(t,e))}function tr(t,e,o){return t.set(er(t,e),o),o}function er(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var or=new WeakMap;class nr{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n,i,r;Zi(this,"row",null),Zi(this,"col",null),r=!1,function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,i=or),i.set(n,r),tr(or,this,o),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:o,countRowHeaders:n,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-n||this.row>=e||this.col>=o)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ji(or,this)}isSouthEastOf(t){return this.row>=t.row&&(Ji(or,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(Ji(or,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(Ji(or,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(Ji(or,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof nr&&tr(or,this,t.isRtl()),this}clone(){return new nr(this.row,this.col,Ji(or,this))}toObject(){return{row:this.row,col:this.col}}}const ir=nr;function rr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function sr(t,e){return t.get(lr(t,e))}function lr(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var ar=new WeakMap;class hr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i,r,s;rr(this,"highlight",null),rr(this,"from",null),rr(this,"to",null),s=!1,function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(i=this,r=ar),r.set(i,s),this.highlight=t.clone(),this.from=e.clone(),this.to=o.clone(),function(t,e,o){t.set(lr(t,e),o)}(ar,this,n)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:o}=t,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=e&&i.row>=e&&n.col<=o&&i.col>=o}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>o.row||t.col>o.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(o.row,t.row),Math.max(o.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;const o=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=this.getDirection(),r=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),l=Math.min(o.row,r.row),a=Math.min(o.col,r.col),h=Math.max(n.row,s.row),c=Math.max(n.col,s.col),u=this._createCellCoords(l,a),d=this._createCellCoords(h,c);return this.from=u,this.to=d,this.setDirection(i),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return sr(ar,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return sr(ar,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return sr(ar,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return sr(ar,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return sr(ar,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return sr(ar,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return sr(ar,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return sr(ar,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof ir&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e=Math.min(this.from.row,this.to.row),o=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),r=Math.min(t.from.row,t.to.row),s=Math.max(t.from.row,t.to.row),l=Math.min(t.from.col,t.to.col),a=Math.max(t.from.col,t.to.col),h=[];return e===r&&h.push("top"),i===a&&h.push(sr(ar,this)?"left":"right"),o===s&&h.push("bottom"),n===l&&h.push(sr(ar,this)?"right":"left"),h}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(this._createCellCoords(n,i));return o}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)t.row===n&&t.col===i?o.push(t):e.row===n&&e.col===i?o.push(e):o.push(this._createCellCoords(n,i));return o}forAll(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=e.row;n<=o.row;n++)for(let i=e.col;i<=o.col;i++)if(!1===t(n,i))return}clone(){return new hr(this.highlight,this.from,this.to,sr(ar,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new ir(t,e,sr(ar,this))}}const cr=hr;function ur(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class dr{get eventManager(){return new yo(this)}constructor(t,e){ur(this,"wtTable",void 0),ur(this,"wtScroll",void 0),ur(this,"wtViewport",void 0),ur(this,"wtOverlays",void 0),ur(this,"selectionManager",void 0),ur(this,"wtEvent",void 0),ur(this,"guid",`wt_${M()}`),ur(this,"drawInterrupted",!1),ur(this,"drawn",!1),ur(this,"domBindings",void 0),ur(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new Qi(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;e<o;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,o){ht(o,t[e])}])}}createCellCoords(t,e){return new ir(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,o){return new cr(t,e,o,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);const e=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<o&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=e-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,o,n,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function gr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class fr extends dr{constructor(t,e,o){super(t,e),gr(this,"cloneSource",void 0),gr(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new Un(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}}class pr{constructor(t,e,o,n,i){var r,s,l;r=this,l=null,s=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(s="wtSettings"),s in r?Object.defineProperty(r,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[s]=l,Ce(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=n;const{TABLE:a,hider:h,spreader:c,holder:u,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=h,this.spreader=c,this.holder=u,this.wtRootElement=d,this.trimmingContainer=wt(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=wt(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=mt(t.TABLE)}getRelativeCellPosition(t,e,o){if(!1===this.clone.wtTable.holder.contains(t))return void qe(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=o<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=n?this.getRelativeCellPositionWithinWindow(r,i,h,a):this.getRelativeCellPositionWithinHolder(r,s,i,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,o,n){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Ht())),r=t<=0?-1*t:0}else r=n.start;return s=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:n.top,{start:o.start+r,top:o.top+s}}getRelativeCellPositionWithinHolder(t,e,o,n,i){const r=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let l=0,a=0;if(o||(l=r-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(a=s-i.top);return{start:n.start-l,top:n.top-a}}makeClone(){if(-1===Li.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=o.createElement("div"),r=o.createElement("table"),s=t.wtRootElement.parentNode;i.className=`${Vi.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&nt(i,[P()]),r.className=t.TABLE.className,t.TABLE.getAttribute("role")&&r.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(r),s.appendChild(i);const l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===Oi||"vertical"===l&&this.type===Ni?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=mt(t.TABLE),new fr(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider;jt([t.style,e.style,t.parentNode.style],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const mr=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class wr extends pr{constructor(t,e,o,n){var i,r,s;super(t,e,Oi,o,n),i=this,s=-1,r=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(r="cachedFixedRowsTop"),r in i?Object.defineProperty(i,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[r]=s,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Gi(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;if(this.trimmingContainer!==e||o&&"vertical"===o)n=this.getScrollPosition(),It(t);else{const{wtTable:e}=this.wot,o=e.hider.getBoundingClientRect();i=Math.ceil(o.bottom)===t.offsetHeight,n=this.getOverlayOffset(),kt(t,"0px",`${n}px`)}const r=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(gt(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultRowHeight");let n=t,i=0;for(;n<e;){const t=this.wot.wtTable.getRowHeight(n);i+=void 0===t?o:t,n+=1}return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=Ht(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===r){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=`${e}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=Ct(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(mr.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:o,wtSettings:n}=this,i=(o.cloneSource?o.cloneSource:o).wtTable.holder,r=n.getSetting("columnHeaders"),s=0===n.getSetting("fixedRowsTop")&&r.length>0&&!tt(i.parentNode,"innerBorderTop")?1:0;let l=this.getTableParentOffset(),a=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&i.offsetHeight!==i.clientHeight&&(a=Ht(this.domBindings.rootDocument)),e){const e=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=o.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),l+=1,l+=s}else l+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);var h;return l+=a,(h=this.mainTableScrollableElement).scrollHeight-h.clientHeight==l-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ft(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>t&&(o=0)}return o}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?ot(o,"emptyColumns"):et(o,"emptyColumns");let n=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==e,r=this.wtSettings.getSetting("columnHeaders");if((i||0===e)&&r.length>0){const e=tt(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(et(o,"innerBorderTop"),n=!e):(ot(o,"innerBorderTop"),n=e)}}return n}}const vr={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),o=t-e;return 0===t||0===e?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};Ce(vr,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const yr=vr;class br extends Wi{constructor(t,e,o,n){super(t,e,o,n,Pi)}}ve(br,yr),ve(br,Ui);const Cr=br;class Sr extends pr{constructor(t,e,o,n){var i,r,s;super(t,e,Pi,o,n),i=this,s=-1,r=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(r="cachedFixedRowsBottom"),r in i?Object.defineProperty(i,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[r]=s,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Cr(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let o=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),e.style.bottom=`${o}px`);const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=Ht(o)),n.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.mainTableScrollableElement===e?(e.scrollTo(gt(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:o,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let r=t,s=0;for(;r<e;){const t=o.getRowHeight(r);s+=void 0===t?i:t,r+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=Ht(o),r=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let o=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=i),o=Math.min(o,t.wtRootElement.scrollWidth),r.width=`${o}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=Ct(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;e&&n.offsetHeight!==n.clientHeight&&(i=Ht(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),o+=i,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ft(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=t-this.clone.wtTable.getTotalHeight(),n=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-n+t,0),o>e&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders");let i=!1;if((o||0===e)&&n.length>0){const e=this.wot.wtTable.holder.parentNode,o=tt(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(et(e,"innerBorderBottom"),i=!o):(ot(e,"innerBorderBottom"),i=o)}return i}}const Rr={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ce(Rr,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const Er=Rr,Tr={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ce(Tr,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const xr=Tr;class Mr extends Wi{constructor(t,e,o,n){super(t,e,o,n,Ni)}}ve(Mr,Er),ve(Mr,xr);const Hr=Mr;class kr extends pr{constructor(t,e,o,n){super(t,e,Ni,o,n)}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Hr(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||n&&"horizontal"===n?(i=this.getScrollPosition(),It(o)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),kt(o,`${i}px`,"0px"));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,dt(e)),o=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultColumnWidth");let n=t,i=0;for(;n<e;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=Ht(e),i=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===r){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),i.height=`${e}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=bt(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(mr.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){const{wtSettings:o}=this,n=o.getSetting("rowHeaders"),i=o.getSetting("fixedColumnsStart"),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===i&&n.length>0&&!tt(r.parentNode,"innerBorderInlineStart")?1:0;let l=this.getTableParentOffset(),a=0;var h;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&r.offsetWidth!==r.clientWidth&&(a=Ht(this.domBindings.rootDocument)),e?(l+=this.sumCellSizes(0,t+1),l-=this.wot.wtViewport.getViewportWidth(),l+=s):l+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),l+=a,(h=this.mainTableScrollableElement).scrollWidth-h.clientWidth==l-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){let t=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(pt(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;return this.trimmingContainer!==t||e&&"horizontal"===e||(o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(o=0)),o}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?ot(e,"emptyRows"):et(e,"emptyRows");let i=!1;if(n&&!o.length)et(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const o=tt(e,"innerBorderInlineStart");t?(et(e,"innerBorderLeft innerBorderInlineStart"),i=!o):(ot(e,"innerBorderLeft innerBorderInlineStart"),i=o)}return i}}class Ir extends Wi{constructor(t,e,o,n){super(t,e,o,n,_i)}}ve(Ir,ji),ve(Ir,xr);const Ar=Ir;function Or(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Pr extends pr{constructor(t,e,o,n,i,r){super(t,e,_i,o,n),Or(this,"topOverlay",void 0),Or(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Ar(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;this.trimmingContainer===this.domBindings.rootWindow?kt(t,this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)+"px",`${this.topOverlay.getOverlayOffset()}px`):It(t);let e=Ct(this.clone.wtTable.TABLE);const o=bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${o}px`,!1}}class Nr extends Wi{constructor(t,e,o,n){super(t,e,o,n,Di)}}ve(Nr,yr),ve(Nr,xr);const _r=Nr;class Dr extends pr{constructor(t,e,o,n,i,r){super(t,e,Di,o,n),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new _r(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${o}px`}else It(e),this.repositionOverlay();let o=Ct(this.clone.wtTable.TABLE);const n=bt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height=`${o}px`,e.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=Ht(o)),n.style.bottom=`${i}px`}}function Lr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Vr=class{constructor(t,e,o,n,i,r){Lr(this,"wot",null),Lr(this,"topOverlay",null),Lr(this,"bottomOverlay",null),Lr(this,"inlineStartOverlay",null),Lr(this,"topInlineStartCornerOverlay",null),Lr(this,"bottomInlineStartCornerOverlay",null),Lr(this,"browserLineHeight",void 0),Lr(this,"wtSettings",null),Lr(this,"resizeObserver",new ResizeObserver((t=>{Me((()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=n,this.domBindings=o,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Ht(s);const a="hidden"===l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?r.holder:mt(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,o=t.getComputedStyle(e.body),n=parseInt(o.lineHeight,10),i=1.2*parseInt(o.fontSize,10);this.browserLineHeight=n||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new wr(...t),this.bottomOverlay=new Sr(...t),this.inlineStartOverlay=new kr(...t),this.topInlineStartCornerOverlay=new Pr(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Dr(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),l={passive:r};let a;(s||i||!Ne())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(a),a=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(n!==e&&i!==e&&!t.target.contains(n)||o!==e&&i!==e&&!t.target.contains(o))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=t.target,s=i!==o&&r!==o&&!r.contains(i),l=n!==o&&r!==o&&!r.contains(n);if(this.keyPressed&&(s||l))return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==o&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=$e(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,o=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(o+=o*this.browserLineHeight,e+=e*this.browserLineHeight);const n=this.scrollVertically(e),i=this.scrollHorizontally(o);return n||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==t.scrollX,this.verticalScrolling=o.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:o}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=mt(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,o=t.clientHeight,n=e!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=o),n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:o}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,r=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,h=l+this.inlineStartOverlay.sumCellSizes(0,r),c=o.hider.style,u=(()=>!i&&this.scrollableElement.scrollTop>Math.max(0,a-o.holder.clientHeight))()?1:0,d=(()=>!i&&this.scrollableElement.scrollLeft>Math.max(0,h-o.holder.clientWidth))()?1:0;if(c.width=`${h+d}px`,c.height=`${a+u}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=o.wtRootElement,{scrollHeight:n,scrollWidth:i}=o.holder;this.hasScrollbarRight=t<n,this.hasScrollbarBottom=e<i,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}expandHiderVerticallyBy(t){const{wtTable:e}=this;e.hider.style.height=`${parseInt(e.hider.style.height,10)+t}px`}expandHiderHorizontallyBy(t){const{wtTable:e}=this;e.hider.style.width=`${parseInt(e.hider.style.width,10)+t}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let o=null;return jt(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(o=e.clone)})),o}syncOverlayTableClassNames(){const t=this.wtTable.TABLE;jt([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}};function Fr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Wr{constructor(t){Fr(this,"settings",{}),Fr(this,"defaults",Object.freeze(this.getDefaults())),Se(this.defaults,((e,o)=>{if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===e)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,o)=>{const n=this.getSetting("data",t,e);ht(o,null==n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?Se(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,o,n,i){return"function"==typeof this.settings[t]?this.settings[t](e,o,n,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class Br extends Wi{constructor(t,e,o,n){super(t,e,o,n,"master")}alignOverlaysWithTrimmingContainer(){const t=wt(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const o=t.parentElement,n=vt(t,"height",e),i=vt(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;if(o&&["auto","hidden","scroll"].includes(i)){const n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?o.insertBefore(n,t.nextElementSibling):o.appendChild(n);const i=parseInt(yt(n,e).height,10);o.removeChild(n),0===i&&(h=0)}h=Math.min(h,l),r.height="auto"===n?"auto":`${h}px`,a=Math.min(a,s),r.width=`${a}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=ct(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,o="master",n=t.getSetting("columnHeaders").length;if(n&&!e.hasOversizedColumnHeadersMarked[o]){const i=t.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount();for(let t=0;t<n;t++)for(let t=-1*i;t<r;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[o]=!0}}}ve(Br,Er),ve(Br,Ui);const jr=Br;function zr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Ur{constructor(t){zr(this,"count",0),zr(this,"startRow",0),zr(this,"endRow",0),zr(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}function $r(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Gr(t,e){return t.get(Yr(t,e))}function Yr(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}o(8107);var Kr=new WeakMap;class Xr{static get DEFAULT_HEIGHT(){return 23}constructor(t){var e,o,n;$r(this,"count",0),$r(this,"startRow",null),$r(this,"endRow",null),$r(this,"startPosition",null),$r(this,"isVisibleInTrimmingContainer",!1),n=void 0,function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,o=Kr),o.set(e,n),function(t,e,o){t.set(Yr(t,e),o)}(Kr,this,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,rowHeightFn:o,scrollOffset:n,totalRows:i,viewportHeight:r}=Gr(Kr,this),s=Math.max(Gr(Kr,this).scrollOffset,0),l=Gr(Kr,this).horizontalScrollbarHeight||0;let a=0,h=!0;const c=[];let u,d=0,g=0;for(let e=0;e<i;e++)if(u=o(e),isNaN(u)&&(u=Xr.DEFAULT_HEIGHT),a<=s&&2!==t&&(this.startRow=e,d=u),a>=s&&a+(2===t?u:0)<=s+r-l&&(null===this.startRow&&(this.startRow=e,d=u),this.endRow=e),c.push(a),a+=u,g=u,2!==t&&(this.endRow=e),a>=s+r-l){h=!1;break}const f=2===t?0:g;if(n+r-l<(2===t?d:0)||n>c.at(-1)+f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===i-1&&h)for(this.startRow=this.endRow;this.startRow>0;){const e=c[this.endRow]+u-c[this.startRow-1];if((e<=r-l||2!==t)&&(this.startRow-=1),e>=r-l)break}1===t&&null!==this.startRow&&e&&e(this),this.startPosition=c[this.startRow],void 0===this.startPosition&&(this.startPosition=null),i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function qr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Qr{constructor(t){qr(this,"count",0),qr(this,"startColumn",0),qr(this,"endColumn",0),qr(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}function Zr(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Jr(t,e){return t.get(ts(t,e))}function ts(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var es=new WeakMap;class os{static get DEFAULT_WIDTH(){return 50}constructor(t){var e,o,n;Zr(this,"count",0),Zr(this,"startColumn",null),Zr(this,"endColumn",null),Zr(this,"startPosition",null),Zr(this,"isVisibleInTrimmingContainer",!1),n=void 0,function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,o=es),o.set(e,n),function(t,e,o){t.set(ts(t,e),o)}(es,this,t),this.calculate()}calculate(){const{calculationType:t,overrideFn:e,scrollOffset:o,totalColumns:n,viewportWidth:i}=Jr(es,this),r=Math.max(Jr(es,this).scrollOffset,0),s=r>0?i+1:i;let l=0,a=!0;const h=[];let c,u=0,d=0;for(let e=0;e<n;e++)if(c=this._getColumnWidth(e),l<=r&&2!==t&&(this.startColumn=e,u=c),l>=r&&l+(2===t?c:0)<=r+s&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e,u=c),this.endColumn=e),h.push(l),l+=c,d=c,2!==t&&(this.endColumn=e),l>=r+i){a=!1;break}const g=2===t?0:d,f=2===t?u:0;if(o+i-s<-1*Jr(es,this).inlineStartOffset||o>h.at(-1)+g||-1*Jr(es,this).scrollOffset-Jr(es,this).viewportWidth>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===n-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=h[this.endColumn]+c-h[this.startColumn-1];if((e<=i||2!==t)&&(this.startColumn-=1),e>i)break}1===t&&null!==this.startColumn&&e&&e(this),this.startPosition=h[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),n<this.endColumn&&(this.endColumn=n-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=Jr(es,this).columnWidthFn(t);return isNaN(e)&&(e=os.DEFAULT_WIDTH),e}}const ns=class{constructor(t,e,o,n,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=o,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;return o=e===this.domBindings.rootWindow?t.documentElement.clientHeight:Ct(e)>0&&e.clientHeight>0?e.clientHeight:1/0,o}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,r=t.getSetting("totalColumns"),s=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=i-(l?a.right-i:a.left);let c,u;if(s)return bt(this.wtTable.wtRootElement);if(c=t.getSetting("freezeOverlays")?Math.min(h,i):Math.min(this.getContainerFillWidth(),h,i),n===o&&r>0&&this.sumColumnWidths(0,r-1)>c)return e.documentElement.clientWidth;if(n!==o&&(u=vt(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===u||"hidden"===u||"auto"===u))return Math.max(c,n.clientWidth);const d=t.getSetting("stretchH");return"none"!==d&&d?c:Math.max(c,bt(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let o=0,n=t;for(;n<e;)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const o=e.offsetWidth;return this.containerWidth=o,t.removeChild(e),o}getWorkspaceOffset(){return ut(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ct(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)this.rowHeaderWidth+=t[o]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)t?(this.rowHeaderWidth+=bt(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:e,wtTable:o}=this;if(e.getSetting("renderAllRows")&&1===t)return new Ur({totalRows:e.getSetting("totalRows")});let n,i,r=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=i,r-=i),a&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),r-=i),n=o.holder.clientHeight===o.holder.offsetHeight?0:Ht(this.domBindings.rootDocument),new Xr({viewportHeight:r,scrollOffset:s,totalRows:e.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,horizontalScrollbarHeight:n})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const{wtSettings:e,wtTable:o}=this;if(e.getSetting("renderAllColumns")&&1===t)return new Qr({totalColumns:e.getSetting("totalColumns")});let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=t,n-=t}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=Ht(this.domBindings.rootDocument)),new os({viewportWidth:n,scrollOffset:i,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>o.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){const e=this.createRowsCalculator(2);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=this.createColumnsCalculator(2);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}createPartiallyVisibleCalculators(){this.rowsPartiallyVisibleCalculator=this.createRowsCalculator(3),this.columnsPartiallyVisibleCalculator=this.createColumnsCalculator(3)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return!(e<i||e===i&&e>0||o>r||o===r&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return!(e<i||e===i&&e>0||o>r||o===r&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Se(this.hasOversizedColumnHeadersMarked,((t,e,o)=>{o[e]=void 0}))}};function is(t,e,o){rs(t,e),e.set(t,o)}function rs(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ss(t,e){return t.get(as(t,e))}function ls(t,e,o){return t.set(as(t,e),o),o}function as(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}o(3514);var hs=new WeakMap,cs=new WeakMap,us=new WeakSet;class ds{constructor(){var t;rs(this,t=us),t.add(this),is(this,hs,void 0),is(this,cs,void 0)}setActiveOverlay(t){return ls(cs,this,t),this}setActiveSelection(t){return ls(hs,this,t),this}scan(){const t=ss(hs,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,o,n,i]=ss(hs,this).getCorners(),{wtTable:r}=ss(cs,this),s=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let a=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<o||s>i)){for(let h=-l;h<0;h++){if(h<e||h>n)continue;const c=h+l;let u=r.getColumnHeader(s,c);const d=ss(cs,this).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:ss(hs,this).settings.selectionType,columnCursor:a,selectionWidth:i-o+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}a+=1}}}scanRowsInHeadersRange(t){const[e,o,n,i]=ss(hs,this).getCorners(),{wtTable:r}=ss(cs,this),s=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let a=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>n)){for(let h=-l;h<0;h++){if(h<o||h>i)continue;const c=h+l;let u=r.getRowHeader(s,c);const d=ss(cs,this).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:ss(hs,this).settings.selectionType,rowCursor:a,selectionHeight:n-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}a+=1}}}scanCellsRange(t){const[e,o,n,i]=ss(hs,this).getCorners(),{wtTable:r}=ss(cs,this);as(us,this,gs).call(this,((s,l)=>{if(s>=e&&s<=n&&l>=o&&l<=i){const e=r.getCell(ss(cs,this).createCellCoords(s,l)),o=ss(cs,this).getSetting("onAfterDrawSelection",s,l,ss(hs,this).settings.layerLevel);"string"==typeof o&&et(e,o),t(e)}}))}scanRowsInCellsRange(t){const[e,,o]=ss(hs,this).getCorners(),{wtTable:n}=ss(cs,this);as(us,this,gs).call(this,((i,r)=>{if(i>=e&&i<=o){const e=n.getCell(ss(cs,this).createCellCoords(i,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,o]=ss(hs,this).getCorners(),{wtTable:n}=ss(cs,this);as(us,this,gs).call(this,((i,r)=>{if(r>=e&&r<=o){const e=n.getCell(ss(cs,this).createCellCoords(i,r));t(e)}}))}}function gs(t){const{wtTable:e}=ss(cs,this),o=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<o;i+=1){const o=e.rowFilter.renderedToSource(i);for(let i=0;i<n;i+=1)t(o,e.columnFilter.renderedToSource(i))}}const fs=class{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=mr,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let t=0,e=this.main.childNodes.length;t<e;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),Ge(t);const o=this,n=this.wot.rootDocument.body,i=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(n,"mousemove",(function t(r){var s;((s=r).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(o.eventManager.removeEventListener(n,"mousemove",t),e.style.display="block")}))}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const o=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let i=0;i<5;i++){const r=o[i],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[r]&&this.settings[r].hide&&(s.className+=" hidden"),n=s.style,n.backgroundColor=this.settings[r]&&this.settings[r].color?this.settings[r].color:t.border.color,n.height=this.settings[r]&&this.settings[r].width?`${this.settings[r].width}px`:`${t.border.width}px`,n.width=this.settings[r]&&this.settings[r].width?`${this.settings[r].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Le()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style},Se({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t})),Se({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const o=this.wot.selectionManager.getAreaSelection();return!(!o.cellRange||t===o.cellRange.to.row&&e===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,o,n,i,r){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,u=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();l.top=`${parseInt(o-d-1,10)}px`,l[s]=`${parseInt(n-d-1,10)}px`,a.top=`${parseInt(o-g/4*3,10)}px`,a[s]=`${parseInt(n-g/4*3,10)}px`;const m=Math.min(parseInt(n+i,10),f-d-2*u),w=Math.min(parseInt(n+i-g/4,10),f-g-2*u);h[s]=`${m}px`,c[s]=`${w}px`;const v=Math.min(parseInt(o+r,10),p-d-2*u),y=Math.min(parseInt(o+r-g/4,10),p-g-2*u);h.top=`${v}px`,c.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(l.display="none",h.display="none",a.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:o,rootWindow:n}=this.wot;let i,r,s,l,a,h;const c=e.getRenderedRowsCount();for(let o=0;o<c;o+=1){const n=e.rowFilter.renderedToSource(o);if(n>=t[0]&&n<=t[2]){i=n,a=t[0];break}}for(let o=c-1;o>=0;o-=1){const n=e.rowFilter.renderedToSource(o);if(n>=t[0]&&n<=t[2]){r=n;break}}const u=e.getRenderedColumnsCount();for(let o=0;o<u;o+=1){const n=e.columnFilter.renderedToSource(o);if(n>=t[1]&&n<=t[3]){s=n,h=t[1];break}}for(let o=u-1;o>=0;o-=1){const n=e.columnFilter.renderedToSource(o);if(n>=t[1]&&n<=t[3]){l=n;break}}if(void 0===i||void 0===s)return void this.disappear();let d=e.getCell(this.wot.createCellCoords(i,s));const g=i!==r||s!==l,f=g?e.getCell(this.wot.createCellCoords(r,l)):d,p=ut(d),m=g?ut(f):p,w=ut(e.TABLE),v=bt(e.TABLE),y=p.top,b=p.left,C=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(C){const t=bt(d),e=n.innerWidth-w.left-v;R=b+t-m.left,S=n.innerWidth-b-t-e-1}else R=m.left+bt(f)-b,S=b-w.left-1;if(this.isEntireColumnSelected(i,r)){const t=this.getDimensionsFromHeader("columns",s,l,a,w);let e=null;t&&([e,S,R]=t),e&&(d=e)}let E=y-w.top-1,T=m.top+Ct(f)-y;if(this.isEntireRowSelected(s,l)){const t=this.getDimensionsFromHeader("rows",i,r,h,w);let e=null;t&&([e,E,T]=t),e&&(d=e)}const x=yt(d,n);parseInt(x.borderTopWidth,10)>0&&(E+=1,T=T>0?T-1:0),parseInt(x[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const M=C?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[M]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[M]=`${S}px`,this.startStyle.height=`${T}px`,this.startStyle.display="block";const H=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+T-H+"px",this.bottomStyle[M]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[M]=S+R-H+"px",this.endStyle.height=`${T+1}px`,this.endStyle.display="block";let k=this.settings.border.cornerVisible;k="function"==typeof k?k(this.settings.layerLevel):k;const I=this.wot.getSetting("onModifyGetCellCoords",r,l);let[A,O]=[r,l];if(I&&Array.isArray(I)&&([,,A,O]=I),Le()||!k||this.isPartRange(A,O))this.cornerStyle.display="none";else{this.cornerStyle.top=E+T+this.cornerCenterPointOffset-1+"px",this.cornerStyle[M]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=wt(e.TABLE);const i=t===n;i&&(t=o.documentElement);const s=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let o=!1,n=0;C?(n=e-parseInt(this.cornerDefaultStyle.width,10)/2,o=n<0):(n=e+bt(f)+parseInt(this.cornerDefaultStyle.width,10)/2,o=n>=Rt(t)),o&&(this.cornerStyle[M]=`${Math.floor(S+R+this.cornerCenterPointOffset-s)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(i?f.getBoundingClientRect().top:f.offsetTop)+Ct(f)+parseInt(this.cornerDefaultStyle.height,10)/2>=St(t)&&(this.cornerStyle.top=`${Math.floor(E+T+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Le()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,l,E,S,R,T)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,o,n,i){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":l=function(){return r.getRowHeader(...arguments)},a=function(){return Ct(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},a=function(){return bt(...arguments)},h="ht__selection--columns",d="left"}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-n),f=l(o,t-n),!g||!f)return!1;const r=ut(g),s=ut(f);return g&&f&&(c=r[d]-i[d]-1,u=s[d]+a(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const o=this[t].style,n=e[t];!n||n.hide?et(this[t],"hidden"):(tt(this[t],"hidden")&&ot(this[t],"hidden"),o.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(o.height=`${n.width}px`),"start"!==t&&"end"!==t||(o.width=`${n.width}px`))}changeBorderToDefaultStyle(t){const e=this[t].style;e.backgroundColor="#000",e.width="1px",e.height="1px"}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?et(this[t],"hidden"):ot(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Le()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function ps(t,e,o){ms(t,e),e.set(t,o)}function ms(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ws(t,e){return t.get(ys(t,e))}function vs(t,e,o){return t.set(ys(t,e),o),o}function ys(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var bs=new WeakMap,Cs=new WeakMap,Ss=new WeakMap,Rs=new WeakMap,Es=new WeakMap,Ts=new WeakMap,xs=new WeakSet;class Ms{constructor(t){var e;ms(this,e=xs),e.add(this),ps(this,bs,void 0),ps(this,Cs,void 0),ps(this,Ss,new ds),ps(this,Rs,new WeakMap),ps(this,Es,new WeakSet),ps(this,Ts,new Map),vs(Cs,this,t)}setActiveOverlay(t){return vs(bs,this,t),ws(Ss,this).setActiveOverlay(ws(bs,this)),ws(Rs,this).has(ws(bs,this))||ws(Rs,this).set(ws(bs,this),new Set),this}getFocusSelection(){return null!==ws(Cs,this)?ws(Cs,this).getFocus():null}getAreaSelection(){return null!==ws(Cs,this)?ws(Cs,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(ws(Ts,this).has(t)){const e=ws(Ts,this).get(t);if(e.has(ws(bs,this)))return e.get(ws(bs,this));const o=new fs(ws(bs,this),t.settings);return e.set(ws(bs,this),o),o}const e=new fs(ws(bs,this),t.settings);return ws(Ts,this).set(t,new Map([[ws(bs,this),e]])),e}getBorderInstances(t){var e,o;return Array.from(null!==(e=null===(o=ws(Ts,this).get(t))||void 0===o?void 0:o.values())&&void 0!==e?e:[])}destroyBorders(t){ws(Ts,this).get(t).forEach((t=>t.destroy())),ws(Ts,this).delete(t)}render(t){if(null===ws(Cs,this))return;t&&ys(xs,this,Hs).call(this);const e=Array.from(ws(Cs,this)),o=new Map,n=new Map;for(let t=0;t<e.length;t++){const i=e[t],{className:r,headerAttributes:s,createLayers:l,selectionType:a}=i.settings;ws(Es,this).has(i)||(ws(Es,this).add(i),i.addLocalHook("destroy",(()=>this.destroyBorders(i))));const h=this.getBorderInstance(i);if(i.isEmpty()){null==h||h.disappear();continue}r&&ws(Ss,this).setActiveSelection(i).scan().forEach((t=>{if(o.has(t)){const e=o.get(t);e.has(r)&&!0===l?e.set(r,e.get(r)+1):e.set(r,1)}else o.set(t,new Map([[r,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))}));const c=i.getCorners();ws(bs,this).getSetting("onBeforeDrawBorders",c,a),null==h||h.appear(c)}o.forEach(((t,e)=>{var o;const n=Array.from(t).map((t=>{let[e,o]=t;return 1===o?e:[e,...Array.from({length:o-1},((t,o)=>`${e}-${o+1}`))]})).flat();n.forEach((t=>ws(Rs,this).get(ws(bs,this)).add(t))),et(e,n),"TD"===e.nodeName&&Array.isArray(null===(o=ws(Cs,this).options)||void 0===o?void 0:o.cellAttributes)&&nt(e,ws(Cs,this).options.cellAttributes)})),Array.from(n.keys()).forEach((t=>{nt(t,[...n.get(t)])}))}}function Hs(){const t=ws(Rs,this).get(ws(bs,this)),e=ws(bs,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let o=0;o<e.length;o++)t.add(e[o]);t.forEach((t=>{var e,o;const n=ws(bs,this).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=ws(Cs,this).options)||void 0===e?void 0:e.cellAttributes)&&(i=ws(Cs,this).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(o=ws(Cs,this).options)||void 0===o?void 0:o.headerAttributes)&&(i=[...i,...ws(Cs,this).options.headerAttributes.map((t=>t[0]))]);for(let e=0,o=n.length;e<o;e++)ot(n[e],t),it(n[e],i)})),t.clear()}class ks extends dr{constructor(t,e){super(t,new Wr(e));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new jr(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new ns(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ms(this.wtSettings.getSetting("selections")),this.wtEvent=new Un(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Vr(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t=[],e=[];Se({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((o,n)=>{this.wtSettings.getSetting(n).length&&e.push(o),t.push(o)})),ot(this.wtTable.wtRootElement.parentNode,t),et(this.wtTable.wtRootElement.parentNode,e)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Is{constructor(t){t instanceof dr?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Is(t);return()=>e},this._wot=new ks(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,o){return this._wot.createCellRange(t,e,o)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,o,n,i){return this._wot.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wot.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wot.scrollViewportVertically(t,e,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,o,n,i){return this._wot.wtSettings.getSetting(t,e,o,n,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function As(t){let{isShiftKey:e,isLeftClick:o,isRightClick:n,coords:i,selection:r,controller:s,cellCoordsFactory:l}=t;const a=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(r.markSource("mouse"),e&&a)i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!s.cell?r.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!s.column?r.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!s.row?r.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!s.row?r.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!s.column&&r.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const t=!r.inInSelection(i),e=o||n&&t;i.row<0&&i.col>=0&&!s.column?e&&r.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?e&&r.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?e&&r.setRangeStart(i):i.col<0&&i.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}r.markEndSource()}const Os=new Map([["mousedown",As],["mouseover",function(t){let{isLeftClick:e,coords:o,selection:n,controller:i,cellCoordsFactory:r}=t;if(!e)return;const s=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),h=n.tableProps.countRows();n.markSource("mouse"),l&&!i.column?n.setRangeEnd(r(h-1,o.col)):s&&!i.row?n.setRangeEnd(r(o.row,a-1)):i.cell||n.setRangeEnd(o),n.markEndSource()}],["touchstart",As]]);function Ps(t,e){let{coords:o,selection:n,controller:i,cellCoordsFactory:r}=e;Os.get(t.type)({coords:o,selection:n,controller:i,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:Xe(t)||"touchstart"===t.type,isRightClick:Ke(t)})}const Ns=new WeakMap,_s=Symbol("rootInstance");function Ds(t){return t===_s}function Ls(t){return Ns.has(t)}function Vs(t,e,o){Fs(t,e),e.set(t,o)}function Fs(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bs(t,e){return t.get(zs(t,e))}function js(t,e,o){return t.set(zs(t,e),o),o}function zs(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Us=new WeakMap,$s=new WeakMap,Gs=new WeakMap,Ys=new WeakMap,Ks=new WeakMap,Xs=new WeakMap,qs=new WeakMap,Qs=new WeakSet;function Zs(){return parseInt(this.hot.rootElement.getAttribute(V()[0]),10)}function Js(t){const e=zs(Qs,this,Zs).call(this)+t;nt(this.hot.rootElement,...V(e))}const tl=class{constructor(t){var e;Fs(this,e=Qs),e.add(this),Ws(this,"hot",void 0),Ws(this,"eventManager",void 0),Ws(this,"settings",void 0),Ws(this,"THEAD",void 0),Ws(this,"TBODY",void 0),Ws(this,"_wt",void 0),Ws(this,"activeWt",void 0),Vs(this,Us,0),Vs(this,$s,0),Ws(this,"postponedAdjustElementsSize",!1),Vs(this,Gs,!1),Vs(this,Ys,void 0),Vs(this,Ks,void 0),Vs(this,Xs,0),Vs(this,qs,0),this.hot=t,this.eventManager=new yo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const o=this._wt.getCell(t,e);return o<0?null:o}scrollViewport(t,e,o,n,i){return this._wt.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wt.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wt.scrollViewportVertically(t,e,o)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),et(t,"handsontable"),js(Ks,this,e.createElement("TABLE")),et(Bs(Ks,this),"htCore"),this.hot.getSettings().tableClassName&&et(Bs(Ks,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(nt(Bs(Ks,this),[P()]),nt(t,[["role","treegrid"],L(-1),V(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=e.createElement("THEAD"),Bs(Ks,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),Bs(Ks,this).appendChild(this.TBODY),this.hot.table=Bs(Ks,this),this.hot.container.insertBefore(Bs(Ks,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:o,rootWindow:n}=this.hot,i=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{js(Gs,this,!0),this.isTextSelectionAllowed(t.target)||(Tt(n),t.preventDefault(),n.focus())})),this.eventManager.addEventListener(t,"mouseup",(()=>{js(Gs,this,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{Bs(Gs,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&Tt(n),t.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(t=>{o.isInProgress()&&!t.shiftKey&&o.finish()})),this.eventManager.addEventListener(i,"mouseup",(n=>{o.isInProgress()&&Xe(n)&&o.finish(),js(Ys,this,!1);const i=Ot(e.activeElement);At(e.activeElement)&&!i||!i&&(o.isSelected()||o.isSelectedByAnyHeader()||t.contains(n.target)||Ke(n))||this.hot.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(t=>{o.isInProgress()&&Ke(t)&&(o.finish(),js(Ys,this,!1))})),this.eventManager.addEventListener(i,"touchend",(()=>{o.isInProgress()&&o.finish(),js(Ys,this,!1)})),this.eventManager.addEventListener(i,"mousedown",(o=>{const n=o.target,r=o.x||o.clientX,s=o.y||o.clientY;let l=o.target;if(Bs(Ys,this)||!t||!this.hot.view)return;const{holder:a}=this.hot.view._wt.wtTable;if(l===a){const t=Ht(e);if(e.elementFromPoint(r+t,s)!==a||e.elementFromPoint(r,s+t)!==a)return}else for(;l!==i;){if(null===l){if(o.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(n):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let r=Y(n);for(;null!==r;)this.eventManager.addEventListener(r.document.documentElement,"click",(()=>{this.hot.unlisten()})),r=Y(r);this.eventManager.addEventListener(Bs(Ks,this),"selectstart",(t=>{this.settings.fragmentSelection||At(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:o}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,o))}translateFromRenderableToVisualIndex(t,e){let o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===o&&(o=t),null===n&&(n=e),[o,n]}countRenderableIndexes(t,e){const o=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(o-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,o,n){if(isNaN(t)||t<0)return 0;const i=o.getNearestNotHiddenIndex(t,e),r=o.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=n-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}countRenderableRowsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Bs(Ks,this),isDataViewInstance:()=>Ls(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(o,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),js($s,this,t.length),this.hot.getSettings().ariaTags&&zs(Qs,this,Zs).call(this)===this.hot.countCols()&&zs(Qs,this,Js).call(this,Bs($s,this)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(o,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),js(Us,this,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,o)=>{const[n,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",n,i);let s=n,l=i;Array.isArray(r)&&([s,l]=r);const a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,a)),this.hot.runHooks("beforeRenderer",o,n,i,h,c,a),this.hot.getCellRenderer(a)(this.hot,o,n,i,h,c,a),this.hot.runHooks("afterRenderer",o,n,i,h,c,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ct(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,js(Ys,this,!0),this.hot.runHooks("beforeOnCellMouseDown",t,i,o,r),Ye(t)||(Ps(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,i,o),this.activeWt=this._wt)},onCellContextMenu:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,js(Ys,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,i,o),Ye(t)||(this.hot.runHooks("afterOnCellContextMenu",t,i,o),this.activeWt=this._wt)},onCellMouseOut:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",t,i,o),Ye(t)||(this.hot.runHooks("afterOnCellMouseOut",t,i,o),this.activeWt=this._wt)},onCellMouseOver:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",t,i,o,r),Ye(t)||(Bs(Ys,this)&&Ps(t,{coords:i,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,i,o),this.activeWt=this._wt)},onCellMouseUp:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",t,i,o),Ye(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,i,o),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.hot.rowIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollVertically",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.hot.columnIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n),this.hot.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,o)=>{const n=this.hot.columnIndexMapper,i=t<0;let r=t;i||(r=n.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,o);return i?s:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,o)=>{let n;const[i,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange();if(s.size()>0){const t=s.peekByIndex(null!=o?o:0);n=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",i,r,n,o)},onBeforeDrawBorders:(t,e)=>{const[o,n,i,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,o)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,r=e>=0?i.getVisualFromRenderableIndex(e):e,s=t>=0?n.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,r,o);if(Array.isArray(l)){const[t,e,o,r]=l;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o,r>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)):r]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const o=this.countRenderableRows(),n=t.startRow,i=t.endRow;if("number"==typeof e)t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1);else if("auto"===e){const e=Math.ceil(i/o*12);t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const o=this.countRenderableColumns(),n=t.startColumn,i=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)),"auto"===e){const e=Math.ceil(i/o*6);t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new Is(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:o,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(o,n),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(At(t))return!0;const e=q(t,this.hot.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}isMouseDown(){return Bs(Ys,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const o=e.firstChild;if(!tt(o,"relative"))return st(e),void this.appendRowHeader(t,e);this.updateCellHeader(o.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:o,getRowHeader:n}=this.hot,i=o.createElement("div"),r=o.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,n),i.appendChild(r),e.appendChild(i)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const i=e.firstChild;tt(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,o,n):(st(e),this.appendColHeader(t,e,o,n))}else{const{rootDocument:i}=this.hot,r=i.createElement("div"),s=i.createElement("span");r.className="relative",s.className="colHeader",this.settings.ariaTags&&(nt(r,...P()),nt(s,...P())),this.updateCellHeader(s,t,o,n),r.appendChild(s),e.appendChild(r)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(tt(t,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(e):tt(t,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(e))),i>-1?at(t,o(e,n)):(ht(t,String.fromCharCode(160)),et(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){js(Xs,this,t),js(qs,this,e)}getLastSize(){return{width:Bs(Xs,this),height:Bs(qs,this)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Bs(Us,this)}getRowHeadersCount(){return Bs($s,this)}getViewportWidth(){return this.hot.view._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this.hot.view._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this.hot.view._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this.hot.view._wt.wtViewport.getWorkspaceHeight()}destroy(){this._wt.destroy(),this.eventManager.destroy()}},el=26;function ol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;const n=[];return Array.isArray(t)&&Array.isArray(t[0])||(o=[t]),o.forEach(((t,o)=>{Array.isArray(t)?t.forEach(((t,i)=>{n.push([o+e,i,t])})):Object.keys(t).forEach((i=>{n.push([o+e,i,t[i]])}))})),n}function nl(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&be(t[0])&&(e=Ee(t[0]))),e}function il(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const rl=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];il(this,"hot",void 0),il(this,"data",void 0),il(this,"dataType","array"),il(this,"colToProp",(()=>{})),il(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return jt(this.data,((o,n)=>{const i=this.getAtCell(n,t);e.push(i)})),e}getAtRow(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===o;let r=null,s=null;if(r=this.modifyRowData(t),Array.isArray(r))s=[],i?r.forEach(((e,o)=>{s[o]=this.getAtPhysicalCell(t,o,r)})):Qo(e,o,(o=>{s[o-e]=this.getAtPhysicalCell(t,o,r)}));else if(be(r)||ae(r))if(s=n?[]:{},!i||n){const i=0,l=this.countFirstRowKeys()-1;Qo(i,l,(a=>{const h=this.colToProp(a);if(a>=(e||i)&&a<=(o||l)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,r);n?s.push(e):Re(s,h,e)}}))}else Se(r,((e,o)=>{Re(s,o,this.getAtPhysicalCell(t,o,r))}));return s}setAtCell(t,e,o){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=Te(o);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(e)?this.data[t][e]=o:Re(this.data[t],e,o)}}getAtPhysicalCell(t,e,o){let n=null;if(o&&(n="string"==typeof e?function(t,e){const o=e.split(".");let n=t;return Se(o,(t=>{if(n=n[t],void 0===n)return n=void 0,!1})),n}(o,e):"function"==typeof e?e(o):o[e]),this.hot.hasHook("modifySourceData")){const o=Te(n);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(t,e){const o=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),o)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,r=null,s=null,l=null;null===t||null===e?(n=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return Qo(i,s,(t=>{a.push(n?this.getAtRow(t,void 0,void 0,o):this.getAtRow(t,r,l,o))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return nl(this.data)}destroy(){this.data=null,this.hot=null}},sl={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,o,n,i,r,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)ue(this._localHooks[t][a],this,e,o,n,i,r,s)}},clearLocalHooks(){return this._localHooks={},this}};Ce(sl,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const ll=sl;function al(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class hl{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;al(this,"indexedValues",[]),al(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ae(this.initValueOrFn)?Qo(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):Qo(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function cl(t,e,o){return[...t.slice(0,e),...o,...t.slice(e)]}function ul(t,e){return Wt(t,(t=>!1===e.includes(t)))}function dl(t,e){return Bt(t,(t=>t-e.filter((e=>e<t)).length))}function gl(t,e){const o=e[0],n=e.length;return Bt(t,(t=>t>=o?t+n:t))}ve(hl,ll);class fl extends hl{constructor(){super((t=>t))}insert(t,e){const o=gl(this.indexedValues,e);this.indexedValues=cl(o,t,e),super.insert(t,e)}remove(t){const e=ul(this.indexedValues,t);this.indexedValues=dl(e,t),super.remove(t)}}function pl(t,e,o,n){const i=o.length?o[0]:void 0;return[...t.slice(0,i),...o.map(((t,e)=>ae(n)?n(t,e):n)),...void 0===i?[]:t.slice(i)]}function ml(t,e){return Wt(t,((t,o)=>!1===e.includes(o)))}class wl extends hl{insert(t,e){this.indexedValues=pl(this.indexedValues,0,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=ml(this.indexedValues,t),super.remove(t)}}class vl extends wl{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Ft(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}class yl extends hl{constructor(){var t,e,o;super(...arguments),t=this,o=[],e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e="orderOfIndexes"),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(o,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=ul(this.orderOfIndexes,[t]),ae(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=pl(this.indexedValues,0,e,this.initValueOrFn),this.orderOfIndexes=gl(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=ml(this.indexedValues,t),this.orderOfIndexes=ul(this.orderOfIndexes,t),this.orderOfIndexes=dl(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class bl extends wl{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Ft(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}const Cl=new Map([["hiding",vl],["index",hl],["linkedPhysicalIndexToValue",yl],["physicalIndexToValue",wl],["trimming",bl]]);let Sl=0;class Rl{constructor(){var t,e,o;t=this,e="collection",o=new Map,e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),Sl+=1)}unregister(t){const e=this.collection.get(t);Kt(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),Sl-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return Xt(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((o=>{o.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function El(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}ve(Rl,ll);class Tl extends Rl{constructor(t,e){super(),El(this,"mergedValuesCache",[]),El(this,"aggregationFunction",void 0),El(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const t=Bt(this.get(),(t=>t.getValues())),e=[],o=Kt(t[0])&&t[0].length||0;for(let n=0;n<o;n+=1){const o=[];for(let e=0;e<this.getLength();e+=1)o.push(t[e][n]);e.push(o)}return Bt(e,this.aggregationFunction)}getMergedValueAtIndex(t,e){const o=this.getMergedValues(e)[t];return Kt(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function xl(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Ml=new WeakMap;class Hl{constructor(){var t,e,o;o=[],function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=Ml),e.set(t,o)}subscribe(t){var e;return this.addLocalHook("change",t),this._write((this,(e=Ml).get(xl(e,this)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){!function(t,e,o){t.set(xl(t,e),o)}(Ml,this,t)}}function kl(t,e){const o=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&o.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)o.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)o.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return o}function Il(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Al(t,e){return t.get(Pl(t,e))}function Ol(t,e,o){return t.set(Pl(t,e),o),o}function Pl(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}ve(Hl,ll);var Nl=new WeakMap,_l=new WeakMap,Dl=new WeakMap,Ll=new WeakMap,Vl=new WeakMap;class Fl{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Il(this,Nl,new Set),Il(this,_l,[]),Il(this,Dl,[]),Il(this,Ll,!1),Il(this,Vl,!1),Ol(Vl,this,null!=t&&t)}createObserver(){const t=new Hl;return Al(Nl,this).add(t),t.addLocalHook("unsubscribe",(()=>{Al(Nl,this).delete(t)})),t._writeInitialChanges(kl(Al(_l,this),Al(Dl,this))),t}emit(t){let e=Al(Dl,this);Al(Ll,this)&&Al(_l,this).length===t.length||(0===t.length?t=new Array(e.length).fill(Al(Vl,this)):Ol(_l,this,new Array(t.length).fill(Al(Vl,this))),Al(Ll,this)||(Ol(Ll,this,!0),e=Al(_l,this)));const o=kl(e,t);Al(Nl,this).forEach((t=>t._write(o))),Ol(Dl,this,t)}}function Wl(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}new Set;class Bl{constructor(){Wl(this,"indexesSequence",new fl),Wl(this,"trimmingMapsCollection",new Tl((t=>t.some((t=>!0===t))),!1)),Wl(this,"hidingMapsCollection",new Tl((t=>t.some((t=>!0===t))),!1)),Wl(this,"variousMapsCollection",new Rl),Wl(this,"hidingChangesObservable",new Fl({initialIndexValue:!1})),Wl(this,"notTrimmedIndexesCache",[]),Wl(this,"notHiddenIndexesCache",[]),Wl(this,"isBatched",!1),Wl(this,"indexesSequenceChanged",!1),Wl(this,"indexesChangeSource",void 0),Wl(this,"trimmedIndexesChanged",!1),Wl(this,"hiddenIndexesChanged",!1),Wl(this,"renderablePhysicalIndexesCache",[]),Wl(this,"fromPhysicalToVisualIndexesCache",new Map),Wl(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,o){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Cl.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Cl.get(t))(e)}(e,o))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof bl?this.trimmingMapsCollection.register(t,e):e instanceof vl?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const o=this.getNumberOfIndexes();return o>0&&e.init(o),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return Kt(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return Kt(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return Kt(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return Kt(e)?e:null}getNearestNotHiddenIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=e>0?n.findIndex((e=>e>t)):n.reverse().findIndex((e=>e<t)),-1===i?o?this.getNearestNotHiddenIndex(t,-e,!1):null:n[i]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);const o=Bt(t,(t=>this.getPhysicalFromVisualIndex(t))),n=this.getNotTrimmedIndexesLength(),i=t.length,r=ul(this.getIndexesSequence(),o),s=r.filter((t=>!1===this.isTrimmed(t)));let l=r.indexOf(s[s.length-1])+1;if(e+i<n){const t=s[e];l=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(cl(r,l,o)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const o=this.getNotTrimmedIndexes()[t],n=Kt(o)?o:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),r=Bt(new Array(e).fill(n),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),o=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(o,e)}}}function jl(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function zl(t){Kt(t)&&Qe(Gt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}ve(Bl,ll);const{register:Ul,getValues:$l}=so("phraseFormatters");Ul("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));const Gl="ContextMenu:items",Yl=`${Gl}.noItems`,Kl=`${Gl}.insertRowAbove`,Xl=`${Gl}.insertRowBelow`,ql=`${Gl}.insertColumnOnTheLeft`,Ql=`${Gl}.insertColumnOnTheRight`,Zl=`${Gl}.removeRow`,Jl=`${Gl}.removeColumn`,ta=`${Gl}.undo`,ea=`${Gl}.redo`,oa=`${Gl}.readOnly`,na=`${Gl}.clearColumn`,ia=`${Gl}.copy`,ra=`${Gl}.copyWithHeaders`,sa=`${Gl}.copyWithGroupHeaders`,la=`${Gl}.copyHeadersOnly`,aa=`${Gl}.cut`,ha=`${Gl}.freezeColumn`,ca=`${Gl}.unfreezeColumn`,ua=`${Gl}.mergeCells`,da=`${Gl}.unmergeCells`,ga=`${Gl}.addComment`,fa=`${Gl}.editComment`,pa=`${Gl}.removeComment`,ma=`${Gl}.readOnlyComment`,wa=`${Gl}.align`,va=`${Gl}.align.left`,ya=`${Gl}.align.center`,ba=`${Gl}.align.right`,Ca=`${Gl}.align.justify`,Sa=`${Gl}.align.top`,Ra=`${Gl}.align.middle`,Ea=`${Gl}.align.bottom`,Ta=`${Gl}.borders`,xa=`${Gl}.borders.top`,Ma=`${Gl}.borders.right`,Ha=`${Gl}.borders.bottom`,ka=`${Gl}.borders.left`,Ia=`${Gl}.borders.remove`,Aa=`${Gl}.nestedHeaders.insertChildRow`,Oa=`${Gl}.nestedHeaders.detachFromParent`,Pa=`${Gl}.hideColumn`,Na=`${Gl}.showColumn`,_a=`${Gl}.hideRow`,Da=`${Gl}.showRow`,La="Filters:",Va=`${La}conditions`,Fa=`${Va}.none`,Wa=`${Va}.isEmpty`,Ba=`${Va}.isNotEmpty`,ja=`${Va}.isEqualTo`,za=`${Va}.isNotEqualTo`,Ua=`${Va}.beginsWith`,$a=`${Va}.endsWith`,Ga=`${Va}.contains`,Ya=`${Va}.doesNotContain`,Ka=`${Va}.byValue`,Xa=`${Va}.greaterThan`,qa=`${Va}.greaterThanOrEqualTo`,Qa=`${Va}.lessThan`,Za=`${Va}.lessThanOrEqualTo`,Ja=`${Va}.isBetween`,th=`${Va}.isNotBetween`,eh=`${Va}.after`,oh=`${Va}.before`,nh=`${Va}.today`,ih=`${Va}.tomorrow`,rh=`${Va}.yesterday`,sh=`${La}labels.filterByCondition`,lh=`${La}labels.filterByValue`,ah=`${La}labels.conjunction`,hh=`${La}labels.disjunction`,ch=`${La}values.blankCells`,uh=`${La}buttons.selectAll`,dh=`${La}buttons.clear`,gh=`${La}buttons.ok`,fh=`${La}buttons.cancel`,ph=`${La}buttons.placeholder.search`,mh=`${La}buttons.placeholder.value`,wh=`${La}buttons.placeholder.secondValue`,vh="CheckboxRenderer:",yh=`${vh}checked`,bh=`${vh}unchecked`,Ch={languageCode:"en-US",[Yl]:"No available options",[Kl]:"Insert row above",[Xl]:"Insert row below",[ql]:"Insert column left",[Ql]:"Insert column right",[Zl]:["Remove row","Remove rows"],[Jl]:["Remove column","Remove columns"],[ta]:"Undo",[ea]:"Redo",[oa]:"Read only",[na]:"Clear column",[wa]:"Alignment",[va]:"Left",[ya]:"Center",[ba]:"Right",[Ca]:"Justify",[Sa]:"Top",[Ra]:"Middle",[Ea]:"Bottom",[ha]:"Freeze column",[ca]:"Unfreeze column",[Ta]:"Borders",[xa]:"Top",[Ma]:"Right",[Ha]:"Bottom",[ka]:"Left",[Ia]:"Remove border(s)",[ga]:"Add comment",[fa]:"Edit comment",[pa]:"Delete comment",[ma]:"Read-only comment",[ua]:"Merge cells",[da]:"Unmerge cells",[ia]:"Copy",[ra]:["Copy with header","Copy with headers"],[sa]:["Copy with group header","Copy with group headers"],[la]:["Copy header only","Copy headers only"],[aa]:"Cut",[Aa]:"Insert child row",[Oa]:"Detach from parent",[Pa]:["Hide column","Hide columns"],[Na]:["Show column","Show columns"],[_a]:["Hide row","Hide rows"],[Da]:["Show row","Show rows"],[Fa]:"None",[Wa]:"Is empty",[Ba]:"Is not empty",[ja]:"Is equal to",[za]:"Is not equal to",[Ua]:"Begins with",[$a]:"Ends with",[Ga]:"Contains",[Ya]:"Does not contain",[Xa]:"Greater than",[qa]:"Greater than or equal to",[Qa]:"Less than",[Za]:"Less than or equal to",[Ja]:"Is between",[th]:"Is not between",[eh]:"After",[oh]:"Before",[nh]:"Today",[ih]:"Tomorrow",[rh]:"Yesterday",[ch]:"Blank cells",[sh]:"Filter by condition",[lh]:"Filter by value",[ah]:"And",[hh]:"Or",[uh]:"Select all",[dh]:"Clear",[gh]:"OK",[fh]:"Cancel",[ph]:"Search",[mh]:"Value",[wh]:"Second value",[yh]:"Checked",[bh]:"Unchecked"},Sh=n,Rh=Ch.languageCode,{register:Eh,getItem:Th,hasItem:xh,getValues:Mh}=so("languagesDictionaries");function Hh(t,e){let o=t,n=e;return be(t)&&(n=t,o=n.languageCode),function(t,e){var o;t!==Rh&&(o=e,Se(Th(Rh),((t,e)=>{Xt(o[e])&&(o[e]=t)})))}(o,n),Eh(o,me(n)),me(n)}function kh(t){return Ih(t)?me(Th(t)):null}function Ih(t){return xh(t)}function Ah(t,e,o){const n=kh(t);if(null===n)return null;const i=n[e];if(Xt(i))return null;const r=function(t,e){let o=t;return jt($l(),(n=>{o=n(t,e)})),o}(i,o);return Array.isArray(r)?r[0]:r}Hh(Ch);const Oh="active-header",Ph="header",Nh="area",_h="focus";class Dh{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}ve(Dh,ll);const Lh=Dh;const Vh=class extends Lh{constructor(t,e){var o,n,i;super(t,null),o=this,i=null,n=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(n="visualCellRange"),n in o?Object.defineProperty(o,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[n]=i,this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:o}=t,n=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(o,-1);return null===n||null===i?null:((n.row>i.row||n.col>i.col)&&(n=e,i=o),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===n)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,o);return null===i?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(t,e,o){return e<0?e:t.getNearestNotHiddenIndex(e,o)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),o="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==i&&null!==i.col&&null!==i.row||(r=this.getNearestNotHiddenCoords(e,o,n)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const o=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return null===o.row||null===o.col||null===n.row||null===n.col?null:this.settings.createCellRange(o,o,n)}};function Fh(t){let{activeHeaderClassName:e,...o}=t;return new Vh({className:e,...o,selectionType:Oh})}function Wh(t){let{areaCornerVisible:e,...o}=t;return new Vh({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...o,selectionType:Nh})}function Bh(t){let{...e}=t;return new Vh({className:"highlight",...e,selectionType:Nh})}function jh(t){let{columnClassName:e,...o}=t;return new Vh({className:e,...o,selectionType:"column"})}function zh(t){let{headerClassName:e,...o}=t;return new Vh({className:e,...o,selectionType:Ph})}function Uh(t){let{rowClassName:e,...o}=t;return new Vh({className:e,...o,selectionType:"row"})}function $h(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Gh(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Yh=new WeakSet;class Kh{constructor(t){var e,o;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e=this,o=Yh),o.add(e),$h(this,"options",void 0),$h(this,"layerLevel",0),$h(this,"focus",void 0),$h(this,"fill",void 0),$h(this,"layeredAreas",new Map),$h(this,"areas",new Map),$h(this,"rowHeaders",new Map),$h(this,"columnHeaders",new Map),$h(this,"activeRowHeaders",new Map),$h(this,"activeColumnHeaders",new Map),$h(this,"activeCornerHeaders",new Map),$h(this,"rowHighlights",new Map),$h(this,"columnHighlights",new Map),$h(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...o}=t;return new Vh({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:e},...o,selectionType:_h})}(t),this.fill=function(t){let{...e}=t;return new Vh({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:"fill"})}(t)}isEnabledFor(t,e){let o=t;t===_h&&(o="current");let n=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Gh(Yh,this,Xh).call(this,this.layeredAreas,Wh)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Gh(Yh,this,Xh).call(this,this.areas,Bh)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Gh(Yh,this,Xh).call(this,this.rowHeaders,zh)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Gh(Yh,this,Xh).call(this,this.columnHeaders,zh)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Gh(Yh,this,Xh).call(this,this.activeRowHeaders,Fh)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Gh(Yh,this,Xh).call(this,this.activeColumnHeaders,Fh)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Gh(Yh,this,Xh).call(this,this.activeCornerHeaders,Fh)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Gh(Yh,this,Xh).call(this,this.rowHighlights,Uh)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Gh(Yh,this,Xh).call(this,this.columnHighlights,jh)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:o,...n}=t;return new Vh({...e,...n,selectionType:"custom-selection"},o)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),jt(this.areas.values(),(t=>{t.clear()})),jt(this.layeredAreas.values(),(t=>{t.clear()})),jt(this.rowHeaders.values(),(t=>{t.clear()})),jt(this.columnHeaders.values(),(t=>{t.clear()})),jt(this.activeRowHeaders.values(),(t=>{t.clear()})),jt(this.activeColumnHeaders.values(),(t=>{t.clear()})),jt(this.activeCornerHeaders.values(),(t=>{t.clear()})),jt(this.rowHighlights.values(),(t=>{t.clear()})),jt(this.columnHighlights.values(),(t=>{t.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Xh(t,e){const o=this.layerLevel;if(t.has(o))return t.get(o);const n=e({layerLevel:o,...this.options});return t.set(o,n),n}const qh=Kh;function Qh(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Zh{constructor(t){Qh(this,"ranges",[]),Qh(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const Jh=Zh;function tc(t,e,o){ec(t,e),e.set(t,o)}function ec(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(t,e){return t.get(ic(t,e))}function nc(t,e,o){return t.set(ic(t,e),o),o}function ic(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var rc=new WeakMap,sc=new WeakMap,lc=new WeakMap,ac=new WeakSet;class hc{constructor(t,e){var o;ec(this,o=ac),o.add(this),tc(this,rc,void 0),tc(this,sc,void 0),tc(this,lc,{x:0,y:0}),nc(rc,this,t),nc(sc,this,e)}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=oc(sc,this).createCellCoords(t,e);let i=oc(rc,this).current().highlight;const r=oc(sc,this).visualToRenderableCoords(i);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",n),null!==r.row&&null!==r.col){const{width:t,height:e}=ic(ac,this,uc).call(this),{row:r,col:a}=ic(ac,this,fc).call(this,i),h=oc(sc,this).fixedRowsBottom(),c=oc(sc,this).minSpareRows(),u=oc(sc,this).minSpareCols(),d=oc(sc,this).autoWrapRow(),g=oc(sc,this).autoWrapCol(),f=oc(sc,this).createCellCoords(r+n.row,a+n.col);if(f.row>=e){const n=Te(o&&c>0&&0===h),i=f.col+1,r=oc(sc,this).createCellCoords(f.row-e,i>=t?i-t:i);this.runLocalHooks("beforeColumnWrap",n,ic(ac,this,pc).call(this,r),i>=t),n.value?this.runLocalHooks("insertRowRequire",oc(sc,this).countRenderableRows()):g&&f.assign(r)}else if(f.row<0){const o=Te(g),n=f.col-1,i=oc(sc,this).createCellCoords(e+f.row,n<0?t+n:n);this.runLocalHooks("beforeColumnWrap",o,ic(ac,this,pc).call(this,i),n<0),g&&f.assign(i)}if(f.col>=t){const n=Te(o&&u>0),i=f.row+1,r=oc(sc,this).createCellCoords(i>=e?i-e:i,f.col-t);this.runLocalHooks("beforeRowWrap",n,ic(ac,this,pc).call(this,r),i>=e),n.value?this.runLocalHooks("insertColRequire",oc(sc,this).countRenderableColumns()):d&&f.assign(r)}else if(f.col<0){const o=Te(d),n=f.row-1,i=oc(sc,this).createCellCoords(n<0?e+n:n,t+f.col);this.runLocalHooks("beforeRowWrap",o,ic(ac,this,pc).call(this,i),n<0),d&&f.assign(i)}const{rowDir:p,colDir:m}=ic(ac,this,cc).call(this,f);s=p,l=m,i=ic(ac,this,pc).call(this,f)}return this.runLocalHooks("afterTransformStart",i,s,l),i}transformEnd(t,e){const o=oc(sc,this).createCellCoords(t,e),n=oc(rc,this).current(),i=oc(sc,this).visualToRenderableCoords(n.highlight),r=ic(ac,this,dc).call(this,n.to.row,n.from.row),s=ic(ac,this,gc).call(this,n.to.col,n.from.col),l=n.to.clone();let a=0,h=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==i.row&&null!==i.col&&null!==r&&null!==s){const{row:t,col:e}=ic(ac,this,fc).call(this,n.highlight),i=oc(sc,this).createCellCoords(r+o.row,s+o.col),c=n.getTopStartCorner(),u=n.getTopEndCorner(),d=n.getBottomEndCorner(),g={row:i.row-t,col:i.col-e};o.col<0?s>=e&&i.col<e&&(i.col=ic(ac,this,gc).call(this,c.col,u.col)+g.col):o.col>0&&s<=e&&i.col>e&&(i.col=ic(ac,this,gc).call(this,u.col,c.col)+g.col),o.row<0?r>=t&&i.row<t&&(i.row=ic(ac,this,dc).call(this,c.row,d.row)+g.row):o.row>0&&r<=t&&i.row>t&&(i.row=ic(ac,this,dc).call(this,d.row,c.row)+g.row);const{rowDir:f,colDir:p}=ic(ac,this,cc).call(this,i);a=f,h=p;const m=ic(ac,this,pc).call(this,i);0===o.row&&0!==o.col?l.col=m.col:0!==o.row&&0===o.col?l.row=m.row:(l.row=m.row,l.col=m.col)}return this.runLocalHooks("afterTransformEnd",l,a,h),l}setOffsetSize(t){let{x:e,y:o}=t;nc(lc,this,{x:e,y:o})}}function cc(t){const{width:e,height:o}=ic(ac,this,uc).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=o&&(n=1,t.row=o-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function uc(){return{width:oc(lc,this).x+oc(sc,this).countRenderableColumns(),height:oc(lc,this).y+oc(sc,this).countRenderableRows()}}function dc(t,e){const o=oc(sc,this).findFirstNonHiddenRenderableRow(t,e);return null===o?null:oc(lc,this).y+o}function gc(t,e){const o=oc(sc,this).findFirstNonHiddenRenderableColumn(t,e);return null===o?null:oc(lc,this).x+o}function fc(t){const{row:e,col:o}=oc(sc,this).visualToRenderableCoords(t);if(null===e||null===o)throw new Error("Renderable coords are not visible.");return oc(sc,this).createCellCoords(oc(lc,this).y+e,oc(lc,this).x+o)}function pc(t){const e=t.clone();return e.col=t.col-oc(lc,this).x,e.row=t.row-oc(lc,this).y,oc(sc,this).renderableToVisualCoords(e)}ve(hc,ll);const mc=hc,wc=[3,2],vc=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],yc=Symbol("root"),bc=Symbol("child");function Cc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yc;if(e!==yc&&e!==bc)throw new Error("The second argument is used internally only and cannot be overwritten.");const o=Array.isArray(t),n=e===yc;let i=0;if(o){const e=t[0];if(0===t.length)i=1;else if(n&&e instanceof cr)i=3;else if(n&&Array.isArray(e))i=Cc(e,bc);else if(t.length>=2&&t.length<=4){!t.some(((t,e)=>!vc[e].includes(typeof t)))&&(i=2)}}return i}function Sc(t){let{createCellCoords:e,createCellRange:o,keepDirection:n=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!wc.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=3===t;let l=s?r.from.row:r[0],a=s?r.from.col:r[1],h=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"==typeof i&&("string"==typeof a&&(a=i(a)),"string"==typeof c&&(c=i(c))),Xt(h)&&(h=l),Xt(c)&&(c=a),!n){const t=l,e=a,o=h,n=c;l=Math.min(t,o),a=Math.min(e,n),h=Math.max(t,o),c=Math.max(e,n)}const u=e(l,a),d=e(h,c);return o(u,u,d)}}function Rc(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Ec(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tc(t,e){return t.get(Mc(t,e))}function xc(t,e,o){return t.set(Mc(t,e),o),o}function Mc(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Hc=new WeakMap,kc=new WeakMap,Ic=new WeakMap,Ac=new WeakMap,Oc=new WeakMap,Pc=new WeakMap;class Nc{constructor(t,e){var o=this;Ec(this,"settings",void 0),Ec(this,"tableProps",void 0),Ec(this,"inProgress",!1),Ec(this,"selectedRange",new Jh(((t,e,o)=>this.tableProps.createCellRange(t,e,o)))),Ec(this,"highlight",void 0),Rc(this,Hc,void 0),Rc(this,kc,void 0),Ec(this,"selectedByRowHeader",new Set),Ec(this,"selectedByColumnHeader",new Set),Rc(this,Ic,!1),Rc(this,Ac,!1),Rc(this,Oc,"unknown"),Rc(this,Pc,-1),this.settings=t,this.tableProps=e,this.highlight=new qh({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,o)=>this.tableProps.createCellRange(t,e,o)}),xc(Hc,this,new mc(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),xc(kc,this,new mc(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return o.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return o.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Tc(Hc,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformStart",...e)})),Tc(Hc,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformStart",...e)})),Tc(Hc,this).addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformEnd",...e)})),Tc(Hc,this).addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformEnd",...e)})),Tc(Hc,this).addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertRowRequire",...e)})),Tc(Hc,this).addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertColRequire",...e)})),Tc(Hc,this).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeRowWrap",...e)})),Tc(Hc,this).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeColumnWrap",...e)})),Tc(kc,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformFocus",...e)})),Tc(kc,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformFocus",...e)}))}getSelectedRange(){return this.selectedRange}markSource(t){xc(Oc,this,t)}markEndSource(){xc(Oc,this,"unknown")}getSelectionSource(){return Tc(Oc,this)}setExpectedLayers(t){xc(Pc,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,xc(Pc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,r=Xt(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();xc(Ic,this,!1),this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),s),(!i||i&&!r&&Xt(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(t)}setRangeStartOnly(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,o)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((o>0||n>0)&&(0===o&&e.col<0&&!i||0===n&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();if(this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode)r.setFrom(r.highlight),r.setTo(r.highlight);else{const t=r.getHorizontalDirection(),o=r.getVerticalDirection(),n=this.isMultiple();r.setTo(e),n&&(t!==r.getHorizontalDirection()||1===r.getWidth()&&!r.includes(r.highlight))&&r.from.assign({col:r.highlight.col}),n&&(o!==r.getVerticalDirection()||1===r.getHeight()&&!r.includes(r.highlight))&&r.from.assign({row:r.highlight.row})}o>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight);const s=this.getLayerLevel();s<this.highlight.layerLevel&&(jt(this.highlight.getAreas(),(t=>{t.clear()})),jt(this.highlight.getLayeredAreas(),(t=>{t.clear()})),jt(this.highlight.getRowHeaders(),(t=>{t.clear()})),jt(this.highlight.getColumnHeaders(),(t=>{t.clear()})),jt(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),jt(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),jt(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),jt(this.highlight.getRowHighlights(),(t=>{t.clear()})),jt(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(s);const l=this.highlight.createArea(),a=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),d=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(l.clear(),a.clear(),h.clear(),c.clear(),u.clear(),d.clear(),g.clear(),f.clear(),p.clear(),this.highlight.isEnabledFor(Nh,r.highlight)&&(this.isMultiple()||s>=1)&&(l.add(r.from).add(r.to).commit(),a.add(r.from).add(r.to).commit(),1===s)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(s-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(s)}if(this.highlight.isEnabledFor(Ph,r.highlight)){if(!r.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),e=this.tableProps.createCellCoords(r.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),n=this.tableProps.createCellCoords(-1,r.to.col);"single"===this.settings.selectionMode?(h.add(t).commit(),c.add(o).commit(),f.add(t).commit(),p.add(o).commit()):(h.add(t).add(e).commit(),c.add(o).add(n).commit(),f.add(t).add(e).commit(),p.add(o).add(n).commit())}const t=!Tc(Ac,this)&&this.isEntireRowSelected()&&(n>0&&n===r.getWidth()||0===n&&this.isSelectedByRowHeader()),e=!Tc(Ac,this)&&this.isEntireColumnSelected()&&(o>0&&o===r.getHeight()||0===o&&this.isSelectedByColumnHeader());t&&u.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),e&&d.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),t&&e&&g.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}const m=-1===Tc(Pc,this)||this.selectedRange.size()===Tc(Pc,this);this.runLocalHooks("afterSetRangeEnd",t,m)}setRangeFocus(t){if(this.selectedRange.isEmpty())return;const e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);const o=this.highlight.getFocus();o.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(_h,e.highlight)&&o.add(e.highlight).commit().syncWith(e),this.inProgress||(xc(Ic,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders&&Tc(Hc,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeStart(Tc(Hc,this).transformStart(t,e,o))}transformEnd(t,e){this.settings.navigableHeaders&&Tc(Hc,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}),this.setRangeEnd(Tc(Hc,this).transformEnd(t,e))}transformFocus(t,e){const o=this.selectedRange.current(),{row:n,col:i}=o.getOuterTopStartCorner(),r=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,n-1);o.highlight.isHeader()?Tc(kc,this).setOffsetSize({x:i<0?Math.abs(i):-r,y:n<0?Math.abs(n):-s}):Tc(kc,this).setOffsetSize({x:i<0?0:-r,y:n<0?0:-s});const l=Tc(kc,this).transformStart(t,e);this.setRangeFocus(l.normalize())}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const t=Te(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&Tc(Ic,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(o>0&&e<0||0===o)&&t.getWidth()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(o>0&&e<0||0===o)&&t.getHeight()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=o?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===i||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=n;xc(Ac,this,d),u&&Number.isInteger(null==u?void 0:u.row)&&Number.isInteger(null==u?void 0:u.col)&&(c=this.tableProps.createCellCoords(tn(u.row,a,i-1),tn(u.col,h,r-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),xc(Ac,this,!1)}selectCells(t){var e=this;const o=Cc(t);if(1===o)return!1;if(0===o)throw new Error(Gt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=Sc(o,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),i=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=n(t),o=e.isValid(r);return!(o&&!e.containsHeaders()||o&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(t.length),jt(t,(t=>{const{from:e,to:o}=n(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(o.clone())})),this.finish()),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"==typeof t?this.tableProps.propToCol(t):t,i="string"==typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,n),c=this.tableProps.createCellCoords(r-1,i),u=this.tableProps.createCellRange(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){let t=0,e=0;Number.isInteger(null==o?void 0:o.row)&&Number.isInteger(null==o?void 0:o.col)?(t=tn(o.row,a,r-1),e=tn(o.col,Math.min(n,i),Math.max(n,i))):(t=tn(o,a,r-1),e=n);const s=this.tableProps.createCellCoords(t,e),h=0===l?0:tn(s.row,a,-1),c=r-1,u=this.tableProps.createCellCoords(h,n),d=this.tableProps.createCellCoords(c,i);this.runLocalHooks("beforeSelectColumns",u,d,s),u.row=h,d.row=c,this.setRangeStartOnly(u,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",u,d,s),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,i-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:n,countCols:i,countRowHeaders:r,countColHeaders:0});if(h){let n=0,l=0;Number.isInteger(null==o?void 0:o.row)&&Number.isInteger(null==o?void 0:o.col)?(n=tn(o.row,Math.min(t,e),Math.max(t,e)),l=tn(o.col,s,i-1)):(n=t,l=tn(o,s,i-1));const a=this.tableProps.createCellCoords(n,l),h=0===r?0:tn(a.col,s,-1),c=i-1,u=this.tableProps.createCellCoords(t,h),d=this.tableProps.createCellCoords(e,c);this.runLocalHooks("beforeSelectRows",u,d,a),u.col=h,d.col=c,this.setRangeStartOnly(u,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",u,d,a),this.finish()}return h}refresh(){if(this.highlight.getCustomSelections().forEach((t=>{t.commit()})),!this.isSelected())return;const t=this.highlight.getFocus(),e=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);const e=this.highlight.createArea(),o=this.highlight.createLayeredArea(),n=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),o.commit(),n.commit(),i.commit(),r.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(e)}}ve(Nc,ll);const _c=Nc,{register:Dc,getItem:Lc,hasItem:Vc,getNames:Fc,getValues:Wc}=so("cellTypes");function Bc(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);const{editor:o,renderer:n,validator:i}=e;o&&wo(t,o),n&&Sn(t,n),i&&Hn(t,i),Dc(t,e)}function jc(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n="string"==typeof e.type?function(t){if(!Vc(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return Lc(t)}(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Se(e,((e,o)=>{t._automaticallyAssignedMetaProps.delete(o)})),!be(n))return;o!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};Se(n,((e,n)=>{var r;(function(t,e){var o;return"CELL_TYPE"!==t&&((null===(o=e._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(t))||!xe(e,t))})(n,o)&&(i[n]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(n))})),fe(t,i)}function zc(t){return Number.isInteger(t)&&t>=0}function Uc(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function $c(t){return null==t}const Gc=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,o,n;for(e=0,o=this.countRows();e<o;e++)if(n=this.getDataAtCell(e,t),!1===qt(n))return!1;return!0},isEmptyRow(t){let e,o,n,i;for(e=0,o=this.countCols();e<o;e++)if(n=this.getDataAtCell(t,e),!1===qt(n))return"object"==typeof n&&(i=this.getCellMeta(t,e),ye(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function Yc(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Kc{constructor(t){Yc(this,"metaCtor",class{}),Yc(this,"meta",void 0),this.meta=this.metaCtor.prototype,fe(this.meta,Gc()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;fe(this.meta,t),jc(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class Xc{constructor(t){var e,o,n;e=this,n=void 0,o=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(o="meta"),o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n;const i=t.getMetaConstructor();this.meta=new i}getMeta(){return this.meta}updateMeta(t){fe(this.meta,t),jc(this.meta,t,t)}}function qc(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Qc{constructor(t){qc(this,"valueFactory",void 0),qc(this,"data",[]),qc(this,"index",[]),qc(this,"holes",new Set),this.valueFactory=t}obtain(t){Uc((()=>zc(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let o;if(e>=0)o=this.data[e],void 0===o&&(o=this.valueFactory(t),this.data[e]=o);else if(o=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=o,this.index[t]=e}else this.data.push(o),this.index[t]=this.data.length-1;return o}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Uc((()=>zc(t)||$c(t)),"Expecting an unsigned number or null/undefined argument.");const o=[],n=this.data.length;for(let t=0;t<e;t++)o.push(n+t),this.data.push(void 0);const i=$c(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...o,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Uc((()=>zc(t)||$c(t)),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice($c(t)?this.index.length-e:t,e);for(let t=0;t<o.length;t++){const e=o[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return Wt(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let e=0;e<this.data.length;e++){const o=this._getKeyByStorageIndex(e);-1!==o&&t.push([o,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){const o=t[e];return e+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function Zc(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Jc=["data","width"];class tu{constructor(t){Zc(this,"globalMeta",void 0),Zc(this,"metas",new Qc((()=>this._createMeta()))),this.globalMeta=t,this.metas=new Qc((()=>this._createMeta()))}updateMeta(t,e){const o=this.getMeta(t);fe(o,e),jc(o,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function o(){}ge(o,t);for(let t=0;t<e.length;t++)o.prototype[e[t]]=void 0;return o}(this.globalMeta.getMetaConstructor(),Jc).prototype}}function eu(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class ou{constructor(t){eu(this,"columnMeta",void 0),eu(this,"metas",new Qc((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,o){const n=this.getMeta(t,e);fe(n,o),jc(n,o)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(t,e)}getMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);return void 0===o?n:n[o]}setMeta(t,e,o,n){var i;const r=this.metas.obtain(t).obtain(e);null===(i=r._automaticallyAssignedMetaProps)||void 0===i||i.delete(o),r[o]=n}removeMeta(t,e,o){delete this.metas.obtain(t).obtain(e)[o]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let o=0;o<e.length;o++)Kt(e[o])&&t.push(...e[o].values());return t}getMetasAtRow(t){Uc((()=>zc(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Qc((t=>this._createMeta(t)))}_createMeta(t){return new(this.columnMeta.getMetaConstructor(t))}}class nu{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new Kc(t),this.tableMeta=new Xc(this.globalMeta),this.columnMeta=new tu(this.globalMeta),this.cellMeta=new ou(this.columnMeta),o.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,o){let{visualRow:n,visualColumn:i}=o;const r=this.cellMeta.getMeta(t,e);return r.visualRow=n,r.visualCol=i,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,o){if("string"!=typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,o)}setCellMeta(t,e,o,n){this.cellMeta.setMeta(t,e,o,n)}updateCellMeta(t,e,o){this.cellMeta.updateMeta(t,e,o)}removeCellMeta(t,e,o){this.cellMeta.removeMeta(t,e,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function iu(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}ve(nu,ll);class ru{constructor(t){iu(this,"metaManager",void 0),iu(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),io.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:o,col:n}=t;if(null!==(e=this.metaSyncMemo.get(o))&&void 0!==e&&e.has(n))return;const{visualRow:i,visualCol:r}=t,s=this.metaManager.hot,l=s.colToProp(r);t.prop=l,s.runHooks("beforeGetCellMeta",i,r,t);const a=xe(t,"type")?t.type:null;let h=ae(t.cells)?t.cells(o,n,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a}),h&&this.metaManager.updateCellMeta(o,n,h),s.runHooks("afterGetCellMeta",i,r,t),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}}function su(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class lu{constructor(t){su(this,"metaManager",void 0),su(this,"usageTracker",new Set),su(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:o,onChange:n=(()=>{})}=t,i="string"==typeof o,r=i?o:e,s=`_${r}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(e,s,n),i&&this.installPropWatcher(o,s,n)}))}installPropWatcher(t,e,o){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const r=!n.usageTracker.has(t);n.usageTracker.add(t),o.call(n,t,i,r),this[e]=i},enumerable:!0,configurable:!0})}}const au=/^(\r\n|\n\r|\r|\n)/,hu=/^[^\t\r\n]+/,cu=/^\t/;function uu(t){let e,o,n,i,r,s="";for(e=0,o=t.length;e<o;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="\t"),r=t[e][n],"string"==typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null==r?"":r;e!==o-1&&(s+="\n")}return s}function du(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class gu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,o){du(this,"hot",void 0),du(this,"metaManager",void 0),du(this,"tableMeta",void 0),du(this,"dataSource",void 0),du(this,"duckSchema",void 0),du(this,"colToPropCache",void 0),du(this,"propToColCache",void 0),this.hot=t,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,e){let n=0,i=0,r=!1;if("function"==typeof e){const e=Ee(t);n=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;n=Math.min(t,e.length)}for(o=0;o<n;o++){const t=r?e(o):e[o];if(be(t)){if(void 0!==t.data){const e=r?i:o;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return nl(this.dataSource)}recursiveDuckColumns(t,e,o){let n,i=e,r=o;return void 0===i&&(i=0,r=""),"object"!=typeof t||Array.isArray(t)||Se(t,((t,e)=>{null===t?(n=r+e,this.colToPropCache.push(n),this.propToColCache.set(n,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Kt(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(Kt(e))return this.hot.toVisualColumn(e);const o=this.hot.toVisualColumn(t);return null===o?t:o}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?de(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let r=i,s=0,l=t;if(("number"!=typeof l||l>=i)&&(l=i),l<this.hot.countRows()&&(r=this.hot.toPhysicalRow(l)),!1===this.hot.runHooks("beforeCreateRow",l,e,o)||null===r)return{delta:0};const a=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;s<e&&i+s<a;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=me(this.getSchema()):(t=[],Qo(h-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(l+s):(t={},pe(t,this.getSchema())),c.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===n&&(r=Math.min(r+1,i)),this.spliceData(r,0,c);const u=this.hot.toVisualRow(r);return this.hot.countSourceRows()===c.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==o&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",u,s,o),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=t;if(("number"!=typeof l||l>=s)&&(l=s),!1===this.hot.runHooks("beforeCreateCol",l,e,o))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let c=this.hot.countCols(),u=0,d=a;"end"===n&&(d=Math.min(d+1,s));const g=d;for(;u<e&&c<r;){if("number"!=typeof l||l>=c)if(h>0)for(let t=0;t<h;t+=1)void 0===i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<h;t++)i[t].splice(d,0,null);u+=1,d+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,u),u>0&&(null==t?this.metaManager.createColumn(null,u):"auto"!==o&&this.metaManager.createColumn(g,e));const f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,u,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(n,e),r=this.hot.countSourceRows();if(n=(r+n)%r,!1===this.hot.runHooks("beforeRemoveRow",n,i.length,i,o))return!1;const s=i.length;if(this.filterData(n,s,i),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const t=Kt(this.tableMeta.columns)||Kt(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}const l=i.slice(0).sort(((t,e)=>e-t));return l.forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",n,s,i,o),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!=typeof t?-e:t;n=(this.hot.countCols()+n)%this.hot.countCols();const i=this.visualColumnsToPhysical(n,e),r=i.slice(0).sort(((t,e)=>e-t));if(!1===this.hot.runHooks("beforeRemoveCol",n,e,i,o))return!1;let s=!0;const l=r.length,a=this.dataSource;for(let t=0;t<l;t++)s&&i[0]!==i[t]-t&&(s=!1);if(s)for(let t=0,o=this.hot.countSourceRows();t<o;t++)a[t].splice(i[0],e),0===t&&this.metaManager.removeColumn(i[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<l;e++)a[t].splice(r[e],1),0===t&&this.metaManager.removeColumn(r[e],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,e,i,o),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,o){const n=this.hot.getDataAtCol(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Lt(l,r);let h=0;for(;h<o;)l.push(null),h+=1;return function(t){const e=t.length;let o=0;for(;o<e;)t[o]=[t[o]],o+=1}(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),i}spliceRow(t,e,o){const n=this.hot.getSourceDataAtRow(t),i=n.slice(e,e+o),r=n.slice(e+o);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Lt(l,r);let h=0;for(;h<o;)l.push(null),h+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),i}spliceData(t,e,o){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,o)){const e=[...this.dataSource.slice(0,t),...o,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,o){let n=this.hot.runHooks("filterData",t,e,o);!1===Array.isArray(n)&&(n=this.dataSource.filter(((t,e)=>-1===o.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(t,e){const o=this.hot.toPhysicalRow(t);let n=this.dataSource[o];const i=this.hot.runHooks("modifyRowData",o);n=isNaN(i)?i:n;let r=null;if(n&&n.hasOwnProperty&&xe(n,e))r=n[e];else if("string"==typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o=n;if(!o)return null;for(let e=0,n=t.length;e<n;e++)if(o=o[t[e]],void 0===o)return null;r=o}else"function"==typeof e&&(r=e(this.dataSource.slice(o,o+1)[0]));if(this.hot.hasHook("modifyData")){const t=Te(r);this.hot.runHooks("modifyData",o,this.propToCol(e),t,"get"),t.isTouched()&&(r=t.value)}return r}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,o){const n=this.hot.toPhysicalRow(t);let i=o,r=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=Te(i);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}if(r&&r.hasOwnProperty&&xe(r,e))r[e]=i;else if("string"==typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o,n=r,s=0;for(s=0,o=t.length-1;s<o;s++)void 0===n[t[s]]&&(n[t[s]]={}),n=n[t[s]];n[t[s]]=i}else"function"==typeof e?e(this.dataSource.slice(n,n+1)[0],i):r[e]=i}visualRowsToPhysical(t,e){const o=this.hot.countSourceRows(),n=[];let i,r=(o+t)%o,s=e;for(;r<o&&s;)i=this.hot.toPhysicalRow(r),n.push(i),s-=1,r+=1;return n}visualColumnsToPhysical(t,e){const o=this.hot.countCols(),n=[];let i=(o+t)%o,r=e;for(;i<o&&r;){const t=this.hot.toPhysicalColumn(i);n.push(t),r-=1,i+=1}return n}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,gu.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,o){const n=[];let i,r,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=o===gu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){s=[];const o=i>=0?this.hot.toPhysicalRow(i):i;for(r=Math.min(t.col,e.col);r<=u&&null!==o;r++)s.push(h.call(this,i,this.colToProp(r)));null!==o&&n.push(s)}return n}getText(t,e){return uu(this.getRange(t,e,gu.DESTINATION_RENDERER))}getCopyableText(t,e){return uu(this.getRange(t,e,gu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const fu=gu;function pu(t,e,o,n){const{hotInstance:i,dataMap:r,dataSource:s,internalSource:l,source:a,metaManager:h,firstRun:c}=n,u=x(l),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":ae(d.dataSchema)?i.dataType="function":i.dataType="object",r&&r.destroy(),t=i.runHooks(`before${u}`,t,c,a);const g=new fu(i,t,h);if(e(g),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let o;t=[];let n=0,r=0;for(n=0,r=d.startRows;n<r;n++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)o=me(e[0]),t.push(o);else{o=[];for(let t=0,e=d.startCols;t<e;t++)o.push(null);t.push(o)}else o=me(e),t.push(o)}}Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),o(g),i.runHooks(`after${u}`,t,c,a),c||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&nt(i.rootElement,[L(-1),V(i.countCols()+(i.view?i.countRowHeaders():0))])}const mu="gridDefault",wu="editorManager.handlingEditor";function vu(t){const e=t.rootDocument.createElement("input");return e.type="text",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&nt(e,[P(),_()]),e}function yu(t){const{rowIndexMapper:e,columnIndexMapper:o}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,r=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===r&&(r=o.getVisualFromRenderableIndex(r)),null===i||null===r?null:t._createCellCoords(i,r)}function bu(t){var e,o;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings();let s=n.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(l<0){if(!r||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=n.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(o=i.getVisualFromRenderableIndex(l))&&void 0!==o?o:l)}const Cu=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Su=t=>t.map((t=>{const e=t.toLowerCase();return Cu.has(e)?Cu.get(e):e})).sort().join("+"),Ru=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Eu=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),Tu=t=>{let{key:e,code:o}=t,n=e;return Ru.test(o)?n=o.replace(Ru,"$1"):Eu.has(o)&&(n=o),n.toLowerCase()},xu=Symbol("shortcut-context");function Mu(t){return be(t)&&t.__kindOf===xu}const Hu=["meta","alt","shift","control"],ku=function(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),Iu=[];let Au=0;const Ou=t=>{let{ownerWindow:e,handleEvent:o,beforeKeyDown:n,afterKeyDown:i}=t;const r=ln({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const l=()=>s,a=t=>r.getItem(t);let h=!1;const c=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const n=Mu(o)?o:a(o);let i=!1;if(!n.hasShortcut(e))return i;const r=n.getShortcuts(e);for(let o=0;o<r.length;o++){const{callback:n,runOnlyIf:s,preventDefault:l,stopPropagation:a,captureCtrl:u,forwardToContext:d}=r[o];if(!0===s(t)){if(h=u,i=!1===n(t,e),h=!1,l&&t.preventDefault(),a&&(Ge(t),t.stopPropagation()),i)break;d&&c(t,e,d)}}return i},u=function(t,e,o,n,i){const r=t=>Hu.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=[];return t.altKey&&o.push("alt"),e&&(t.ctrlKey||t.metaKey)?o.push("control/meta"):(t.ctrlKey&&o.push("control"),t.metaKey&&o.push("meta")),t.shiftKey&&o.push("shift"),o},l=t=>{if(!1===e(t))return;const l=o(t);if(229===t.keyCode||!1===l||Ye(t))return;const a=Tu(t);let h=[];r(a)||(h=s(t));const c=[a].concat(h);!i(t,c)&&(Be()&&h.includes("meta")||!Be()&&h.includes("control"))&&i(t,[a].concat(s(t,!0))),n(t)},a=t=>{if(t.key){const e=Tu(t);r(e)&&ku.press(e)}},h=t=>{if(t.key){const e=Tu(t);r(e)&&ku.release(e)}},c=()=>{ku.releaseAll()};return{mount:()=>{let e=t;for(Au+=1;e;)1===Au&&(e.document.documentElement.addEventListener("keydown",a),Iu.push({event:"keydown",listener:a}),e.document.documentElement.addEventListener("keyup",h),Iu.push({event:"keyup",listener:h})),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=Y(e)},unmount:()=>{let e=t;for(Au-=1;e;){if(0===Au){for(let t=0;t<Iu.length;t++){const{event:o,listener:n}=Iu[t];e.document.documentElement.removeEventListener(o,n)}Iu.length=0}e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=Y(e)}},isPressed:t=>ku.isPressed(t),releasePressedKeys:()=>ku.releaseAll()}}(e,o,n,i,c);return u.mount(),{addContext:t=>{const e=(t=>{const e=ln({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),o=function(){let{keys:t,callback:o,group:n,runOnlyIf:i=(()=>!0),captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Xt(n))throw new Error("You need to define the shortcut's group.");if(!1===ae(o))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(Gt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:o,group:n,runOnlyIf:i,captureCtrl:r,preventDefault:s,stopPropagation:l};Kt(a)&&(u.relativeToGroup=a,u.position=h),Mu(c)&&(u.forwardToContext=c),t.forEach((t=>{const o=Su(t);if(e.hasItem(o)){const t=e.getItem(o);let n=t.findIndex((t=>t.group===a));-1!==n?"before"===h?n-=1:n+=1:n=t.length,t.splice(n,0,u)}else e.addItem(o,[u])}))},n=t=>{const o=Su(t);e.removeItem(o)};return{__kindOf:xu,addShortcut:o,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{Se(e,((o,n)=>{!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])})),o(t)}))},getShortcuts:t=>{const o=Su(t),n=e.getItem(o);return Kt(n)?n.slice():[]},hasShortcut:t=>{const o=Su(t);return e.hasItem(o)},removeShortcutsByKeys:n,removeShortcutsByGroup:t=>{e.getItems().forEach((e=>{let[o,i]=e;const r=i.filter((e=>e.group!==t));0===r.length?n((t=>t.split("+"))(o)):(i.length=0,i.push(...r))}))}}})(t);return r.addItem(t,e),e},getActiveContextName:l,getContext:a,setActiveContextName:t=>{if(!r.hasItem(t))throw new Error(Gt`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t},isCtrlPressed:()=>!h&&(u.isPressed("control")||u.isPressed("meta")),releasePressedKeys:()=>u.releasePressedKeys(),destroy:()=>u.unmount()}},Pu={name:"editorFastOpen",callback(t,e){const{highlight:o}=t.getSelectedRangeLast();o.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Nu={name:"editorOpen",callback(t,e,o){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:r}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const n=t.getSettings(),i="function"==typeof n.enterMoves?n.enterMoves(e):n.enterMoves;o.includes("shift")?t.selection.transformFocus(-i.row,-i.col):t.selection.transformFocus(i.row,i.col)}else r.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Ge(e))}},_u={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(1,0)}},Du={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,-1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.min(o.row-i,t.countRows()-1);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},Lu={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Vu={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,t.getDirectionFactor())}},Fu={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(o.col,n.col,e)}},Wu={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const l=o.getNearestNotHiddenIndex(t.countRows()-1,-1),a=i.clone();a.row=n.row,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},Bu={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=o.getNearestNotHiddenIndex(t.countCols()-1,-1),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(r.row,s))}}},ju={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),l=o.getNearestNotHiddenIndex(s,1),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},zu={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const l=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},Uu={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||s){const l=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},$u={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeLast(),s=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||s){const l=o.getNearestNotHiddenIndex(0,1),a=i.clone();a.row=n.row,e.setRangeStart(a,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},Gu={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(o.row,n.row,e)}},Yu={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(-1,0)}},Ku={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),r=Math.max(o.row-i,0);t.selection.setRangeEnd(o),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},Xu={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},qu={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+o;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Qu={name:"moveCellSelectionInlineEnd",callback(t,e){const o=t.getSettings(),n=t.getSelectedRangeLast(),i="function"==typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},Zu={name:"moveCellSelectionInlineStart",callback(t,e){const o=t.getSettings(),n=t.getSelectedRangeLast(),i="function"==typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},Ju={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===o&&(o=-1),t.selection.setRangeStart(t._createCellCoords(o,e))}},td={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),r=o.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},ed={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},od={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,r=o.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,r))}},nd={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,n=t.getSelectedRangeLast().highlight.row;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},id={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},rd={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===o&&(o=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(o,e))}},sd={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=o.getNearestNotHiddenIndex(i,1),l=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,l))}},ld={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},ad={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+o);n===-o?i=-1:n+i<o&&(i=-(n+o)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},hd={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),o=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,r=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(o,n),l=t._createCellCoords(i,r);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){const o={};if(e.col>=0){const n=Math.floor(t.countVisibleCols()/2);o.col=Math.max(e.col-n,0)}if(e.row>=0){const n=Math.floor(t.countVisibleRows()/2);o.row=Math.max(e.row-n,0)}t.scrollViewportTo({...o,verticalSnap:"top",horizontalSnap:"start"})}}},cd={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:o,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(o,n),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==o||s!==n)){const{readOnly:o}=t.getCellMeta(e,s);o||r.set(`${e}x${s}`,[e,s,i])}}));t.setDataAtCell(Array.from(r.values()))}},ud=[{name:"editorCloseAndSave",callback(t,e){const o=t._getEditorManager();o.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),o.moveSelectionAfterEnter(e)}},{name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Pu,Nu,_u,Du,Lu,Vu,Fu,Wu,Bu,ju,zu,Uu,$u,Gu,Yu,Ku,Xu,qu,Qu,Zu,{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},Ju,td,ed,od,nd,id,rd,sd,ld,ad,{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},hd,{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},cd];function dd(t){const e={};return ud.forEach((o=>{let{name:n,callback:i}=o;e[n]=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return i(t,...o)}})),e}function gd(t){const e=t.getShortcutManager().addContext("editor"),o=dd(t),n={group:wu};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>o.editorCloseWithoutSaving()}],n)}function fd(t){const e=t.getShortcutManager().addContext("grid"),o=dd(t),n={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return Kt(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:mu};e.addShortcuts([{keys:[["F2"]],callback:t=>o.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>o.emptySelectedCells()}],{group:wu,runOnlyIf:()=>Kt(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>o.selectAllCells(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>t.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>o.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>o.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>o.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>o.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>o.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>o.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>o.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>o.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>o.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>o.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>o.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>o.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>o.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>o.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>o.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>o.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>o.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>o.scrollToFocusedCell()}],n)}let pd=null;const md=new Map;function wd(t,e){var o,n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;const s=new yo(r);let l,a,h,c,u,d,g=!0;Ds(i)&&(this,Ns.set(this,!0)),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(o=null==e?void 0:e.layoutDirection)&&void 0!==o?o:"inherit",p=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return"rtl"===p},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=function(t){let e=jl(t);return Ih(e)||(e=Rh,zl(t)),e}(e.language);const m=new nu(r,e,[ru,lu]),w=m.getTableMeta(),v=m.getGlobalMeta(),y=ln();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Ls(this)&&function(t,e){const o=!qt(t),n="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="14.3.0";let r,s="invalid",l="invalid";const a=function(t){let e=[][Qt],o=e;if(t[Qt]!==ee("Z"))return!1;for(let e="",n="B<H4P+".split(""),i=ee(n.shift());i;i=ee(n.shift()||"A"))--i<""[Qt]?o|=(Jt(`${Jt(Zt(e)+(Zt(te(t,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=te(t,i,i?1===n[Qt]?9:8:6);return o===e}(t=oe(t||""));if(o||n||a)if(a){const e=Dt("16/04/2024","DD/MM/YYYY"),o=Math.floor(e.toDate().getTime()/864e5),n=ne(t);r=Dt(864e5*(n+1),"x").format("MMMM DD, YYYY"),o>n?(s="expired",l="expired"):(s="valid",l="valid")}else n?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";if(ie()&&(s="valid",l="valid"),re||"valid"===s||(se[s]({keyValidityDate:r,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](se[s]({keyValidityDate:r,hotVersion:i})),re=!0),"valid"!==l&&e.parentNode&&le[l]({keyValidityDate:r,hotVersion:i})){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=le[l]({keyValidityDate:r,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}(e.licenseKey,t),this.guid=`ht_${M()}`,md.set(this.guid,this),this.columnIndexMapper=new Bl,this.rowIndexMapper=new Bl,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterRowSequenceChange",t)})),a=new rl(r),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let b=new _c(w,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:t=>l.propToCol(t),isEditorOpened:()=>!!r.getActiveEditor()&&r.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(t,e)=>r._createCellCoords(t,e),createCellRange:(t,e,o)=>r._createCellRange(t,e,o),visualToRenderableCoords:t=>{const{row:e,col:o}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getRenderableFromVisualIndex(e):e,o>=0?r.columnIndexMapper.getRenderableFromVisualIndex(o):o)},renderableToVisualCoords:t=>{const{row:e,col:o}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getVisualFromRenderableIndex(e):e,o>=0?r.columnIndexMapper.getVisualFromRenderableIndex(o):o)},findFirstNonHiddenRenderableRow:(t,e)=>{const o=e>t?1:-1,n=Math.min(t,e),i=Math.max(t,e),s=r.rowIndexMapper.getNearestNotHiddenIndex(t,o);return null===s||1===o&&s>i||-1===o&&s<n?null:s>=0?r.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(t,e)=>{const o=e>t?1:-1,n=Math.min(t,e),i=Math.max(t,e),s=r.columnIndexMapper.getNearestNotHiddenIndex(t,o);return null===s||1===o&&s>i||-1===o&&s<n?null:s>=0?r.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(t,e)=>t<0||e<0?r.getSettings().disableVisualSelection:r.getCellMeta(t,e).disableVisualSelection});this.selection=b;const C=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function S(t){const e=jl(t);Ih(e)?(r.runHooks("beforeLanguageChange",e),v.language=e,r.runHooks("afterLanguageChange",e)):zl(t)}function R(t,e){const o="className"===t?r.rootElement:r.table;if(g)et(o,e);else{let n=[],i=[];v[t]&&(n=Array.isArray(v[t])?v[t]:$t(v[t])),e&&(i=Array.isArray(e)?e:$t(e));const r=Ut(n,i),s=Ut(i,n);r.length&&ot(o,r),s.length&&et(o,s)}v[t]=e}function E(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function T(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function H(t,e,o){if(!t.length)return;const n=r.getActiveEditor(),i=new E;let s=!0;i.onQueueEmpty=t=>{n&&s&&n.cancelChanges(),o(t)};for(let o=t.length-1;o>=0;o--){const[n,a,,h]=t[o],c=l.propToCol(a),u=r.getCellMeta(n,c);"numeric"===u.type&&"string"==typeof h&&qo(h,[","])&&(t[o][3]=T(h)),r.getCellValidator(u)&&(i.addValidatorToQueue(),r.validateCell(t[o][3],u,function(e,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){s=!1,t.splice(e,1),o.valid=!0;const n=r.getCell(o.visualRow,o.visualCol);null!==n&&ot(n,w.invalidCellClassName)}i.removeValidatorFormQueue()}}(o,u),e))}i.checkIfQueueIsEmpty()}function k(t,e){let o=t.length-1;if(o<0)return;for(;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(w.allowInsertRow)for(;t[o][0]>r.countRows()-1;){const{delta:t}=l.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===r.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)for(;l.propToCol(t[o][1])>r.countCols()-1;){const{delta:t}=l.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||l.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}r.forceFullRender=!0,h.adjustRowsAndCols(),r.runHooks("beforeChangeRender",t,e),c.lockEditor(),r._refreshBorders(null),c.unlockEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",t,e||"edit");const n=r.getActiveEditor();n&&Kt(n.refreshValue)&&n.refreshValue()}function I(t,e,o){return Array.isArray(t)?t:[[t,e,o]]}function A(t,e){const o=r.getActiveEditor(),n=r.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===n||0===i.length?(o&&o.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",C),this.rowIndexMapper.addLocalHook("cacheUpdated",C),this.selection.addLocalHook("afterSetRangeEnd",((t,e)=>{const o=Te(!1),n=this.selection.getSelectedRange(),{from:i,to:s}=n.current(),l=n.size()-1;this.runHooks("afterSelection",i.row,i.col,s.row,s.col,o,l),this.runHooks("afterSelectionByProp",i.row,r.colToProp(i.col),s.row,r.colToProp(s.col),o,l),e&&(!o.isTouched()||o.isTouched()&&!o.value)&&d.scrollTo(t);const a=b.isSelectedByRowHeader(),h=b.isSelectedByColumnHeader();a&&h?et(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?(ot(this.rootElement,"ht__selection--columns"),et(this.rootElement,"ht__selection--rows")):h?(ot(this.rootElement,"ht__selection--rows"),et(this.rootElement,"ht__selection--columns")):ot(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("beforeSetFocus",(t=>{this.runHooks("beforeSelectionFocusSet",t.row,t.col)})),this.selection.addLocalHook("afterSetFocus",(t=>{const e=Te(!1);this.runHooks("afterSelectionFocusSet",t.row,t.col,e),(!e.isTouched()||e.isTouched()&&!e.value)&&d.scrollTo(t),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:o,to:n}=t[e];this.runHooks("afterSelectionEnd",o.row,o.col,n.row,n.col,e),this.runHooks("afterSelectionEndByProp",o.row,r.colToProp(o.col),n.row,r.colToProp(n.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{c.destroyEditor(),this._refreshBorders(),ot(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformFocus",...e)})).addLocalHook("afterModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformFocus",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),h={alter(t,e){var o,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const c=t=>{if(0===t.length)return[];const e=[...t];return e.sort(((t,e)=>{let[o]=t,[n]=e;return o===n?0:o>n?1:-1})),Ft(e,((t,e)=>{let[o,n]=e;const i=t[t.length-1],[r,s]=i,l=r+s;if(o<=l){const t=Math.max(n-(l-o),0);i[1]+=t}else t.push([o,n]);return t}),[e[0]])};switch(t){case"insert_row_below":case"insert_row_above":const a=r.countSourceRows();if(w.maxRows===a)return;const u="insert_row_below"===t?"below":"above";e=null!==(o=e)&&void 0!==o?o:"below"===u?a:0;const{delta:d,startPhysicalIndex:g}=l.createRow(e,i,{source:s,mode:u});if(d){const t=b.selectedRange.current(),e=null==t?void 0:t.from,o=null==e?void 0:e.row,n=r.toVisualRow(g);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Kt(o)&&o>=n){const{row:n,col:i}=t.to;let s=e.col;b.isSelectedByRowHeader()&&(s=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(r._createCellCoords(o+d,s),!0),b.setRangeEnd(r._createCellCoords(n+d,i))}else r._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(n=e)&&void 0!==n?n:"end"===f?r.countSourceCols():0;const{delta:p,startPhysicalIndex:m}=l.createCol(e,i,{source:s,mode:f});if(p){if(Array.isArray(w.colHeaders)){const t=[r.toVisualColumn(m),0];t.length+=p,Array.prototype.splice.apply(w.colHeaders,t)}const t=b.selectedRange.current(),e=null==t?void 0:t.from,o=null==e?void 0:e.col,n=r.toVisualColumn(m);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Kt(o)&&o>=n){const{row:n,col:i}=t.to;let s=e.row;b.isSelectedByColumnHeader()&&(s=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(r._createCellCoords(s,o+p),!0),b.setRangeEnd(r._createCellCoords(n,i+p))}else r._refreshBorders()}break;case"remove_row":const v=t=>{let e=0;jt(t,(t=>{let[o,n]=t;const i=qt(o)?r.countRows()-1:Math.max(o-e,0);if(Number.isInteger(o)&&(o=Math.max(o-e,0)),!l.removeRow(o,n,s))return;const a=r.countRows(),h=w.fixedRowsTop;h>=i+1&&(w.fixedRowsTop-=Math.min(n,h-i));const c=w.fixedRowsBottom;c&&i>=a-c&&(w.fixedRowsBottom-=Math.min(n,c)),e+=n}))};Array.isArray(e)?v(c(e)):v([[e,i]]),h.adjustRowsAndCols(),r._refreshBorders();break;case"remove_col":const y=t=>{let e=0;jt(t,(t=>{let[o,n]=t;const i=qt(o)?r.countCols()-1:Math.max(o-e,0);let a=r.toPhysicalColumn(i);if(Number.isInteger(o)&&(o=Math.max(o-e,0)),!l.removeCol(o,n,s))return;const h=w.fixedColumnsStart;h>=i+1&&(w.fixedColumnsStart-=Math.min(n,h-i)),Array.isArray(w.colHeaders)&&(void 0===a&&(a=-1),w.colHeaders.splice(a,n)),e+=n}))};Array.isArray(e)?y(c(e)):y([[e,i]]),h.adjustRowsAndCols(),r._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}a||h.adjustRowsAndCols()},adjustRowsAndCols(){const t=w.minRows,e=w.minSpareRows,o=w.minCols,n=w.minSpareCols;if(0===r.countRows()&&0===r.countCols()&&b.deselect(),t){const e=r.countRows();e<t&&l.createRow(e,t-e,{source:"auto"})}if(e){const t=r.countEmptyRows(!0);if(t<e){const o=e-t,n=Math.min(o,w.maxRows-r.countSourceRows());l.createRow(r.countRows(),n,{source:"auto"})}}{let t;(o||n)&&(t=r.countEmptyCols(!0));let e=r.countCols();if(o&&!w.columns&&e<o){const n=o-e;t+=n,l.createCol(e,n,{source:"auto"})}if(n&&!w.columns&&"array"===r.dataType&&t<n){e=r.countCols();const o=n-t,i=Math.min(o,w.maxCols-e);l.createCol(e,i,{source:"auto"})}}if(b.isSelected()){const t=r.countRows(),e=r.countCols();jt(b.selectedRange,(o=>{let n=!1,i=o.from.row,s=o.from.col,l=o.to.row,a=o.to.col;i>t-1?(i=t-1,n=!0,l>i&&(l=i)):l>t-1&&(l=t-1,n=!0,i>l&&(i=l)),s>e-1?(s=e-1,n=!0,a>s&&(a=s)):a>e-1&&(a=e-1,n=!0,s>a&&(s=a)),n&&(s<0?r.selectRows(i,l,s):i<0?r.selectColumns(s,a,i):r.selectCell(i,s,l,a))}))}r.view&&r.view.adjustElementsSize()},populateFromArray(t,e,o,n,i){let s,l,a,h;const c=[],u={},d=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let p=0,m=0;switch(be(o)&&(p=o.col-f+1,m=o.row-g+1),i){case"shift_down":const i=Vt(e),v=i.length,y=Math.max(v,p),b=r.getData().slice(g),C=Vt(b).slice(f,f+y);for(a=0;a<y;a+=1)if(a<v){for(s=0,l=i[a].length;s<m-l;s+=1)i[a].push(i[a][s%l]);a<C.length?d.push(i[a].concat(C[a])):d.push(i[a].concat(new Array(b.length).fill(null)))}else d.push(i[a%v].concat(C[a]));r.populateFromArray(g,f,Vt(d));break;case"shift_right":const S=e.length,R=Math.max(S,m),E=r.getData().slice(g).map((t=>t.slice(f)));for(s=0;s<R;s+=1)if(s<S){for(a=0,h=e[s].length;a<p-h;a+=1)e[s].push(e[s][a%h]);if(s<E.length)for(let t=0;t<E[s].length;t+=1)e[s].push(E[s][t]);else e[s].push(...new Array(E[0].length).fill(null))}else e.push(e[s%l].slice(0,R).concat(E[s]));r.populateFromArray(g,f,e);break;default:u.row=t.row,u.col=t.col;let T,x=0,M=0,H=!0;const k=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e[t%e.length];return null!==o?n[o%n.length]:n},I=e.length,A=o?o.row-t.row+1:0;for(l=o?A:Math.max(I,A),s=0;s<l&&!(o&&u.row>o.row&&A>I||!w.allowInsertRow&&u.row>r.countRows()-1||u.row>=w.maxRows);s++){const e=s-x,i=k(e).length,d=o?o.col-t.col+1:0;if(h=o?d:Math.max(i,d),u.col=t.col,T=r.getCellMeta(u.row,u.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!T.skipRowOnPaste){for(M=0,a=0;a<h&&!(o&&u.col>o.col&&d>i||!w.allowInsertColumn&&u.col>r.countCols()-1||u.col>=w.maxCols);a++){if(T=r.getCellMeta(u.row,u.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&T.skipColumnOnPaste){M+=1,u.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==n){u.col+=1;continue}let t=k(e,a-M),o=r.getDataAtCell(u.row,u.col);if(null!==t&&"object"==typeof t)if(Array.isArray(t)&&null===o&&(o=[]),null===o||"object"!=typeof o)H=!1;else{const e=de(Array.isArray(o)?o:o[0]||o),n=de(Array.isArray(t)?t:t[0]||t);ye(e,n)||Array.isArray(e)&&Array.isArray(n)?t=me(t):H=!1}else null!==o&&"object"==typeof o&&(H=!1);H&&c.push([u.row,u.col,t]),H=!0,u.col+=1}u.row+=1}else x+=1,u.row+=1,l+=1}r.setDataAtCell(c,null,null,n||"populateFromArray")}}},this.init=function(){var t,e;a.setData(w.data),r.runHooks("beforeInit"),(Le()||Fe())&&et(r.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new tl(this),c=Ho.getInstance(r,w,b),d=function(t){const{selection:e}=t;let o=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){o=!0},scrollTo(i){var r;if(o||n)return void(o=!1);let s;e.isFocusSelectionChanged()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):e.isSelectedByCorner()?s=()=>{}:e.isSelectedByRowHeader()?s=function(t){return e=>{let{row:o}=e;t.scrollViewportTo({row:o})}}(t):e.isSelectedByColumnHeader()?s=function(t){return e=>{let{col:o}=e;t.scrollViewportTo({col:o})}}(t):1===e.getSelectedRange().size()&&e.isMultiple()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t)):s=function(t){return e=>{const o=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if("mouse"===o&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}(t),null===(r=s)||void 0===r||r(i)}}}(r),u=new Bo(r),Ls(this)&&function(t){const e=function(t){return e=>{if(!e)return null;const o=yu(t),n=bu(t);return e.col<o.col&&(e.col=o.col),e.col>n.col&&(e.col=n.col),e.row<o.row&&(e.row=o.row),e.row>n.row&&(e.row=n.row),e}}(t);let o;const{activate:n,deactivate:i}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=t.rootElement,n=vu(t),i=vu(t);return n.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromBottom())),o.firstChild.before(n),o.lastChild.after(i),{activate(){t._registerTimeout((()=>{n.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{n.tabIndex=-1,i.tabIndex=-1}),10)}}}(t,{onFocusFromTop(){var n;const i=null!==(n=e(o))&&void 0!==n?n:yu(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_above",i),t.selectCell(i.row,i.col)),t.listen()},onFocusFromBottom(){var n;const i=null!==(n=e(o))&&void 0!==n?n:bu(t);i&&(t.runHooks("modifyFocusOnTabNavigation","from_below",i),t.selectCell(i.row,i.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,l=!1,a=!1;t.addHook("afterListen",(()=>i())),t.addHook("afterUnlisten",(()=>n())),t.addHook("afterSelection",((e,n,i,h,c)=>{var u;l&&(r.wrapped&&r.flipped||a)&&(a=!1,c.value=!0),s&&(o=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),t.addHook("beforeRowWrap",((t,e,o)=>{r.wrapped=!0,r.flipped=o}));const h={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:mu,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...h,callback:()=>{const{tabNavigation:e}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(a=!0)},position:"before"},{...h,callback:e=>{const{tabNavigation:n,autoWrapRow:i}=t.getSettings();if(l=!1,s=!0,!n||!t.selection.isSelected()||i&&r.wrapped&&r.flipped||!i&&r.wrapped)return i&&r.wrapped&&r.flipped&&(o=e.shiftKey?yu(t):bu(t)),r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten(),!1;e.preventDefault()},position:"after"}])}(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===r.rootElement.offsetParent&&(t=r.rootElement,e=()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()},new IntersectionObserver(((o,n)=>{o.forEach((o=>{o.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)),"object"==typeof g&&(r.runHooks("afterChange",g[0],g[1]),g=!1),r.runHooks("afterInit")},this._createCellCoords=function(t,e){return r.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,o){return r.view._wt.createCellRange(t,e,o)},this.validateCell=function(t,e,o,n){let i=r.getCellValidator(e);function s(t){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!0===e.hidden)return void o(t);const n=e.visualCol,i=e.visualRow,s=r.getCell(i,n,!0);if(s&&"TH"!==s.nodeName){const t=r.rowIndexMapper.getRenderableFromVisualIndex(i),e=r.columnIndexMapper.getRenderableFromVisualIndex(n);r.view._wt.getSetting("cellRenderer",t,e,s)}o(t)}var l,a;a=i,"[object RegExp]"===Object.prototype.toString.call(a)&&(l=i,i=function(t,e){e(l.test(t))}),ae(i)?(t=r.runHooks("beforeValidate",t,e.visualRow,e.prop,n),r._registerImmediate((()=>{i.call(e,t,(o=>{r&&(o=r.runHooks("afterValidate",o,t,e.visualRow,e.prop,n),e.valid=o,s(o),r.runHooks("postAfterValidate",o,t,e.visualRow,e.prop,n))}))}))):r._registerImmediate((()=>{e.valid=!0,s(e.valid,!1)}))},this.setDataAtCell=function(t,e,o,n){const i=I(t,e,o),s=[];let h,c,u,d=n;for(h=0,c=i.length;h<c;h++){if("object"!=typeof i[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof i[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=i[h][1]>=this.countCols()?i[h][1]:l.colToProp(i[h][1]),s.push([i[h][0],u,a.getAtCell(this.toPhysicalRow(i[h][0]),i[h][1]),i[h][2]])}d||"object"!=typeof t||(d=e);const g=A(s,n);r.runHooks("afterSetDataAtCell",g,d),H(g,d,(()=>{k(g,d)}))},this.setDataAtRowProp=function(t,e,o,n){const i=I(t,e,o),s=[];let l,h,c=n;for(l=0,h=i.length;l<h;l++)s.push([i[l][0],i[l][1],a.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!=typeof t||(c=e);const u=A(s,n);r.runHooks("afterSetDataAtRowProp",u,c),H(u,c,(()=>{k(u,c)}))},this.listen=function(){r&&!r.isListening()&&(md.forEach((t=>{r!==t&&t.unlisten()})),pd=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(pd=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return pd===r.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r._refreshBorders(t,e)},this.populateFromArray=function(t,e,o,n,i,s,l){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"==typeof n?r._createCellCoords(n,i):null;return h.populateFromArray(r._createCellCoords(t,e),o,a,s,l)},this.spliceCol=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return l.spliceCol(t,e,o,...i)},this.spliceRow=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];return l.spliceRow(t,e,o,...i)},this.getSelected=function(){if(b.isSelected())return Bt(b.getSelectedRange(),(t=>{let{from:e,to:o}=t;return[e.row,e.col,o.row,o.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!b.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];jt(b.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const o=t.getTopStartCorner(),n=t.getBottomEndCorner();Qo(o.row,n.row,(t=>{Qo(o.col,n.col,(o=>{this.getCellMeta(t,o).readOnly||e.push([t,o,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const o=t();return this.resumeExecution(e),o},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!r.view)return;const{width:t,height:e}=r.view.getLastSize(),{width:o,height:n}=r.rootElement.getBoundingClientRect(),i=o!==t||n!==e;!1===r.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:o,height:n},i)||((i||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(o,n),r.render()),r.runHooks("afterRefreshDimensions",{width:t,height:e},{width:o,height:n},i))},this.updateData=function(t,e){pu(t,(t=>{l=t}),(t=>{l=t,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols()}),{hotInstance:r,dataMap:l,dataSource:a,internalSource:"updateData",source:e,metaManager:m,firstRun:g})},this.loadData=function(t,e){pu(t,(t=>{l=t}),(()=>{m.clearCellsCache(),r.initIndexMappers(),h.adjustRowsAndCols(),g&&(g=[null,"loadData"])}),{hotInstance:r,dataMap:l,dataSource:a,internalSource:"loadData",source:e,metaManager:m,firstRun:g})},this.getInitialColumnCount=function(){const t=w.columns;let e=0;if(Array.isArray(t))e=t.length;else if(ae(t))if("array"===r.dataType){const o=this.countSourceCols();for(let n=0;n<o;n+=1)t(n)&&(e+=1)}else"object"!==r.dataType&&"function"!==r.dataType||(e=l.colToPropCache.length);else if(Kt(w.dataSchema)){const t=l.getSchema();e=Array.isArray(t)?t.length:Ee(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,o,n){return Xt(t)?l.getAll():l.getRange(r._createCellCoords(t,e),r._createCellCoords(o,n),l.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,o,n){return l.getCopyableText(r._createCellCoords(t,e),r._createCellCoords(o,n))},this.getCopyableData=function(t,e){return l.getCopyable(t,l.colToProp(e))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(g?r.loadData:r.updateData).bind(this);let n,i,s=!1;if(Kt(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Kt(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Kt(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in t)"data"===n||("language"===n?S(t.language):"className"===n?R("className",t.className):"tableClassName"===n&&r.table?(R("tableClassName",t.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):io.getSingleton().isRegistered(n)||io.getSingleton().isDeprecated(n)?(ae(t[n])||Array.isArray(t[n]))&&(t[n].initialHook=!0,r.addHook(n,t[n])):!e&&xe(t,n)&&(v[n]=t[n]));void 0===t.data&&void 0===w.data?o(null,"updateSettings"):void 0!==t.data?o(t.data,"updateSettings"):void 0!==t.columns&&(l.createMap(),r.initIndexMappers());const a=r.countCols(),u=w.columns;if(u&&ae(u)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||m.clearCache(),a>0)for(n=0,i=0;n<a;n++){if(u){const t=s?u(n):u[i];t&&m.updateColumnMeta(i,t)}i+=1}Kt(t.cell)&&Se(t.cell,(t=>{r.setCellMetaObject(t.row,t.col,t)})),r.runHooks("afterCellMetaReset");let d=r.rootElement.style.height;""!==d&&(d=parseInt(r.rootElement.style.height,10));let f=t.height;if(ae(f)&&(f=f()),e&&r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style")),null===f){const t=r.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",t):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else void 0!==f&&(r.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,r.rootElement.style.overflow="hidden");if(void 0!==t.width){let e=t.width;ae(e)&&(e=e()),r.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",t)),h.adjustRowsAndCols(),r.view&&!g&&(r.forceFullRender=!0,c.lockEditor(),r._refreshBorders(null),r.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),e||!r.view||""!==d&&""!==f&&void 0!==f||d===f||r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=r.getSelectedLast();if(w.getValue){if(ae(w.getValue))return w.getValue.call(r);if(t)return r.getData()[t[0][0]][w.getValue]}else if(t)return r.getDataAtCell(t[0],t[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,o,n,i){h.alter(t,e,o,n,i)},this.getCell=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===n?null:r.view.getCellAtCoords(r._createCellCoords(i,n),o)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:o,col:n}=e;let i=o,s=n;return o>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(o)),n>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(n)),r._createCellCoords(i,s)},this.colToProp=function(t){return l.colToProp(t)},this.propToCol=function(t){return l.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return l.get(t,l.colToProp(e))},this.getDataAtRowProp=function(t,e){return l.get(t,e)},this.getDataAtCol=function(t){const e=[],o=l.getRange(r._createCellCoords(0,t),r._createCellCoords(w.data.length-1,t),l.DESTINATION_RENDERER);for(let t=0;t<o.length;t+=1)for(let n=0;n<o[t].length;n+=1)e.push(o[t][n]);return e},this.getDataAtProp=function(t){const e=[],o=l.getRange(r._createCellCoords(0,l.propToCol(t)),r._createCellCoords(w.data.length-1,l.propToCol(t)),l.DESTINATION_RENDERER);for(let t=0;t<o.length;t+=1)for(let n=0;n<o[t].length;n+=1)e.push(o[t][n]);return e},this.getSourceData=function(t,e,o,n){let i;return i=void 0===t?a.getData():a.getByRange(r._createCellCoords(t,e),r._createCellCoords(o,n)),i},this.getSourceDataArray=function(t,e,o,n){let i;return i=void 0===t?a.getData(!0):a.getByRange(r._createCellCoords(t,e),r._createCellCoords(o,n),!0),i},this.getSourceDataAtCol=function(t){return a.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,o,n){const i=I(t,e,o),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&jt(i,(t=>{let[e,o,n]=t;l.push([e,o,a.getAtCell(e,o),n])})),jt(i,(t=>{let[e,o,n]=t;a.setAtCell(e,o,n)})),s&&this.runHooks("afterSetSourceDataAtCell",l,n),this.render();const h=r.getActiveEditor();h&&Kt(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(t){return a.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return a.getAtCell(t,e)},this.getDataAtRow=function(t){return l.getRange(r._createCellCoords(t,0),r._createCellCoords(t,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,o,n){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,o,n],[r,s]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=r),void 0===a&&(a=s);let u="mixed";return Qo(Math.max(Math.min(r,l),0),Math.max(r,l),(t=>{let e=!0;return Qo(Math.max(Math.min(s,a),0),Math.max(s,a),(o=>{const n=this.getCellMeta(t,o);return c=n.type,h?e=h===c:h=c,e})),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,o){const[n,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let s=m.getCellMetaKeyValue(n,i,o);!1!==r.runHooks("beforeRemoveCellMeta",t,e,o,s)&&(m.removeCellMeta(n,i,o),r.runHooks("afterRemoveCellMeta",t,e,o,s)),s=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&m.removeRow(this.toPhysicalRow(t),e),n.length>0&&jt(n.reverse(),(e=>{m.createRow(this.toPhysicalRow(t)),jt(e,((e,o)=>this.setCellMetaObject(t,o,e)))})),r.render()},this.setCellMetaObject=function(t,e,o){"object"==typeof o&&Se(o,((o,n)=>{this.setCellMeta(t,e,n,o)}))},this.setCellMeta=function(t,e,o,n){if(!1===r.runHooks("beforeSetCellMeta",t,e,o,n))return;let i=t,s=e;t<this.countRows()&&(i=this.toPhysicalRow(t)),e<this.countCols()&&(s=this.toPhysicalColumn(e)),m.setCellMeta(i,s,o,n),r.runHooks("afterSetCellMeta",t,e,o,n)},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(t,e){let o=this.toPhysicalRow(t),n=this.toPhysicalColumn(e);return null===o&&(o=t),null===n&&(n=e),m.getCellMeta(o,n,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return m.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===r.dataType||w.columns)},this.getCellRenderer=function(t,e){const o="number"==typeof t?r.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof o?Cn(o):Xt(o)?Cn("text"):o},this.getCellEditor=function(t,e){const o="number"==typeof t?r.getCellMeta(t,e).editor:t.editor;return"string"==typeof o?mo(o):Xt(o)?mo("text"):o},this.getCellValidator=function(t,e){const o="number"==typeof t?r.getCellMeta(t,e).validator:t.validator;return"string"==typeof o?function(t){if("function"==typeof t)return t;if(!Tn(t))throw Error(`No registered validator found under "${t}" name`);return En(t)}(o):o},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,o){const n=new E;t&&(n.onQueueEmpty=t);let i=r.countRows()-1;for(;i>=0;){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=r.countCols()-1;for(;t>=0;)void 0===o||-1!==o.indexOf(t)?(n.addValidatorToQueue(),r.validateCell(r.getDataAtCell(i,t),r.getCellMeta(i,t),(t=>{if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=w.rowHeaders,o=t;return void 0!==o&&(o=r.runHooks("modifyRowHeader",o)),void 0===o?(e=[],Qo(r.countRows()-1,(t=>{e.push(r.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[o]?e=e[o]:ae(e)?e=e(o):e&&"string"!=typeof e&&"number"!=typeof e&&(e=o+1),e},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let t=0,e=r.countCols();t<e;t++)if(r.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const o=r.runHooks("modifyColHeader",t);if(void 0===o){const t=[],e=r.countCols();for(let o=0;o<e;o++)t.push(r.getColHeader(o));return t}let n=w.colHeaders;const i=r.toPhysicalColumn(o),s=function(t){const e=[],o=r.countCols();let n=0;for(;n<o;n++)ae(w.columns)&&w.columns(n)&&e.push(n);return e[t]}(i);return!1===w.colHeaders?n=null:w.columns&&ae(w.columns)&&w.columns(s)&&w.columns(s).title?n=w.columns(s).title:w.columns&&w.columns[i]&&w.columns[i].title?n=w.columns[i].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[i]?n=w.colHeaders[i]:ae(w.colHeaders)?n=w.colHeaders(i):w.colHeaders&&"string"!=typeof w.colHeaders&&"number"!=typeof w.colHeaders&&(n=function(t){let e,o=t+1,n="";for(;o>0;)e=(o-1)%el,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/el,10);return n}(o)),n=r.runHooks("modifyColumnHeaderValue",n,t,e),n},this._getColWidthFromSettings=function(t){let e;if(t>=0&&(e=r.getCellMeta(0,t).width),void 0!==e&&e!==w.width||(e=w.colWidths),null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=r._getColWidthFromSettings(t);return e=r.runHooks("modifyColWidth",e,t),void 0===e&&(e=os.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=w.rowHeights;if(null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=r._getRowHeightFromSettings(t);return e=r.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const t=w.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Zo(r.countRows()-1,(o=>{if(r.isEmptyRow(o))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return Zo(r.countCols()-1,(o=>{if(r.isEmptyCol(o))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return w.isEmptyRow.call(r,t)},this.isEmptyCol=function(t){return w.isEmptyCol.call(r,t)},this.selectCell=function(t,e,o,n){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Xt(t)&&!Xt(e)&&this.selectCells([[t,e,o,n]],i,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const o=b.selectCells(t);return o&&e&&r.listen(),d.resume(),o},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return b.selectColumns(t,e,o)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return b.selectRows(t,e,o)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),b.selectAll(t,e,o)};const O=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);this.scrollViewportTo=function(t){var e,o;"number"==typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(o=arguments[4])||void 0===o||o});const{row:n,col:i,verticalSnap:s,horizontalSnap:l,considerHiddenIndexes:a}=null!==(e=t)&&void 0!==e?e:{};let h,c,u,d;void 0!==s&&(h="top"===s,c=!h),void 0!==l&&(u="start"===l,d=!u);let g=n,f=i;if(void 0===a||a){const t=Number.isInteger(n)&&n>=0,e=Number.isInteger(i)&&i>=0,o=t?O(this.rowIndexMapper,n):void 0,s=e?O(this.columnIndexMapper,i):void 0;if(null===o||null===s)return!1;g=t?r.rowIndexMapper.getRenderableFromVisualIndex(o):n,f=e?r.columnIndexMapper.getRenderableFromVisualIndex(s):i}const p=Number.isInteger(g),m=Number.isInteger(f);return p&&g>=0&&m&&f>=0?r.view.scrollViewport(r._createCellCoords(g,f),h,d,c,u):p&&g>=0&&(m&&f<0||!m)?r.view.scrollViewportVertically(g,h,c):!!(m&&f>=0&&(p&&g<0||!p))&&r.view.scrollViewportHorizontally(f,d,u)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast();this.scrollViewportTo(e.toObject())?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),m.clearCache(),md.delete(this.guid),Ls(r)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}st(r.rootElement),s.destroy(),c&&c.destroy(),r.batchExecution((()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),y.getItems().forEach((t=>{let[,e]=t;e.destroy()})),y.clear(),r.runHooks("afterDestroy")}),!0),io.getSingleton().destroy(r),Se(r,((t,e,o)=>{var n;ae(t)?o[e]=(n=e,()=>{throw new Error(`The "${n}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==e&&(o[e]=null)})),r.isDestroyed=!0,l&&l.destroy(),l=null,h=null,b=null,c=null,r=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(t){const e=x(t);return"UndoRedo"===e?this.undoRedo:y.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:y.getId(t)},this.getInstance=function(){return r},this.addHook=function(t,e){io.getSingleton().add(t,e,r)},this.hasHook=function(t){return io.getSingleton().has(t,r)||io.getSingleton().has(t)},this.addHookOnce=function(t,e){io.getSingleton().once(t,e,r)},this.removeHook=function(t,e){io.getSingleton().remove(t,e,r)},this.runHooks=function(t,e,o,n,i,s,l){return io.getSingleton().run(r,t,e,o,n,i,s,l)},this.getTranslatedPhrase=function(t,e){return Ah(w.language,t,e)},this.toHTML=()=>Ko(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Ko(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=t;"function"==typeof e&&(e=setTimeout(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){jt(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){jt(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.destroyEditor(t),r.view.render(),e&&b.isSelected()&&c.prepareEditor()},this._getEditorManager=function(){return c},this.isRtl=function(){return"rtl"===r.rootWindow.getComputedStyle(r.rootElement).direction},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const P=Ou({handleEvent:()=>r.isListening(),beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});var N;this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&P.releasePressedKeys()})),this.getShortcutManager=function(){return P},this.getFocusManager=function(){return u},gn().forEach((t=>{const e=fn(t);y.addItem(t,new e(this))})),N=r,[gd,fd].forEach((t=>t(N))),P.setActiveContextName("grid"),io.getSingleton().run(r,"construct")}new Set;const vd={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){jt(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){Se(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Ce(vd,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const yd=vd;function bd(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Cd=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Sd="baseEditor";class Rd{static get EDITOR_TYPE(){return"base"}constructor(t){bd(this,"hot",void 0),bd(this,"state",Cd.VIRGIN),bd(this,"_opened",!1),bd(this,"_fullEditMode",!1),bd(this,"_closeCallback",null),bd(this,"TD",null),bd(this,"row",null),bd(this,"col",null),bd(this,"prop",null),bd(this,"originalValue",null),bd(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,o,n,i,r){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=i,this.cellProperties=r,this.state=Cd.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let o,n,i,r;if(e){const t=this.hot.getSelectedLast();o=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[o,n,i,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(s)&&([o,n]=s);const l=this.hot.getShortcutManager().getContext("editor"),a={runOnlyIf:()=>Kt(this.hot.getSelected()),group:Sd};this.isInFullEditMode()&&l.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],a),this.hot.populateFromArray(o,n,t,i,r,"edit")}beginEditing(t,e){if(this.state!==Cd.VIRGIN)return;const o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,i)),this.state=Cd.EDITING,this.isInFullEditMode()){const e="string"==typeof t?t:Yt(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,o){let n;if(o){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),o(e),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager().getContext("editor");if(i.removeShortcutsByGroup(Sd),i.removeShortcutsByGroup(So),this.state!==Cd.VIRGIN){if(this.state===Cd.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const o=this.getValue();n=this.cellProperties.trimWhitespace?[["string"==typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=Cd.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=Cd.FINISHED,this.discardEditor(t)})):(this.state=Cd.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=Cd.FINISHED,this.discardEditor()}discardEditor(t){this.state===Cd.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Cd.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Cd.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Cd.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:o,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,r=ut(e),s=bt(e),l=ut(this.hot.rootElement),a=bt(this.hot.rootElement),h=o.topOverlay.holder,c=o.inlineStartOverlay.holder,u=h!==i?h.scrollTop:0,d=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(t=o.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,p=f.name,m=["master","inline_start"].includes(p)?u:0,w=["master","top","bottom"].includes(p)?d:0,v=r.top===l.top?0:1;let y=r.top-l.top-v-m,b=0;b=this.hot.isRtl()?i.innerWidth-r.left-s-g-1+w:r.left-l.left-1-w,["top","top_inline_start_corner"].includes(p)&&(y+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(b+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const C=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(C&&S<=0||S===E)&&(y+=1),R<=0&&(b+=1);const T=n.rowsRenderCalculator.startPosition,x=n.columnsRenderCalculator.startPosition,M=Math.abs(o.inlineStartOverlay.getScrollPosition()),H=o.topOverlay.getScrollPosition(),k=Ht(this.hot.rootDocument);let I=e.offsetTop;if(["inline_start","master"].includes(p)&&(I+=T-H),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:t,wtTable:e}=o.bottomOverlay.clone;I+=t.getWorkspaceHeight()-e.getHeight()-k}let A=e.offsetLeft;this.hot.isRtl()?(A=A>=0?f.getWidth()-e.offsetLeft:Math.abs(A),A+=x-M-s):["top","master","bottom"].includes(p)&&(A+=x-M);const O=yt(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",N=parseInt(O[P],10)>0?0:1,_=parseInt(O.borderTopWidth,10)>0?0:1,D=bt(e)+N,L=Ct(e)+_,V=(F=h).offsetWidth!==F.clientWidth?k:0;var F;const W=function(t){return t.offsetHeight!==t.clientHeight}(c)?k:0,B=this.hot.view.maximumVisibleElementWidth(A)-V+N;return{top:y,start:b,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(I)-W+_,23),width:D,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function Ed(t,e,o){t.addEventListener(e,o,!1)}function Td(t,e,o){t.removeEventListener(e,o,!1)}function xd(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Md(t,e){const o=Et(e),n=e.value.split("\n");let i=o,r=0;for(let e=0;e<n.length;e++){const s=n[e];0!==e&&(r+=n[e-1].length+1);const l=r+s.length;if("home"===t?i=r:"end"===t&&(i=l),o<=l)break}xt(e,i)}function Hd(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}ve(Rd,yd);const kd="ht_editor_hidden",Id="textEditor";class Ad extends Rd{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),Hd(this,"eventManager",new yo(this)),Hd(this,"autoResize",function(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=t.body,n=t.createTextNode(""),i=t.createElement("span");let r;function s(){n.textContent=r.value,i.style.position="absolute",i.style.fontSize=xd(r).fontSize,i.style.fontFamily=xd(r).fontFamily,i.style.whiteSpace="pre",o.appendChild(i);const t=i.clientWidth+2;o.removeChild(i);const s=r.style;s.height=`${e.minHeight}px`,e.minWidth>t?s.width=`${e.minWidth}px`:t>e.maxWidth?s.width=`${e.maxWidth}px`:s.width=`${t}px`;const l=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>l?s.height=`${e.minHeight}px`:e.maxHeight<l?(s.height=`${e.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,o){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,function(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const o=parseInt(t.minHeight,10);isNaN(o)||(e.minHeight=o)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const o=parseInt(t.maxHeight,10);isNaN(o)||(e.maxHeight=o)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const o=parseInt(t.minWidth,10);isNaN(o)||(e.minWidth=o)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const o=parseInt(t.maxWidth,10);isNaN(o)||(e.maxWidth=o)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}(o),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),a&&(Ed(r,"input",s),Ed(r,"keydown",l)),s()},resize:s,unObserve(){Td(r,"input",s),Td(r,"keydown",l)}}}(this.hot.rootDocument)),Hd(this,"TEXTAREA",void 0),Hd(this,"textareaStyle",void 0),Hd(this,"TEXTAREA_PARENT",void 0),Hd(this,"textareaParentStyle",void 0),Hd(this,"layerClass",void 0),this.eventManager=new yo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function(t,e){const o=t.closest(".handsontable");return!!o&&(o.parentNode===e||o===e)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,o,n,i,r){const s=this.state;if(super.prepare(t,e,o,n,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&(this.TEXTAREA.value=""),s!==Cd.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===Cd.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),xt(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),nt(this.TEXTAREA,[["data-hot-input",""],O(-1)]),this.hot.getSettings().ariaTags&&nt(this.TEXTAREA,[_()]),et(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),et(this.TEXTAREA_PARENT,"handsontableInputHolder"),tt(this.TEXTAREA_PARENT,this.layerClass)&&ot(this.TEXTAREA_PARENT,this.layerClass),et(this.TEXTAREA_PARENT,kd),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Oe.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ot(this.TEXTAREA_PARENT,this.layerClass),et(this.TEXTAREA_PARENT,kd)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;Qo(t.length-1,(o=>{if(tt(t[o],"handsontableEditor"))return e=!0,!1})),tt(this.TEXTAREA_PARENT,kd)&&ot(this.TEXTAREA_PARENT,kd),e?(this.layerClass="ht_editor_visible",et(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),et(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Cd.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:o,width:n,maxWidth:i,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=yt(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=yt(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),u=n-h,d=r-c,g=i-h,f=s-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(u,g),minHeight:Math.min(d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){Ve()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===Cd.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===Cd.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o=t.getContext("grid"),n={runOnlyIf:()=>Kt(this.hot.getSelected()),group:Id},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:o,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[o]=e;Md(o,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[o]=e;Md(o,this.TEXTAREA)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(So),t.removeShortcutsByGroup(Id),t.removeShortcutsByGroup(Sd)}}function Od(t,e,o,n,i,r,s){const l=s.ariaTags,a=[],h=[],c=[],u=[];s.className&&et(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(j())):l&&c.push(j()[0]),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(z())):(h.push(s.invalidCellClassName),l&&c.push(z()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!r&&s.placeholder&&a.push(s.placeholderCellClassName),ot(e,h),et(e,a),it(e,c),nt(e,u)}function Pd(t,e,o,n,i,r,s){Od.apply(this,[t,e,o,n,i,r,s]);let l=r;if(!l&&s.placeholder&&(l=s.placeholder),l=Yt(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){st(e);const n=t.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=t.getSourceDataAtRow(o),e.appendChild(n)}else ht(e,l)}Od.RENDERER_TYPE="base",Pd.RENDERER_TYPE="text";const Nd={CELL_TYPE:"text",editor:Ad,renderer:Pd};function _d(t,e){const o=new wd(t,e||{},_s);return o.init(),o}Bc(Nd),_d.editors={BaseEditor:Rd},_d.Core=function(t){return new wd(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_s)},_d.DefaultSettings=Gc(),_d.hooks=io.getSingleton(),_d.CellCoords=ir,_d.CellRange=cr,_d.packageName="handsontable",_d.buildDate="16/04/2024 10:23:22",_d.version="14.3.0",_d.languages={dictionaryKeys:Sh,getLanguageDictionary:kh,getLanguagesDictionaries:function(){return Mh()},registerLanguageDictionary:Hh,getTranslatedPhrase:Ah};const Dd=_d;function Ld(t,e,o){return e=Gd(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Vd()?Reflect.construct(e,o||[],Gd(t).constructor):e.apply(t,o))}function Vd(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Vd=function(){return!!t})()}function Fd(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function Wd(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}function Bd(t){return Bd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bd(t)}function jd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zd(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wd(n.key),n)}}function Ud(t,e,o){return e&&zd(t.prototype,e),o&&zd(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function $d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yd(t,e)}function Gd(t){return Gd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gd(t)}function Yd(t,e){return Yd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yd(t,e)}function Kd(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var Xd=null,qd="global";function Qd(t,e){var o=r.Children.toArray(t),n=r.Children.count(t),i=null;return 0!==n&&(i=1===n&&o[0].props[e]?o[0]:o.find((function(t){return void 0!==t.props[e]}))),i||null}function Zd(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function Jd(t,e){if(void 0===t||null===e)return null;var o=eg(e.props,!1);return o.className="".concat("hot-wrapper-editor-container"," ").concat(o.className),E.createPortal(r.createElement("div",Object.assign({},o),e),t.body)}function tg(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qd,n=Qd(t,"hot-editor"),i=Zd(n);return n?r.cloneElement(n,{emitEditorInstance:function(t,o){e.get(i)||e.set(i,new Map),e.get(i).set(null!=o?o:qd,t)},editorColumnScope:o,isEditor:!0}):null}function eg(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var og=function(){return Ud((function t(){jd(this,t)}),null,[{key:"getSettings",value:function(t){var e={};if(t.settings){var o=t.settings;for(var n in o)o.hasOwnProperty(n)&&(e[n]=o[n])}for(var i in t)"settings"!==i&&"children"!==i&&t.hasOwnProperty(i)&&(e[i]=t[i]);return e}}])}(),ng=function(t){function e(){return jd(this,e),Ld(this,e,arguments)}return $d(e,t),Ud(e,[{key:"getSettingsProps",value:function(){var t=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter((function(e){return!t.internalProps.includes(e)})).reduce((function(e,o){return e[o]=t.props[o],e}),{})}},{key:"getLocalEditorElement",value:function(){return tg(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var t=this.props._getChildElementByType(this.props.children,"hot-renderer"),e=this.getLocalEditorElement();this.columnSettings=og.getSettings(this.getSettingsProps()),null!==t&&(this.columnSettings.renderer=this.props._getRendererWrapper(t),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==e&&(this.columnSettings.editor=this.props._getEditorClass(e,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var t=Jd(this.props._getOwnerDocument(),this.getLocalEditorElement());return r.createElement(r.Fragment,null,t)}}])}(r.Component),ig=function(t){function e(){var t;return jd(this,e),(t=Ld(this,e,arguments)).state={portals:[]},t}return $d(e,t),Ud(e,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.state.portals)}}])}(r.Component);function rg(t,e){return t(e={exports:{}},e.exports),e.exports}var sg="function"==typeof Symbol&&Symbol.for,lg=sg?Symbol.for("react.element"):60103,ag=sg?Symbol.for("react.portal"):60106,hg=sg?Symbol.for("react.fragment"):60107,cg=sg?Symbol.for("react.strict_mode"):60108,ug=sg?Symbol.for("react.profiler"):60114,dg=sg?Symbol.for("react.provider"):60109,gg=sg?Symbol.for("react.context"):60110,fg=sg?Symbol.for("react.async_mode"):60111,pg=sg?Symbol.for("react.concurrent_mode"):60111,mg=sg?Symbol.for("react.forward_ref"):60112,wg=sg?Symbol.for("react.suspense"):60113,vg=sg?Symbol.for("react.suspense_list"):60120,yg=sg?Symbol.for("react.memo"):60115,bg=sg?Symbol.for("react.lazy"):60116,Cg=sg?Symbol.for("react.block"):60121,Sg=sg?Symbol.for("react.fundamental"):60117,Rg=sg?Symbol.for("react.responder"):60118,Eg=sg?Symbol.for("react.scope"):60119;function Tg(t){if("object"===Bd(t)&&null!==t){var e=t.$$typeof;switch(e){case lg:switch(t=t.type){case fg:case pg:case hg:case ug:case cg:case wg:return t;default:switch(t=t&&t.$$typeof){case gg:case mg:case bg:case yg:case dg:return t;default:return e}}case ag:return e}}}function xg(t){return Tg(t)===pg}var Mg={AsyncMode:fg,ConcurrentMode:pg,ContextConsumer:gg,ContextProvider:dg,Element:lg,ForwardRef:mg,Fragment:hg,Lazy:bg,Memo:yg,Portal:ag,Profiler:ug,StrictMode:cg,Suspense:wg,isAsyncMode:function(t){return xg(t)||Tg(t)===fg},isConcurrentMode:xg,isContextConsumer:function(t){return Tg(t)===gg},isContextProvider:function(t){return Tg(t)===dg},isElement:function(t){return"object"===Bd(t)&&null!==t&&t.$$typeof===lg},isForwardRef:function(t){return Tg(t)===mg},isFragment:function(t){return Tg(t)===hg},isLazy:function(t){return Tg(t)===bg},isMemo:function(t){return Tg(t)===yg},isPortal:function(t){return Tg(t)===ag},isProfiler:function(t){return Tg(t)===ug},isStrictMode:function(t){return Tg(t)===cg},isSuspense:function(t){return Tg(t)===wg},isValidElementType:function(t){return"string"==typeof t||"function"==typeof t||t===hg||t===pg||t===ug||t===cg||t===wg||t===vg||"object"===Bd(t)&&null!==t&&(t.$$typeof===bg||t.$$typeof===yg||t.$$typeof===dg||t.$$typeof===gg||t.$$typeof===mg||t.$$typeof===Sg||t.$$typeof===Rg||t.$$typeof===Eg||t.$$typeof===Cg)},typeOf:Tg},Hg=rg((function(t,e){}));Hg.AsyncMode,Hg.ConcurrentMode,Hg.ContextConsumer,Hg.ContextProvider,Hg.Element,Hg.ForwardRef,Hg.Fragment,Hg.Lazy,Hg.Memo,Hg.Portal,Hg.Profiler,Hg.StrictMode,Hg.Suspense,Hg.isAsyncMode,Hg.isConcurrentMode,Hg.isContextConsumer,Hg.isContextProvider,Hg.isElement,Hg.isForwardRef,Hg.isFragment,Hg.isLazy,Hg.isMemo,Hg.isPortal,Hg.isProfiler,Hg.isStrictMode,Hg.isSuspense,Hg.isValidElementType,Hg.typeOf,rg((function(t){t.exports=Mg}));Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},o=0;o<10;o++)e["_"+String.fromCharCode(o)]=o;var n=Object.getOwnPropertyNames(e).map((function(t){return e[t]}));if("0123456789"!==n.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}})()&&Object.assign;function kg(){}function Ig(){}Function.call.bind(Object.prototype.hasOwnProperty),Ig.resetWarningCache=kg;var Ag=rg((function(t){t.exports=function(){function t(t,e,o,n,i,r){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var o={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ig,resetWarningCache:kg};return o.PropTypes=o,o}()})),Og=function(t){function e(){var t;return jd(this,e),(t=Ld(this,e,arguments)).id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCache=new Map,t.portalContainerCache=new Map,t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return $d(e,t),Ud(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(t){this.__hotInstance=t}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!=typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(t){this.hotElementRef=t}},{key:"getRendererWrapper",value:function(t){var e=this;return function(o,n,i,s,l,a,h){var c=e.getRenderedCellCache(),u=e.getPortalContainerCache(),d="".concat(i,"-").concat(s),g=o.guid,f="".concat(g,"-").concat(d),p="".concat(d,"-").concat(g);if(c.has(d)&&(n.innerHTML=c.get(d).innerHTML),n&&!n.getAttribute("ghost-table")){for(var m=e.portalCache.get(p),w=u.get(f);n.firstChild;)n.removeChild(n.firstChild);if(m&&w)n.appendChild(w);else{var v=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;o||(o=document),Xd||(Xd=o.createDocumentFragment());var s=null!=i?i:o.createElement("DIV");Xd.appendChild(s);var l=r.cloneElement(t,function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Fd(Object(o),!0).forEach((function(e){var n,i,r;n=t,i=e,r=o[e],(i=Wd(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Fd(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:E.createPortal(l,s,n),portalContainer:s}}(t,{TD:n,row:i,col:s,prop:l,value:a,cellProperties:h,isRenderer:!0},n.ownerDocument,p,w),y=v.portal,b=v.portalContainer;u.set(f,b),n.appendChild(b),e.portalCache.set(p,y)}}return c.set(d,n),n}}},{key:"getEditorClass",value:function(t){var e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qd,n=Zd(t),i=null===(e=this.getEditorCache().get(n))||void 0===e?void 0:e.get(o);return this.makeEditorClass(i)}},{key:"makeEditorClass",value:function(t){var e=function(e){function o(e){var n;return jd(this,o),n=Ld(this,o,[e]),t.hotCustomEditorInstance=n,n.editorComponent=t,n}return $d(o,e),Ud(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Dd.editors.BaseEditor);return Object.getOwnPropertyNames(Dd.editors.BaseEditor.prototype).forEach((function(o){"constructor"!==o&&(e.prototype[o]=function(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t[o]).call.apply(e,[t].concat(i))})})),e}},{key:"getGlobalRendererElement",value:function(){return Qd(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return tg(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var t,e,o=og.getSettings(this.props),n=this.getGlobalRendererElement(),i=this.getGlobalEditorElement();return o.columns=this.columnSettings.length?this.columnSettings:o.columns,i?o.editor=this.getEditorClass(i,qd):this.props.editor||null!==(t=this.props.settings)&&void 0!==t&&t.editor?o.editor=this.props.editor||this.props.settings.editor:o.editor=mo("text"),n?(o.renderer=this.getRendererWrapper(n),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(e=this.props.settings)&&void 0!==e&&e.renderer?o.renderer=this.props.renderer||this.props.settings.renderer:o.renderer=Cn("text"),o}},{key:"displayAutoSizeWarning",value:function(t){var e,o;this.hotInstance&&(null!==(e=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||null!==(o=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==o&&o.enabled)&&this.componentRendererColumns.size>0&&function(){var t;"undefined"!=typeof console&&(t=console).warn.apply(t,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(t,e){this.columnSettings[e]=t}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var t;this.renderersPortalManager.setState({portals:(t=this.portalCache.values(),function(t){if(Array.isArray(t))return Kd(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Kd(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Kd(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})}},{key:"updateHot",value:function(t){this.hotInstance&&this.hotInstance.updateSettings(t,!1)}},{key:"setRenderersPortalManagerRef",value:function(t){this.renderersPortalManager=t}},{key:"componentDidMount",value:function(){var t=this,e=this.createNewGlobalSettings();this.hotInstance=new Dd.Core(this.hotElementRef,e),this.hotInstance.addHook("beforeViewRender",(function(){return t.handsontableBeforeViewRender()})),this.hotInstance.addHook("afterViewRender",(function(){return t.handsontableAfterViewRender()})),this.hotInstance.init(),this.displayAutoSizeWarning(e)}},{key:"componentDidUpdate",value:function(){this.clearCache();var t=this.createNewGlobalSettings();this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var t=this,e=r.Children.toArray(this.props.children).filter((function(t){return function(t){return t.type===ng}(t)})).map((function(e,o){return r.cloneElement(e,{_componentRendererColumns:t.componentRendererColumns,_emitColumnSettings:t.setHotColumnSettings.bind(t),_columnIndex:o,_getChildElementByType:Qd.bind(t),_getRendererWrapper:t.getRendererWrapper.bind(t),_getEditorClass:t.getEditorClass.bind(t),_getOwnerDocument:t.getOwnerDocument.bind(t),_getEditorCache:t.getEditorCache.bind(t),children:e.props.children})})),o=eg(this.props),n=Jd(this.getOwnerDocument(),this.getGlobalEditorElement());return r.createElement(r.Fragment,null,r.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),e),r.createElement(ig,{ref:this.setRenderersPortalManagerRef.bind(this)}),n)}}],[{key:"version",get:function(){return"14.3.0"}}])}(r.Component);Og.propTypes={style:Ag.object,id:Ag.string,className:Ag.string};var Pg=["children"],Ng=r.forwardRef((function(t,e){var o,n=t.children,i=function(t,e){if(null==t)return{};var o,n,i=function(t,e){if(null==t)return{};var o,n,i={},r=Object.keys(t);for(n=0;n<r.length;n++)o=r[n],e.indexOf(o)>=0||(i[o]=t[o]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)o=r[n],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(i[o]=t[o])}return i}(t,Pg),s="function"==typeof r.useId?r.useId():void 0,l=null!==(o=i.id)&&void 0!==o?o:s;return r.createElement(Og,Object.assign({id:l},i,{ref:e}),n)}));Ng.version=Og.version,r.Component;const _g="handsontableEditor";class Dg extends Ad{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),xt(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const o=this.getSourceData(e.row,e.col);void 0!==o&&s.setValue(o),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&fe(l,r.handsontable),this.htOptions=l}beginEditing(t,e){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,o)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const e={group:_g,relativeToGroup:So,position:"before"},o=(t,e)=>{const o=this.htEditor;if(void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length))return e.preventDefault(),Ge(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let n,i;return!e.getSelectedLast()&&e.flipped?n=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],n=Math.max(0,i-1)):(i=e.getSelectedLast()[0],n=i-1)),o(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let n,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)n=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],n=Math.min(t,i+1)}}else n=0;return o(n,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_g)}}function Lg(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vg(t,e){return t.get(function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(t,e))}var Fg=new WeakMap;class Wg extends Dg{constructor(){var t,e,o;super(...arguments),Lg(this,"query",null),Lg(this,"strippedChoices",[]),Lg(this,"rawChoices",[]),t=this,e=Fg,o=this.hot.guid.slice(0,9),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o),Lg(this,"sortByRelevance",(function(t,e,o){const n=[],i=[],r=t.length;let s,l,a,h,c=e.length;if(0===r){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=I(Yt(e[a])),o)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=l.length-h-r,n.push({baseIndex:a,index:h,charsLeft:s,value:l}))}for(n.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=n.length;a<c;a++)i.push(n[a].baseIndex);return i}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const t=this.rawChoices.find((t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value));return Kt(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),et(this.htContainer,"autocompleteEditor"),et(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&nt(this.TEXTAREA,[["type","text"],["role","combobox"],D("listbox"),["aria-autocomplete","list"]])}prepare(t,e,o,n,i,r){var s;super.prepare(t,e,o,n,i,r),this.hot.getSettings().ariaTags&&nt(this.TEXTAREA,[B("false"),(s=`${Vg(Fg,this)}-listbox-${t}-${e}`,["aria-controls",s])])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=null==o?void 0:o.length,{row:i,col:r}=this;this.showEditableElement(),this.focus();let s=Ht();0===s&&Be()&&(s+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[bt(this.TEXTAREA)-2]:void 0,width:t?bt(this.TEXTAREA)+s:void 0,autoColumnSize:!0,renderer:(t,i,r,s,l,a,h)=>{Pd(t,i,r,s,l,a,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,p,m=Yt(a);var w;m&&!u&&(f=!0===c?m.indexOf(g):m.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(p=m.substr(f,g.length),m=m.replace(p,`<strong>${p}</strong>`))),e&&nt(i,[["role","option"],...o?[(w=n,["aria-setsize",w])]:[],...o?[$(o.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),i.innerHTML=m},afterSelectionEnd:(t,o)=>{if(e){const e=this.htEditor.getCell(t,o,!0);nt(e,[["aria-selected","true"]]),nt(this.TEXTAREA,...(n=e.id,["aria-activedescendant",n]))}var n}}),e&&(nt(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...P()),nt(this.htEditor.rootElement,[["role","listbox"],("polite",["aria-live","polite"]),U("text"),["id",`${Vg(Fg,this)}-listbox-${i}-${r}`]]),nt(this.TEXTAREA,...B("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&nt(this.TEXTAREA,[B("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=Et(this.TEXTAREA),o=(n=this.TEXTAREA).selectionEnd?n.selectionEnd:0;var n;const i=this.cellProperties.sortByRelevance,r=this.cellProperties.filter;let s=null,l=null,a=t;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(s)?s.length:0;if(!1===r)h&&(l=s[0]);else{const t=[];for(let e=0,o=a.length;e<o&&!(i&&h<=e);e++)h?t.push(a[s[e]]):t.push(a[e]);l=0,a=t}this.strippedChoices=a,this.htEditor.loadData(Vt([a])),0===a.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(l)),this.hot.listen(),xt(this.TEXTAREA,e,e===o?void 0:o)}flipDropdownIfNeeded(){const t=wt(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(e||!e&&(o||"horizontal"===o))return!1;const n=ut(this.TEXTAREA),i=Ct(this.TEXTAREA),r=this.getDropdownHeight(),s=t.scrollTop,l=Ct(this.hot.view._wt.wtTable.THEAD),a=ut(t),h=n.top-a.top-l+s,c=t.scrollHeight-h-l-i,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let o=0,n=0,i=0,r=null;do{i=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=i,n+=1}while(o<t);r=o-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(o-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+Ht(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,o=Bt(t,(t=>Yt(t)));return Bt(o,(t=>e?t:I(t)))}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),o=e?e.from.row:-1;let n=!1;return t===je.ARROW_DOWN&&o>0&&o<this.htEditor.countRows()-1&&(n=!0),t===je.ARROW_UP&&o>-1&&(n=!0),n}onBeforeKeyDown(t){if(32===(e=t.keyCode)||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90||t.keyCode===je.BACKSPACE||t.keyCode===je.DELETE||t.keyCode===je.INSERT){let e=10;if(t.keyCode===je.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}var e}}class Bg extends Rd{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){const t=this.TD.querySelector('input[type="checkbox"]');tt(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const jg=()=>window,zg=()=>window.document,Ug=(t,e)=>window.setTimeout(t,e),$g=function(t,e,o,n){t.addEventListener(e,o,!!n)},Gg=function(t,e,o,n){t.removeEventListener(e,o,!!n)},Yg=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},Kg=function(t,e){Yg(t,e)||(t.className=""===t.className?e:t.className+" "+e)},Xg=function(t,e){var o;t.className=(o=(" "+t.className+" ").replace(" "+e+" "," ")).trim?o.trim():o.replace(/^\s+|\s+$/g,"")},qg=function(t){return/Array/.test(Object.prototype.toString.call(t))},Qg=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Zg=function(t){let e=t.getDay();return 0===e||6===e},Jg=function(t){return t%4==0&&t%100!=0||t%400==0},tf=function(t,e){return[31,Jg(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},ef=function(t){Qg(t)&&t.setHours(0,0,0,0)},of=function(t,e){return t.getTime()===e.getTime()},nf=function(t,e,o){let n,i;for(n in e)i=void 0!==t[n],i&&"object"==typeof e[n]&&null!==e[n]&&void 0===e[n].nodeName?Qg(e[n])?o&&(t[n]=new Date(e[n].getTime())):qg(e[n])?o&&(t[n]=e[n].slice(0)):t[n]=nf({},e[n],o):!o&&i||(t[n]=e[n]);return t},rf=function(t,e,o){let n=zg().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=nf(n,o),t.dispatchEvent(n)},sf=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},lf={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},af=function(t,e,o){for(e+=t.firstDay;e>=7;)e-=7;return o?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},hf=function(t){let e=[],o="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),o="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+o+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},cf=function(t,e,o,n,i){let r=new Date(n,o,e),s=t.hasMoment?t.moment(r).isoWeek():function(t,e){t.setHours(0,0,0,0);let o=t.getDate(),n=t.getDay(),i=e,r=i-1,s=function(t){return(t+7-1)%7};t.setDate(o+r-s(n));let l=new Date(t.getFullYear(),0,i),a=(t.getTime()-l.getTime())/864e5;return 1+Math.round((a-r+s(l.getDay()))/7)}(r,i);return'<td class="pika-week">'+s+"</td>"},uf=function(t,e,o,n){return'<tr class="pika-row'+(o?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},df=function(t,e,o,n,i,r){let s,l,a,h,c,u=t._o,d=o===u.minYear,g=o===u.maxYear,f='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',p=!0,m=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(o===i?s-e:12+s-e)+'"'+(s===n?' selected="selected"':"")+(d&&s<u.minMonth||g&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",qg(u.yearRange)?(s=u.yearRange[0],l=u.yearRange[1]+1):(s=o-u.yearRange,l=1+o+u.yearRange),a=[];s<l&&s<=u.maxYear;s++)s>=u.minYear&&a.push('<option value="'+s+'"'+(s===o?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+o+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",u.showMonthAfterYear?f+=c+h:f+=h+c,d&&(0===n||u.minMonth>=n)&&(p=!1),g&&(11===n||u.maxMonth<=n)&&(m=!1),0===e&&(f+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),f+"</div>"};function gf(t){let e=this,o=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let n=(t=t||jg().event).target||t.srcElement;if(n)if(Yg(n,"is-disabled")||(!Yg(n,"pika-button")||Yg(n,"is-empty")||Yg(n.parentNode,"is-disabled")?Yg(n,"pika-prev")?e.prevMonth():Yg(n,"pika-next")&&e.nextMonth():(e.setDate(new Date(n.getAttribute("data-pika-year"),n.getAttribute("data-pika-month"),n.getAttribute("data-pika-day"))),o.bound&&Ug((function(){e.hide(),o.blurFieldOnSelect&&o.field&&o.field.blur()}),100))),Yg(n,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){let o=(t=t||jg().event).target||t.srcElement;o&&(Yg(o,"pika-select-month")?e.gotoMonth(o.value):Yg(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(t){if(t=t||jg().event,e.isVisible())switch(t.keyCode){case 13:case 27:o.field&&o.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(o.parse)return o.parse(o.field.value,o.format);if(this.hasMoment){let t=this.moment(o.field.value,o.format,o.formatStrict);return t&&t.isValid()?t.toDate():null}return new Date(Date.parse(o.field.value))},e._onInputChange=function(t){let o;t.firedBy!==e&&(o=e._parseFieldValue(),Qg(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=zg().activeElement;do{if(Yg(t,"pika-single"))return}while(t=t.parentNode);e._c||(e._b=Ug((function(){e.hide()}),50)),e._c=!1},e._onClick=function(t){let n=(t=t||jg().event).target||t.srcElement,i=n;if(n){!hasEventListeners&&Yg(n,"pika-select")&&(n.onchange||(n.setAttribute("onchange","return;"),$g(n,"change",e._onChange)));do{if(Yg(i,"pika-single")||i===o.trigger)return}while(i=i.parentNode);e._v&&n!==o.trigger&&i!==o.trigger&&e.hide()}},e.el=zg().createElement("div"),e.el.className="pika-single"+(o.isRTL?" is-rtl":"")+(o.theme?" "+o.theme:""),$g(e.el,"mousedown",e._onMouseDown,!0),$g(e.el,"touchend",e._onMouseDown,!0),$g(e.el,"change",e._onChange),o.keyboardInput&&$g(zg(),"keydown",e._onKeyChange),o.field&&(o.container?o.container.appendChild(e.el):o.bound?zg().body.appendChild(e.el):o.field.parentNode.insertBefore(e.el,o.field.nextSibling),$g(o.field,"change",e._onInputChange),o.defaultDate||(o.defaultDate=e._parseFieldValue(),o.setDefaultDate=!0));let n=o.defaultDate;Qg(n)?o.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),o.bound?(this.hide(),e.el.className+=" is-bound",$g(o.trigger,"click",e._onInputClick),$g(o.trigger,"focus",e._onInputFocus),$g(o.trigger,"blur",e._onInputBlur)):this.show()}function ff(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}gf.prototype={config:function(t){this._o||(this._o=nf({},lf,!0));let e=nf(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let o=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=o>4?4:o,Qg(e.minDate)||(e.minDate=!1),Qg(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),qg(e.yearRange)){let t=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||lf.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Qg(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Qg(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",rf(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!Qg(t))return;let o=this._o.minDate,n=this._o.maxDate;Qg(o)&&t<o?t=o:Qg(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),ef(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),rf(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Qg(t)){if(this.calendars){let o=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<o.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let o,n=this.getDate()||new Date,i=24*parseInt(e)*60*60*1e3;"add"===t?o=new Date(n.valueOf()+i):"subtract"===t&&(o=new Date(n.valueOf()-i)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=sf(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=sf({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(ef(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=lf.minDate,this._o.minYear=lf.minYear,this._o.minMonth=lf.minMonth,this._o.startRange=lf.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(ef(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=lf.maxDate,this._o.maxYear=lf.maxYear,this._o.maxMonth=lf.maxMonth,this._o.endRange=lf.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e,o=this._o,n=o.minYear,i=o.maxYear,r=o.minMonth,s=o.maxMonth,l="";this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let t=0;t<o.numberOfMonths;t++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),l+='<div class="pika-lendar">'+df(this,t,this.calendars[t].year,this.calendars[t].month,this.calendars[0].year,e)+this.render(this.calendars[t].year,this.calendars[t].month,e)+"</div>";this.el.innerHTML=l,o.bound&&"hidden"!==o.field.type&&Ug((function(){o.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),o.bound&&o.field.setAttribute("aria-label",o.ariaLabel)},adjustPosition:function(){let t,e,o,n,i,r,s,l,a,h,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,o=this.el.offsetHeight,n=jg().innerWidth||zg().documentElement.clientWidth,i=jg().innerHeight||zg().documentElement.clientHeight,r=zg().body.scrollTop||zg().documentElement.scrollTop,h=!0,c=!0,a=t.getBoundingClientRect(),s=a.left+jg().pageXOffset,l=a.bottom+jg().pageYOffset,(this._o.reposition&&s+e>n||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&l+o>i+r||this._o.position.indexOf("top")>-1&&l-o-t.offsetHeight>0)&&(l=l-o-t.offsetHeight,c=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",Kg(this.el,h?"left-aligned":"right-aligned"),Kg(this.el,c?"bottom-aligned":"top-aligned"),Xg(this.el,h?"right-aligned":"left-aligned"),Xg(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,o){let n=this._o,i=new Date,r=tf(t,e),s=new Date(t,e,1).getDay(),l=[],a=[];ef(i),n.firstDay>0&&(s-=n.firstDay,s<0&&(s+=7));let h=0===e?11:e-1,c=11===e?0:e+1,u=0===e?t-1:t,d=11===e?t+1:t,g=tf(u,h),f=r+s,p=f;for(;p>7;)p-=7;f+=7-p;let m=!1;for(let o=0,p=0;o<f;o++){let f=new Date(t,e,o-s+1),w=!!Qg(this._d)&&of(f,this._d),v=of(f,i),y=-1!==n.events.indexOf(f.toDateString()),b=o<s||o>=r+s,C=o-s+1,S=e,R=t,E=n.startRange&&of(n.startRange,f),T=n.endRange&&of(n.endRange,f),x=n.startRange&&n.endRange&&n.startRange<f&&f<n.endRange;b&&(o<s?(C=g+C,S=h,R=u):(C-=r,S=c,R=d));let M={day:C,month:S,year:R,hasEvent:y,isSelected:w,isToday:v,isDisabled:n.minDate&&f<n.minDate||n.maxDate&&f>n.maxDate||n.disableWeekends&&Zg(f)||n.disableDayFn&&n.disableDayFn(f),isEmpty:b,isStartRange:E,isEndRange:T,isInRange:x,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&w&&(m=!0),a.push(hf(M)),7==++p&&(n.showWeekNumber&&a.unshift(cf(this,o-s,e,t,n.firstWeekOfYearMinDays)),l.push(uf(a,n.isRTL,n.pickWholeWeek,m)),a=[],p=0,m=!1)}return function(t,e,o){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+o+'">'+function(t){let e,o=[];for(t.showWeekNumber&&o.push("<th></th>"),e=0;e<7;e++)o.push('<th scope="col"><abbr title="'+af(t,e)+'">'+af(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?o.reverse():o).join("")+"</tr></thead>"}(t)+"<tbody>"+e.join("")+"</tbody></table>"}(n,l,o)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Xg(this.el,"is-hidden"),this._o.bound&&($g(zg(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&Gg(zg(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Kg(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Gg(this.el,"mousedown",this._onMouseDown,!0),Gg(this.el,"touchend",this._onMouseDown,!0),Gg(this.el,"change",this._onChange),t.keyboardInput&&Gg(zg(),"keydown",this._onKeyChange),t.field&&(Gg(t.field,"change",this._onInputChange),t.bound&&(Gg(t.trigger,"click",this._onInputClick),Gg(t.trigger,"focus",this._onInputFocus),Gg(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const pf="date",mf="dateEditor";class wf extends Ad{constructor(){super(...arguments),ff(this,"defaultDateFormat","DD/MM/YYYY"),ff(this,"parentDestroyed",!1),ff(this,"$datePicker",null)}static get EDITOR_TYPE(){return pf}init(){if("function"!=typeof Dt)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),et(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(t=>{tt(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(t),super.open(),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:mf})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{this.hot._refreshBorders()})),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(mf),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){const e=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.hot.view.isMouseDown(),n=!!t&&Ue(t.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new gf(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(Dt),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,Dt(i,e,!0).isValid()&&this.$datePicker.setMoment(Dt(i,e),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),n||o||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,Dt(i,e,!0).isValid()&&this.$datePicker.setMoment(Dt(i,e),!0),n||o||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&pe(e,this.cellProperties.datePickerConfig);const o=e.onSelect,n=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=Dt(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),o&&o()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},e}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==Cd.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:o,columnIndexMapper:n}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:r}=null!==(e=i.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,s=o.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),l=o.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),a=n.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),h=n.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=l&&this.col>=a&&this.col<=h){const t=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+Ct(this.TD)}px`;let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-bt(this.datePicker):e+=t.left,this.datePickerStyle.left=`${e}px`}else this.hideDatepicker()}}class vf extends Wg{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}io.getSingleton().add("beforeValidate",(function(t,e,o){const n=this.getCellMeta(e,this.propToCol(o));n.editor===vf&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));class yf extends Ad{static get EDITOR_TYPE(){return"numeric"}}class bf extends Ad{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&nt(this.TEXTAREA,[_()]),st(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Cf="ht_editor_visible",Sf="selectEditor";class Rf extends Rd{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",et(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",tt(this.select,Cf)&&ot(this.select,Cf),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r);const s=this.cellProperties.selectOptions;let l;l="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),st(this.select),Se(l,((t,e)=>{const o=this.hot.rootDocument.createElement("OPTION");o.value=e,at(o,t),this.select.appendChild(o)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"==typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==Cd.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:o,height:n}=this.getEditedCellRect(),i=this.select.style;i.height=`${n}px`,i.width=`${o}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",et(this.select,Cf)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o=t.getContext("grid"),n={group:Sf};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o,callback:()=>{}}],n),!0===this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Sf)}}class Ef extends Ad{static get EDITOR_TYPE(){return"time"}prepare(t,e,o,n,i,r){super.prepare(t,e,o,n,i,r),this.TEXTAREA.dir="ltr"}}function Tf(t,e,o,n,i,r,s){Od.apply(this,[t,e,o,n,i,r,s]),at(e,null==r?"":r,!1)}function xf(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=s.allowHtml?Tf:Pd,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(..._()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,o,n,i,r,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),et(e,"htAutocomplete"),!t.acArrowListener){const i=new yo(t);t.acArrowListener=function(i){tt(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(o,n),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}function Mf(t,e,o,n,i,r,s){xf.apply(this,[t,e,o,n,i,r,s])}Tf.RENDERER_TYPE="html",xf.RENDERER_TYPE="autocomplete",Mf.RENDERER_TYPE="dropdown";const Hf=new WeakMap,kf=new WeakMap,If="data-row",Af="data-col",Of="checkbox";function Pf(t,e,o,n,i,r,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;Od.apply(this,[t,e,o,n,i,r,s]),function(t){let e=kf.get(t);if(!e){const{rootElement:o}=t;e=new yo(t),e.addEventListener(o,"click",(e=>function(t,e){const{target:o}=t;if(!Nf(o))return;if(!o.hasAttribute(If)||!o.hasAttribute(Af))return;const n=parseInt(o.getAttribute(If),10),i=parseInt(o.getAttribute(Af),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}(e,t))),e.addEventListener(o,"mouseup",(e=>function(t,e){const{target:o}=t;Nf(o)&&o.hasAttribute(If)&&o.hasAttribute(Af)&&setTimeout(e.listen,10)}(e,t))),e.addEventListener(o,"change",(e=>function(t,e){const{target:o}=t;if(!Nf(o))return;if(!o.hasAttribute(If)||!o.hasAttribute(Af))return;const n=parseInt(o.getAttribute(If),10),i=parseInt(o.getAttribute(Af),10),r=e.getCellMeta(n,i);if(!r.readOnly){let o=null;o=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(n,i,o)}}(e,t))),kf.set(t,e)}}(t);let h=function(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(l);const c=s.label;let u=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),st(e),r===s.checkedTemplate||Yt(r).toLocaleLowerCase(s.locale)===Yt(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||Yt(r).toLocaleLowerCase(s.locale)===Yt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:qt(r)?et(h,"noValue"):(h.style.display="none",et(h,"htBadValue"),u=!0),nt(h,[[If,o],[Af,n]]),a&&nt(h,[N(h.checked?t.getTranslatedPhrase(yh):t.getTranslatedPhrase(bh)),(d=h.checked,["aria-checked",d]),["role","checkbox"]]),!u&&c){let s="";if(c.value)s="function"==typeof c.value?c.value.call(this,o,n,i,r):c.value;else if(c.property){const e=t.getDataAtRowProp(o,c.property);s=null!==e?e:""}const a=function(t,e,o){const n=t.createElement("label");return n.className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}(l,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}var d;function g(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=t.getSelectedRange(),n=[];let i=[],r=0;if(o){for(let s=0;s<o.length;s++){const{row:l,col:a}=o[s].getTopStartCorner(),{row:h,col:c}=o[s].getBottomEndCorner();for(let o=l;o<=h;o+=1)for(let n=a;n<=c;n+=1){const s=t.getCellMeta(o,n),l={checkedTemplate:s.checkedTemplate,uncheckedTemplate:s.uncheckedTemplate};if("checkbox"!==s.type)return;if(!0===s.readOnly)continue;void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1);const a=t.getDataAtCell(o,n);!1===e?[s.checkedTemplate,s.checkedTemplate.toString()].includes(a)?i.push([o,n,s.uncheckedTemplate,l]):[s.uncheckedTemplate,s.uncheckedTemplate.toString(),null,void 0].includes(a)&&i.push([o,n,s.checkedTemplate,l]):i.push([o,n,s.uncheckedTemplate,l]),r+=1}n.push(r),r=0}i=i.every((t=>{let[,,e]=t;return e===i[0][2]}))?i.map((t=>{let[e,o,n]=t;return[e,o,n]})):i.map((t=>{let[e,o,,n]=t;return[e,o,n.checkedTemplate]})),i.length>0&&n.forEach((e=>{const o=i.splice(0,e);t.setDataAtCell(o)}))}}function f(){const e=t.getSelectedRange();if(e){for(let o=0;o<e.length;o++){const n=e[o].getTopStartCorner(),i=e[o].getBottomEndCorner();for(let e=n.row;e<=i.row;e++)for(let o=n.col;o<=i.col;o++){const n=t.getCellMeta(e,o);if("checkbox"!==n.type)return!1;const i=t.getCell(e,o);if(null==i)return!0;if(i.querySelectorAll("input[type=checkbox]").length>0&&!n.readOnly)return!0}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(l.createTextNode("#bad-value#")),Hf.has(t)||(Hf.set(t,!0),function(){const e=t.getShortcutManager().getContext("grid"),o={group:"checkboxRenderer",relativeToGroup:wu,position:"before"};e.addShortcuts([{keys:[["space"]],callback:()=>(g(),!f())},{keys:[["enter"]],callback:()=>(g(),!f()),runOnlyIf:()=>{var e;return t.getSettings().enterBeginsEditing&&(null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())}},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!f())}],o)}())}function Nf(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}function _f(t,e,o,n,i,r,s){xf.apply(this,[t,e,o,n,i,r,s])}io.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,o){const{label:n,type:i,row:r,column:s,prop:l}=e;if(i===Of){if(n){const{value:e,property:i}=n;let a=o;if(e)a="function"==typeof e?e(r,s,l,o):e;else if(i){const t=this.getDataAtRowProp(r,i);a=null!==t?t:o}t=a}return t}})),Pf.RENDERER_TYPE=Of,_f.RENDERER_TYPE="handsontable";var Df=o(8646);function Lf(t,e){if(qo(t)){const o=e.numericFormat,n=o&&o.culture||"-",i=o&&o.pattern;if(void 0!==n&&!Df.languages()[n]){const t=n.replace("-",""),e=Df.allLanguages?Df.allLanguages[n]:Df[t];e&&Df.registerLanguage(e)}Df.setLanguage(n),t=Df(t).format(i||"0")}return t}function Vf(t,e,o,n,i,r,s){let l=r;if(qo(l)){const t=s.className||"",o=t.length?t.split(" "):[];l=Lf(l,s),o.indexOf("htLeft")<0&&o.indexOf("htCenter")<0&&o.indexOf("htRight")<0&&o.indexOf("htJustify")<0&&o.push("htRight"),o.indexOf("htNumeric")<0&&o.push("htNumeric"),s.className=o.join(" "),e.dir="ltr"}Pd(t,e,o,n,i,l,s)}function Ff(t,e,o,n,i,r,s){Pd.apply(this,[t,e,o,n,i,r,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let h="";Qo(l-1,(()=>{h+=a})),at(e,h)}function Wf(t,e,o,n,i,r,s){Pd.apply(this,[t,e,o,n,i,r,s])}function Bf(t,e,o,n,i,r,s){Pd.apply(this,[t,e,o,n,i,r,s]),e.dir="ltr"}function jf(t,e){let o=t;null==o&&(o=""),this.allowEmpty&&""===o?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(o,zf(o,e)):zf(o,e)(this.source):e(!0)}function zf(t,e){const o=t;return function(t){let n=!1;for(let e=0,i=t.length;e<i;e++)if(o===t[e]){n=!0;break}e(n)}}function Uf(t,e){const o=po(pf,this.instance);let n=t,i=!0;null==n&&(n="");let r=Dt(n,this.dateFormat||o.defaultDateFormat,!0).isValid(),s=Dt(new Date(n)).isValid()||r;if(this.allowEmpty&&""===n&&(s=!0,r=!0),s||(i=!1),!s&&r&&(i=!0),s&&!r)if(!0===this.correctFormat){const t=function(t,e){const o=Dt(function(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}(t)),n=Dt(t,e),i=t.search(/[A-z]/g)>-1;let r;return r=o.isValid()&&o.format("x")===n.format("x")||!n.isValid()||i?o:n,r.format(e)}(n,this.dateFormat),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"dateValidator"),i=!0}else i=!1;e(i)}function $f(t,e){jf.apply(this,[t,e])}function Gf(t,e){let o=t;null==o&&(o=""),this.allowEmpty&&""===o?e(!0):e(""!==o&&qo(t))}Vf.RENDERER_TYPE="numeric",Ff.RENDERER_TYPE="password",Wf.RENDERER_TYPE="select",Bf.RENDERER_TYPE="time",jf.VALIDATOR_TYPE="autocomplete",Uf.VALIDATOR_TYPE="date",$f.VALIDATOR_TYPE="dropdown",Gf.VALIDATOR_TYPE="numeric";const Yf=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function Kf(t,e){const o=this.timeFormat||"h:mm:ss a";let n=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const r=/^\d{1,2}$/.test(i);r&&(i+=":00");const s=Dt(i,Yf,!0).isValid()?Dt(i):Dt(i,o);let l=s.isValid(),a=Dt(i,o,!0).isValid()&&!r;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(n=!1),!l&&a&&(n=!0),l&&!a)if(!0===this.correctFormat){const t=s.format(o),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"timeValidator"),n=!0}else n=!1;e(n)}Kf.VALIDATOR_TYPE="time";const Xf={CELL_TYPE:"autocomplete",editor:Wg,renderer:xf,validator:jf},qf={CELL_TYPE:"checkbox",editor:Bg,renderer:Pf};function Qf(t,e,o,n,i,r,s){xf.apply(this,[t,e,o,n,i,r,s])}Qf.RENDERER_TYPE="date";const Zf={CELL_TYPE:"date",editor:wf,renderer:Qf,validator:Uf},Jf={CELL_TYPE:"dropdown",editor:vf,renderer:Mf,validator:$f},tp={CELL_TYPE:"handsontable",editor:Dg,renderer:_f},ep={CELL_TYPE:"numeric",editor:yf,renderer:Vf,validator:Gf,dataType:"number"},op={CELL_TYPE:"password",editor:bf,renderer:Ff,copyable:!1},np={CELL_TYPE:"select",editor:Rf,renderer:Wf},ip={CELL_TYPE:"time",editor:Ef,renderer:Bf,validator:Kf};function rp(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function lp(t,e){return t.get(ap(t,e))}function ap(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const hp=new Map([["plugin",function(t){return!!fn(t)}],["cell-type",Vc],["editor",co],["renderer",vn],["validator",Tn]]),cp=[];let up=null;var dp=new WeakMap,gp=new WeakSet;class fp{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){var e;rp(this,e=gp),e.add(this),sp(this,"eventManager",new yo(this)),sp(this,"pluginName",null),sp(this,"pluginsInitializedCallbacks",[]),sp(this,"isPluginsReady",!1),sp(this,"enabled",!1),sp(this,"initialized",!1),function(t,e,o){rp(t,e),e.set(t,{})}(this,dp),Ce(this,"hot",t,{writable:!1}),up=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[o,n]=e.split(":");if(!hp.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);hp.get(o)(n)||t.push(` - ${n} (${o})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");cp.push(e)}}if(up||(up=gn()),up.indexOf("UndoRedo")>=0&&up.splice(up.indexOf("UndoRedo"),1),up.indexOf(this.pluginName)>=0&&up.splice(up.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()})),0===up.length){if(cp.length>0){const t=[`${cp.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){lp(dp,this)[t]=lp(dp,this)[t]||[];const o=lp(dp,this)[t];this.hot.addHook(t,e),o.push(e),lp(dp,this)[t]=o}removeHooks(t){jt(lp(dp,this)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=lp(dp,this);Se(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){jt(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=ap(gp,this,pp).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),Se(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function pp(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let o=0;o<e.length;o++)if(void 0!==t[e[o]])return!0;return!1}function mp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const wp=class{constructor(t){mp(this,"hot",null),mp(this,"container",null),mp(this,"injected",!1),mp(this,"rows",[]),mp(this,"columns",[]),mp(this,"samples",null),mp(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:t};this.rows.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(t){if(null!=this.hot.getColHeader(0)){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:t};this.columns.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(t){this.injected||this.injectTable(),jt(this.rows,(e=>{t(e.row,Ct(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),jt(this.columns,(e=>{const{width:o}=e.table.getBoundingClientRect();t(e.col,Math.ceil(o))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((o=>{jt(o.strings,(o=>{e.appendChild(this.createColElement(o.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,n),o.appendChild(n)),this.samples.forEach((n=>{jt(n.strings,(n=>{const i=n.col,r=this.hot.getCellMeta(t,i);r.col=i,r.row=t;const s=this.hot.getCellRenderer(r),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,i,this.hot.colToProp(i),n.value,r),o.appendChild(l)}))})),o}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const n=t.createElement("th");o.push([-1,n]),e.appendChild(n)}this.samples.forEach((n=>{jt(n.strings,(n=>{const i=n.col,r=t.createElement("th");o.push([i,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),jt(o,(t=>{const[e,o]=t;this.hot.view.appendColHeader(e,o)}))}createCol(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment();return this.samples.forEach((n=>{jt(n.strings,(n=>{const i=n.row,r=this.hot.getCellMeta(i,t);r.col=t,r.row=i;const s=this.hot.getCellRenderer(r),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,i,t,this.hot.colToProp(t),n.value,r),a.appendChild(l),o.appendChild(a)}))})),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const o=this.hot.rootDocument.createElement("col");let n=0;e>=0&&t>=0&&(n=this.hot.getCellMeta(e,t).colspan);let i=this.hot.getColWidth(t);if(n>1)for(let e=t+1;e<t+n;e++)i+=this.hot.getColWidth(e);return o.style.width=`${i}px`,o}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("table"),i=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&n.appendChild(s),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&r.appendChild(l),n.appendChild(r),et(n,t),o.appendChild(n),{fragment:o,table:n,tHead:i,tBody:r,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("div");return et(n,`htGhostTable htAutoSize ${t.trim()}`),o.appendChild(n),{fragment:o,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function vp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class yp{static get SAMPLE_COUNT(){return 3}constructor(t){vp(this,"samples",null),vp(this,"dataFactory",null),vp(this,"customSampleCount",null),vp(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:yp.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,o){const n=new Map,{from:i,to:r}="number"==typeof o?{from:o,to:o}:o;return Qo(i,r,(o=>{const i=this.generateSample(t,e,o);n.set(o,i)})),n}generateSample(t,e,o){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const n=new Map,i="row"===t?"col":"row",r=[];return Qo(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(o,e):this.dataFactory(e,o);if(!1===s)return;const{value:l,bundleSeed:a}=s,h="string"==typeof a&&a.length>0;let c;c=h?a:be(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${Yt(l).length}`,n.has(c)||n.set(c,{needed:this.getSampleCount(),strings:[]});const u=n.get(c);u.needed&&(!(r.indexOf(l)>-1)||this.allowDuplicates||h)&&(u.strings.push({value:l,[i]:e}),r.push(l),u.needed-=1)})),n}}const bp=yp;function Cp(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Rp(t,e){return t.get(Ep(t,e))}function Ep(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("modifyAutoColumnSizeSeed");const Tp="autoColumnSize";var xp=new WeakMap,Mp=new WeakSet;class Hp extends fp{static get PLUGIN_KEY(){return Tp}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){var e;super(t),Cp(this,e=Mp),e.add(this),Sp(this,"ghostTable",new wp(this.hot)),Sp(this,"samplesGenerator",new bp(((t,e)=>{const o=this.hot.toPhysicalRow(t),n=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(n))return!1;const i=this.hot.getCellMeta(t,e);let r="";i.spanned||(r=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,r)),{value:r,bundleSeed:s}}))),Sp(this,"firstCalculation",!0),Sp(this,"inProgress",!1),Sp(this,"measuredColumns",0),Sp(this,"columnWidthsMap",new wl),function(t,e,o){Cp(t,e),e.set(t,[])}(this,xp),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,o)=>Ep(Mp,this,Op).call(this,t,e,o)))}isEnabled(){return!1!==this.hot.getSettings()[Tp]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Tp];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Ep(Mp,t,Ip).call(t,...o)})),this.addHook("beforeChangeRender",(t=>Ep(Mp,this,Ap).call(this,t))),this.addHook("afterFormulasValuesUpdate",(t=>Ep(Mp,this,Np).call(this,t))),this.addHook("beforeViewRender",(t=>Ep(Mp,this,kp).call(this,t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>Ep(Mp,this,Pp).call(this))),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,o)=>Ep(Mp,this,Op).call(this,t,e,o)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,e=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();-1!==e&&-1!==o&&this.calculateColumnsWidth({from:e,to:o},void 0,t)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;Qo(n.from,n.to,(t=>{let e=this.hot.toPhysicalColumn(t);null===e&&(e=t),(o||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e))&&jt(this.samplesGenerator.generateColumnSamples(t,i),(t=>{let[e,o]=t;return this.ghostTable.addColumn(e,o)}))})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,e)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const o=this.hot.countCols()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return He(n),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+Hp.CALCULATION_STEP,o)},t),e=e+Hp.CALCULATION_STEP+1,e<o?n=Me(i):(He(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[Tp],e=t&&xe(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&xe(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[Tp];let e=Hp.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return be(t)&&(e=t.syncLimit,H(e)?e=Jo(o,e):e>>=0),Math.min(e,o)}getColumnWidth(t){let e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0===o&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),e&&"number"==typeof o&&(o=Math.max(o,os.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){return Ft(this.hot.getColHeader(),((t,e,o)=>{const n=Rp(xp,this).length;return(n-1<o||Rp(xp,this)[o]!==e)&&t.push(o),n-1<o?Rp(xp,this).push(e):Rp(xp,this)[o]=e,t}),[])}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{jt(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Wt(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function kp(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function Ip(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}function Ap(t){const e=Bt(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}function Op(t,e,o){let n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Pp(){!function(t,e,o){t.set(Ep(t,e),o)}(xp,this,this.hot.getColHeader())}function Np(t){const e=Bt(Wt(t,(t=>{var e;return Kt(null===(e=t.address)||void 0===e?void 0:e.col)})),(t=>t.address.col));this.clearCache(Array.from(new Set(e)))}const _p={horizontal:"horizontal",vertical:"vertical"};function Dp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Lp(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("modifyAutofillRange"),io.getSingleton().register("beforeAutofill"),io.getSingleton().register("afterAutofill");const Vp="autofill",Fp=["fillHandle"];var Wp=new WeakSet;function Bp(){this.selectAdjacent()&&this.fillIn()}function jp(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function zp(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Up(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function $p(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Gp(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Yp(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const Kp="autoRowSize";var Xp=new WeakSet;class qp extends fp{static get PLUGIN_KEY(){return Kp}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){var e,o;super(t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,o=Xp),o.add(e),Gp(this,"headerHeight",null),Gp(this,"ghostTable",new wp(this.hot)),Gp(this,"samplesGenerator",new bp(((t,e)=>{const o=this.hot.toPhysicalRow(t),n=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(n))return!1;if(t>=0&&e>=0&&this.hot.getCellMeta(t,e).hidden)return!1;let i;return t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i}}))),Gp(this,"firstCalculation",!0),Gp(this,"inProgress",!1),Gp(this,"measuredRows",0),Gp(this,"rowHeightsMap",new wl),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,o)=>Yp(Xp,this,Zp).call(this,t,e,o)))}isEnabled(){const t=this.hot.getSettings()[Kp];return!0===t||be(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Yp(Xp,t,Jp).call(t,...o)})),this.addHook("beforeChangeRender",(t=>Yp(Xp,this,tm).call(this,t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>Yp(Xp,this,Qp).call(this,t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,o)=>Yp(Xp,this,Zp).call(this,t,e,o)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"==typeof t?{from:t,to:t}:t,i="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}Qo(n.from,n.to,(t=>{(o||null===this.rowHeightsMap.getValueAtIndex(t))&&jt(this.samplesGenerator.generateRowSamples(t,i),(t=>{let[e,o]=t;return this.ghostTable.addRow(e,o)}))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const o=this.hot.countRows()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return He(n),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+qp.CALCULATION_STEP,o)},t),e=e+qp.CALCULATION_STEP+1,e<o?n=Me(i):(He(n),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},t),this.firstCalculation=!1,e=r+1),e<o?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[Kp],e=t&&xe(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&xe(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){ct(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[Kp];let e=qp.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return be(t)&&(e=t.syncLimit,H(e)?e=Jo(o,e):e>>=0),Math.min(e,o)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let n=e;return null!==o&&o>(e||0)&&(n=o),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:o}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{Qo(Math.min(e,o),Math.max(e,o),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!Wt(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Qp(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function Zp(t,e,o){let n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function Jp(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}))}function tm(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}const em=new Map([["indexesSequence",{getListWithInsertedItems:cl,getListWithRemovedItems:ul}],["physicallyIndexed",{getListWithInsertedItems:pl,getListWithRemovedItems:ml}]]),om=t=>{if(!1===em.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return em.get(t)},{getListWithInsertedItems:nm,getListWithRemovedItems:im}=om("physicallyIndexed"),{getListWithInsertedItems:rm,getListWithRemovedItems:sm}=om("physicallyIndexed");const lm="bindRowsWithHeaders",am=new Map([["loose",class extends hl{constructor(){super((t=>t))}insert(t,e){const o=gl(this.indexedValues,e);this.indexedValues=nm(o,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=im(this.indexedValues,t);this.indexedValues=dl(e,t),super.remove(t)}}],["strict",class extends hl{constructor(){super((t=>t))}insert(t,e){this.indexedValues=rm(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=sm(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}]]);var hm=new WeakSet;function cm(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function um(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dm(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function gm(t,e){return t.get(pm(t,e))}function fm(t,e,o){return t.set(pm(t,e),o),o}function pm(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const mm="collapsibleColumns",wm=["nestedHeaders"],vm="collapsibleIndicator",ym=mm,bm=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Cm=new WeakMap,Sm=new WeakSet;function Rm(t,e,o){var n;const{collapsible:i,origColspan:r,isCollapsed:s}=null!==(n=this.headerStateManager.getHeaderSettings(o,t))&&void 0!==n?n:{},l=i&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${vm}`);var c;it(e,[B("")[0]]),l?(h||(h=this.hot.rootDocument.createElement("div"),et(h,vm),e.querySelector("div:first-child").appendChild(h)),ot(h,["collapsed","expanded"]),s?(et(h,"collapsed"),ht(h,"+"),a&&nt(e,...B(!1))):(et(h,"expanded"),ht(h,"-"),a&&nt(e,...B(!0))),a&&nt(h,..._())):null===(c=h)||void 0===c||c.remove()}function Em(t,e){tt(t.target,vm)&&(tt(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):tt(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ge(t))}function Tm(){this.updatePlugin()}function xm(t,e){e||this.updatePlugin()}function Mm(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Hm=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class km{constructor(t,e){Mm(this,"hot",void 0),Mm(this,"sortingStates",new yl),Mm(this,"sortEmptyCells",!1),Mm(this,"indicator",!0),Mm(this,"headerAction",!0),Mm(this,"compareFunctionFactory",void 0),Mm(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){be(t)&&Se(t,((t,e)=>{Hm.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[o]=e;return o===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return be(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map((t=>{let[e,o]=t;return{column:this.hot.toVisualColumn(e),...o}}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(Kt(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Im="asc",Am="desc",Om="colHeader";function Pm(t){if(t!==Am)return t===Im?Am:Im}function Nm(t){return t.querySelector(`.${Om}`)}function _m(t,e){if(t<0||!e.parentNode)return!1;const o=e.parentNode.parentNode.childNodes;return-1==Array.from(o).indexOf(e.parentNode)-o.length}function Dm(t,e,o){return-1===t&&e>=0&&!1===Ke(o)}const Lm="indicatorDisabled",Vm="columnSorting",Fm="sortAction",Wm=new Map([[Im,"ascending"],[Am,"descending"]]),Bm=-1;function jm(t,e,o){const n=e.locale;return function(e,i){const{sortEmptyCells:r}=o;return"string"==typeof e&&(e=e.toLocaleLowerCase(n)),"string"==typeof i&&(i=i.toLocaleLowerCase(n)),e===i?0:qt(e)?qt(i)?0:r&&"asc"===t?Bm:1:qt(i)?r&&"asc"===t?1:Bm:isNaN(e)&&!isNaN(i)?"asc"===t?1:Bm:!isNaN(e)&&isNaN(i)?"asc"===t?Bm:1:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?Bm:1:e>i?"asc"===t?1:Bm:0)}}const zm="default",{register:Um,getItem:$m,hasItem:Gm}=so("sorting.compareFunctionFactory"),{register:Ym,getItem:Km}=so("sorting.mainSortComparator");function Xm(t){return Gm(t)?$m(t):$m(zm)}function qm(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Qm(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}Um("numeric",(function(t,e,o){return function(e,n){const i=parseFloat(e),r=parseFloat(n),{sortEmptyCells:s}=o;if(i===r||isNaN(i)&&isNaN(r))return 0;if(s){if(qt(e))return"asc"===t?Bm:1;if(qt(n))return"asc"===t?1:Bm}return isNaN(i)?1:isNaN(r)?Bm:i<r?"asc"===t?Bm:1:i>r?"asc"===t?1:Bm:0}})),Um("checkbox",(function(t,e,o){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:r}=o;return function(s,l){const a=qt(s),h=qt(l),c=a?i:s,u=h?i:l,d=c===i||c===n,g=u===i||u===n;if(!1===r){if(a&&!1===h)return 1;if(!1===a&&h)return Bm}return!1===d&&g?"asc"===t?Bm:1:d&&!1===g?"asc"===t?1:Bm:!1===d&&!1===g?jm(t,e,o)(s,l):c===i&&u===n?"asc"===t?Bm:1:c===n&&u===i?"asc"===t?1:Bm:0}})),Um("date",(function(t,e,o){return function(n,i){const{sortEmptyCells:r}=o;if(n===i)return 0;if(qt(n))return qt(i)?0:r&&"asc"===t?Bm:1;if(qt(i))return r&&"asc"===t?1:Bm;const s=e.dateFormat,l=Dt(n,s),a=Dt(i,s);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?Bm:1:a.isBefore(l)?"asc"===t?1:Bm:0:Bm:1}})),Um(zm,jm);const Zm="columnSorting",Jm="append",tw=Zm;Ym(Zm,(function(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function(o){const n=t[0],s=e[0],l=i[0],a=r[0],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:Xm(s.type))(n,s,h)(l,a)}()}})),io.getSingleton().register("beforeColumnSort"),io.getSingleton().register("afterColumnSort");var ew=new WeakSet;class ow extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=ew),e.add(t),qm(this,"columnStatesManager",null),qm(this,"columnMetaCache",null),qm(this,"pluginKey",Zm),qm(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Zm}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new km(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new wl((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>Qm(ew,this,iw).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Qm(ew,t,sw).call(t,...o)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>Qm(ew,this,nw).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Qm(ew,t,rw).call(t,...o)})),this.hot.view&&Qm(ew,this,nw).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const o=Nm(e);!1!==_m(t,e)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;const o=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return o&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(o)&&-1===o.row&&o.col>=0},relativeToGroup:wu,position:"before",group:tw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tw)}sort(t){const e=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),n=this.areValidSortConfigs(o);!1!==this.hot.runHooks("beforeColumnSort",e,o,n)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new fl),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",e,n?o:e,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return Kt(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return function(t){if(t.some((t=>!1===function(t){if(!1===be(t))return!1;const{column:e,sortOrder:o}=t;return Number.isInteger(e)&&[Im,Am].includes(o)}(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}(t)&&t.every((t=>{let{column:o}=t;return o<=e&&o>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=Bt(t,(t=>{let{column:e,...o}=t;return{column:this.hot.toPhysicalColumn(e),...o}})),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value;return Kt(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=Bt(e.initialConfig,(t=>{let{column:e,...o}=t;return{column:this.hot.toVisualColumn(e),...o}}))),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(Kt(e)){const o=Pm(e);return Kt(o)?{column:t,sortOrder:o}:void 0}const o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:Pm()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jm;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(t),n=-1!==o,i=this.getSortConfig(),r=this.getColumnNextConfig(t);if(n){if(Xt(r))return[...i.slice(0,o),...i.slice(o+1)];if(e===Jm)return[...i.slice(0,o),...i.slice(o+1),r];if("replace"===e)return[...i.slice(0,o),r,...i.slice(o+1)]}return Kt(r)?i.concat(r):i}getPluginColumnConfig(t){if(be(t)){const e=t[this.pluginKey];if(be(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(n);return Array.isArray(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns[t])):ae(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(o,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),o=Object.create(e);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),o}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],o=this.hot.countRows(),n=e=>Bt(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let t=0;t<this.getNumberOfRowsToSort(o);t+=1)e.push([this.hot.toPhysicalRow(t)].concat(n(t)));const i=Bt(e,(t=>t[0]));!function(t,e){const o=Km(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];t.sort(o(...i))}(e,this.pluginKey,Bt(t,(t=>t.sortOrder)),Bt(t,(t=>this.getFirstCellSettings(t.column))));for(let t=e.length;t<o;t+=1)e.push([t].concat(n(t)));const r=Bt(e,(t=>t[0])),s=new Map(Bt(i,((t,e)=>[t,r[e]]))),l=Bt(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if(be(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||be(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(ot(t,Array.from(Wm.values()).concat(Fm,Lm,Vm)),!1!==this.enabled){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];et(t,function(t,e,o,n){const i=[Vm];if(n&&i.push(Fm),!1===o)return i.push(Lm),i;const r=t.getSortOrderOfColumn(e);return Kt(r)&&i.push(Wm.get(r)),i}(...o))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Kt(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&tt(t.target,Om)}onAfterOnCellMouseDown(t,e){!1!==Dm(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function nw(){const t=this.getAllSavedSortSettings();if(be(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function iw(t,e){const o=Nm(e);if(!1===_m(t,e)||null===o)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,r=n.headerAction;if(this.updateHeaderClasses(o,this.columnStatesManager,t,i,r),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);nt(e,...(s=o?`${o}ending`:"none",["aria-sort",s]))}var s}function rw(t){!0===t&&this.hot.view&&Qm(ew,this,nw).call(this)}function sw(t,e,o,n){!1!==Dm(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function lw(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const aw=class{constructor(t,e){lw(this,"plugin",void 0),lw(this,"hot",void 0),lw(this,"endpoints",[]),lw(this,"settings",void 0),lw(this,"settingsType","array"),lw(this,"currentEndpoint",null),lw(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let o=t;if(o||"function"!=typeof this.settings)return o||(o=this.settings),jt(o,(t=>{const o={};this.assignSetting(t,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,o,"reversedRowCoords",!1),this.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"sourceColumn",t.destinationColumn),this.assignSetting(t,o,"type","sum"),this.assignSetting(t,o,"forceNumeric",!1),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"customFunction",null),this.assignSetting(t,o,"readOnly",!0),this.assignSetting(t,o,"roundFloat",!1),e.push(o)})),e;this.settingsType="function"}assignSetting(t,e,o,n){if("ranges"!==o||void 0!==t[o]){if("ranges"!==o||0!==t[o].length)if(void 0===t[o]){if(n instanceof Error)throw n;e[o]=n}else"destinationRow"===o&&e.reversedRowCoords?e[o]=this.hot.countRows()-t[o]-1:e[o]=t[o]}else e[o]=n}resetSetupBeforeStructureAlteration(t,e,o){if("function"!==this.settingsType)return;const n=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();jt(i,(i=>{"row"===n&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=o:"remove_row"===t&&(i.alterRowOffset=-1*o)),"col"===n&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=o:"remove_col"===t&&(i.alterColumnOffset=-1*o))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,o,n,i){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;jt(a,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=l*o),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=l*o)})),this.resetAllEndpoints(a,!h),jt(a,h?t=>{this.extendEndpointRanges(t,c,n[0],n.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,o,n){jt(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?o>t[1]?t[1]+=n:o<t[0]&&(t[0]-=n):o>=t[0]&&o<=t[1]&&(t[1]-=n,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,o=[],n=[];jt(e,(t=>{const e=[];if(t[1])for(let o=t[0];o<=t[1];o++)e.push(this.hot.toPhysicalRow(o));else e.push(this.hot.toPhysicalRow(t[0]));n.push(e)})),jt(n,(t=>{let e=[];jt(t,((n,i)=>{0===i?e.push(n):t[i]!==t[i-1]+1&&(e.push(t[i-1]),o.push(e),e=[],e.push(n)),i===t.length-1&&(e.push(n),o.push(e))}))})),t.ranges=o}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,jt(t.ranges,(o=>{jt(o,((n,i)=>{n>=e&&(o[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.some((t=>{const e=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+o>=this.hot.countCols()}))||(this.cellsToSetCache=[],jt(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],jt(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],jt(t,((t,o,n)=>{`${t[2]||""}`!=`${t[3]}`&&jt(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(n[o][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),jt(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.alterRowOffset||0,n=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?o:0)),this.hot.toVisualColumn(t.destinationColumn+(e?n:0)),""])}setEndpointValue(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const o=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){const e=t.roundFloat;let o=0;Number.isInteger(e)&&(o=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(o)}o?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){qe("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function hw(t){return null==t||isNaN(t)}function cw(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const uw="columnSummary";var dw=new WeakSet;function gw(){this.endpoints.initEndpoints()}function fw(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function pw(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function mw(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class ww{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){mw(this,"rootDocument",void 0),mw(this,"isRtl",!1),mw(this,"container",null),mw(this,"editor",void 0),mw(this,"editorStyle",void 0),mw(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const o=this.getInputElement();o.style.width=`${t}px`,o.style.height=`${e}px`}}getSize(){return{width:bt(this.getInputElement()),height:Ct(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){this.getInputElement().readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),et(this.container,ww.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),et(t,ww.CLASS_EDITOR),et(e,ww.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${ww.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}const vw=ww;function yw(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class bw{constructor(t){yw(this,"wasLastActionShow",!0),yw(this,"showDebounced",null),yw(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=he((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}ve(bw,ll);const Cw=bw,Sw="---------";function Rw(t,e){const o={};return jt(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&(o[t]||(o[t]=[]),o[t][n]=e(t,n))}))})),o}function Ew(t,e,o,n,i){jt(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&function(t,e,o,n,i,r){const s=i(t,e);let l=n;s.className&&(l="vertical"===o?function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}(s.className,n):function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}(s.className,n)),r(t,e,"className",l)}(t,r,e,o,n,i)}))}))}function Tw(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function xw(t,e){let o=!1;return Array.isArray(t)&&jt(t,(t=>(t.forAll(((t,n)=>{if(t>=0&&n>=0&&e(t,n))return o=!0,!1})),o))),o}function Mw(t,e){const o={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:n,left:i}=t.getBoundingClientRect();o.top=n,o.left=i}return o}function Hw(t,e,o){kw(t,e),e.set(t,o)}function kw(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iw(t,e,o){return t.set(Ow(t,e),o),o}function Aw(t,e){return t.get(Ow(t,e))}function Ow(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const Pw="comments",Nw="comment",_w="value",Dw="style",Lw="readOnly",Vw=Pw,Fw=`plugin:${Pw}`;var Ww=new WeakMap,Bw=new WeakMap,jw=new WeakMap,zw=new WeakMap,Uw=new WeakMap,$w=new WeakMap,Gw=new WeakMap,Yw=new WeakSet;function Kw(t){if(this.hot.view&&this.hot.view._wt&&!Aw(jw,this)&&!this.targetIsCommentTextArea(t)){const e=K(t.target,"TD","TBODY");let o=null;e&&(o=this.hot.getCoords(e)),(!e||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}function Xw(t){const{rootDocument:e}=this.hot;if(!(Aw(jw,this)||Aw(Ww,this).isFocused()||tt(t.target,"wtBorder")||Aw($w,this)===t.target)&&Aw(Ww,this))if(Iw($w,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));Aw(Bw,this).show(e)}else q(t.target,e)&&!this.targetIsCommentTextArea(t)&&Aw(Bw,this).hide()}function qw(){Iw(jw,this,!1)}function Qw(t,e){e[Nw]&&e[Nw][_w]&&et(t,e.commentedCellClassName)}function Zw(){Iw(Gw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Jw(){Iw(Gw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Fw)}function tv(t){Iw(Uw,this,{width:bt(t.target),height:Ct(t.target)})}function ev(t){const e=bt(t.target),o=Ct(t.target);e===Aw(Uw,this).width+1&&o===Aw(Uw,this).height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Dw]:{width:e,height:o}})}function ov(t){Aw(Ww,this).isVisible()&&Ge(t)}function nv(){Aw(zw,this)||this.hide()}function iv(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}o(3609);class rv{constructor(t){iv(this,"hot",void 0),iv(this,"commands",{}),iv(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=t.split(":"),r=i[0],s=2===i.length?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(s&&l.submenu&&(l=function(t,e){let o;return jt(e,(e=>{const n=e.key?e.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return o=e,!1})),o}(s,l.submenu.items)),!0===l.disabled)return;if("function"==typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(xe(l,"submenu"))return;const a=[];"function"==typeof l.callback&&a.push(l.callback),"function"==typeof this.commonCallback&&a.push(this.commonCallback),o.unshift(i.join(":")),jt(a,(t=>t.apply(this.hot,o)))}}const sv="alignment",lv="clear_column",av="col_left",hv="col_right",cv="make_read_only",uv="redo",dv="remove_col",gv="remove_row",fv="row_above",pv="row_below",mv="no_items",wv="undo",vv=[fv,pv,av,hv,lv,gv,dv,wv,uv,cv,sv,Sw,mv],yv={[Sw]:function(){return{name:Sw}},[mv]:function(){return{key:mv,name(){return this.getTranslatedPhrase(Yl)},disabled:!0,isCommand:!1}},[fv]:function(){return{key:fv,name(){return this.getTranslatedPhrase(Kl)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||(this.selection.isSelectedByCorner()?0===this.countRows():this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}},[pv]:function(){return{key:pv,name(){return this.getTranslatedPhrase(Xl)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[av]:function(){return{key:av,name(){return this.getTranslatedPhrase(ql)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||(this.selection.isSelectedByCorner()?0===this.countCols():this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}},[hv]:function(){return{key:hv,name(){return this.getTranslatedPhrase(Ql)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[lv]:function(){return{key:lv,name(){return this.getTranslatedPhrase(na)},callback(t,e){const o=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}},[gv]:function(){return{key:gv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[o,,n]=t[0];o-n!=0&&(e=1)}return this.getTranslatedPhrase(Zl,e)},callback(){this.alter("remove_row",function(t){const e=Cc(t.getSelected());if(0===e||1===e)return[];const o=Sc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;jt(t.getSelected(),(t=>{const{from:e,to:i}=o(t),r=Math.max(e.row,0),s=i.row-r+1;jt(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e));return Ft(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[dv]:function(){return{key:dv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,o,,n]=t[0];o-n!=0&&(e=1)}return this.getTranslatedPhrase(Jl,e)},callback(){this.alter("remove_col",function(t){const e=Cc(t.getSelected());if(0===e||1===e)return[];const o=Sc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;jt(t.getSelected(),(t=>{const{from:e,to:i}=o(t),r=Math.max(e.col,0),s=i.col-r+1;jt(Array.from(new Array(s),((t,e)=>r+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e));return Ft(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[wv]:function(){return{key:wv,name(){return this.getTranslatedPhrase(ta)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[uv]:function(){return{key:uv,name(){return this.getTranslatedPhrase(ea)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[cv]:function(){return{key:cv,name(){let t=this.getTranslatedPhrase(oa);const e=xw(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=xw(t,((t,e)=>this.getCellMeta(t,e).readOnly));jt(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&this.setCellMeta(t,o,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!(t&&!t.isSingleHeader()&&!this.selection.isSelectedByCorner()&&0!==this.countRows()&&0!==this.countCols()&&this.getSelectedRange()&&0!==this.getSelectedRange().length)}}},[sv]:function(){return{key:sv,name(){return this.getTranslatedPhrase(wa)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${sv}:left`,name(){let t=this.getTranslatedPhrase(va);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htLeft"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${sv}:center`,name(){let t=this.getTranslatedPhrase(ya);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htCenter"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${sv}:right`,name(){let t=this.getTranslatedPhrase(ba);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htRight"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${sv}:justify`,name(){let t=this.getTranslatedPhrase(Ca);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htJustify"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{name:Sw},{key:`${sv}:top`,name(){let t=this.getTranslatedPhrase(Sa);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htTop"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${sv}:middle`,name(){let t=this.getTranslatedPhrase(Ra);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${sv}:bottom`,name(){let t=this.getTranslatedPhrase(Ea);const e=xw(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htBottom"))return!0}));return e&&(t=Tw(t)),t},callback(){const t=this.getSelectedRange(),e=Rw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,o,n),Ew(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1}]}}}};function bv(){const t={};return Se(yv,((e,o)=>{t[o]=e()})),t}function Cv(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Sv{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Cv(this,"hot",void 0),Cv(this,"predefinedItems",bv()),Cv(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,Se(t,((t,o)=>{let n="";t.name===Sw?(e[Sw]=t,n=Sw):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,e[o]=t,n=t.key):(e[t.key]=t,n=t.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=e}getItems(){return function(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=[];let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n&&n.items?n=n.items:Array.isArray(n)||(n=t),be(n)?Se(n,((t,n)=>{let i=e["string"==typeof t?t:n];i||(i=t),be(t)?fe(i,t):"string"==typeof i&&(i={name:i}),void 0===i.key&&(i.key=n),o.push(i)})):jt(n,((t,n)=>{let i=e[t];!i&&vv.indexOf(t)>=0||(i||(i={name:t,key:`${n}`}),be(t)&&fe(i,t),void 0===i.key&&(i.key=n),o.push(i))})),o}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function Rv(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Ev{constructor(t,e){Rv(this,"top",void 0),Rv(this,"topRelative",void 0),Rv(this,"left",void 0),Rv(this,"leftRelative",void 0),Rv(this,"scrollTop",void 0),Rv(this,"scrollLeft",void 0),Rv(this,"cellHeight",void 0),Rv(this,"cellWidth",void 0);const o=e.scrollY,n=e.scrollX;let i,r,s,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),s=parseInt(t.left,10),a=t.height||0,h=t.width||0,r=i,l=s,i+=o,s+=n):"event"===this.type&&(i=parseInt(t.pageY,10),s=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,r=i-o,l=s-n),this.top=i,this.topRelative=r,this.left=s,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=n,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function Tv(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function xv(t,e){return t.get(Hv(t,e))}function Mv(t,e,o){return t.set(Hv(t,e),o),o}function Hv(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var kv=new WeakMap,Iv=new WeakMap,Av=new WeakMap,Ov=new WeakMap,Pv=new WeakMap;class Nv{constructor(t){Tv(this,kv,void 0),Tv(this,Iv,void 0),Tv(this,Av,void 0),Tv(this,Ov,!1),Tv(this,Pv,{above:0,below:0,left:0,right:0}),Mv(Ov,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return xv(Pv,this)[t]=e,this}setElement(t){return Mv(kv,this,t),this}setParentElement(t){return Mv(Iv,this,t),this}updatePosition(t){Mv(Av,this,new Ev(t,xv(kv,this).ownerDocument.defaultView)),xv(Ov,this)?(xv(Av,this).fitsBelow(xv(kv,this))?this.setPositionBelowCursor():xv(Av,this).fitsAbove(xv(kv,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===xv(kv,this).dir?xv(Av,this).fitsOnLeft(xv(kv,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():xv(Av,this).fitsOnRight(xv(kv,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=xv(Pv,this).above+xv(Av,this).top-xv(kv,this).offsetHeight;xv(Iv,this)&&(t=xv(Av,this).top+xv(Av,this).cellHeight-xv(kv,this).offsetHeight+3),xv(kv,this).style.top=`${t}px`}setPositionBelowCursor(){let t=xv(Pv,this).below+xv(Av,this).top+1;xv(Iv,this)&&(t=xv(Av,this).top-1),xv(kv,this).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=xv(Av,this).left;if(xv(Iv,this)){const{right:e}=xv(Iv,this).getBoundingClientRect();t+=xv(Av,this).cellWidth+e-(xv(Av,this).left+xv(Av,this).cellWidth)}else t+=xv(Pv,this).right;xv(kv,this).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=xv(Pv,this).left+xv(Av,this).left-xv(kv,this).offsetWidth;if(xv(Iv,this)){const{left:e}=xv(Iv,this).getBoundingClientRect();t-=xv(Av,this).left-e}xv(kv,this).style.left=`${t}px`}}function _v(t){let{initialPage:e=-1,size:o=(()=>0),onItemSelect:n=(()=>{}),onClear:i=(()=>{})}=t;const r=new Set;let s=tn(e,-1,a()-1);function l(t,e){const o=a()-1;return t<0&&(t=o),t>o&&(t=0),r.has(t)?-1:(r.add(t),!1===n(t,!1)&&(t=l(1===e?++t:--t,e)),t)}function a(){return Math.max(o(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==n(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(r.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(r.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(r.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(r.clear(),s=l(--s,-1))},getSize:a,clear:function(){r.clear(),s=e,i()}}}function Dv(t){return xe(t,"submenu")}function Lv(t){return new RegExp(Sw,"i").test(t.name)}function Vv(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function Fv(t){return xe(t,"disableSelection")}function Wv(t,e){const o=t.slice(0);for(let t=0;t<o.length&&o[t].name===e;)o.shift();return o}const Bv="menu",jv=Bv;function zv(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Uv(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $v(t,e,o){return t.set(Yv(t,e),o),o}function Gv(t,e){return t.get(Yv(t,e))}function Yv(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Kv=new WeakMap,Xv=new WeakMap;class qv{constructor(t,e){var o=this;Uv(this,"hot",void 0),Uv(this,"options",void 0),Uv(this,"eventManager",new yo(this)),Uv(this,"container",void 0),Uv(this,"positioner",void 0),Uv(this,"hotMenu",null),Uv(this,"hotSubMenus",{}),Uv(this,"parentMenu",void 0),Uv(this,"menuItems",null),Uv(this,"origOutsideClickDeselects",null),zv(this,Kv,void 0),zv(this,Xv,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Nv(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=Y(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return Gv(Kv,this)}getKeyboardShortcutsCtrl(){return Gv(Xv,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=he((t=>this.openSubMenu(t)),300),e=this.options.minWidth||215;let o=!1,n=Wt(this.menuItems,(t=>(t.key===mv&&(o=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(t,this.hot))));if(n.length<1&&!o)n.push(bv()[mv]);else if(0===n.length)return;n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sw,o=t.slice(0);return o=Wv(o,e),o=function(t,e){let o=t.slice(0);return o.reverse(),o=Wv(o,e),o.reverse(),o}(o,e),o=function(t){const e=[];return jt(t,((t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}(o),o}(n,Sw);let i=!1;const r={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>Kt(t)&&t<e?e:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(t,e,o,n,i,r)=>{if(e.hasAttribute("ghost-table"))return;const l=t.getSourceDataAtRow(o),a=s.rootDocument.createElement("div"),h="function"==typeof r?r.call(s):r;if(st(e),et(a,"htItemWrapper"),s.getSettings().ariaTags){const t=!Vv(l,s)&&!Fv(l)&&!Lv(l);nt(e,[["role","menuitem"],N(h),...t?[O(-1)]:[],...Vv(l,s)?[["aria-disabled","true"]]:[],...Dv(l)?[B(!1)]:[]])}e.className="",e.appendChild(a),Lv(l)?et(e,"htSeparator"):"function"==typeof l.renderer?(et(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,a,o,n,i,h))):at(a,h),Vv(l,s)?et(e,"htDisabled"):Fv(l)?et(e,"htSelectionDisabled"):Dv(l)&&et(e,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{Gv(Kv,this).setCurrentPage(e.row)},afterOnCellMouseOver:(e,o)=>{this.isAllSubMenusClosed()?t(o.row):this.openSubMenu(o.row)},rowHeights:t=>n[t].name===Sw?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),We()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,o,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{We()&&Ke(t)||!i||!this.hasSelectedItem()||(Le()||Fe()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s,l;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),$v(Kv,this,(l=this.hotMenu,_v({size:()=>l.countRows(),onItemSelect(t,e){const o=l.getCell(t,0);if(!o||function(t){return tt(t,"htSeparator")}(o)||function(t){return tt(t,"htDisabled")}(o)||function(t){return tt(t,"htSelectionDisabled")}(o))return!1;l.selectCell(t,0,...e?[t,0,!1,!1]:[])},onClear(){l.deselectCell()}}))),$v(Xv,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];function n(t,e){s(e).addShortcuts(t,{group:Bv})}function i(t,e){const i=s(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),o.push({shortcuts:t,contextName:e}),n(t,e)}function r(t){return t?`${jv}:${t}`:jv}function s(e){var o;const n=t.hotMenu.getShortcutManager(),i=r(e);return null!==(o=n.getContext(i))&&void 0!==o?o:n.addContext(i)}return n(function(t){const{hot:e,hotMenu:o}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(o,n)=>{const i=e.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(o):i.tabMoves;n.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=o.getSelectedLast();if(e){const o=t.openSubMenu(e[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{o.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=o.getSelectedLast();n&&(o.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{o.getSelectedLast()?o.selection.transformStart(-o.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{o.getSelectedLast()?o.selection.transformStart(o.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}(t)),e.forEach((t=>{let{shortcuts:e,contextName:o}=t;i(e,o)})),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...o]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(r(e))}}}(this)),Gv(Xv,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(Gv(Kv,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();t&&nt(this.parentMenu.hotMenu.getCell(t[0],0),[B(!1)])}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!function(t){return tt(t,"htSubmenu")}(e))return!1;const o=this.hotMenu.getSourceDataAtRow(t),n=new qv(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(o.submenu.items),n.open(),n.setPosition(e.getBoundingClientRect()),this.hotSubMenus[o.key]=n,this.hot.getSettings().ariaTags&&nt(e,[B(!0)]),n}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),o=this.hotSubMenus[e.key];if(o){o.destroy(),delete this.hotSubMenus[e.key];const n=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&nt(n,[B(!1)])}}closeAllSubMenus(){jt(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const o=this.hot.getSelectedRange(),n=o?function(t){return Bt(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}(o):[];this.runLocalHooks("executeCommand",e.key,n,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,n,t)}isCommandPassive(t){return!1===t.isCommand||Lv(t)||Vv(t,this.hot)||Dv(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let o,n=t;return n&&(ae(n)&&(n=n.call(this.hot),n=null===n||Xt(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=e.querySelector(`.${this.options.className}.${n}`)),o||(o=e.createElement("div"),et(o,`htMenu ${this.options.className}`),n&&et(o,n),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,o=t.hider.style,n=t.holder.style,i=parseInt(o.width,10),r=Ft(e,((t,e)=>t+(e.name===Sw?1:26)),0);n.width=`${i+3}px`,n.height=`${r+3}px`,o.height=n.height,this.hot.getSettings().ariaTags&&nt(this.hotMenu.rootElement,[["role","menu"],O(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!q(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||q(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&tt(t.target,"htCore")&&q(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function Qv(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Zv(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}ve(qv,ll);const Jv="contextMenu",ty=Jv;io.getSingleton().register("afterContextMenuDefaultOptions"),io.getSingleton().register("beforeContextMenuShow"),io.getSingleton().register("afterContextMenuShow"),io.getSingleton().register("afterContextMenuHide"),io.getSingleton().register("afterContextMenuExecute");var ey=new WeakSet;class oy extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=ey),e.add(t),Qv(this,"commandExecutor",new rv(this.hot)),Qv(this,"itemsFactory",null),Qv(this,"menu",null)}static get PLUGIN_KEY(){return Jv}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[fv,pv,Sw,av,hv,Sw,gv,dv,Sw,wv,uv,Sw,cv,Sw,sv]}isEnabled(){return!!this.hot.getSettings()[Jv]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Jv];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new qv(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>Zv(ey,this,iy).call(this))),this.menu.addLocalHook("afterOpen",(()=>Zv(ey,this,ry).call(this))),this.menu.addLocalHook("afterClose",(()=>Zv(ey,this,sy).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),this.addHook("afterOnCellContextMenu",(t=>Zv(ey,this,ny).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),o=Mw(this.menu.container,this.hot.rootDocument);this.open({left:e.left+o.left,top:e.top+o.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:ty})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ty)}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),Se(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}prepareMenuItems(){this.itemsFactory=new Sv(this.hot,oy.DEFAULT_ITEMS);const t=this.hot.getSettings()[Jv],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),jt(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function ny(t){const e=this.hot.getSettings(),o=e.rowHeaders,n=e.colHeaders,i=t.target;if(this.close(),tt(i,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!o&&!n&&!(function(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}(i)||tt(i,"current")&&tt(i,"wtBorder")))return;const r=Mw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+r.top,left:t.clientX+r.left})}function iy(){this.hot.runHooks("beforeContextMenuShow",this)}function ry(){this.hot.runHooks("afterContextMenuShow",this)}function sy(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}oy.SEPARATOR={name:Sw};class ly{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class ay{constructor(){this.clipboardData=new ly}}function hy(t,e,o){cy(t,e),e.set(t,o)}function cy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uy(t,e){return t.get(gy(t,e))}function dy(t,e,o){return t.set(gy(t,e),o),o}function gy(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var fy=new WeakMap,py=new WeakMap,my=new WeakMap,wy=new WeakMap,vy=new WeakMap,yy=new WeakMap,by=new WeakSet;class Cy{constructor(t){let{countRows:e,countColumns:o,rowsLimit:n,columnsLimit:i,countColumnHeaders:r}=t;var s;cy(this,s=by),s.add(this),hy(this,fy,void 0),hy(this,py,void 0),hy(this,my,void 0),hy(this,wy,void 0),hy(this,vy,void 0),hy(this,yy,void 0),dy(py,this,e),dy(my,this,o),dy(wy,this,n),dy(vy,this,i),dy(yy,this,r)}setSelectedRange(t){dy(fy,this,t)}getCellsRange(){if(0===uy(py,this).call(this)||0===uy(my,this).call(this))return null;const{row:t,col:e}=uy(fy,this).getTopStartCorner(),{row:o,col:n}=uy(fy,this).getBottomEndCorner(),i=gy(by,this,Ry).call(this,t,o),r=gy(by,this,Sy).call(this,e,n);return{isRangeTrimmed:o!==i||n!==r,startRow:t,startCol:e,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(0===uy(my,this).call(this)||0===uy(yy,this).call(this))return null;const{col:t}=uy(fy,this).getTopStartCorner(),{col:e}=uy(fy,this).getBottomEndCorner(),o=gy(by,this,Sy).call(this,t,e);return{isRangeTrimmed:e!==o,startRow:-1,startCol:t,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===uy(my,this).call(this)||0===uy(yy,this).call(this))return null;const{col:t}=uy(fy,this).getTopStartCorner(),{col:e}=uy(fy,this).getBottomEndCorner(),o=gy(by,this,Sy).call(this,t,e);return{isRangeTrimmed:e!==o,startRow:-uy(yy,this).call(this),startCol:t,endRow:-1,endCol:o}}}function Sy(t,e){return Math.min(e,Math.max(t+uy(vy,this).call(this)-1,t))}function Ry(t,e){return Math.min(e,Math.max(t+uy(wy,this).call(this)-1,t))}function Ey(t){const e=[],o=[];return jt(t,(t=>{Qo(Math.min(t.startRow,t.endRow),Math.max(t.startRow,t.endRow),(t=>{-1===e.indexOf(t)&&e.push(t)})),Qo(Math.min(t.startCol,t.endCol),Math.max(t.startCol,t.endCol),(t=>{-1===o.indexOf(t)&&o.push(t)}))})),{rows:e,columns:o}}function Ty(t,e,o){xy(t,e),e.set(t,o)}function xy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function My(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Hy(t,e){return t.get(Iy(t,e))}function ky(t,e,o){return t.set(Iy(t,e),o),o}function Iy(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("afterCopyLimit"),io.getSingleton().register("modifyCopyableRange"),io.getSingleton().register("beforeCut"),io.getSingleton().register("afterCut"),io.getSingleton().register("beforePaste"),io.getSingleton().register("afterPaste"),io.getSingleton().register("beforeCopy"),io.getSingleton().register("afterCopy");const Ay="copyPaste",Oy=["fragmentSelection"],Py=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Ny=new WeakMap,_y=new WeakMap,Dy=new WeakMap,Ly=new WeakMap,Vy=new WeakMap,Fy=new WeakMap,Wy=new WeakMap,By=new WeakMap,jy=new WeakSet;function zy(t){if(De()){const e=this.hot.getSelectedRangeLast();if(e){const{row:o,col:n}=e.highlight,i=this.hot.getCell(o,n,!0);i&&function(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Nt(t,o),e(),_t(t,o)}(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function Uy(t){const{rows:e}=Ey(t);let o=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)o+=1;return{columnHeadersCount:o}}function $y(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);n&&Nt(n)}}}function Gy(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);null!=n&&n.hasAttribute("contenteditable")&&_t(n)}}}function Yy(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(ia)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1})),Hy(Ny,this)&&t.items.push(function(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?tn(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ra,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),Hy(_y,this)&&t.items.push(function(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?tn(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(sa,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),Hy(Dy,this)&&t.items.push(function(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?tn(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(la,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),t.items.push(function(t){return{key:"cut",name(){return this.getTranslatedPhrase(aa)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}function Ky(t,e,o,n,i){Hy(By,this)&&(i.value=!0),ky(By,this,!1)}function Xy(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function qy(){Iy(jy,this,Gy).call(this)}function Qy(){Iy(jy,this,$y).call(this)}function Zy(){Iy(jy,this,Gy).call(this)}function Jy(t,e){return`border_row${t}col${e}`}function tb(t){var e,o;return(Kt(t.start)||Kt(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left),(Kt(t.end)||Kt(t.right))&&(t.end=null!==(o=t.end)&&void 0!==o?o:t.right),delete t.left,delete t.right,t}function eb(t){return Kt(t.start)&&(t.left=t.start),Kt(t.end)&&(t.right=t.end),t}function ob(t,e){return{id:Jy(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function nb(t,e){let o=!1;return jt(t.getSelectedRange(),(n=>{n.forAll(((n,i)=>{if(n<0||i<0)return;const r=t.getCellMeta(n,i).borders;if(r){if(!e)return o=!0,!1;if(!xe(r[e],"hide")||!1===r[e].hide)return o=!0,!1}}))})),o}function ib(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}const rb=new Map([["left","start"],["right","end"]]);function sb(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Ma);return nb(this,e)&&(t=ib(t)),t},callback(o,n){const i=nb(this,e);t.prepareBorder(n,e,i)}}}function lb(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Ha);return nb(this,"bottom")&&(t=ib(t)),t},callback(e,o){const n=nb(this,"bottom");t.prepareBorder(o,"bottom",n)}}}function ab(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(ka);return nb(this,e)&&(t=ib(t)),t},callback(o,n){const i=nb(this,e);t.prepareBorder(n,e,i)}}}function hb(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Ia)},callback(e,o){t.prepareBorder(o,"noBorders")},disabled(){return!nb(this)}}}function cb(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const ub="customBorders";var db=new WeakSet;function gb(t){var e;this.hot.getSettings()[ub]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Ta)},disabled(){const t=this.getSelectedRangeLast();return!t||!!t.isSingleHeader()||this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(xa);return nb(this,"top")&&(t=ib(t)),t},callback(t,o){const n=nb(this,"top");e.prepareBorder(o,"top",n)}}),sb(this),lb(this),ab(this),hb(this)]}})}function fb(){this.changeBorderSettings()}function pb(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mb(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const wb="dragToScroll";var vb=new WeakSet;function yb(t){if(Ke(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback(((t,o)=>{var n,i;const r=null!==(n=e.scrollLeft)&&void 0!==n?n:e.scrollX,s=null!==(i=e.scrollTop)&&void 0!==i?i:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(o))})),this.listen()}function bb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cb(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Sb(t,e,o){return t.set(Rb(t,e),o),o}function Rb(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("afterDropdownMenuDefaultOptions"),io.getSingleton().register("beforeDropdownMenuShow"),io.getSingleton().register("afterDropdownMenuShow"),io.getSingleton().register("afterDropdownMenuHide"),io.getSingleton().register("afterDropdownMenuExecute");const Eb="dropdownMenu",Tb="changeType",xb=Eb;var Mb=new WeakMap,Hb=new WeakSet;class kb extends fp{static get PLUGIN_KEY(){return Eb}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[av,hv,Sw,dv,Sw,lv,Sw,cv,Sw,sv]}constructor(t){var e;super(t),bb(this,e=Hb),e.add(this),Cb(this,"commandExecutor",new rv(this.hot)),Cb(this,"itemsFactory",null),Cb(this,"menu",null),function(t,e,o){bb(t,e),e.set(t,!1)}(this,Mb),this.hot.addHook("afterGetColHeader",((t,e)=>Rb(Hb,this,Ob).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[Eb]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new Sv(this.hot,kb.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Rb(Hb,t,Vb).call(t,...o)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Rb(Hb,t,Lb).call(t,...o)}));const e=this.hot.getSettings()[Eb],o={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const n=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new qv(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>Rb(Hb,this,Pb).call(this))),this.menu.addLocalHook("afterOpen",(()=>Rb(Hb,this,Nb).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>Rb(Hb,this,_b).call(this,t))),this.menu.addLocalHook("afterClose",(()=>Rb(Hb,this,Db).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),jt(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),o=Mw(this.menu.container,this.hot.rootDocument),n=this.hot.getCell(-1,e.col,!0),i=n.getBoundingClientRect();this.open({left:i.left+o.left,top:i.top+n.offsetHeight+o.top},{left:i.width}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:xb},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:xb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>Rb(Hb,this,Ab).call(this,t)))}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),Se(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Ib(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Ab(t){if(tt(t.target,Tb)){const e=Mw(this.menu.container,this.hot.rootDocument),o=t.target.getBoundingClientRect();t.stopPropagation(),Sb(Mb,this,!1),this.open({left:o.left+e.left,top:o.top+t.target.offsetHeight+3+e.top},{left:o.width})}}function Ob(t,e){const o=e.parentNode;if(!o)return;const n=o.parentNode.childNodes,i=Array.prototype.indexOf.call(n,o);if(t<0||i!==n.length-1)return;const r=e.querySelector(`.${Tb}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=Tb,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(nt(s,[_(),N(" ")]),nt(e,[D("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Pb(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Nb(){this.hot.runHooks("afterDropdownMenuShow",this),Rb(Hb,this,Ib).call(this,this.menu)}function _b(t){Rb(Hb,this,Ib).call(this,t)}function Db(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Lb(t){return this,(e=Mb).get(Rb(e,this))?null:t;var e}function Vb(t){tt(t.target,Tb)&&Sb(Mb,this,!0)}function Fb(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}kb.SEPARATOR={name:Sw};const Wb=class{constructor(t){Fb(this,"hot",void 0),Fb(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:o,endCol:n}=this._getDataRange(),i=this.options,r=[];return Qo(t,o,(t=>{const o=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(Qo(e,n,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||o.push(this.hot.getDataAtCell(t,e))})),r.push(o))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:o}=this._getDataRange(),n=this.hot.getRowHeader();Qo(e,o,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:o}=this._getDataRange(),n=this.hot.getColHeader();Qo(e,o,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[o=0,n=0,i=e,r=t]=this.options.range;return o=Math.max(o,0),n=Math.max(n,0),i=Math.min(i,e),r=Math.min(r,t),{startRow:o,startCol:n,endRow:i,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}};function Bb(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class jb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){Bb(this,"dataProvider",void 0),Bb(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=we(this.constructor.DEFAULT_OPTIONS);const o=new Date;return e=fe(we(jb.DEFAULT_OPTIONS),e),e=fe(e,t),e.filename=k(e.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),e}}const zb=jb,Ub=String.fromCharCode(13),$b=String.fromCharCode(34),Gb=String.fromCharCode(10),Yb={csv:class extends zb{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const n=o.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let s=t.bom?String.fromCharCode(65279):"";return n&&(o=Bt(o,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=o.join(t.columnDelimiter),s+=t.rowDelimiter),jt(e,((e,o)=>{o>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(i[o])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Yt(t);return""!==o&&(e||o.indexOf(Ub)>=0||o.indexOf($b)>=0||o.indexOf(Gb)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}};function Kb(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class Xb{constructor(t,e){let{id:o,stateless:n=!0}=e;Kb(this,"hot",void 0),Kb(this,"id",void 0),Kb(this,"elements",[]),Kb(this,"hidden",!1),Kb(this,"stateId",""),Kb(this,"state",void 0),this.hot=t,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new yl)}getElements(){return this.elements}reset(){jt(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),jt(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}ve(Xb,ll);const qb={};function Qb(t,e){if(!qb[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:o,descriptor:n}=qb[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(t){return o.apply(t.meta.instance,[].concat([t],[i]))}}function Zb(t){if(!qb[t])throw Error(`Filter condition "${t}" does not exist.`);return qb[t].descriptor}function Jb(t,e,o){o.key=t,qb[t]={condition:e,descriptor:o}}const tC="none";Jb(tC,(function(){return!0}),{name:Fa,inputsCount:0,showOperators:!1});const eC="empty";Jb(eC,(function(t){return qt(t.value)}),{name:Wa,inputsCount:0,showOperators:!0});const oC="not_empty";Jb(oC,(function(t,e){return!Qb(eC,e)(t)}),{name:Ba,inputsCount:0,showOperators:!0});const nC="eq";Jb(nC,(function(t,e){let[o]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale)===Yt(o)}),{name:ja,inputsCount:1,showOperators:!0});const iC="neq";Jb(iC,(function(t,e){return!Qb(nC,e)(t)}),{name:za,inputsCount:1,showOperators:!0}),Jb("gt",(function(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}),{name:Xa,inputsCount:1,showOperators:!0}),Jb("gte",(function(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}),{name:qa,inputsCount:1,showOperators:!0}),Jb("lt",(function(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}),{name:Qa,inputsCount:1,showOperators:!0}),Jb("lte",(function(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}),{name:Za,inputsCount:1,showOperators:!0});const rC="date_after";Jb(rC,(function(t,e){let[o]=e;const n=Dt(t.value,t.meta.dateFormat),i=Dt(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)>=0}),{name:eh,inputsCount:1,showOperators:!0});const sC="date_before";Jb(sC,(function(t,e){let[o]=e;const n=Dt(t.value,t.meta.dateFormat),i=Dt(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)<=0}),{name:oh,inputsCount:1,showOperators:!0});const lC="between";Jb(lC,(function(t,e){let[o,n]=e,i=o,r=n;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(r,10);i=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=Qb(sC,[r]),o=Qb(rC,[i]);return e(t)&&o(t)}return t.value>=i&&t.value<=r}),{name:Ja,inputsCount:2,showOperators:!0});const aC="not_between";Jb(aC,(function(t,e){return!Qb(lC,e)(t)}),{name:th,inputsCount:2,showOperators:!0});const hC="begins_with";Jb(hC,(function(t,e){let[o]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Yt(o))}),{name:Ua,inputsCount:1,showOperators:!0});const cC="ends_with";Jb(cC,(function(t,e){let[o]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Yt(o))}),{name:$a,inputsCount:1,showOperators:!0});const uC="contains";Jb(uC,(function(t,e){let[o]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Yt(o))>=0}),{name:Ga,inputsCount:1,showOperators:!0});const dC="not_contains";Jb(dC,(function(t,e){return!Qb(uC,e)(t)}),{name:Ya,inputsCount:1,showOperators:!0});const gC="date_tomorrow";Jb(gC,(function(t){const e=Dt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Dt().subtract(-1,"days").startOf("day"),"d")}),{name:ih,inputsCount:0});const fC="date_today";Jb(fC,(function(t){const e=Dt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Dt().startOf("day"),"d")}),{name:nh,inputsCount:0});const pC="date_yesterday";Jb(pC,(function(t){const e=Dt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Dt().subtract(1,"days").startOf("day"),"d")}),{name:rh,inputsCount:0});const mC="text",wC={numeric:[tC,Sw,eC,oC,Sw,nC,iC,Sw,"gt","gte","lt","lte",lC,aC],[mC]:[tC,Sw,eC,oC,Sw,nC,iC,Sw,hC,cC,Sw,uC,dC],date:[tC,Sw,eC,oC,Sw,nC,iC,Sw,sC,rC,lC,Sw,gC,fC,pC]};function vC(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const yC="built",bC="building",CC=["click","input","keydown","keypress","keyup","focus","blur","change"];class SC{static get DEFAULTS(){return we({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){vC(this,"hot",void 0),vC(this,"eventManager",new yo(this)),vC(this,"options",void 0),vC(this,"_element",void 0),vC(this,"buildState",void 0),this.hot=t,this.options=fe(SC.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===bC?this._element:this.buildState===yC?(this.update(),this._element):(this.buildState=bC,this.build(),this.buildState=yC,this._element)}isBuilt(){return this.buildState===yC}translateIfPossible(t){return"string"==typeof t&&t.startsWith(La)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=bC),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&et(this._element,this.options.className),this.options.children.length)jt(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),Se(this.options,((t,o)=>{void 0!==e[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(e[o]=this.translateIfPossible(t))})),this._element.appendChild(e),jt(CC,(o=>t(e,o)))}else jt(CC,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function RC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EC(t,e){return t.get(TC(t,e))}function TC(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}ve(SC,ll);var xC=new WeakMap,MC=new WeakSet;class HC extends SC{static get DEFAULTS(){return we({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){var o;super(t,fe(HC.DEFAULTS,e)),RC(this,o=MC),o.add(this),function(t,e,o){RC(t,e),e.set(t,void 0)}(this,xC),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>TC(MC,this,kC).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");!function(t,e,o){t.set(TC(t,e),o)}(xC,this,this._element.firstChild),et(this._element,"htUIInput"),et(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(EC(xC,this).type=this.options.type,EC(xC,this).placeholder=this.translateIfPossible(this.options.placeholder),EC(xC,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&EC(xC,this).focus()}}function kC(t){this.options.value=t.target.value}function IC(t,e,o){AC(t,e),e.set(t,o)}function AC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OC(t,e,o){return t.set(NC(t,e),o),o}function PC(t,e){return t.get(NC(t,e))}function NC(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var _C=new WeakMap,DC=new WeakMap,LC=new WeakMap,VC=new WeakMap,FC=new WeakMap,WC=new WeakSet;class BC extends SC{static get DEFAULTS(){return we({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){var o;super(t,fe(BC.DEFAULTS,e)),AC(this,o=WC),o.add(this),IC(this,_C,null),IC(this,DC,[]),IC(this,LC,void 0),IC(this,VC,void 0),IC(this,FC,void 0),this.registerHooks()}getMenu(){return PC(_C,this)}registerHooks(){this.addLocalHook("click",(()=>NC(WC,this,UC).call(this)))}setItems(t){OC(DC,this,this.translateNames(t)),PC(_C,this)&&PC(_C,this).setMenuItems(PC(DC,this))}translateNames(t){return jt(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),OC(_C,this,new qv(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),PC(_C,this).setMenuItems(PC(DC,this));const t=new SC(this.hot,{className:"htUISelectCaption"}),e=new SC(this.hot,{className:"htUISelectDropdown"});OC(LC,this,t),OC(VC,this,t.element),OC(FC,this,e),this.hot.getSettings().ariaTags&&(nt(e.element,[_()]),nt(this._element,[["role","listbox"]])),jt([t,e],(t=>this._element.appendChild(t.element))),PC(_C,this).addLocalHook("select",(t=>NC(WC,this,jC).call(this,t))),PC(_C,this).addLocalHook("afterClose",(()=>NC(WC,this,zC).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:PC(_C,this).hot.getTranslatedPhrase(Fa),PC(VC,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();PC(_C,this)&&(PC(_C,this).open(),PC(_C,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),PC(_C,this).getNavigator().toFirstItem(),PC(_C,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){PC(_C,this)&&PC(_C,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){PC(_C,this)&&(PC(_C,this).destroy(),OC(_C,this,null)),PC(LC,this)&&PC(LC,this).destroy(),PC(FC,this)&&PC(FC,this).destroy(),super.destroy()}}function jC(t){t.name!==Sw&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function zC(){this.runLocalHooks("afterClose")}function UC(){this.openOptions()}function $C(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function GC(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var YC=new WeakSet;class KC extends Xb{constructor(t,e){var o,n;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,n=YC),n.add(o),$C(this,"name",""),$C(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new BC(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new HC(this.hot,{placeholder:mh})),this.elements.push(new HC(this.hot,{placeholder:wh})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>GC(YC,this,XC).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),jt(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>GC(YC,this,qC).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=we(t.command);e.name.startsWith(Va)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),jt(t.args,((t,o)=>{if(o>e.inputsCount-1)return!1;const n=this.getInputElement(o);n.setValue(t),n[e.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout((()=>n.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||Zb(tC),e=[];return jt(this.getInputElements(),((o,n)=>{t.inputsCount>n&&e.push(o.getValue())})),{command:t,args:e}}updateState(t,e){const o=Zb(t?t.name:tC);this.state.setValueAtIndex(e,{command:o,args:t?t.args:[]}),t||jt(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof BC))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof HC))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{et(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&et(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return et(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),jt(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[Zb(tC)];if(null!==t){const{visualIndex:o}=t;e=function(t){const e=[];let o=t;return wC[o]||(o=mC),jt(wC[o],(t=>{let o;o=t===Sw?{name:Sw}:we(Zb(t)),e.push(o)})),e}(this.hot.getDataType(0,o,this.hot.countRows(),o))}jt(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function XC(t){jt(this.getInputElements(),((e,o)=>{e[t.inputsCount>o?"show":"hide"](),0===o&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function qC(t){$e(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ge(t))}const QC={};function ZC(t,e,o){QC[t]={name:e,func:o}}const JC="conjunction";ZC(JC,ah,(function(t,e){return t.every((t=>t.func(e)))}));const tS="disjunction";ZC(tS,hh,(function(t,e){return t.some((t=>t.func(e)))}));const eS="disjunctionWithExtraCondition";function oS(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function nS(t,e){return t.get(rS(t,e))}function iS(t,e,o){return t.set(rS(t,e),o),o}function rS(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}ZC(eS,hh,(function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}));var sS=new WeakMap,lS=new WeakMap;class aS extends SC{static get DEFAULTS(){return we({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,fe(aS.DEFAULTS,e)),oS(this,sS,void 0),oS(this,lS,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),iS(lS,this,t),iS(sS,this,this._element.firstChild),nS(sS,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(nS(lS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&nS(sS,this).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(nS(sS,this).checked=t)}focus(){this.isBuilt()&&nS(sS,this).focus()}}var hS=new WeakSet;class cS extends Xb{constructor(t,e){var o,n;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,n=hS),n.add(o),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(et(e.parentNode,"htFiltersMenuOperators"),jt(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[JC,tS];jt(t,(e=>{const o=new aS(this.hot,{name:"operator",label:{htmlFor:e,textContent:(n=e,QC[n].name)},value:e,checked:e===t[0],id:e});var n;o.addLocalHook("change",(t=>function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(hS,this,uS).call(this,t))),this.elements.push(o)}))}setChecked(t){if(this.elements.length<t)throw Error(Gt`Radio button with index ${t} doesn't exist.`);jt(this.elements,((e,o)=>{e.setChecked(o===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof aS&&t.isChecked()));return t?t.getValue():JC}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&jt(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>1?arguments[1]:void 0,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:JC;e===eS&&(e=tS),this.state.setValueAtIndex(t,e)}reset(){this.setChecked(0)}}function uS(t){this.setState(t.target.value)}function dS(t,e){let o=t;return""===o&&(o=`(${e})`),o}!function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ie||(Ie="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}();const gS=new Set([1]).has(1),fS=gS&&"function"==typeof Array.from;function pS(t){let e=t;return gS&&(e=new Set(e)),function(t){let o;return o=gS?e.has(t):!!~e.indexOf(t),o}}function mS(t){return null==t?"":t}function wS(t){let e=t;return e=fS?Array.from(new Set(e)):zt(e),e=e.sort(((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)),e}function vS(t,e,o,n){const i=[],r=t===e;let s;return r||(s=pS(e)),jt(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const l={checked:e,value:t,visualValue:dS(t,o)};n&&n(l),i.push(l)})),i}function yS(t,e){return t.get(bS(t,e))}function bS(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var CS=new WeakMap;class SS extends SC{static get DEFAULTS(){return we({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){var o,n,i;super(t,fe(SS.DEFAULTS,e)),i=void 0,function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,n=CS),n.set(o,i)}build(){super.build(),function(t,e,o){t.set(bS(t,e),o)}(CS,this,this._element.firstChild)}update(){this.isBuilt()&&(yS(CS,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&yS(CS,this).focus()}activate(){yS(CS,this).click()}}function RS(t,e,o){ES(t,e),e.set(t,o)}function ES(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TS(t,e){return t.get(MS(t,e))}function xS(t,e,o){return t.set(MS(t,e),o),o}function MS(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const HS="multipleSelect.itemBox";var kS=new WeakMap,IS=new WeakMap,AS=new WeakMap,OS=new WeakMap,PS=new WeakMap,NS=new WeakMap,_S=new WeakSet;class DS extends SC{static get DEFAULTS(){return we({className:"htUIMultipleSelect",value:[]})}constructor(t,e){var o;super(t,fe(DS.DEFAULTS,e)),ES(this,o=_S),o.add(this),RS(this,kS,[]),RS(this,IS,void 0),RS(this,AS,void 0),RS(this,OS,void 0),RS(this,PS,void 0),RS(this,NS,void 0),xS(OS,this,new HC(this.hot,{placeholder:ph,className:"htUIMultipleSelectSearch"})),xS(PS,this,new SS(this.hot,{textContent:uh,className:"htUISelectAll"})),xS(NS,this,new SS(this.hot,{textContent:dh,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return TS(IS,this)}registerHooks(){TS(OS,this).addLocalHook("keydown",(t=>MS(_S,this,VS).call(this,t))),TS(OS,this).addLocalHook("input",(t=>MS(_S,this,LS).call(this,t))),TS(PS,this).addLocalHook("click",(t=>MS(_S,this,FS).call(this,t))),TS(NS,this).addLocalHook("click",(t=>MS(_S,this,WS).call(this,t)))}setItems(t){xS(kS,this,t),TS(IS,this)&&TS(IS,this).loadData(TS(kS,this))}setLocale(t){xS(AS,this,t)}getLocale(){return TS(AS,this)}getItems(){return[...TS(kS,this)]}getValue(){return function(t){const e=[];return jt(t,(t=>{t.checked&&e.push(t.value)})),e}(TS(kS,this))}getSearchInputElement(){return TS(OS,this)}getSelectAllElement(){return TS(PS,this)}getClearAllElement(){return TS(NS,this)}isSelectedAllValues(){return TS(kS,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),o=new SC(this.hot,{className:"htUISelectionControls",children:[TS(PS,this),TS(NS,this)]});this._element.appendChild(TS(OS,this).element),this._element.appendChild(o.element),this._element.appendChild(e);const n=e=>{if(!this._element)return;TS(IS,this)&&TS(IS,this).destroy(),et(e,"htUIMultipleSelectHot"),xS(IS,this,new this.hot.constructor(e,{data:TS(kS,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,o,n,i,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{TS(IS,this).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>TS(IS,this).container.scrollWidth-Ht(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),TS(IS,this).init();const o=TS(IS,this).getShortcutManager().getContext("grid");o.removeShortcutsByKeys(["Tab"]),o.removeShortcutsByKeys(["Shift","Tab"]),o.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:HS}),o.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{TS(IS,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:HS})};n(e),this.hot._registerTimeout((()=>n(e)),100)}focus(){this.isBuilt()&&TS(IS,this).listen()}reset(){TS(OS,this).reset(),TS(PS,this).reset(),TS(NS,this).reset()}update(){this.isBuilt()&&(TS(IS,this).loadData(function(t,e){const o=pS(e);return Bt(t,(t=>(t.checked=o(t.value),t)))}(TS(kS,this),this.options.value)),super.update())}destroy(){TS(IS,this)&&TS(IS,this).destroy(),TS(OS,this).destroy(),TS(NS,this).destroy(),TS(PS,this).destroy(),xS(OS,this,null),xS(NS,this,null),xS(PS,this,null),xS(IS,this,null),xS(kS,this,null),super.destroy()}}function LS(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let o;o=""===e?[...TS(kS,this)]:Wt(TS(kS,this),(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),TS(IS,this).loadData(o)}function VS(t){this.runLocalHooks("keydown",t,this),ce($e,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ge(t),TS(IS,this).listen(),TS(IS,this).selectCell(0,0))}function FS(t){const e=[];t.preventDefault(),jt(TS(IS,this).getSourceData(),((t,o)=>{t.checked=!0,e.push(ol(t,o)[0])})),TS(IS,this).setSourceDataAtCell(e)}function WS(t){const e=[];t.preventDefault(),jt(TS(IS,this).getSourceData(),((t,o)=>{t.checked=!1,e.push(ol(t,o)[0])})),TS(IS,this).setSourceDataAtCell(e)}const BS="by_value";function jS(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}Jb(BS,(function(t,e){let[o]=e;return o(t.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[pS(e)]},showOperators:!1});var zS,US=new WeakSet;class $S extends Xb{constructor(t,e){var o,n;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,n=US),n.add(o),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"name",""),this.name=e.name,this.elements.push(new DS(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>jS(US,this,GS).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t))),this.hot.addHook("modifyFiltersMultiSelectValue",((t,e)=>jS(US,this,KS).call(this,t,e)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===BS){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?tC:BS},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,o,n,i,r)=>{const[s]=Wt(o,(t=>t.name===BS)),l={},a=this.hot.getTranslatedPhrase(ch);if(s){const o=i(e,r),h=Bt(o,(t=>t.value)),c=new Map(o.map((t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)]))),u=wS(h);n&&(s.args[0]=n);const d=[],g=vS(u,s.args[0],a,(t=>{t.checked&&d.push(t.value),jS(US,this,YS).call(this,t,c)})),f=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,f).locale,l.args=[d],l.command=Zb(BS),l.itemsSnapshot=g}else l.args=[],l.command=Zb(tC);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof DS))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,r)=>{et(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return et(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),jt(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(ch),e=this._getColumnVisibleValues(),o=e.map((t=>t.value)),n=new Map(e.map((t=>[t.value,t.meta]))),i=wS(o),r=vS(i,i,t,(t=>{jS(US,this,YS).call(this,t,n)}));this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Bt(this.hot.getDataAtCol(t.visualIndex),((e,o)=>({value:mS(e),meta:this.hot.getCellMeta(o,t.visualIndex)})))}}function GS(t){$e(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ge(t))}function YS(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function KS(t,e){return"numeric"===e.type?Lf(t,e):t}var XS=new WeakSet;class qS extends Xb{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){var o,n;super(t,{id:e.id,stateless:!0}),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(o=this,n=XS),n.add(o),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"name",""),this.name=e.name,this.elements.push(new HC(this.hot,{type:"button",value:gh,className:"htUIButton htUIButtonOK",identifier:qS.BUTTON_OK})),this.elements.push(new HC(this.hot,{type:"button",value:fh,className:"htUIButton htUIButtonCancel",identifier:qS.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){jt(this.elements,(t=>{t.addLocalHook("click",((t,e)=>function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(XS,this,QS).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(et(e.parentNode,"htFiltersMenuActionBar"),jt(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function QS(t,e){e.options.identifier===zS.BUTTON_OK?this.accept():this.cancel()}function ZS(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}zS=qS;const JS="ConditionCollection.filteringStates";class tR{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ZS(this,"hot",void 0),ZS(this,"isMapRegistrable",void 0),ZS(this,"filteringStates",new yl),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(JS,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var o;const n=this.filteringStates.getValueAtIndex(e),i=null!==(o=null==n?void 0:n.conditions)&&void 0!==o?o:[],r=null==n?void 0:n.operation;return this.isMatchInConditions(i,t,r)}isMatchInConditions(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JC;return!t.length||function(t){if(!QC[t])throw Error(`Operation with id "${t}" does not exist.`);const e=QC[t].func;return function(t,o){return e(t,o)}}(o)(t,e)}addCondition(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JC,n=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,r=Bt(e.args,(t=>"string"==typeof t?t.toLocaleLowerCase(i):t)),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==o)throw Error(Gt`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Xt(QC[o]))throw new Error(Gt`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:o,conditions:[{name:s,args:r,func:Qb(s,r)}]},n):a.push({name:s,args:r,func:Qb(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,o;return null!==(e=null===(o=this.filteringStates.getValueAtIndex(t))||void 0===o?void 0:o.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return Ft(this.filteringStates.getEntries(),((t,e)=>{let[o,{operation:n,conditions:i}]=e;return t.push({column:o,operation:n,conditions:Bt(i,(t=>{let{name:e,args:o}=t;return{name:e,args:o}}))}),t}),[])}importAllConditions(t){this.clean(),jt(t,(t=>{jt(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const o=this.getConditions(t);return e?o.some((t=>t.name===e)):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(JS),this.filteringStates=null,this.clearLocalHooks()}}ve(tR,ll);const eR=tR;function oR(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const nR=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];oR(this,"conditionCollection",void 0),oR(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return jt(this.conditionCollection.getFilteredColumns(),((e,o)=>{let n=this.columnDataFactory(e);o&&(n=this._getIntersectData(n,t)),t=this.filterByColumn(e,n)})),t}filterByColumn(t){const e=[];return jt(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(o=>{void 0!==o&&this.conditionCollection.isMatch(o,t)&&e.push(o)})),e}_getIntersectData(t,e){const o=[];return jt(e,(e=>{const n=e.meta.visualRow;void 0!==t[n]&&(o[n]=t[n])})),o}};function iR(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rR(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var sR=new WeakSet;class lR{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];var n,i;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(n=this,i=sR),i.add(n),iR(this,"hot",void 0),iR(this,"conditionCollection",void 0),iR(this,"columnDataFactory",void 0),iR(this,"changes",[]),iR(this,"grouping",!1),iR(this,"latestEditedColumnPosition",-1),iR(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=o,this.conditionCollection.addLocalHook("beforeRemove",(t=>rR(sR,this,aR).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>rR(sR,this,hR).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>rR(sR,this,cR).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,jt(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const n=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const r=n.slice(0,i),s=n.slice(i);s.length&&s[0].column===t&&s.shift();const l=function(t){const e=t.length;return function o(n){return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const l=n.concat(r);let a;return a=l.length>=e?t.apply(this,l):o(l),a}}([])}((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new eR(o.hot,!1),r=[].concat(t,n);i.importAllConditions(r);const s=o.columnDataFactory(e);let l;l=i.isEmpty()?s:new nR(i,(t=>o.columnDataFactory(t))).filter(),l=Bt(l,(t=>t.meta.visualRow));const a=pS(l);return i.destroy(),Wt(s,(t=>a(t.meta.visualRow)))}))(r),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),Se(this,((t,e)=>{this[e]=null}))}}function aR(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function hR(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function cR(){jt(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}ve(lR,ll);const uR=lR,dR="filters";function gR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fR(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function pR(t,e){return t.get(mR(t,e))}function mR(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const wR="filters",vR=wR;var yR=new WeakMap,bR=new WeakSet;function CR(t){t&&jt(t,(t=>{const[,e]=t,o=this.hot.propToCol(e);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)}))}function SR(){this.restoreComponents(Array.from(this.components.values()))}function RR(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ER(t){t.items.push({name:Sw}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function TR(t){var e;if("accept"===t){const t=this.getSelectedColumn();var o;if(null===t)return void(null===(o=this.dropdownMenuPlugin)||void 0===o||o.close());const{physicalIndex:e}=t,n=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,i,r);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),n.command.key!==tC&&(this.conditionCollection.addCondition(e,n,s,l),i.command.key!==tC&&this.conditionCollection.addCondition(e,i,s,l)),r.command.key!==tC&&this.conditionCollection.addCondition(e,r,s,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function xR(t,e){this.updateDependentComponentsVisibility(),t.constructor!==KC||e.inputsCount||this.setListeningDropdownMenu()}function MR(){this.setListeningDropdownMenu()}function HR(t,e){const o=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(o)?et(e,"htFiltersActive"):ot(e,"htFiltersActive")}function kR(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:o,column:n}}=t,i=o.filter((t=>t.name===BS)),r=o.filter((t=>t.name!==BS));if(i.length>=2||r.length>=3)qe(Gt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(r[0],n),this.components.get("filter_by_condition2").updateState(r[1],n),this.components.get("filter_operators").updateState(e,n),this.components.get("filter_by_value").updateState(t)}}const IR="internal-use-in-handsontable",AR={licenseKey:IR,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function OR(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[CE])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function PR(t){return Object.keys(t).reduce(((e,o)=>("hyperformula"!==o&&(e[o]=t[o]),e)),{})}function NR(){const t="engine_relationship",e=so(CE);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function _R(){const t="shared_engine_usage",e=so(CE);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function DR(t){var e;const o=NR(),n=0===o.size?[]:Array.from(null!==(e=o.get(t))&&void 0!==e?e:[]);return new Map(n.map((t=>[t.getPlugin("formulas").sheetId,t])))}function LR(t,e){if(t){const o=NR(),n=o.get(t),i=_R(),r=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),0===n.length&&o.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(i.delete(t),t.destroy()))}}const VR="DD/MM/YYYY";function FR(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function WR(t,e){return"string"==typeof t&&"date"===e}function BR(t,e){return Dt(t,e,!0).isValid()}function jR(t,e){return Dt(t,e,!0).format(VR)}function zR(t,e){const o=new Date(Date.UTC(0,0,t+-1));return Dt(o).format(e)}function UR(t,e,o){const n=function(t,e){const o=[];return t.forEach((t=>{const n={from:t,to:e};o.forEach((t=>{const e=t.from>t.to,o=t.to<=n.from;t.from>n.from&&o&&e&&(n.from+=1)})),n.from>=e&&(e+=1),o.push(n)})),o}(t,function(t,e,o){const n=Array.from(Array(o).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=n[e])&&void 0!==i?i:0:n[e-1]+1}(t,e,o));return function(t){return t.forEach(((e,o)=>{t.slice(o+1).forEach((t=>{const o=t.from<t.to;t.from>e.from&&o&&(t.from-=1)}))})),t}(n)}function $R(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function GR(t,e){return t.get(KR(t,e))}function YR(t,e,o){return t.set(KR(t,e),o),o}function KR(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var XR=new WeakMap,qR=new WeakMap,QR=new WeakMap,ZR=new WeakMap,JR=new WeakMap,tE=new WeakMap,eE=new WeakMap;const oE=class{constructor(t,e,o){$R(this,XR,void 0),$R(this,qR,void 0),$R(this,QR,void 0),$R(this,ZR,[]),$R(this,JR,[]),$R(this,tE,void 0),$R(this,eE,[]),YR(XR,this,t),YR(qR,this,e),YR(QR,this,o)}setRemovedHfIndexes(t){return YR(eE,this,t.map((t=>{const e=GR(qR,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),GR(eE,this)}getRemovedHfIndexes(){return GR(eE,this)}getHfIndexFromVisualIndex(t){const e=GR(qR,this).getIndexesSequence(),o=GR(qR,this).getNotTrimmedIndexes();return e.indexOf(o[t])}syncMoves(t){const e=`move${x(GR(XR,this))}s`;GR(QR,this).getEngine().batch((()=>{t.forEach((t=>{const o=t.from!==t.to,n=t.from+1!==t.to;o&&n&&GR(QR,this).getEngine()[e](GR(QR,this).getSheetId(),t.from,1,t.to)}))}))}storeMovesInformation(t,e,o){!1!==o&&(YR(JR,this,t.map((t=>this.getHfIndexFromVisualIndex(t)))),YR(tE,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(GR(QR,this).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const o=UR(GR(JR,this),GR(tE,this),GR(qR,this).getNumberOfIndexes());null===GR(QR,this).getSheetId()?GR(QR,this).getPostponeAction((()=>this.syncMoves(o))):this.syncMoves(o)}getIndexesChangeSyncMethod(){const t=`set${x(GR(XR,this))}Order`;return e=>{if(GR(QR,this).isPerformingUndoRedo())return;const o=GR(qR,this).getIndexesSequence();if("update"===e&&o.length>0){const e=GR(ZR,this).map((t=>o.indexOf(t))),n=GR(QR,this).getEngine().getSheetDimensions(GR(QR,this).getSheetId());let i;i="row"===GR(XR,this)?n.height:n.width;for(let t=e.length;t<i;t+=1)e.push(t);GR(QR,this).getEngine()[t](GR(QR,this).getSheetId(),e)}YR(ZR,this,o)}}init(){YR(ZR,this,GR(qR,this).getIndexesSequence())}};function nE(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function iE(t,e){return t.get(sE(t,e))}function rE(t,e,o){return t.set(sE(t,e),o),o}function sE(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var lE=new WeakMap,aE=new WeakMap,hE=new WeakMap,cE=new WeakMap,uE=new WeakMap,dE=new WeakMap,gE=new WeakMap;const fE=class{constructor(t,e,o){nE(this,lE,void 0),nE(this,aE,void 0),nE(this,hE,void 0),nE(this,cE,!1),nE(this,uE,!1),nE(this,dE,null),nE(this,gE,null),rE(lE,this,new oE("row",t,this)),rE(aE,this,new oE("column",e,this)),rE(hE,this,o)}getForAxis(t){return iE("row"===t?lE:aE,this)}setPerformUndo(t){rE(cE,this,t)}setPerformRedo(t){rE(uE,this,t)}isPerformingUndoRedo(){return iE(cE,this)||iE(uE,this)}getSheetId(){return iE(gE,this)}getEngine(){return iE(dE,this)}getPostponeAction(){return iE(hE,this)}setupSyncEndpoint(t,e){rE(dE,this,t),rE(gE,this,e),iE(lE,this).init(),iE(aE,this).init()}};function pE(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mE(t,e,o){wE(t,e),e.set(t,o)}function wE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vE(t,e,o){return t.set(bE(t,e),o),o}function yE(t,e){return t.get(bE(t,e))}function bE(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const CE="formulas",SE=["maxRows","maxColumns","language"];io.getSingleton().register("afterNamedExpressionAdded"),io.getSingleton().register("afterNamedExpressionRemoved"),io.getSingleton().register("afterSheetAdded"),io.getSingleton().register("afterSheetRemoved"),io.getSingleton().register("afterSheetRenamed"),io.getSingleton().register("afterFormulasValuesUpdate");const RE=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var EE=new WeakMap,TE=new WeakMap,xE=new WeakMap,ME=new WeakSet;function HE(t,e,o){const n=this.hot.propToCol(o);if(this.isFormulaCellType(e,n)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let i=this.engine.getCellValue(t);return"date"===o.type&&qo(i)&&(i=zR(i,o.dateFormat)),"object"==typeof i&&null!==i?i.value:i}return t}function kE(t,e,o){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:l,col:a}=o.getTopStartCorner(),{row:h,col:c}=o.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:p}=u.start,{row:m,col:w}=u.end,v=m-f+1,y=w-p+1;for(let t=0;t<g.length;t+=1)for(let e=0;e<g[t].length;e+=1){const o=g[t][e],n=t%v,i=e%y,r=this.hot.getCellMeta(n,i);WR(o,r.type)&&(o.startsWith("'")?g[t][e]=o.slice(1):!1===this.isFormulaCellType(n,i,this.sheetId)&&(g[t][e]=(b=o,C=r.dateFormat,Dt(b,VR,!0).format(C))))}var b,C;return g}function IE(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(x(CE))||vE(TE,this,Xt(this.hot.getSettings().data))}function AE(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((o,n)=>{o.forEach(((o,i)=>{const r=this.hot.getCellMeta(n,i),s=r.dateFormat;WR(o,r.type)&&(e=!0,BR(o,s)?t[n][i]=jR(o,s):!1===this.isFormulaCellType(n,i)&&(t[n][i]=`'${o}`))}))})),!0===e&&(vE(EE,this,!0),this.engine.setSheetContent(this.sheetId,t),vE(EE,this,!1))}function OE(t,e){var o,n;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(x(CE)))if(this.sheetName=(o=this.engine,!Xt(n=this.hot.getSettings()[CE].sheetName)&&o.doesSheetExist(n)||(n=o.addSheet(n)),n),yE(TE,this))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){vE(EE,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),vE(EE,this,!1)}}}function PE(t,e,o,n){if("get"!==n||yE(EE,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;if(!this.isFormulaCellType(i,e)&&"ARRAY"!==this.getCellType(i,e))return void(FR(o.value)&&(o.value=FR(r=o.value)?r.substr(1):r));var r;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(s),a=this.hot.getCellsMeta().find((t=>t.visualRow===i&&t.visualCol===e));void 0===a&&(a={}),"date"===a.type&&qo(l)&&(l=zR(l,a.dateFormat));const h="object"==typeof l&&null!==l?l.value:l;o.value=h}function NE(t,e,o,n){if("get"!==n||yE(EE,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===i||null===r)return;if(!this.isFormulaCellType(i,r)&&"ARRAY"!==this.getCellType(i,r))return;const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};o.value=this.engine.getCellSerialized(l)}function _E(t,e){if(RE(e))return;const o=[],n=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,r):o.push([e,s,r]),n.push({address:h})}))}));o.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{o.forEach((t=>{let[e,o,n]=t;this.syncChangeWithEngine(e,o,n)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function DE(t,e){if(RE(e))return;const o=[],n=[];t.forEach((t=>{let[e,i,,r]=t;const s=this.hot.propToCol(i);if(!qo(s))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(n.push({address:l}),o.push(...this.engine.setCellContents(l,r))):qe(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(o),this.validateDependentCells(o,n)}function LE(t,e){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,e]))return!1}function VE(t,e){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,e]))return!1}function FE(t,e,o){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(o).every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])))&&void 0}function WE(t,e,o){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(o).every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])))&&void 0}function BE(t,e,o){if(RE(o))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function jE(t,e,o){if(RE(o))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function zE(t,e,o,n){if(RE(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function UE(t,e,o,n){if(RE(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function $E(t,e,o){var n;vE(EE,this,!0);const i=this.hot.getSourceDataArray(o,0,o+((null===(n=e.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());vE(EE,this,!1),i.forEach(((t,e)=>{t.forEach(((t,n)=>{this.engine.setCellContents({col:n,row:o+e,sheet:this.sheetId},[[t]])}))}))}function GE(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function YE(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function KE(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function XE(t){this.hot.runHooks("afterSheetAdded",t)}function qE(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function QE(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function ZE(t,e,o){JE(t,e),e.set(t,o)}function JE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tT(t,e){return t.get(oT(t,e))}function eT(t,e,o){return t.set(oT(t,e),o),o}function oT(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeHideColumns"),io.getSingleton().register("afterHideColumns"),io.getSingleton().register("beforeUnhideColumns"),io.getSingleton().register("afterUnhideColumns");const nT="hiddenColumns";var iT=new WeakMap,rT=new WeakMap,sT=new WeakSet;function lT(t,e){return this.isHidden(e)?0:tT(iT,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function aT(t,e,o){if(!1===tT(iT,this).copyPasteEnabled&&this.isHidden(e)&&(o.skipColumnOnPaste=!0),this.isHidden(e-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function hT(t){if(tT(iT,this).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return jt(t,(t=>{let e=!0,n=0;Qo(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||o(t.startRow,t.endRow,n,i-1),e=!0):(e&&(n=i),i===t.endCol&&o(t.startRow,t.endRow,n,i),e=!1)}))})),e}function cT(t,e){if(!tT(iT,this).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&o.push("beforeHiddenColumn"),et(e,o)}function uT(t){var e;t.items.push({name:Sw},(e=this,{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,o,,n]=t;o-n!=0&&(e=1)}return this.getTranslatedPhrase(Pa,e)},callback(){const{from:t,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(t.col,o.col),0),i=Math.max(t.col,o.col),r=[];for(let t=n;t<=i;t+=1)r.push(t);e.hideColumns(r);const s=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Na,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countCols()||this.selectColumns(i,r)},disabled:!1,hidden(){const o=Bt(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,r=n.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>a-l+1){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return jt(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}(this))}function dT(){Array.isArray(tT(iT,this).columns)&&this.hideColumns(tT(iT,this).columns)}function gT(t,e,o){fT(t,e),e.set(t,o)}function fT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pT(t,e){return t.get(wT(t,e))}function mT(t,e,o){return t.set(wT(t,e),o),o}function wT(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeHideRows"),io.getSingleton().register("afterHideRows"),io.getSingleton().register("beforeUnhideRows"),io.getSingleton().register("afterUnhideRows");const vT="hiddenRows";var yT=new WeakMap,bT=new WeakMap,CT=new WeakSet;function ST(t,e){return this.isHidden(e)?0:t}function RT(t,e,o){if(!1===pT(yT,this).copyPasteEnabled&&this.isHidden(t)&&(o.skipRowOnPaste=!0),this.isHidden(t-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}function ET(t){if(pT(yT,this).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return jt(t,(t=>{let e=!0,n=0;Qo(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||o(n,i-1,t.startCol,t.endCol),e=!0):(e&&(n=i),i===t.endRow&&o(n,i,t.startCol,t.endCol),e=!1)}))})),e}function TT(t,e){if(!pT(yT,this).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&o.push("beforeHiddenRow"),et(e,o)}function xT(t){var e;t.items.push({name:Sw},(e=this,{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[o,,n]=t;o-n!=0&&(e=1)}return this.getTranslatedPhrase(_a,e)},callback(){const{from:t,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(t.row,o.row),0),i=Math.max(t.row,o.row),r=[];for(let t=n;t<=i;t+=1)r.push(t);e.hideRows(r);const s=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Da,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],r=e[e.length-1];i=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,r=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==n?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),r-i+1===this.countRows()||this.selectRows(i,r)},disabled:!1,hidden(){const o=Bt(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,r=n.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(i!==r){if(r-i+1>a-l+1){const t=h.slice(i,r+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return jt(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}(this))}function MT(){Array.isArray(pT(yT,this).rows)&&this.hideRows(pT(yT,this).rows)}function HT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kT(t,e){return t.get(AT(t,e))}function IT(t,e,o){return t.set(AT(t,e),o),o}function AT(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeColumnFreeze"),io.getSingleton().register("afterColumnFreeze"),io.getSingleton().register("beforeColumnUnfreeze"),io.getSingleton().register("afterColumnUnfreeze");const OT="manualColumnFreeze";var PT=new WeakMap,NT=new WeakSet;function _T(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(ha)},callback(t,o){const[{start:{col:n}}]=o;e.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ca)},callback(e,o){const[{start:{col:n}}]=o;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}(this))}function DT(t,e){if(kT(PT,this)){const o=this.hot.getSettings().fixedColumnsStart;if(e<o)return!1;if(t.some((t=>t<o)))return!1}}function LT(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const VT="px",FT=class{constructor(t){LT(this,"hot",void 0),LT(this,"_element",null),LT(this,"state",0),LT(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){qo(t)&&(this._element.style.top=t+VT),qo(e)&&(this._element.style[this.inlineProperty]=e+VT)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){qo(t)&&(this._element.style.width=t+VT),qo(e)&&(this._element.style.height=e+VT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){qo(t)&&(this._element.style.marginTop=t+VT),qo(e)&&(this._element.style[`margin${x(this.inlineProperty)}`]=e+VT)}getOffset(){const t=this._element.style,e=`margin${x(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}},WT=class extends FT{build(){super.build(),et(this._element,"ht__manualColumnMove--backlight")}},BT=class extends FT{build(){super.build(),et(this._element,"ht__manualColumnMove--guideline")}};function jT(t,e,o){zT(t,e),e.set(t,o)}function zT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UT(t,e,o){return t.set(GT(t,e),o),o}function $T(t,e){return t.get(GT(t,e))}function GT(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeColumnMove"),io.getSingleton().register("afterColumnMove");const YT="manualColumnMove",KT="ht__manualColumnMove",XT="show-ui",qT="on-moving--columns",QT="after-selection--columns";var ZT=new WeakMap,JT=new WeakMap,tx=new WeakMap,ex=new WeakMap,ox=new WeakMap,nx=new WeakMap,ix=new WeakMap,rx=new WeakMap,sx=new WeakMap,lx=new WeakMap,ax=new WeakMap,hx=new WeakSet;function cx(t,e,o,n){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=tt(t.target,"sortAction");if(!s||!r||$T(ox,this)||0!==t.button||l)return UT(ox,this,!1),$T(tx,this).length=0,void ot(this.hot.rootElement,[qT,XT]);const a=$T(JT,this).isBuilt()&&!$T(JT,this).isAppended(),h=$T(ZT,this).isBuilt()&&!$T(ZT,this).isAppended();a&&h&&($T(JT,this).appendTo(i.hider),$T(ZT,this).appendTo(i.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){n.column=!0,UT(ox,this,!0);const r=o.firstChild?function(t,e){const o={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return o;for(;n!==e;)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;return o}(t,o.firstChild).x:t.offsetX;$T(nx,this).eventPageX=t.pageX,UT(rx,this,e.col),$T(nx,this).TD=o,$T(nx,this).col=e.col,UT(tx,this,this.prepareColumnsToMoving(d,g)),UT(lx,this,!!this.hot.getSettings().rowHeaders),UT(ex,this,this.hot.countCols()),UT(ax,this,this.hot.getSettings().fixedColumnsStart),UT(sx,this,ut(this.hot.rootElement).left);const s=$T(lx,this)?-1:0,l=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,a=e.col<$T(ax,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?o.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(a?h:0)+u;$T(ZT,this).setPosition(l,f),$T(ZT,this).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-l),$T(ZT,this).setOffset(null,-u),et(this.hot.rootElement,qT)}else ot(this.hot.rootElement,QT),UT(ox,this,!1),$T(tx,this).length=0}function ux(t){$T(ox,this)&&($T(nx,this).eventPageX=t.pageX,this.refreshPositions())}function dx(t,e,o,n){this.hot.getSelectedRangeLast()&&$T(ox,this)&&($T(tx,this).indexOf(e.col)>-1?ot(this.hot.rootElement,XT):et(this.hot.rootElement,XT),n.row=!0,n.column=!0,n.cell=!0,UT(rx,this,e.col),$T(nx,this).TD=o)}function gx(){const t=$T(nx,this).col,e=$T(tx,this).length;if(UT(rx,this,void 0),UT(ox,this,!1),ot(this.hot.rootElement,[qT,XT,QT]),this.hot.selection.isSelectedByColumnHeader()&&et(this.hot.rootElement,QT),e<1||void 0===t)return;const o=$T(tx,this)[0],n=this.hot.toPhysicalColumn(o),i=this.dragColumns($T(tx,this),t);if($T(tx,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(n),o=t+e-1;this.hot.selectColumns(t,o)}}function fx(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;$T(ZT,this).setPosition(e),$T(ZT,this).setSize(null,t.hider.offsetHeight-e)}function px(){this.moveBySettingsOrLoad()}function mx(t,e,o){wx(t,e),e.set(t,o)}function wx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vx(t,e,o){return t.set(bx(t,e),o),o}function yx(t,e){return t.get(bx(t,e))}function bx(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const Cx="manualColumnResize",Sx="manualColumnWidths";var Rx=new WeakMap,Ex=new WeakMap,Tx=new WeakMap,xx=new WeakMap,Mx=new WeakMap,Hx=new WeakMap,kx=new WeakMap,Ix=new WeakMap,Ax=new WeakMap,Ox=new WeakMap,Px=new WeakMap,Nx=new WeakMap,Dx=new WeakMap,Lx=new WeakMap,Vx=new WeakMap,Fx=new WeakMap,Wx=new WeakSet;function Bx(){const t=this.hot.getSettings()[Cx],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{yx(Vx,this).setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{yx(Vx,this).setValueAtIndex(e,t)}))}),!0),vx(Fx,this,t)):!0===t&&Array.isArray(yx(Fx,this))&&this.hot.batchExecution((()=>{yx(Fx,this).forEach(((t,e)=>{yx(Vx,this).setValueAtIndex(e,t)}))}),!0)}function jx(t){if(!Pt(t.target)&&!0!==yx(Nx,this)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const o=e.getAttribute("colspan");!e||null!==o&&"1"!==o||yx(Px,this)||this.setupHandlePosition(e)}}function zx(t){t.target.parentNode===this.hot.rootElement&&tt(t.target,"manualColumnResizer")&&(this.setupHandlePosition(yx(Rx,this)),this.setupGuidePosition(),vx(Px,this,!0),null===yx(Lx,this)&&(vx(Lx,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(yx(Lx,this))),vx(Dx,this,yx(Dx,this)+1),this.startX=t.pageX,vx(Mx,this,yx(kx,this)))}function Ux(t){if(yx(Px,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();vx(xx,this,yx(kx,this)+e),jt(yx(Tx,this),(t=>{vx(Mx,this,this.setManualSize(t,yx(xx,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function $x(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeColumnResize",yx(Mx,this),e,!1),o&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",yx(Mx,this),e,!1)};yx(Px,this)&&(this.hideHandleAndGuide(),vx(Px,this,!1),yx(Mx,this)!==yx(kx,this)&&(yx(Tx,this).length>1?(jt(yx(Tx,this),(t=>{e(t)})),t()):jt(yx(Tx,this),(t=>{e(t,!0)}))),this.setupHandlePosition(yx(Rx,this)))}function Gx(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(yx(Ax,this)),this.hot.rootElement.removeChild(yx(Ox,this)),vx(Px,this,!1),vx(Nx,this,!0),this.hot._registerImmediate((()=>{vx(Nx,this,!1)}))}function Yx(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),n=yx(Vx,this).getValueAtIndex(t);this.hot.getSettings()[Cx]&&n&&(o=n)}return o}function Kx(t,e){let o=yx(Vx,this).getValueAtIndex(e);return null===o&&(o=t),o}function Xx(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function qx(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Qx="px",Zx=class{constructor(t){qx(this,"hot",void 0),qx(this,"_element",null),qx(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+Qx),void 0!==e&&(this._element.style.left=e+Qx)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+Qx),e&&(this._element.style.height=e+Qx)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+Qx),e&&(this._element.style.marginLeft=e+Qx)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},Jx=class extends Zx{build(){super.build(),et(this._element,"ht__manualRowMove--backlight")}},tM=class extends Zx{build(){super.build(),et(this._element,"ht__manualRowMove--guideline")}};function eM(t,e,o){oM(t,e),e.set(t,o)}function oM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nM(t,e,o){return t.set(rM(t,e),o),o}function iM(t,e){return t.get(rM(t,e))}function rM(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeRowMove"),io.getSingleton().register("afterRowMove");const sM="manualRowMove",lM="ht__manualRowMove",aM="show-ui",hM="on-moving--rows",cM="after-selection--rows";var uM=new WeakMap,dM=new WeakMap,gM=new WeakMap,fM=new WeakMap,pM=new WeakMap,mM=new WeakMap,wM=new WeakSet;function vM(t,e,o,n){const{wtTable:i,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||iM(fM,this)||0!==t.button)return nM(fM,this,!1),iM(gM,this).length=0,void ot(this.hot.rootElement,[hM,aM]);const a=iM(dM,this).isBuilt()&&!iM(dM,this).isAppended(),h=iM(uM,this).isBuilt()&&!iM(uM,this).isAppended();a&&h&&(iM(dM,this).appendTo(i.hider),iM(uM,this).appendTo(i.hider));const{from:c,to:u}=l,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){n.row=!0,nM(fM,this,!0),iM(pM,this).eventPageY=t.pageY,iM(pM,this).coords=e,iM(pM,this).TD=o,nM(gM,this,this.prepareRowsToMoving());const s=i.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+t.offsetY;iM(uM,this).setPosition(null,s),iM(uM,this).setSize(i.hider.offsetWidth-s,this.getRowsHeight(d,g)),iM(uM,this).setOffset(-l,null),et(this.hot.rootElement,hM),this.refreshPositions()}else ot(this.hot.rootElement,cM),nM(fM,this,!1),iM(gM,this).length=0}function yM(t){iM(fM,this)&&(iM(pM,this).eventPageY=t.pageY,this.refreshPositions())}function bM(t,e,o,n){this.hot.getSelectedRangeLast()&&iM(fM,this)&&(iM(gM,this).indexOf(e.row)>-1?ot(this.hot.rootElement,aM):et(this.hot.rootElement,aM),n.row=!0,n.column=!0,n.cell=!0,iM(pM,this).coords=e,iM(pM,this).TD=o)}function CM(){const t=iM(pM,this).row,e=iM(gM,this).length;if(nM(fM,this,!1),ot(this.hot.rootElement,[hM,aM,cM]),this.hot.selection.isSelectedByRowHeader()&&et(this.hot.rootElement,cM),e<1||void 0===t)return;const o=iM(gM,this)[0],n=this.hot.toPhysicalRow(o),i=this.dragRows(iM(gM,this),t);if(iM(gM,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(n),o=t+e-1;this.hot.selectRows(t,o)}}function SM(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;iM(uM,this).setPosition(null,e),iM(uM,this).setSize(t.hider.offsetWidth-e)}function RM(){this.moveBySettingsOrLoad()}function EM(t,e,o){TM(t,e),e.set(t,o)}function TM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xM(t,e,o){return t.set(HM(t,e),o),o}function MM(t,e){return t.get(HM(t,e))}function HM(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const kM="manualRowResize",IM="manualRowHeights";var AM=new WeakMap,OM=new WeakMap,PM=new WeakMap,NM=new WeakMap,_M=new WeakMap,DM=new WeakMap,LM=new WeakMap,VM=new WeakMap,FM=new WeakMap,WM=new WeakMap,BM=new WeakMap,jM=new WeakMap,zM=new WeakMap,UM=new WeakMap,$M=new WeakMap,GM=new WeakMap,YM=new WeakSet;function KM(t){if(!Pt(t.target)&&!0!==MM(jM,this)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(MM(BM,this)||this.setupHandlePosition(e))}}function XM(t){tt(t.target,"manualRowResizer")&&(this.setupHandlePosition(MM(AM,this)),this.setupGuidePosition(),xM(BM,this,!0),null===MM(UM,this)&&(xM(UM,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(MM(UM,this))),xM(zM,this,MM(zM,this)+1),xM(DM,this,t.pageY),xM(_M,this,MM(LM,this)))}function qM(t){MM(BM,this)&&(xM(NM,this,MM(LM,this)+(t.pageY-MM(DM,this))),jt(MM(PM,this),(t=>{xM(_M,this,this.setManualSize(t,MM(NM,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function QM(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),o&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};MM(BM,this)&&(this.hideHandleAndGuide(),xM(BM,this,!1),MM(_M,this)!==MM(LM,this)&&(MM(PM,this).length>1?(jt(MM(PM,this),(t=>{e(t)})),t()):jt(MM(PM,this),(t=>{e(t,!0)}))),this.setupHandlePosition(MM(AM,this)))}function ZM(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(MM(FM,this)),this.hot.rootElement.removeChild(MM(WM,this)),xM(BM,this,!1),xM(jM,this,!0),this.hot._registerImmediate((()=>{xM(jM,this,!1)}))}function JM(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),n=MM($M,this).getValueAtIndex(t);this.hot.getSettings()[kM]&&n&&(o=n)}return o}function tH(){const t=this.hot.getSettings()[kM],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==e?e.forEach(((t,e)=>{MM($M,this).setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{MM($M,this).setValueAtIndex(e,t)})),xM(GM,this,t)):!0===t&&Array.isArray(MM(GM,this))&&MM(GM,this).forEach(((t,e)=>{MM($M,this).setValueAtIndex(e,t)}))}),!0)}function eH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}o(237);const oH=class{constructor(t,e,o,n,i,r){eH(this,"row",void 0),eH(this,"col",void 0),eH(this,"rowspan",void 0),eH(this,"colspan",void 0),eH(this,"removed",!1),eH(this,"cellCoordsFactory",void 0),eH(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=o,this.colspan=n,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){return Gt`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return Gt`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return Gt`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return Gt`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,o){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=o||t.col+t.colspan-1>=o}normalize(t){const e=t.countRows(),o=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const o=t[0]||t[1],n=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,n),l=Math.max(e,n),a=this[r],h=this[r]+this[i]-1;if(a>=e&&(this[r]+=o),o>0)e<=h&&e>a&&(this[i]+=o);else if(o<0){if(s<=a&&l>=h)return this.removed=!0,!1;if(a>=s&&a<=l){const t=l-a+1,e=Math.abs(o)-t;this[r]-=e+o,this[i]-=t}else if(a<=s&&h>=l)this[i]+=o;else if(a<=s&&h>=s&&h<l){const t=h-s+1;this[i]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}};function nH(t,e,o,n){e?e.row===o&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function iH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rH(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var sH=new WeakSet;class lH{constructor(t){var e,o;(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e=this,o=sH),o.add(e),iH(this,"plugin",void 0),iH(this,"mergedCells",[]),iH(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return Gt`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const o=this.mergedCells;let n=!1;return jt(o,(o=>!(o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=e&&o.col+o.colspan-1>=e&&(n=o,1)))),n}getByRange(t){const e=this.mergedCells;let o=!1;return jt(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(o=e,o))),o}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,n=[];let i=t;if(!i.includesRange){const t=this.hot._createCellCoords(i.from.row,i.from.col),e=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(t,t,e)}return jt(o,(t=>{const o=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(o,o,r);e?i.overlaps(s)&&n.push(t):i.includesRange(s)&&n.push(t)})),!!n.length&&n}add(t){const e=this.mergedCells,o=t.row,n=t.col,i=t.rowspan,r=t.colspan,s=new oH(o,n,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,n),a=this.isOverlapping(s);return l||a?(qe(lH.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}remove(t,e){const o=this.mergedCells,n=this.get(t,e),i=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===i)&&(o.splice(i,1),n)}clear(){const t=this.mergedCells,e=[],o=[];jt(t,(t=>{const o=this.hot.getCell(t.row,t.col);o&&e.push([o,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,jt(e,((t,n)=>{Qo(0,t.rowspan-1,(e=>{Qo(0,t.colspan-1,(n=>{if(0!==n||0!==e){const i=this.hot.getCell(t.row+e,t.col+n);i&&o.push([i,null,null,null])}}))})),e[n][1]=null})),jt(e,(t=>{nH(...t)})),jt(o,(t=>{nH(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let o=!1;return jt(this.mergedCells,(t=>!this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)).overlaps(e)||(o=!0,!1))),o}isFirstRenderableMergedCell(t,e){const o=this.get(t,e);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===e}getFirstRenderableCoords(t,e){const o=this.get(t,e);if(!o||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(n,i)}getStartMostColumnIndex(t,e){const o=rH(sH,this,aH).call(this,t,"col",-1);let n=e;for(let t=0;t<o.length;t++)if(o[t]<=e){n=o[t];break}return n}getEndMostColumnIndex(t,e){const o=rH(sH,this,aH).call(this,t,"col",1);let n=e;for(let t=0;t<o.length;t++)if(o[t]>=e){n=o[t];break}return n}getTopMostRowIndex(t,e){const o=rH(sH,this,aH).call(this,t,"row",-1);let n=e;for(let t=0;t<o.length;t++)if(o[t]<=e){n=o[t];break}return n}getBottomMostRowIndex(t,e){const o=rH(sH,this,aH).call(this,t,"row",1);let n=e;for(let t=0;t<o.length;t++)if(o[t]>=e){n=o[t];break}return n}shiftCollections(t,e,o){const n=[0,0];switch(t){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o}jt(this.mergedCells,(t=>{t.shift(n,e)})),Zo(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}function aH(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=new Map,i=1===o?t.getTopStartCorner():t.getBottomEndCorner(),r=1===o?t.getBottomEndCorner():t.getTopStartCorner();for(let t=i.row;1===o?t<=r.row:t>=r.row;t+=o)for(let s=i.col;1===o?s<=r.col:s>=r.col;s+=o){const i="row"===e?t:s,r=this.get(t,s);let l=i;r&&(l=1===o?r[e]+r[`${e}span`]-1:r[e]),n.has(i)||n.set(i,new Set),n.get(i).add(l)}return Array.from(new Set(Array.from(n.entries()).filter((t=>{let[,e]=t;return 1===e.size})).flatMap((t=>{let[,e]=t;return Array.from(e)}))))}const hH=lH;function cH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const uH=class{constructor(t){cH(this,"plugin",void 0),cH(this,"mergedCellsCollection",void 0),cH(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let o=null;return o=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",o}snapDragArea(t,e,o,n){const i=e.slice(0),r=this.getAutofillSize(t,e,o),[s,l,a,h]=t,c=["up","down"].indexOf(o)>-1?a-s+1:h-l+1,u=r-Math.floor(r/c)*c,d=this.getFarthestCollection(t,e,o,n);if(d)if("down"===o){const t=d.row+d.rowspan-s-u;i[2]+t>=this.plugin.hot.countRows()?i[2]-=u:i[2]+=u?t:0}else if("right"===o){const t=d.col+d.colspan-l-u;i[3]+t>=this.plugin.hot.countCols()?i[3]-=u:i[3]+=u?t:0}else if("up"===o){const t=a-u-d.row+1;i[0]+t<0?i[0]+=u:i[0]-=u?t:0}else if("left"===o){const t=h-u-d.col+1;i[1]+t<0?i[1]+=u:i[1]-=u?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:o,foundMergedCells:n,fillSize:r,dragArea:i,cycleLength:c}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),fe(this.currentFillData,t)}getAutofillSize(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return n-l;case"down":return h-r;case"left":return i-a;case"right":return c-s;default:return null}}getDragArea(t,e,o){const[n,i,r,s]=t,[l,a,h,c]=e;switch(o){case"up":return[l,a,n-1,s];case"down":return[r+1,i,h,s];case"left":return[l,a,r,i-1];case"right":return[n,s+1,h,c];default:return null}}getFarthestCollection(t,e,o,n){const[i,r,s,l]=t,a=["up","down"].indexOf(o)>-1,h=a?s:l,c=a?i:r,u=this.getAutofillSize(t,e,o),d=a?s-i+1:l-r+1,g=u-Math.floor(u/d)*d;let f=null,p=null,m=null;switch(o){case"up":f="includesVertically",m=h-g+1;break;case"left":f="includesHorizontally",m=h-g+1;break;case"down":f="includesVertically",m=c+g-1;break;case"right":f="includesHorizontally",m=c+g-1}return jt(n,(t=>{t[f](m)&&t.isFarther(p,o)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),o=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,i=(t,o)=>{switch(n){case"up":return t.row-o>=e.from.row;case"down":return t.row+t.rowspan-1+o<=e.to.row;case"left":return t.col-o>=e.from.column;case"right":return t.col+t.colspan-1+o<=e.to.column;default:return null}};let r=0,s=null,l=1;do{for(let t=0;t<o.length;t+=1){if(s=o[t],r=l*this.currentFillData.cycleLength,i(s,r))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan})}t===o.length-1&&(l+=1)}}while(i(s,r));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},o={min:null,max:null};return jt(t,(t=>{const n=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||n<e.min)&&(e.min=n),(null===e.max||n>e.max)&&(e.max=n),(null===o.min||i<o.min)&&(o.min=i),(null===o.max||i>o.max)&&(o.max=i)})),{from:{row:e.min,column:o.min},to:{row:e.max,column:o.max}}}dragAreaOverlapsCollections(t,e,o){const n=this.getDragArea(t,e,o),[i,r,s,l]=n,a=this.plugin.hot._createCellCoords(i,r),h=this.plugin.hot._createCellCoords(s,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}};function dH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const gH=class{constructor(t){dH(this,"plugin",void 0),dH(this,"hot",void 0),dH(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,o,n){const i=Math.min(o[0],o[2]),r=Math.min(o[1],o[3]),s=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===n)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;const a=this.plugin.mergedCellsCollection.get(t,e);if(!a)return;const h=a.getLastRow(),c=a.getLastColumn();return i<=a.row&&r<=a.col&&s>=h&&l>=c?`${this.fullySelectedMergedCellClassName}-${n}`:this.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const o=[];if(!e||!t)return!1;for(let e=0;e<t.rowspan;e+=1)for(let n=0;n<t.colspan;n+=1)o.push(this.hot._createCellCoords(t.row+e,t.col+n));for(let t=0;t<o.length;t+=1){const n=[];for(let i=0;i<e.length;i+=1)n[i]=e[i].includes(o[t]);if(!n.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}};function fH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class pH{constructor(t){fH(this,"data",void 0),fH(this,"next",null),fH(this,"prev",null),this.data=t}}const mH=class{constructor(){fH(this,"first",null),fH(this,"last",null)}push(t){const e=new pH(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){const e=new pH(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;for(;e;){const o=t(e);if(e===this.last||!0===o)break;e=e.next}}remove(t){if(null===this.first)return!1;let e,o,n=this.first;for(;n;){if(n.data===t)return e=n.next,o=n.prev,e&&(e.prev=o),o&&(o.next=e),n===this.first&&(this.first=e),n===this.last&&(this.last=o),!0;n=n.next}return!1}hasCycle(){let t=this.first,e=this.first;for(;;){if(null===t)return!1;if(t=t.next,null===t)return!1;if(t=t.next,e=e.next,t===e)return!0}}pop(){if(null===this.last)return null;const t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;const t=this.first;return this.first=this.first.next,t}recursiveReverse(){if(!this.first)return;!function t(e,o){o&&(t(o,o.next),o.next=e)}(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let t,e=this.first.next,o=this.first;for(;e;)t=e.next,e.next=o,o.prev=e,o=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=o,this.last=t}};function wH(t,e,o){vH(t,e),e.set(t,o)}function vH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yH(t,e){return t.get(CH(t,e))}function bH(t,e,o){return t.set(CH(t,e),o),o}function CH(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var SH=new WeakMap,RH=new WeakMap,EH=new WeakMap,TH=new WeakMap,xH=new WeakMap,MH=new WeakMap,HH=new WeakMap,kH=new WeakSet;class IH{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:o,columnIndexMapper:n}=t;var i;vH(this,i=kH),i.add(this),wH(this,SH,new mH),wH(this,RH,new mH),wH(this,EH,null),wH(this,TH,null),wH(this,xH,null),wH(this,MH,null),wH(this,HH,null),bH(xH,this,e),bH(MH,this,o),bH(HH,this,n)}getCurrentVerticalNode(){return yH(TH,this).data}getFirstVerticalNode(){return yH(RH,this).first.data}getNextVerticalNode(){return yH(TH,this).next.data}getPrevVerticalNode(){return yH(TH,this).prev.data}getCurrentHorizontalNode(){return yH(EH,this).data}getFirstHorizontalNode(){return yH(SH,this).first.data}getNextHorizontalNode(){return yH(EH,this).next.data}getPrevHorizontalNode(){return yH(EH,this).prev.data}setPrevNodeAsActive(){bH(TH,this,yH(TH,this).prev),bH(EH,this,yH(EH,this).prev)}setNextNodeAsActive(){bH(TH,this,yH(TH,this).next),bH(EH,this,yH(EH,this).next)}buildFocusOrder(t){const e=t.getTopStartCorner(),o=t.getBottomEndCorner(),n=new WeakSet;bH(SH,this,new mH);for(let i=e.row;i<=o.row;i++)if(!yH(MH,this).isHidden(i))for(let r=e.col;r<=o.col;r++){if(yH(HH,this).isHidden(r))continue;const e=CH(kH,this,AH).call(this,t,yH(SH,this),n,i,r);e&&bH(EH,this,e)}yH(SH,this).first&&(yH(SH,this).first.prev=yH(SH,this).last,yH(SH,this).last.next=yH(SH,this).first);const i=new WeakSet;bH(RH,this,new mH);for(let n=e.col;n<=o.col;n++)if(!yH(HH,this).isHidden(n))for(let r=e.row;r<=o.row;r++){if(yH(MH,this).isHidden(r))continue;const e=CH(kH,this,AH).call(this,t,yH(RH,this),i,r,n);e&&bH(TH,this,e)}yH(RH,this).first&&(yH(RH,this).first.prev=yH(RH,this).last,yH(RH,this).last.next=yH(RH,this).first)}setActiveNode(t,e){return yH(SH,this).inorder((o=>{const{rowStart:n,rowEnd:i,colStart:r,colEnd:s}=o.data;if(t>=n&&t<=i&&e>=r&&e<=s)return bH(EH,this,o),!1})),yH(RH,this).inorder((o=>{const{rowStart:n,rowEnd:i,colStart:r,colEnd:s}=o.data;if(t>=n&&t<=i&&e>=r&&e<=s)return bH(TH,this,o),!1})),this}}function AH(t,e,o,n,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),a=yH(xH,this).call(this,n,i);if(a&&o.has(a))return null;const h={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(a){if(o.add(a),a.row<r.row||a.row+a.rowspan-1>s.row||a.col<r.col||a.col+a.colspan-1>s.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}const c=e.push(h);return n===l.row&&i===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?c:null}function OH(t,e,o){PH(t,e),e.set(t,o)}function PH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NH(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _H(t,e,o){return t.set(LH(t,e),o),o}function DH(t,e){return t.get(LH(t,e))}function LH(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}io.getSingleton().register("beforeMergeCells"),io.getSingleton().register("afterMergeCells"),io.getSingleton().register("beforeUnmergeCells"),io.getSingleton().register("afterUnmergeCells");const VH="mergeCells",FH=VH;var WH=new WeakMap,BH=new WeakMap,jH=new WeakMap,zH=new WeakSet;function UH(){this.generateFromSettings(this.hot.getSettings()[VH]),this.hot.render()}function $H(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),o=e.getTopStartCorner(),n=e.getBottomEndCorner();for(let e=0;e<t.length;e+=1)if(o.row===t[e].row&&o.col===t[e].col&&n.row===t[e].row+t[e].rowspan-1&&n.col===t[e].col+t[e].colspan-1)return!1}return t}function GH(t){DH(BH,this).row=t.row,DH(BH,this).col=t.col}function YH(t){const e=this.hot.getSelectedRangeLast(),{highlight:o}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;DH(WH,this)&&(null!==i.getRenderableFromVisualIndex(DH(WH,this).row)&&(o.row=DH(WH,this).row),null!==n.getRenderableFromVisualIndex(DH(WH,this).col)&&(o.col=DH(WH,this).col),_H(WH,this,null));const r=this.mergedCellsCollection.get(o.row,o.col);if(!r)return;const s=r.col,l=r.col+r.colspan-1;if(t.col<0){const e=o.col>=s&&o.col<=l?s-1:l,i=n.getNearestNotHiddenIndex(e,-1);t.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,o.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,o.col)-1,1)}else if(t.col>0){const e=o.col>=s&&o.col<=l?l+1:s,i=n.getNearestNotHiddenIndex(e,1);t.col=null===i?this.hot.view.countRenderableColumnsInRange(o.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(o.col,i)-1,1)}const a=r.row,h=r.row+r.rowspan-1;if(t.row<0){const e=o.row>=a&&o.row<=h?a-1:h,n=i.getNearestNotHiddenIndex(e,-1);t.row=null===n?-this.hot.view.countRenderableRowsInRange(0,o.row):-Math.max(this.hot.view.countRenderableRowsInRange(n,o.row)-1,1)}else if(t.row>0){const e=o.row>=a&&o.row<=h?h+1:a,n=i.getNearestNotHiddenIndex(e,1);t.row=null===n?this.hot.view.countRenderableRowsInRange(o.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(o.row,n)-1,1)}}function KH(t){const e=this.hot.getSelectedRangeLast(),o=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot,s=(t,e)=>{o.expand(this.hot._createCellCoords(t,e));for(let t=0;t<this.mergedCellsCollection.mergedCells.length;t+=1)o.expandByRange(this.mergedCellsCollection.mergedCells[t].getRange())};if(t.col<0){let r=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;s(n.row,r),"E-W"===e.getHorizontalDirection()&&"E-W"===o.getHorizontalDirection()&&(r=o.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(r,1);null!==l&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1))}else if(t.col>0){let r=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;s(n.row,r),"W-E"===e.getHorizontalDirection()&&"W-E"===o.getHorizontalDirection()&&(r=o.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(r,-1);null!==l&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1))}if(t.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;s(i,n.col),"S-N"===e.getVerticalDirection()&&"S-N"===o.getVerticalDirection()&&(i=o.getTopStartCorner().row);const l=r.getNearestNotHiddenIndex(i,1);null!==l&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,n.row)-1,1))}else if(t.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;s(i,n.col),"N-S"===e.getVerticalDirection()&&"N-S"===o.getVerticalDirection()&&(i=o.getBottomStartCorner().row);const l=r.getNearestNotHiddenIndex(i,-1);null!==l&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,l)-1,1))}}function XH(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void _H(WH,this,e.clone());for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);const o=this.mergedCellsCollection.get(e.row,e.col);_H(WH,this,e.clone()),o&&e.assign(o)}function qH(t,e){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:n,col:i,colspan:r,rowspan:s}=o;return[n,i,n+s-1,i+r-1]}function QH(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){const t=this.getSelectedLast();if(t){const o=e.mergedCellsCollection.get(t[0],t[1]);if(o.row===t[0]&&o.col===t[1]&&o.row+o.rowspan-1===t[2]&&o.col+o.colspan-1===t[3])return this.getTranslatedPhrase(da)}return this.getTranslatedPhrase(ua)},callback(){const t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:o,to:n}=t;e.toggleMerge(t),this.selectCell(o.row,o.col,n.row,n.col,!1)},disabled(){const t=this.getSelectedLast();return!t||oH.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function ZH(t,e,o){const n=this.mergedCellsCollection.get(e,o),i=be(n)?we(n):void 0;if(be(i)){const{rowIndexMapper:t,columnIndexMapper:n}=this.hot,{row:r,col:s,colspan:l,rowspan:a}=i,[h,c]=this.translateMergedCellToRenderable(r,a,s,l),u=h-t.getRenderableFromVisualIndex(e)+1,d=c-n.getRenderableFromVisualIndex(o)+1;i.row=t.getNearestNotHiddenIndex(i.row,1),i.col=n.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,u),i.colspan=Math.min(i.colspan,d)}nH(t,i,e,o)}function JH(){_H(WH,this,null)}function tk(){if(DH(WH,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),o=t.getHorizontalDirection(),n=DH(WH,this).clone().normalize();DH(jH,this).setActiveNode(n.row,n.col),DH(BH,this).row>0||DH(BH,this).col>0?DH(jH,this).setPrevNodeAsActive():("E-W"===o&&DH(BH,this).col<0||"S-N"===e&&DH(BH,this).row<0)&&DH(jH,this).setNextNodeAsActive()}function ek(t,e){const o=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let r=null,s=null;if(DH(BH,this).col<0){const{rowEnd:t,colEnd:e}=DH(jH,this).getPrevHorizontalNode();s=n.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if(DH(BH,this).col>0){const{rowStart:t,colStart:e}=DH(jH,this).getNextHorizontalNode();s=n.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}else if(DH(BH,this).row<0){const{rowEnd:t,colEnd:e}=DH(jH,this).getPrevVerticalNode();s=n.getNearestNotHiddenIndex(e,-1),r=i.getNearestNotHiddenIndex(t,-1)}else if(DH(BH,this).row>0){const{rowStart:t,colStart:e}=DH(jH,this).getNextVerticalNode();s=n.getNearestNotHiddenIndex(e,1),r=i.getNearestNotHiddenIndex(t,1)}if(null!==r||null!==s){const n=this.hot._createCellCoords(r,s),i=this.mergedCellsCollection.get(n.row,n.col),l=this.hot.selection.highlight.getFocus();t=n.row,e=n.col,i?o.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):o.highlight.assign(n),l.clear(),l.add(n).commit()}DH(jH,this).setActiveNode(t,e),_H(BH,this,{row:0,col:0})}function ok(){this.hot.getSelectedRangeLast().isHeader()||DH(jH,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function nk(t,e,o){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?o.copyable=!1:(o.rowspan=n.rowspan,o.colspan=n.colspan))}function ik(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function rk(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function sk(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const o=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,o))return n=e,n;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i?(n=this.autofillCalculations.snapDragArea(e,n,o,i),n):n}function lk(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function ak(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function hk(t,e,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",t,e)}function ck(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function uk(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function dk(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast();jt(this.mergedCellsCollection.getWithinRange(e),(o=>{e.getBottomEndCorner().row===o.getLastRow()&&e.getBottomEndCorner().col===o.getLastColumn()&&(t[2]=o.row,t[3]=o.col)}))}}function gk(t,e,o,n){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,o,n)}function fk(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function pk(t,e,o,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getByRange(i);if(!r)return;const s=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,l))}function mk(){qe(Gt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const wk="sort";const vk="multiColumnSorting",yk="columnSorting",bk=vk;Ym(vk,(function(t,e){return function(o,n){const[,...i]=o,[,...r]=n;return function o(n){const s=t[n],l=e[n],a=i[n],h=r[n],c=l.multiColumnSorting,u=(c.compareFunctionFactory?c.compareFunctionFactory:Xm(l.type))(s,l,c)(a,h);if(0===u){const t=n+1;if(void 0!==e[t])return o(t)}return u}(0)}}));function Ck(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Sk(){let{label:t="",colspan:e=1,origColspan:o=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:o,collapsible:n,isCollapsed:r,crossHiddenColumns:i,isHidden:s,isRoot:l,isPlaceholder:a}}function Rk(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Ek(t,e){return t.get(xk(t,e))}function Tk(t,e,o){return t.set(xk(t,e),o),o}function xk(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const Mk=["label","collapsible"];var Hk=new WeakMap,kk=new WeakMap,Ik=new WeakMap;class Ak{constructor(){Rk(this,Hk,[]),Rk(this,kk,0),Rk(this,Ik,1/0)}setColumnsLimit(t){Tk(Ik,this,t)}setData(){Tk(Hk,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const o=[];if(0===e)return o;jt(t,(t=>{const n=[];let i=0;o.push(n),jt(t,(t=>{const o=Sk();if(be(t)){const{label:e,colspan:n}=t;o.label=Yt(e),"number"==typeof n&&n>1&&(o.colspan=n,o.origColspan=n)}else o.label=Yt(t);i+=o.origColspan;let r=!1;if(i>=e&&(o.colspan=o.origColspan-(i-e),o.origColspan=o.colspan,r=!0),n.push(o),o.colspan>1)for(let t=0;t<o.colspan-1;t++)n.push({label:"",isPlaceholder:!0});return!r}))}));const n=Math.max(...Bt(o,(t=>t.length)));return jt(o,(t=>{if(t.length<n){const e=Bt(new Array(n-t.length),(()=>Sk()));t.splice(t.length,0,...e)}})),o}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Ek(Ik,this))),Tk(kk,this,Ek(Hk,this).length)}getData(){return Ek(Hk,this)}mergeWith(t){jt(t,(t=>{let{row:e,col:o,...n}=t;const i=this.getHeaderSettings(e,o);null!==i&&fe(i,n,Mk)}))}map(t){jt(Ek(Hk,this),(e=>{jt(e,(e=>{const o=t({...e});be(o)&&fe(e,o,Mk)}))}))}getHeaderSettings(t,e){var o;if(t>=Ek(kk,this)||t<0)return null;const n=Ek(Hk,this)[t];return!1===Array.isArray(n)||e>=n.length?null:null!==(o=n[e])&&void 0!==o?o:null}getHeadersSettings(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(t>=Ek(kk,this)||t<0)return n;const i=Ek(Hk,this)[t];let r=0;for(let t=e;t<i.length;t++){const e=i[t];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=e.colspan,n.push(e),e.colspan>1&&(t+=e.colspan-1),r===o)break;if(r>o)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return Ek(kk,this)}getColumnsCount(){return Ek(kk,this)>0?Ek(Hk,this)[0].length:0}clear(){Tk(Hk,this,[]),Tk(kk,this,0)}}function Ok(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const Pk="DF-pre-order",Nk=new Map([[Pk,function t(e,o){let n=e.call(o,this);for(let i=0;i<this.childs.length;i++){if(!1===n)return!1;n=t.call(this.childs[i],e,o)}return n}],["DF-post-order",function t(e,o){for(let n=0;n<this.childs.length;n++)if(!1===t.call(this.childs[n],e,o))return!1;return e.call(o,this)}],["BF",function(t,e){const o=[this];!function n(){if(0===o.length)return;const i=o.shift();o.push(...i.childs),!1!==t.call(e,i)&&n()}()}]]);class _k{constructor(t){Ok(this,"data",{}),Ok(this,"parent",null),Ok(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new _k({...t.data});for(let o=0;o<t.childs.length;o++)e.addChild(this.cloneTree(t.childs[o]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!Nk.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);Nk.get(e).call(this,t,this)}walkUp(t){const e=this,o=n=>{!1!==t.call(e,n)&&null!==n.parent&&o(n.parent)};o(this)}}function Dk(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Lk(t,e){return t.get(Vk(t,e))}function Vk(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var Fk=new WeakMap,Wk=new WeakMap,Bk=new WeakMap;class jk{constructor(t){Dk(this,Fk,new Map),Dk(this,Wk,new Map),Dk(this,Bk,null),function(t,e,o){t.set(Vk(t,e),o)}(Bk,this,t)}getRoots(){return Array.from(Lk(Fk,this).values())}getRootByColumn(t){let e;return Lk(Wk,this).has(t)&&(e=Lk(Fk,this).get(Lk(Wk,this).get(t))),e}getNode(t,e){const o=this.getRootByColumn(e);if(!o)return;const n=e-Lk(Wk,this).get(e);let i,r=0;return o.walkDown((o=>{const{data:{origColspan:s,headerLevel:l}}=o;if(t===l){if(n>=r&&n<=r+s-1)return i=o,i.data.isRoot=e===i.data.columnIndex,!1;r+=s}})),i}rebuildTreeIndex(){let t=0;Lk(Wk,this).clear(),jt(Lk(Fk,this),(e=>{let[,{data:{colspan:o}}]=e;for(let e=t;e<t+o;e++)Lk(Wk,this).set(e,t);t+=o}))}buildTree(){this.clear();const t=Lk(Bk,this).getColumnsCount();let e=0;for(;e<t;){const t=Lk(Bk,this).getHeaderSettings(0,e),o=new _k;Lk(Fk,this).set(e,o),this.buildLeaves(o,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=Lk(Bk,this).getHeadersSettings(o,e,n);o+=1,jt(i,(n=>{const i={...n,headerLevel:o-1,columnIndex:e};let r;1===o?(t.data=i,r=t):(r=new _k(i),t.addChild(r)),o<Lk(Bk,this).getLayersCount()&&this.buildLeaves(r,e,o,n.origColspan),e+=n.origColspan}))}clear(){Lk(Fk,this).clear(),Lk(Wk,this).clear()}}function zk(t,e){t.walkDown((t=>{let{data:o,childs:n}=t;if(!o.isHidden&&(e(o.columnIndex),0===n.length))for(let t=1;t<o.colspan;t++)e(o.columnIndex+t)}))}function Uk(t,e){let{childs:o}=t;if(0!==o.length)return o[0].data[e]}function $k(t){return Uk(t,"origColspan")===t.data.origColspan}function Gk(t){const{data:e,childs:o}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($k(t))return Gk(o[0]);e.isCollapsed=!1;const n=o.slice(1),i=new Set;let r=0;if(n.length>0)jt(n,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,zk(t,(t=>{i.add(t)}))}));else{const{colspan:t,origColspan:o,columnIndex:n}=e;r=o-t;for(let t=1;t<o;t++)i.add(n+t)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):$k(t)&&(e.isCollapsed=Uk(t,"isCollapsed"))})),{rollbackModification:()=>Yk(t),affectedColumns:Array.from(i),colspanCompensation:r}}function Yk(t){var e;const{data:o,childs:n}=t;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($k(t))return Yk(n[0]);o.isCollapsed=!0;const i=n.slice(1),r=new Set;if(i.length>0)jt(i,(t=>{zk(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=o;for(let o=1;o<t;o++){const t=e+o;r.add(t)}}const s=o.colspan-(null!==(e=Uk(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=s,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):$k(t)&&(e.isCollapsed=Uk(t,"isCollapsed"))})),{rollbackModification:()=>Gk(t),affectedColumns:Array.from(r),colspanCompensation:s}}const Kk=new Map([["collapse",Yk],["expand",Gk],["hide-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0}))}],["show-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Gt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(!o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1}))}]]);function Xk(t){const e=[];return jt(t,(t=>{t.walkDown((t=>{const o=t.data,{origColspan:n,columnIndex:i,headerLevel:r,crossHiddenColumns:s}=o,l=function(t,e){let o;return Array.isArray(t[e])?o=t[e]:(o=[],t[e]=o),o}(e,r);let a=!1;for(let t=i;t<i+n;t++)if(s.includes(t)||a)l.push({label:"",isPlaceholder:!0});else{const t=qk(o);t.isRoot=!0,l.push(t),a=!0}}))})),e}function qk(t){const{crossHiddenColumns:e,...o}=Sk(t);return o}function Qk(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}function Zk(t,e,o){return t.set(tI(t,e),o),o}function Jk(t,e){return t.get(tI(t,e))}function tI(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var eI=new WeakMap,oI=new WeakMap,nI=new WeakMap;class iI{constructor(){Qk(this,eI,new Ak),Qk(this,oI,new jk(Jk(eI,this))),Qk(this,nI,[[]])}setState(t){Jk(eI,this).setData(t);let e=!1;try{Jk(oI,this).buildTree()}catch(t){Jk(oI,this).clear(),Jk(eI,this).clear(),e=!0}return Zk(nI,this,Xk(Jk(oI,this).getRoots())),e}setColumnsLimit(t){Jk(eI,this).setColumnsLimit(t)}mergeStateWith(t){const e=Bt(t,(t=>{let{row:e,...o}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...o}}));Jk(eI,this).mergeWith(e),Jk(oI,this).buildTree(),Zk(nI,this,Xk(Jk(oI,this).getRoots()))}mapState(t){Jk(eI,this).map(t),Jk(oI,this).buildTree(),Zk(nI,this,Xk(Jk(oI,this).getRoots()))}mapNodes(t){return Ft(Jk(oI,this).getRoots(),((e,o)=>(o.walkDown((o=>{const n=t(o.data);void 0!==n&&e.push(n)})),e)),[])}triggerNodeModification(t,e,o){e<0&&(e=this.rowCoordsToLevel(e));const n=Jk(oI,this).getNode(e,o);let i;return n&&(i=function(t,e,o){if(!Kk.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return Kk.get(t)(e,o)}(t,n,o),Zk(nI,this,Xk(Jk(oI,this).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var o,n;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(o=null===(n=Jk(nI,this)[t])||void 0===n?void 0:n[e])&&void 0!==o?o:null}getHeaderTreeNodeData(t,e){const o=this.getHeaderTreeNode(t,e);return o?{...o.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;return Jk(oI,this).getNode(t,e)||null}findTopMostEntireHeaderLevel(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const n=o-t+1;let i=!1,r=null;for(let e=t;e<=o;e++){const s=Jk(oI,this).getRootByColumn(e);if(!s)break;i=!0,s.walkDown((e=>{const{columnIndex:i,headerLevel:s,origColspan:l,isHidden:a}=e.data;a||l<=n&&i>=t&&i+l-1<=o&&(null===r||s<r)&&(r=s)}),Pk)}return i&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var o;const{isRoot:n}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0};if(n)return e;let i=e-1;for(;i>=0;){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,i))&&void 0!==r?r:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var o;const{isRoot:n,origColspan:i}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(n)return e+i-1;let r=e+1;for(;r<this.getColumnsCount();){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return Jk(eI,this).getLayersCount()}getColumnsCount(){return Jk(eI,this).getColumnsCount()}clear(){Zk(nI,this,[]),Jk(eI,this).clear(),Jk(oI,this).clear()}}function rI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const sI=class{constructor(t,e){rI(this,"hot",void 0),rI(this,"nestedHeaderSettingsGetter",void 0),rI(this,"layersCount",0),rI(this,"container",void 0),rI(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let o=0;o<e;o++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:o}=this.hot,n=e.createDocumentFragment(),i=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=o.getRenderableIndexesLength();for(let t=0;t<this.layersCount;t++){const n=e.createElement("tr");for(let i=0;i<s;i++){let s=o.getVisualFromRenderableIndex(i);null===s&&(s=i);const l=e.createElement("th"),a=this.nestedHeaderSettingsGetter(t,s);if(a&&(!a.isPlaceholder||a.isHidden)){let t=a.label;r&&(t+='<button class="changeType"></button>'),at(l,t),l.colSpan=a.colspan,n.appendChild(l)}}i.appendChild(n)}n.appendChild(i),t.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}};function lI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function aI(t,e,o){hI(t,e),e.set(t,o)}function hI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cI(t,e,o){return t.set(dI(t,e),o),o}function uI(t,e){return t.get(dI(t,e))}function dI(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const gI="nestedHeaders";var fI=new WeakMap,pI=new WeakMap,mI=new WeakMap,wI=new WeakMap,vI=new WeakSet;function yI(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:o}=e;if(o.isHeader()&&o.col>=0){const t=uI(fI,this).findLeftMostColumnIndex(o.row,o.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function bI(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:o}=e;if(!(o.isHeader()&&o.col>=0))return t;const n=this.hot.view.getFirstFullyVisibleColumn(),i=this.hot.view.getLastFullyVisibleColumn(),r=uI(fI,this).findLeftMostColumnIndex(o.row,o.col),s=uI(fI,this).findRightMostColumnIndex(o.row,o.col);return r<n&&s>i?t:r<n?r:s}function CI(t,e,o){const n=uI(fI,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:r,selectionWidth:s}=o,{isRoot:l,colspan:a}=uI(fI,this).getHeaderSettings(e,t);if(r===Ph){if(!l)return n.columnIndex}else if(r===Oh&&(a>s-i||!l))return null;return t}function SI(t,e,o){let{columnHeadersCount:n}=o;if(0!==n)for(let o=0;o<e.length;o++){const{startRow:n,startCol:r,endRow:s,endCol:l}=e[o],a=s-n+1;if(n>=0||1==r-l+1)break;for(let e=r;e<=l;e++)for(let o=n;o<=s;o++){var i;const n=a+o,s=e-r;0!==s&&(!1===(null===(i=uI(fI,this).getHeaderTreeNodeData(o,e))||void 0===i?void 0:i.isRoot)&&(t[n][s]=""))}}}function RI(t,e,o,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function EI(t,e){const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;cI(mI,this,e.clone()),cI(wI,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=o,a=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?r.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?r.push(i.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(Xe(t)||Ke(t)&&a)&&r.push(s,s+l-1,e.row),n.selectColumns(...r)}function TI(t,e,o,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:r,origColspan:s}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;n.column=!0,n.cell=!0;const u=[],d=tn(e.row,-1/0,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(a.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function xI(){cI(wI,this,!1)}function MI(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!uI(wI,this)||!t)return;const e=this.hot.getSelectedRangeLast(),o=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=uI(fI,this).getHeaderTreeNodeData(uI(mI,this).row,uI(mI,this).col);if(e.setHighlight(uI(mI,this)),r>e.getWidth()||i<o||i+r-1>n){const t=uI(fI,this).findTopMostEntireHeaderLevel(tn(o,i,i+r-1),tn(n,i,i+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function HI(t){const{highlight:e}=this.hot.getSelectedRangeLast(),o=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(o.isHeader()&&o.col>=0))return;const n=uI(fI,this).findLeftMostColumnIndex(o.row,o.col),i=uI(fI,this).findRightMostColumnIndex(o.row,o.col);if(t.col<0){const o=e.col>=n&&e.col<=i?n-1:i,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);t.col=null===r?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(r,e.col)-1,1)}else if(t.col>0){const o=e.col>=n&&e.col<=i?i+1:n,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);t.col=null===r?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,r)-1,1)}}function kI(t,e){const o=t.row,n=this._getHeaderTreeNodeDataByCoords({row:o,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:o,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function II(t){t.length=0;for(let e=0;e<uI(fI,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function AI(t){const e=uI(fI,this).getLayersCount();let o=t.startColumn,n=!!e;for(let i=0;i<e;i++){const e=uI(fI,this).findLeftMostColumnIndex(i,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(n=!1),qo(r)&&r<t.startColumn){o=r;break}}t.startColumn=n?uI(fI,this).getHeaderTreeNodeData(0,o).columnIndex:o}function OI(t,e){const o=this.ghostTable.getWidth(e);return t>o?t:o}function PI(t,e,o){var n;const{label:i}=null!==(n=uI(fI,this).getHeaderTreeNodeData(o,e))&&void 0!==n?n:{label:""};return i}function NI(t,e){if(t<0)return this.hot.getCell(t,uI(fI,this).findLeftMostColumnIndex(t,e),!0)}function _I(){this.updatePlugin()}function DI(t,e){e||this.updatePlugin()}function LI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const VI=class{constructor(t,e){LI(this,"hot",void 0),LI(this,"data",null),LI(this,"plugin",void 0),LI(this,"parentReference",new WeakMap),LI(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Qo(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,o){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:o,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&jt(t.__children,(o=>{this.cacheNode(o,e+1,t)}))}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,o,n){let i=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},i=!0,r-=1),null!=o&&r===o?{result:s,end:!0}:null!=n&&s===n?{result:r,end:!0}:(r+=1,s.__children&&jt(s.__children,(t=>{if(this.parentReference.set(t,i?null:s),r=this.readTreeNodes(t,r,o,n),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return Se(this.data[0],((e,o)=>{t[o]=null})),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const o=this.getRowParent(t);return null==o?this.data.indexOf(e):o.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(jt(o.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var o;return(null===(o=t.__children)||void 0===o?void 0:o[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(e=o.__children)||void 0===e?void 0:e.length)}addChild(t,e){let o=e;this.hot.runHooks("beforeAddChild",t,o);let n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.push(o),this.rewriteCache();const r=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,o)}addChildAtIndex(t,e,o){let n,i=o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const o=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",o,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(o,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",o,1),n=o}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);i=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(t),n=this.getRowParent(o),i=this.getRowIndexWithinParent(o);switch(e){case"below":this.addChildAtIndex(n,i+1,null);break;case"above":this.addChildAtIndex(n,i,null)}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const n=[];Array.isArray(t)?(Qo(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);n.push(this.getDataObject(e))})),Qo(0,n.length-2,(t=>{this.detachFromParent(n[t],!1)})),o=n[n.length-1]):o=t;const i=this.getRowIndex(o),r=this.countChildren(o),s=this.getRowIndexWithinParent(o),l=this.getRowParent(o),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!=s){const t=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),a.__children.push(o)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),e&&this.hot.render()}filterData(t,e,o){const n=[];jt(o,(t=>{n.push(this.getDataObject(t))})),jt(n,(t=>{const e=this.getRowIndexWithinParent(t),o=this.getRowParent(t);null===o?this.data.splice(e,1):o.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,o){const n=this.getDataObject(t-1);let i=null,r=t;n&&n.__children&&0===n.__children.length?(i=n,r=0):t<this.countAllRows()&&(i=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),i?o?i.__children.splice(r,e,...o):i.__children.splice(r,e):o?this.data.splice(r,e,...o):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,o=null;do{o=this.getRowParent(o),null!==o&&(e=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,o,n){const i=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=r.__children.slice(s,s+1),a=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||o||n?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,l[0]),r.__children.splice(s+(a&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}};function FI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const WI=class{constructor(t,e){FI(this,"hot",void 0),FI(this,"plugin",void 0),this.hot=e,this.plugin=t}};class BI extends WI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const o=this.hot.toPhysicalRow(t),n=this.dataManager.getRowLevel(o),i=this.dataManager.getDataObject(o),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(jt(l,(t=>{t&&r.removeChild(t)})),et(e,BI.CSS_CLASSES.indicatorContainer),n){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",Qo(0,n-1,(()=>{const e=t.createElement("SPAN");et(e,BI.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");a&&nt(t,[_()]),et(e,BI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?(et(t,`${BI.CSS_CLASSES.button} ${BI.CSS_CLASSES.expandButton}`),a&&nt(e,[B(!1)])):(et(t,`${BI.CSS_CLASSES.button} ${BI.CSS_CLASSES.collapseButton}`),a&&nt(e,[B(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}const jI=BI,zI=class extends WI{constructor(t,e){var o;super(t,e),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),jt(o.lastCollapsedRows,((i,r)=>{i>=t&&i<e&&(o.lastCollapsedRows[r]=i+n)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:(t,e)=>{Qo(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(i)&&jt(i.__children,(t=>{n.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(n,!0,!1),o&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];jt(t,(t=>{n.push(...this.collapseChildren(t,!1,!1))})),o&&this.trimRows(n),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return jt(t,(t=>{n.push(t),e&&this.collapseChildRows(t,n)})),o&&this.trimRows(n),n}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(t)&&jt(this.dataManager.getDataObject(t).__children,(t=>{const o=this.dataManager.getRowIndex(t);e.push(o),this.collapseChildRows(o,e)})),o&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return jt(t,(t=>{n.push(t),e&&this.expandChildRows(t,n)})),o&&this.untrimRows(n),n}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.dataManager.hasChildren(t)&&jt(this.dataManager.getDataObject(t).__children,(t=>{if(!this.isAnyParentCollapsed(t)){const o=this.dataManager.getRowIndex(t);e.push(o),this.expandChildRows(o,e)}})),o&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,r=null,s=null;return isNaN(t)?(i=t,r=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&jt(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);n.push(e)})),s=this.expandRows(n,!0,!1),o&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];jt(t,(t=>{n.push(...this.expandChildren(t,!1,!1))})),o&&this.untrimRows(n),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];jt(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];jt(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{jt(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{jt(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),o=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&jt(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return o=!1,!1})),o}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const o=this.translateTrimmedRow(e.row);tt(t.target,jI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),Ge(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};var UI=new WeakMap;const $I=class extends WI{constructor(){var t,e,o;super(...arguments),t=this,e="dataManager",o=this.plugin.dataManager,e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,function(t,e,o){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.set(t,o)}(this,UI,{row_above:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"below")}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Aa)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Oa)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Qo(0,t.items.length-1,(o=>{if(0===o)return jt(e,((e,n)=>{t.items.splice(o+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return Qo(0,t.items.length-1,(e=>{const o=(n=UI,i=this,n.get(function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(n,i)))[t.items[e].key];var n,i;null!=o&&(t.items[e].callback=o)})),t}};function GI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}class YI{constructor(t){GI(this,"plugin",void 0),GI(this,"hot",void 0),GI(this,"dataManager",void 0),GI(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,o,n){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:o,movePossible:n}))return!1;this.movedToCollapsed=!1;const i=o===this.hot.countRows(),r=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let s=!0;const l=t.map((t=>{if(!s)return!1;const e=this.dataManager.translateTrimmedRow(t);return s=this.shouldAllowMoving(e,r),e})),a=-1===l.indexOf(r);if(!s||!a)return!1;const h=this.getBaseParent(l),c=this.getTargetParent(i,r),u=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,r,u),this.moveRows(l,r,c),this.dataManager.rewriteCache(),this.moveCellsMeta(l,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,o,n,n&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,o),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:o,dropIndex:n,movePossible:i}=t;let r=!1;return Xt(n)&&(qe(Gt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,o,n,i,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let o=this.dataManager.getRowParent(t?e-1:e);return null==o&&(o=this.dataManager.getRowParent(e-1)),o}shiftCollapsibleParentsLocations(t,e,o){o||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,o){const n=e===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,n)}))}))}moveCellsMeta(t,e){const o=[],n=Math.max(...t)<e;t.forEach((t=>{o.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(n?o.length:0),0,...o)}selectCells(t,e){const o=t.length;let n=0,i=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[o-1]<e?this.dataManager.translateTrimmedRow(e-o):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(s);n=this.dataManager.untranslateTrimmedRow(l),i=n}else t[o-1]<e?(i=e-1,n=i-o+1):(n=e,i=n+o-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(n,0)),r.setRangeEnd(this.hot._createCellCoords(i,s),!0)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}}function KI(t,e,o){XI(t,e),e.set(t,o)}function XI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qI(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function QI(t,e){return t.get(JI(t,e))}function ZI(t,e,o){return t.set(JI(t,e),o),o}function JI(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const tA="nestedRows",eA=tA;var oA=new WeakMap,nA=new WeakMap,iA=new WeakSet;function rA(t,e,o,n){return this.rowMoveController.onBeforeRowMove(t,e,o,n)}function sA(t,e,o){this.collapsingUI.toggleState(t,e,o)}function lA(t,e,o){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*e),this.dataManager.filterData(t,e,o),ZI(oA,this,!0),this.dataManager.getData().slice()}function aA(t){return this.contextMenuUI.appendOptions(t)}function hA(t,e){this.headersUI.appendLevelIndicators(t,e)}function cA(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function uA(t,e,o,n){n!==this.pluginName&&this.hot._registerTimeout((()=>{ZI(oA,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function dA(t,e,o){const n=Array.from(o.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const o=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(o)&&o.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));o.length=0,o.push(...n)}function gA(){this.collapsingUI.collapsedRowsStash.stash()}function fA(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function pA(){this.collapsingUI.collapsedRowsStash.stash()}function mA(t,e,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function wA(){this.dataManager.rewriteCache()}function vA(){this.headersUI.updateRowHeaderWidth()}function yA(t,e){QI(oA,this)&&(e.skipRender=!0)}function bA(t){if(!function(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"==typeof t&&!Array.isArray(t)&&null!==t)))}(t))return Qe("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[tA]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function CA(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}const SA=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;CA(this,"rootWindow",void 0),CA(this,"prefix",void 0),CA(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const o=void 0===t?e:t,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${o}`);return null===n?void 0:JSON.parse(n)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){jt(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};io.getSingleton().register("persistentStateSave"),io.getSingleton().register("persistentStateLoad"),io.getSingleton().register("persistentStateReset");const RA="persistentState";function EA(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function TA(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}const xA="search",MA=function(t,e,o,n,i){t.getCellMeta(e,o).isSearchResult=i},HA=function(t,e,o){return!(Xt(t)||null===t||!t.toLocaleLowerCase||0===t.length||Xt(e)||null===e||-1===e.toString().toLocaleLowerCase(o.locale).indexOf(t.toLocaleLowerCase(o.locale)))};var kA=new WeakSet;function IA(t,e,o,n,i,r){const s=r.className||[];let l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}function AA(t,e,o){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function OA(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}var PA=new WeakSet;function NA(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(o),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function _A(){this.freezeOverlays=!0,jt(this.clones,(t=>{et(t,"hide-tween")}))}function DA(){this.freezeOverlays=!1,jt(this.clones,(t=>{ot(t,"hide-tween"),et(t,"show-tween")})),this.hot._registerTimeout((()=>{jt(this.clones,(t=>{ot(t,"show-tween")}))}),400),jt(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}const LA="trimRows";var VA=new WeakSet;function FA(){const t=this.hot.getSettings()[LA];Array.isArray(t)&&this.hot.batchExecution((()=>{jt(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}o(3921);const WA="undoRedo";function BA(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(o,n){const i=o&&o.length;i&&o.find((t=>{const[,,e,o]=t;return e!==o}))&&e.done((()=>{const e=o.reduce(((t,e)=>(t.push([...e]),t)),[]);jt(e,(e=>{e[1]=t.propToCol(e[1])}));const n=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new BA.ChangeAction(e,n)}),n)})),t.addHook("afterCreateRow",((t,o,n)=>{e.done((()=>new BA.CreateRowAction(t,o)),n)}));const o=(e,o,n,i)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,l=[];return Qo(n,i,(n=>{Qo(e,o,(e=>{const o=t.getCellMeta(e,n);if(Object.keys(o).length!==s){const t=Object.fromEntries(Object.entries(o).filter((t=>{let[e]=t;return!1===r.includes(e)})));l.push([o.visualRow,o.visualCol,t])}}))})),l};t.addHook("beforeRemoveRow",((n,i,r,s)=>{e.done((()=>{const r=t.toPhysicalRow(n),s=r+i-1,l=me(e.instance.getSourceData(r,0,r+i-1,e.instance.countSourceCols()-1));return new BA.RemoveRowAction(r,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),o(r,s,0,t.countCols()-1))}),s)})),t.addHook("afterCreateCol",((t,o,n)=>{e.done((()=>new BA.CreateColumnAction(t,o)),n)})),t.addHook("beforeRemoveCol",((n,i,r,s)=>{e.done((()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+n)%e.instance.countCols(),l=s+i-1,a=[],h=[],c=[];Qo(r.length-1,(e=>{const o=[],n=r[e];Qo(s,l,(e=>{o.push(n[t.toPhysicalColumn(e)])})),a.push(o)})),Qo(i-1,(e=>{c.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&Qo(i-1,(e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new BA.RemoveColumnAction(s,c,a,h,u,d,t.getSettings().fixedColumnsStart,o(0,t.countRows(),s,l))}),s)})),t.addHook("beforeCellAlignment",((t,o,n,i)=>{e.done((()=>new BA.CellAlignmentAction(t,o,n,i)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new BA.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,o)=>{!1!==t&&e.done((()=>new BA.RowMoveAction(t,o)))})),t.addHook("beforeColumnMove",((t,o)=>{!1!==t&&e.done((()=>new BA.ColumnMoveAction(t,o)))})),t.addHook("beforeMergeCells",((o,n)=>{n||e.done((()=>new BA.MergeCellsAction(t,o)))})),t.addHook("afterUnmergeCells",((o,n)=>{n||e.done((()=>new BA.UnmergeCellsAction(t,o)))})),t.addHook("afterInit",(()=>{e.init()}))}BA.prototype.done=function(t,e){if(this.ignoreNewActions)return;if("UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;const o=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",o,e))return;const n=t(),i=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())},BA.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const o=me(e);if(!1===this.instance.runHooks("beforeUndo",o))return;this.ignoreNewActions=!0;const n=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(()=>{n.ignoreNewActions=!1,n.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},BA.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const o=me(e);if(!1===this.instance.runHooks("beforeRedo",o))return;this.ignoreNewActions=!0;const n=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(()=>{n.ignoreNewActions=!1,n.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},BA.prototype.isUndoAvailable=function(){return this.doneActions.length>0},BA.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},BA.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},BA.prototype.isEnabled=function(){return this.enabled},BA.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;var e;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",UA)},BA.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;var e;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",UA)},BA.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},BA.Action=function(){},BA.Action.prototype.undo=function(){},BA.Action.prototype.redo=function(){},BA.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},ge(BA.ChangeAction,BA.Action),BA.ChangeAction.prototype.undo=function(t,e){const o=me(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let t=0,e=o.length;t<e;t++)o[t].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.undo");for(let e=0,r=o.length;e<r;e++){const[r,s]=o[e];t.getSettings().minSpareRows&&r+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(r+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&s+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(s+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const r=t.getSelectedLast();if(void 0!==r){const[e,n]=o[0],[i,s]=r,l=e>=t.view.getFirstFullyVisibleRow(),a=n>=t.view.getFirstFullyVisibleColumn();if(!1===(l&&a)&&!0==(i!==e||s!==n)){const o={row:e,col:n};!1===l&&(o.verticalSnap="top"),!1===a&&(o.horizontalSnap="start"),t.scrollViewportTo(o)}}t.selectCells(this.selected,!1,!1)},BA.ChangeAction.prototype.redo=function(t,e){const o=me(this.changes);for(let t=0,e=o.length;t<e;t++)o[t].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},BA.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},ge(BA.CreateRowAction,BA.Action),BA.CreateRowAction.prototype.undo=function(t,e){const o=t.countRows(),n=t.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},BA.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},BA.RemoveRowAction=function(t,e,o,n,i,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=r},ge(BA.RemoveRowAction,BA.Action),BA.RemoveRowAction.prototype.undo=function(t,e){const o=t.getSettings(),n=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((o=>{const i=parseInt(o,10);n.push([this.index+e,isNaN(i)?o:i,t[o]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((e=>{let[o,n,i]=e;t.setCellMetaObject(o,n,i)})),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},BA.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},BA.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},ge(BA.CreateColumnAction,BA.Action),BA.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},BA.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},BA.RemoveColumnAction=function(t,e,o,n,i,r,s,l){this.index=t,this.indexes=e,this.data=o,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=l},ge(BA.RemoveColumnAction,BA.Action),BA.RemoveColumnAction.prototype.undo=function(t,e){t.getSettings().fixedColumnsStart=this.fixedColumnsStart;const o=this.indexes.slice(0).sort(),n=(t,e,n)=>n[this.indexes.indexOf(o[e])],i=this.data.length,r=[];for(let t=0;t<i;t++)r.push(Bt(this.data[t],n));const s=Bt(this.headers,n),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),jt(t.getSourceDataArray(),((t,e)=>{jt(o,((o,n)=>{t[o]=r[e][n],l.push([e,o,t[o]])}))})),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&jt(s,((e,n)=>{t.getSettings().colHeaders[o[n]]=e})),this.removedCellMetas.forEach((e=>{let[o,n,i]=e;t.setCellMetaObject(o,n,i)})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},BA.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},BA.CellAlignmentAction=function(t,e,o,n){this.stateBefore=t,this.range=e,this.type=o,this.alignment=n},BA.CellAlignmentAction.prototype.undo=function(t,e){jt(this.range,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&t.setCellMeta(e,o,"className",this.stateBefore[e][o]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},BA.CellAlignmentAction.prototype.redo=function(t,e){Ew(this.range,this.type,this.alignment,((e,o)=>t.getCellMeta(e,o)),((e,o,n,i)=>t.setCellMeta(e,o,n,i))),t.addHookOnce("afterViewRender",e),t.render()},BA.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},ge(BA.FiltersAction,BA.Action),BA.FiltersAction.prototype.undo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),o.filter()},BA.FiltersAction.prototype.redo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};class jA extends BA.Action{constructor(t,e){super(),this.cellRange=e;const o=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(o.row,o.col,n.row,n.col)}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();t.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange)}}BA.MergeCellsAction=jA;class zA extends BA.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange,!0)}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0),t.render()}}function UA(t,e){if("loadData"===e)return this.undoRedo.clear()}BA.UnmergeCellsAction=zA,BA.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"},ge(BA.RowMoveAction,BA.Action),BA.RowMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),UR(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:n}=t;e<n&&(n-=1),o.moveRow(n,e)})),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},BA.RowMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),o.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},BA.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"},ge(BA.ColumnMoveAction,BA.Action),BA.ColumnMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),UR(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:n}=t;e<n&&(n-=1),o.moveColumn(n,e)})),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},BA.ColumnMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),o.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},BA.prototype.init=function(){const t=this.instance.getSettings().undo,e=void 0===t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},BA.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),e={runOnlyIf:t=>!t.altKey,group:WA};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],e)},BA.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(WA)};const $A=io.getSingleton();$A.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),$A.register("beforeUndo"),$A.register("afterUndo"),$A.register("beforeRedo"),$A.register("afterRedo"),BA.PLUGIN_KEY="undoRedo",BA.SETTING_KEYS=!0;const GA=BA;wo(Rd),wo(Wg),wo(Bg),wo(wf),wo(vf),wo(Dg),wo(yf),wo(bf),wo(Rf),wo(Ad),wo(Ef),Sn(xf),Sn(Od),Sn(Pf),Sn(Mf),Sn(_f),Sn(Tf),Sn(Vf),Sn(Ff),Sn(Wf),Sn(Pd),Sn(Bf),Hn(jf),Hn($f),Hn(Uf),Hn(Gf),Hn(Kf),Bc(Xf),Bc(qf),Bc(Zf),Bc(Jf),Bc(tp),Bc(ep),Bc(op),Bc(np),Bc(Nd),Bc(ip),pn(Hp),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=Wp),e.add(t),Dp(this,"addingStarted",!1),Dp(this,"mouseDownOnCellCorner",!1),Dp(this,"mouseDragOutside",!1),Dp(this,"handleDraggedCells",0),Dp(this,"directions",[]),Dp(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return Vp}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[Vp,...Fp]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>Lp(Wp,this,jp).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>Lp(Wp,this,Bp).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>Lp(Wp,this,zp).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:o}=t.getTopStartCorner(),{row:n,col:i}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:o,endRow:n,endCol:i}]),s=[],l=[],a=[];return jt(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),jt(s,(t=>{const e=[];jt(l,(o=>{e.push(this.hot.getCopyableData(t,o))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,o,n]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,s.row,s.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,o),Math.max(s.col,n)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=function(t,e,o){let n,i,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",n=o(e[0],e[1]),i=o(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",n=o(e[0],t[3]+1),i=o(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",n=o(e[0],e[1]),i=o(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",n=o(t[2]+1,e[1]),i=o(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:n,endOfDragCoords:i}}(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),o=this.hot._createCellRange(c,c,u),n=this.hot.runHooks("beforeAutofill",t,e,o,h);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=n;const s=n;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let o=0;o<t;o++)r.push(s[(o+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let o=0;o<s.length;o++){r.push([]);for(let n=0;n<t;n++)r[o].push(s[o][(n+(s[o].length-e))%s[o].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",r,e,o,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),o=e.getBottomEndCorner();let n=t;if(this.directions.includes(_p.vertical)&&this.directions.includes(_p.horizontal)){const i=e.getTopStartCorner();(o.col<=t.col||i.col>=t.col)&&(n=this.hot._createCellCoords(o.row,t.col)),(o.row<t.row||i.row>t.row)&&(n=this.hot._createCellCoords(t.row,o.col))}else if(this.directions.includes(_p.vertical))n=this.hot._createCellCoords(t.row,o.col);else{if(!this.directions.includes(_p.horizontal))return;n=this.hot._createCellCoords(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),o=this.hot.countRows();let n;for(let i=t[2]+1;i<o;i++){for(let o=t[1];o<=t[3];o++)if(!qt(e[i][o]))return-1;const o=e[i][t[1]-1],r=e[i][t[3]+1];qt(o)&&qt(r)||(n=i)}return n}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...Bt(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,o=ut(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Ct(this.hot.table),n=ut(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+bt(this.hot.table);return t.clientY>o&&t.clientX<=n}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>Lp(Wp,this,Up).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>Lp(Wp,this,$p).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=function(t){const e={};return!0===t?(e.directions=Object.keys(_p),e.autoInsertRow=!0):be(t)?(Kt(t.autoInsertRow)?t.direction===_p.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Kt(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(_p)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}),pn(qp),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=hm),e.add(t),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"headerIndexes",null)}static get PLUGIN_KEY(){return lm}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[lm]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[lm];"string"!=typeof t&&(t="loose");const e=am.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(hm,this,cm).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t;super(...arguments),um(this,t=Sm),t.add(this),dm(this,"nestedHeadersPlugin",null),dm(this,"headerStateManager",null),function(t,e,o){um(t,e),e.set(t,null)}(this,Cm)}static get PLUGIN_KEY(){return mm}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[mm,...wm]}isEnabled(){return!!this.hot.getSettings()[mm]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||qe("You need to configure the Nested Headers plugin in order to use collapsible headers."),fm(Cm,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>pm(Sm,this,Tm).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return pm(Sm,t,xm).call(t,...o)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return pm(Sm,t,Rm).call(t,...o)})),this.addHook("beforeOnCellMouseDown",((t,e,o)=>pm(Sm,this,Em).call(this,t,e,o))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),fm(Cm,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:i,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,o))&&void 0!==t?t:{};if(n)return i?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:ym,relativeToGroup:wu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ym)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};Qo(0,t-1,(t=>{const r=e.childNodes[t],s=o.childNodes[t],l=n?n.childNodes[t]:null;Qo(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${vm}`);i(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${vm}`),i(e)),n&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${vm}`),i(e))}))}))}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:o,origColspan:n,headerLevel:i,columnIndex:r,isCollapsed:s}=e;if(!0===o&&n>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!bm.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const o=Wt(t,(t=>{let{row:e}=t;return e<0}));let n=o.length>0;jt(o,(t=>{var o;let{row:i,col:r}=t;const{collapsible:s,isCollapsed:l}=null!==(o=this.headerStateManager.getHeaderSettings(i,r))&&void 0!==o?o:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return n=!1,!1}));const i=[],r=[];n&&jt(o,(t=>{let{row:o,col:n}=t;const{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,o,n);s>0&&(r.push(...l),i.push(a))}));const s=this.getCollapsedColumns();let l=[];"collapse"===e?l=zt([...s,...r]):"expand"===e&&(l=Wt(s,(t=>!r.includes(t))));const a=bm.get(e);if(!1===this.hot.runHooks(a.beforeHook,s,l,n))return void jt(i,(t=>{t()}));this.hot.batchExecution((()=>{jt(r,(t=>{gm(Cm,this).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length,c=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&c){const{row:t,col:e}=c.highlight;if((this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e))&&r.includes(e)){const o=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,n=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==o&&null!==n&&this.hot.selectCell(o,n)}}this.hot.runHooks(a.afterHook,s,l,n,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return gm(Cm,this).getHiddenIndexes()}destroy(){fm(Cm,this,null),super.destroy()}}),pn(ow),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=dw),e.add(t),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"endpoints",null)}static get PLUGIN_KEY(){return uw}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[uw]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[uw],this.endpoints=new aw(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return cw(dw,t,gw).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return cw(dw,t,fw).call(t,...o)})),this.addHook("beforeCreateRow",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,o))),this.addHook("beforeCreateCol",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,o))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)})),this.addHook("afterCreateRow",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,o))),this.addHook("afterCreateCol",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,o))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return cw(dw,t,pw).call(t,...o)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return Se(t.ranges,(o=>{e+=this.getPartialSum(o,t.sourceColumn)})),e}getPartialSum(t,e){let o=0,n=t[1]||t[0],i=null,r=0;do{if(i=this.getCellValue(n,e),i=hw(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>r&&(r=t)}o+=i||0,n-=1}while(n>=t[0]);return Math.round(o*10**r)/10**r}calculateMinMax(t,e){let o=null;return Se(t.ranges,(n=>{const i=this.getPartialMinMax(n,t.sourceColumn,e);if(null===o&&null!==i&&(o=i),null!==i)switch(e){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i)}})),null===o?"Not enough data":o}getPartialMinMax(t,e,o){let n,i=null,r=t[1]||t[0];do{if(n=this.getCellValue(r,e),n=hw(n)?null:n,null===i)i=n;else if(null!==n)switch(o){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n)}r-=1}while(r>=t[0]);return i}countEmpty(t,e){let o,n=0,i=t[1]||t[0];do{o=this.getCellValue(i,e),o=hw(o)?null:o,null===o&&(n+=1),i-=1}while(i>=t[0]);return n}countEntries(t){let e=0;return Se(t.ranges,(o=>{const n=void 0===o[1]?1:o[1]-o[0]+1,i=this.countEmpty(o,t.sourceColumn);e+=n,e-=i})),e}calculateAverage(t){return this.calculateSum(t)/this.countEntries(t)}getCellValue(t,e){const o=this.hot.toVisualRow(t),n=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),r="";if(null!==o&&null!==n&&(r=this.hot.getCellMeta(o,n).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Gt`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}),pn(class extends fp{constructor(){var t;super(...arguments),kw(this,t=Yw),t.add(this),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"range",{}),Hw(this,Ww,null),Hw(this,Bw,null),Hw(this,jw,!1),Hw(this,zw,!1),Hw(this,Uw,{}),Hw(this,$w,null),Hw(this,Gw,"")}static get PLUGIN_KEY(){return Pw}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[Pw]}enablePlugin(){this.enabled||(Aw(Ww,this)||Iw(Ww,this,new vw(this.hot.rootDocument,this.hot.isRtl())),Aw(Bw,this)||Iw(Bw,this,new Cw(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,o,n,i,r)=>Ow(Yw,this,Qw).call(this,t,r))),this.addHook("afterScroll",(()=>Ow(Yw,this,nv).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>Ow(Yw,this,ov).call(this,t))),Aw(Bw,this).addLocalHook("hide",(()=>this.hide())),Aw(Bw,this).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Aw(Bw,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),o=t.addContext(Fw);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();Iw(zw,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(Fw),this.hot._registerTimeout((()=>{Iw(zw,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!Aw(Ww,this).isVisible()},group:Vw}),o.addShortcut({keys:[["Escape"]],callback:()=>{Aw(Ww,this).setValue(Aw(Gw,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&Aw(Ww,this).isVisible()},group:Vw}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&Aw(Ww,this).isVisible()},group:Vw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Vw)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>Ow(Yw,this,Xw).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>Ow(Yw,this,Kw).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>Ow(Yw,this,qw).call(this))),this.eventManager.addEventListener(e,"focus",(()=>Ow(Yw,this,Jw).call(this))),this.eventManager.addEventListener(e,"blur",(()=>Ow(Yw,this,Zw).call(this))),this.eventManager.addEventListener(e,"mousedown",(t=>Ow(Yw,this,tv).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(t=>Ow(Yw,this,ev).call(this,t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=K(t.target,"TD","TBODY");return!!(e&&tt(e,"htCommentCell")&&K(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=Aw(Ww,this).getValue();let o="";null!=t?o=t:null!=e&&(o=e);const n=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(n,i,{[_w]:o}),this.hot.render()}setCommentAtCell(t,e,o){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(o)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Nw),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(o)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,_w)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,_w)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:o}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Aw(Bw,this).cancelHiding(),Aw(Ww,this).setValue(null!==(t=n[Nw]?n[Nw][_w]:null)&&void 0!==t?t:""),Aw(Ww,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){Aw(Ww,this).hide()}refreshEditor(){var t,e;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&Aw(Ww,this).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:n}=this.hot,{row:i,col:r}=this.range.from;let s=o.getRenderableFromVisualIndex(i),l=n.getRenderableFromVisualIndex(r);const a=null===s;Aw(Ww,this).setPosition(0,0),null===s&&(s=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(i,-1))),null===l&&(l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1)));const h=null===s,c=null===l;s=null!==(t=s)&&void 0!==t?t:0,l=null!==(e=l)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:d}}=this.hot,{wtTable:g}=d,f=d.getCell({row:s,col:l},!0),p=this.getCommentMeta(i,r,Dw);p?Aw(Ww,this).setSize(p.width,p.height):Aw(Ww,this).resetSize();const m=c?0:g.getStretchedColumnWidth(l),w=a&&!h?Ct(f):0,{left:v,top:y,width:b,height:C}=f.getBoundingClientRect(),{width:S,height:R}=Aw(Ww,this).getSize(),{innerWidth:E,innerHeight:T}=this.hot.rootWindow,x=this.hot.rootDocument.documentElement;let M=v+u.scrollX+m,H=y+u.scrollY+w;this.hot.isRtl()&&(M-=S+m),this.hot.isLtr()&&v+b+S>E?M=v+u.scrollX-S-1:this.hot.isRtl()&&M<-(x.scrollWidth-x.clientWidth)&&(M=v+u.scrollX+m+1),y+R>T&&(H-=R-C+1),Aw(Ww,this).setPosition(M,H),Aw(Ww,this).setReadOnlyState(this.getCommentMeta(i,r,Lw))}focusEditor(){Aw(Ww,this).focus()}updateCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e)[Nw];let i;n?(i=me(n),pe(i,o)):i=o,this.hot.setCellMeta(t,e,Nw,i)}getCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e);if(n[Nw])return n[Nw][o]}addToContextMenu(t){var e;t.items.push({name:Sw},(e=this,{key:"commentsAddEdit",name(){var t;const o=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=o&&o.isCell()&&e.getCommentAtCell(o.row,o.col)?this.getTranslatedPhrase(fa):this.getTranslatedPhrase(ga)},callback(){const t=this.getSelectedRangeLast();this.deselectCell(),e.setRange(t),e.show(),e.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(pa)},callback(){this.getSelectedRangeLast().forAll(((e,o)=>{e>=0&&o>=0&&t.removeCommentAtCell(e,o,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(ma),o=xw(this.getSelectedRange(),((e,o)=>t.getCommentMeta(e,o,Lw)));return o?Tw(e):e},callback(){this.getSelectedRangeLast().forAll(((e,o)=>{if(e>=0&&o>=0){const n=!!t.getCommentMeta(e,o,Lw);t.updateCommentMeta(e,o,{[Lw]:!n})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[Pw];if(be(t))return t.displayDelay}getEditorInputElement(){return Aw(Ww,this).getInputElement()}destroy(){Aw(Ww,this)&&Aw(Ww,this).destroy(),Aw(Bw,this)&&Aw(Bw,this).destroy(),super.destroy()}}),pn(oy),pn(class extends fp{constructor(){var t;super(...arguments),xy(this,t=jy),t.add(this),My(this,"columnsLimit",1/0),My(this,"rowsLimit",1/0),My(this,"pasteMode","overwrite"),My(this,"uiContainer",this.hot.rootDocument.body),Ty(this,Ny,!1),Ty(this,_y,!1),Ty(this,Dy,!1),Ty(this,Ly,"cells-only"),Ty(this,Vy,!1),Ty(this,Fy,!1),Ty(this,Wy,new Cy({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ty(this,By,!1),My(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ay}static get SETTING_KEYS(){return[Ay,...Oy]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[Ay]}enablePlugin(){var t=this;if(this.enabled)return;const{[Ay]:e}=this.hot.getSettings();var o,n;"object"==typeof e&&(this.pasteMode=null!==(o=e.pasteMode)&&void 0!==o?o:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,ky(Ny,this,!!e.copyColumnHeaders),ky(_y,this,!!e.copyColumnGroupHeaders),ky(Dy,this,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(n=e.uiContainer)&&void 0!==n?n:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(t=>Iy(jy,this,Yy).call(this,t))),this.addHook("afterSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Iy(jy,t,Ky).call(t,...o)})),this.addHook("afterSelectionEnd",(()=>Iy(jy,this,Xy).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),De()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Iy(jy,t,qy).call(t,...o)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return Iy(jy,t,Qy).call(t,...o)})),this.addHook("afterSelection",(()=>Iy(jy,this,Zy).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){ky(Ly,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),ky(Vy,this,!0),Iy(jy,this,zy).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ky(Fy,this,!0),Iy(jy,this,zy).call(this,"cut")}getRangedCopyableData(t){return uu(this.getRangedData(t))}getRangedData(t){const e=[],{rows:o,columns:n}=Ey(t);return jt(o,(t=>{const o=[];jt(n,(e=>{t<0?o.push(this.hot.getColHeader(e,t)):o.push(this.hot.getCopyableData(t,e))})),e.push(o)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const o=new ay;t&&o.clipboardData.setData("text/plain",t),e&&o.clipboardData.setData("text/html",e),this.onPaste(o)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);Hy(Wy,this).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===Hy(Ly,this)?e.set("headers",Hy(Wy,this).getMostBottomColumnHeadersRange()):("with-column-headers"===Hy(Ly,this)?e.set("headers",Hy(Wy,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Hy(Ly,this)&&e.set("headers",Hy(Wy,this).getAllColumnHeadersRange()),e.set("cells",Hy(Wy,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:o,endRow:n,endCol:i}=t;return{startRow:e,startCol:o,endRow:n,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=e.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:t,startCol:e,endRow:n,endCol:i}=o;this.hot.runHooks("afterCopyLimit",n-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const o=t.length,n=t[0].length,i=[],{row:r,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;for(;i.length<o||h<=l;){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;u=l,c=s;const g=[],f=i.length%o;for(;g.length<n||c<=a;){const{skipColumnOnPaste:e,visualCol:o}=this.hot.getCellMeta(r,c);if(c=o+1,!0===e)continue;d=o;const i=g.length%n;g.push(t[f][i])}i.push(g)}return ky(By,this,!0),this.hot.populateFromArray(r,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){if(!this.hot.isListening()&&!Hy(Vy,this)||this.isEditorOpened())return;this.setCopyableText(),ky(Vy,this,!1);const e=this.getRangedData(this.copyableRanges),o=Iy(jy,this,Uy).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",e,this.copyableRanges,o)){const n=uu(e);if(t&&t.clipboardData){const o=Xo(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[Py,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",e,this.copyableRanges,o)}ky(Ly,this,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!Hy(Fy,this)||this.isEditorOpened())return;this.setCopyableText(),ky(Fy,this,!1);const e=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",e,this.copyableRanges)){const o=uu(e);if(t&&t.clipboardData){const n=Xo(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[Py,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){const o=A(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const o={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let r=t;if("string"==typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0];return`${e}${t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${t}`),r=i.querySelector("table")}if(!r||!function(t){return"TABLE"===(t&&t.nodeName||"")}(r))return;const s=i.querySelector('meta[name$="enerator"]'),l=null!==r.querySelector("tbody th"),a=r.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?o.nestedHeaders=Array.from(t).reduce(((t,e)=>{const o=Array.from(e.cells).reduce(((t,e,o)=>{if(l&&0===o)return t;const{colSpan:n,innerHTML:i}=e,r=n>1?{label:i,colspan:n}:i;return t.push(r),t}),[]);return t.push(o),t}),[]):d&&(o.colHeaders=Array.from(t[0].children).reduce(((t,e,o)=>(l&&0===o||t.push(e.innerHTML),t)),[]))}u.length&&(o.fixedRowsTop=u.length),c.length&&(o.fixedRowsBottom=c.length);const p=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=p.length;const m=new Array(f);for(let t=0;t<f;t++)m[t]=new Array(h);const w=[],v=[];for(let t=0;t<f;t++){const e=p[t],o=Array.from(e.cells),n=o.length;for(let e=0;e<n;e++){const n=o[e],{nodeName:i,innerHTML:r,rowSpan:l,colSpan:a}=n,h=m[t].findIndex((t=>void 0===t));if("TD"===i){if(l>1||a>1){for(let e=t;e<t+l;e++)if(e<f)for(let t=h;t<h+a;t++)m[e][t]=null;const e=n.getAttribute("style");e&&e.includes("mso-ignore:colspan")||w.push({col:h,row:t,rowspan:l,colspan:a})}let e="";e=s&&/excel/gi.test(s.content)?r.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):r.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),m[t][h]=e.replace(Yo,(t=>Go[t]))}else v.push(r)}}return w.length&&(o.mergeCells=w),v.length&&(o.rowHeaders=v),m.length&&(o.data=m),o}(o,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=function(t){const e=[[""]];if(0===t.length)return e;let o,n=0,i=0;for(;t.length>0&&o!==t.length;)if(o=t.length,t.match(cu))t=t.replace(cu,""),n+=1,e[i][n]="";else if(t.match(au))t=t.replace(au,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let e=0,n=!0;for(;n;){const i=t.slice(0,1);'"'===i&&(e+=1),o+=i,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&e%2==0)&&(n=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(hu);o=e?e[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}(e)),void 0===e||e&&0===e.length)return;if(!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[o,n,i,r]=this.populateValues(e);this.hot.selectCell(o,n,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,r)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=db),e.add(t),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"savedBorders",[])}static get PLUGIN_KEY(){return ub}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[ub]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>cb(db,this,gb).call(this,t))),this.addHook("init",(()=>cb(db,this,fb).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let o=["top","bottom","start","end"],n=null;e&&(this.checkSettingsCohesion([e]),o=Object.keys(e),n=tb(e));const i=Sc(Cc(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});jt(t,(t=>{i(t).forAll(((t,e)=>{jt(o,(o=>{var i,r;this.prepareBorderFromCustomAdded(t,e,n,(i=o,null!==(r=rb.get(i))&&void 0!==r?r:i))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=Sc(Cc(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),o=[];return jt(t,(t=>{e(t).forAll(((t,e)=>{jt(this.savedBorders,(n=>{n.row===t&&n.col===e&&o.push(eb(n))}))}))})),o}clearBorders(t){t?this.setBorders(t):(jt(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);const o=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,o,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:o})}prepareBorderFromCustomAdded(t,e,o,n){const i=this.hot.countRows(),r=this.hot.countCols();if(t>=i||e>=r)return;let s=ob(t,e);var l,a;o&&(l=s,xe(a=o,"border")&&a.border&&(l.border=a.border),xe(a,"top")&&Kt(a.top)&&(a.top?(be(a.top)||(a.top={width:1,color:"#000"}),l.top=a.top):(a.top={hide:!0},l.top=a.top)),xe(a,"bottom")&&Kt(a.bottom)&&(a.bottom?(be(a.bottom)||(a.bottom={width:1,color:"#000"}),l.bottom=a.bottom):(a.bottom={hide:!0},l.bottom=a.bottom)),xe(a,"start")&&Kt(a.start)&&(a.start?(be(a.start)||(a.start={width:1,color:"#000"}),l.start=a.start):(a.start={hide:!0},l.start=a.start)),xe(a,"end")&&Kt(a.end)&&(a.end?(be(a.end)||(a.end={width:1,color:"#000"}),l.end=a.end):(a.end={hide:!0},l.end=a.end)),s=l,jt(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,o),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",eb(s)),this.insertBorderIntoSettings(s,n)}prepareBorderFromCustomAddedRange(t,e){const o=Math.min(t.to.row,this.hot.countRows()-1),n=Math.min(t.to.col,this.hot.countCols()-1);Qo(t.from.row,o,(o=>{Qo(t.from.col,n,(n=>{const i=ob(o,n);let r=0;o===t.from.row&&xe(e,"top")&&(r+=1,i.top=e.top),o===t.to.row&&xe(e,"bottom")&&(r+=1,i.bottom=e.bottom),n===t.from.col&&xe(e,"start")&&(r+=1,i.start=e.start),n===t.to.col&&xe(e,"end")&&(r+=1,i.end=e.end),r>0&&(this.hot.setCellMeta(o,n,"borders",eb(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const o=Jy(t,e);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,o,n){let i=this.hot.getCellMeta(t,e).borders;i=i&&void 0!==i.border?tb(i):ob(t,e),n?(i[o]={hide:!0},4===this.countHide(i)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(i,o,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",eb(i)))):(i[o]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(i,o,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",eb(i)))}prepareBorder(t,e,o){jt(t,(t=>{let{start:n,end:i}=t;if(n.row===i.row&&n.col===i.col)"noBorders"===e?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,e,o);else switch(e){case"noBorders":Qo(n.col,i.col,(t=>{Qo(n.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":Qo(n.col,i.col,(t=>{this.setBorder(n.row,t,e,o)}));break;case"bottom":Qo(n.col,i.col,(t=>{this.setBorder(i.row,t,e,o)}));break;case"start":Qo(n.row,i.row,(t=>{this.setBorder(t,n.col,e,o)}));break;case"end":Qo(n.row,i.row,(t=>{this.setBorder(t,i.col,e,o)}))}}))}createCustomBorders(t){jt(t,(t=>{const e=tb(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:o,start:n,end:i}=t;return Ft([e,o,n,i],((t,e)=>{let o=t;return e&&e.hide&&(o+=1),o}),0)}clearBordersFromSelectionSettings(t){const e=Bt(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){jt(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){jt(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=Bt(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):jt(this.savedBorders,((o,n)=>{if(t.id===o.id)return this.savedBorders[n]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,o){let n=!1;return jt(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id)return jt(this.hot.view._wt.selectionManager.getBorderInstances(i),(t=>{t.toggleHiddenClass(e,o)})),n=!0,!1})),n}checkCustomSelections(t,e,o){const n=this.countHide(t);let i=!1;return 4===n?(this.removeAllBorders(t.row,t.col),i=!0):jt(this.hot.selection.highlight.customSelections,(n=>{if(t.id===n.settings.id)return n.visualCellRange=e,n.commit(),o&&jt(this.hot.view._wt.selectionManager.getBorderInstances(n),(e=>{e.changeBorderStyle(o,t)})),i=!0,!1})),i}changeBorderSettings(){const t=this.hot.getSettings()[ub];if(Array.isArray(t)){const e=me(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=t.some((t=>Kt(t.left)||Kt(t.right))),o=t.some((t=>Kt(t.start)||Kt(t.end)));if(e&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=vb),e.add(t),pb(this,"boundaries",null),pb(this,"callback",null),pb(this,"listening",!1)}static get PLUGIN_KEY(){return wb}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[wb]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>mb(vb,this,yb).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>mb(vb,this,yb).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=Y(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}),pn(kb),pn(class extends fp{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:n}=this.hot,i=this._createTypeFormatter(t,e),r=this._createBlob(i),s=n.URL||n.webkitURL,l=o.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const t=s.createObjectURL(r);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Yb[t])throw new Error(`Export format type "${t}" is not supported.`);return function(t,e,o){return"function"==typeof Yb[t]?new Yb[t](e,o):null}(t,new Wb(this.hot),e)}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}),pn(class extends fp{static get PLUGIN_KEY(){return wR}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){var e;super(t),gR(this,e=bR),e.add(this),fR(this,"dropdownMenuPlugin",null),fR(this,"conditionCollection",null),fR(this,"conditionUpdateObserver",null),fR(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),fR(this,"filtersRowsMap",null),function(t,e,o){gR(t,e),e.set(t,void 0)}(this,yR),this.hot.addHook("afterGetColHeader",((t,e)=>mR(bR,this,HR).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[wR]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new bl),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,o=t=>(t.addLocalHook("accept",(()=>mR(bR,this,TR).call(this,"accept"))),t.addLocalHook("cancel",(()=>mR(bR,this,TR).call(this,"cancel"))),t.addLocalHook("change",(e=>mR(bR,this,xR).call(this,t,e))),t),n=()=>`${this.hot.getTranslatedPhrase(sh)}:`;if(!this.components.get("filter_by_condition")){const t=new KC(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>mR(bR,this,MR).call(this))),this.components.set("filter_by_condition",o(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new cS(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new KC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>mR(bR,this,MR).call(this))),this.components.set("filter_by_condition2",o(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new $S(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(lh)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new qS(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new eR(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new uR(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>mR(bR,this,kR).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>mR(bR,this,ER).call(this,t))),this.addHook("afterDropdownMenuShow",(()=>mR(bR,this,SR).call(this))),this.addHook("afterDropdownMenuHide",(()=>mR(bR,this,RR).call(this))),this.addHook("afterChange",(t=>mR(bR,this,CR).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!pR(yR,this)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{const e=t.getNavigator(),o=pR(yR,this).getLastMenuPage();t.focus(),o>0?e.setCurrentPage(o):e.toFirstItem()}},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];!function(t,e,o){t.set(mR(t,e),o)}(yR,this,function(t,e){let o=-1;const n=(i=e,_v({initialPage:0,size:()=>i.length,onItemSelect:(t,e)=>{const o=i[t];return o instanceof DS?e:!(o.element&&!ct(o.element))&&void o.focus()}}));var i;const r=o=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(dR),n.setCurrentPage(e.indexOf(o))};function s(i){const r=t.getKeyboardShortcutsCtrl(),s=i.getKeyboardShortcutsCtrl();n.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(dR),callback:()=>{i.isSubMenu()&&i.close(),r.listen(dR)}}]),i.isSubMenu()||r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const i=t.getNavigator();i.getCurrentPage()>-1&&(o=i.getCurrentPage()),i.clear(),e.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const o=e[n.getCurrentPage()];o instanceof BC&&(o.openOptions(),t.preventDefault()),o instanceof SS&&(o.activate(),t.preventDefault()),o instanceof SC||t.preventDefault()}}],dR)}return e.forEach((t=>{t instanceof SC&&(t.addLocalHook("click",r(t)),t.addLocalHook("focus",r(t)),t.addLocalHook("afterClose",r(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||n.clear()})),t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s),{...n,listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(dR)},getLastMenuPage:function(){return o}}}(t,e));const o=t=>{pR(yR,this).listen(),t.preventDefault(),$e(t.keyCode,"TAB")&&(t.shiftKey?pR(yR,this).toPreviousItem():pR(yR,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",o),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",o)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:vR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vR)}addCondition(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JC;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:o},n)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),o=!this.conditionCollection.isEmpty();let n=[];const i=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",i))if(o){const o=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),n=Bt(e.filter(),(t=>t.meta.visualRow));const t=pS(n);Qo(this.hot.countSourceRows()-1,(e=>{t(e)||o.push(e)})),jt(o,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),t||n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),o=[];return jt(this.hot.getSourceDataAtCol(e),((t,n)=>{var i;const{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(n,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(n),e))&&void 0!==i?i:t;o.push({meta:{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:mS(g)})})),o}updateValueComponentCondition(t){const e=wS(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}restoreComponents(t){var e;const o=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(o)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,o,n){let i=t;return i===tS&&e.command.key!==tC&&o.command.key!==tC&&n.command.key!==tC?i=eS:n.command.key!==tC&&(e.command.key!==tC&&o.command.key!==tC||(i=JC)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...o):this.hideComponents(...o)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new nR(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return jt(n,(o=>{jt(e.menuItems,((e,n)=>{e.key===o.getMenuItemDescriptor().key&&t.push(n)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu.hotMenu,o=e.getPlugin("hiddenRows");for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=this.getIndexesOfComponents(...i);t?o.showRows(s):o.hideRows(s),e.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}),pn(class extends fp{constructor(){var t,e;super(...arguments),t=this,wE(this,e=ME),e.add(this),mE(this,EE,!1),mE(this,TE,!1),mE(this,xE,[["valuesUpdated",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,GE).call(t,...o)}],["namedExpressionAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,YE).call(t,...o)}],["namedExpressionRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,KE).call(t,...o)}],["sheetAdded",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,XE).call(t,...o)}],["sheetRenamed",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,qE).call(t,...o)}],["sheetRemoved",function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return bE(ME,t,QE).call(t,...o)}]]),pE(this,"staticRegister",so("formulas")),pE(this,"engine",null),pE(this,"sheetName",null),pE(this,"indexSyncer",null),pE(this,"rowAxisSyncer",null),pE(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return CE}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[CE,...SE]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[CE]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=function(t){const e=t.getSettings(),o=e[CE],n=null==o?void 0:o.engine;if(!0===o)return null;if(Xt(n))return null;var i;if("function"==typeof n.hyperformula||"function"==typeof n)return function(t,e,o){const n=e[CE],i=function(t){var e;const o=t[CE],n=PR(null!=o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=OR(t);return{...AR,...n,...i}}(e),r=NR(),s=_R();(function(t,e){e&&e.forEach((e=>{const{name:o,plugin:n,translations:i}=e;try{t.registerFunction(o,n,i)}catch(t){qe(t.message)}}))})(t,n.functions),function(t,e){if(e){const{langCode:o}=e;try{t.registerLanguage(o,e)}catch(t){qe(t.message)}}}(t,n.language);const l=t.buildEmpty(i);return r.set(l,[o]),s.set(l,[o.guid]),function(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:o,expression:n,scope:i,options:r}=e;try{t.addNamedExpression(o,n,i,r)}catch(t){qe(t.message)}})),t.resumeEvaluation())}(l,n.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}(null!==(i=n.hyperformula)&&void 0!==i?i:n,e,t);if("object"==typeof n&&Xt(n.hyperformula)){const e=NR(),o=_R().get(n);return e.has(n)||e.set(n,[]),e.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:IR}),n.getConfig().leapYear1900===AR.leapYear1900&&!1!==ye(n.getConfig().nullDate,AR.nullDate)||qe(Gt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,IE).call(e,...o)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,OE).call(e,...o)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,IE).call(e,...o)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,OE).call(e,...o)})),this.addHook("modifyData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,PE).call(e,...o)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,NE).call(e,...o)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,HE).call(e,...o)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,DE).call(e,...o)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,_E).call(e,...o)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,_E).call(e,...o)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,LE).call(e,...o)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,VE).call(e,...o)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,BE).call(e,...o)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,jE).call(e,...o)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,FE).call(e,...o)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,WE).call(e,...o)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,zE).call(e,...o)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,UE).call(e,...o)})),this.indexSyncer=new fE(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,o,n)=>{this.rowAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("beforeColumnMove",((t,e,o,n)=>{this.columnAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("afterRowMove",((t,e,o,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("afterColumnMove",((t,e,o,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,AE).call(e,...o)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,$E).call(e,...o)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return bE(ME,e,kE).call(e,...o)})),yE(xE,this).forEach((t=>{let[e,o]=t;return this.engine.on(e,o)})),super.enablePlugin()}else qe("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){yE(xE,this).forEach((t=>{let[e,o]=t;return this.engine.off(e,o)})),LR(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=function(t){var e;const o=t[CE];return{...PR(null!=o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),...OR(t)}}(this.hot.getSettings());(function(t,e){return Object.keys(e).some((o=>void 0!==e[o]&&e[o]!==t[o]))})(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const o=this.hot.getSettings()[CE];if(Kt(o)&&Kt(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[CE].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){yE(xE,this).forEach((t=>{var e;let[o,n]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(o,n)})),vE(xE,this,null),LR(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(Kt(e)&&(o=e,!(Array.isArray(o)&&o.length&&o.every((t=>Array.isArray(t))))))return qe("The provided data should be an array of arrays."),!1;var o;if(null!=t&&this.engine.doesSheetExist(t))return qe("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(o),e),o}catch(t){return qe(t.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void Qe(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${x(CE)}.switchSheet`)}getCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==n&&null!==i?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;t.forEach((t=>{var e;const n=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(o.has(n)||o.add(n))})),DR(this.engine).forEach(((t,n)=>{var i;(e||n!==this.sheetId)&&o.has(n)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){const e=t=>{var e;const{row:o,col:n,sheet:i}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return Kt(i)?`${i}:${o}x${n}`:""},o=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((t=>e(t))));t.forEach((t=>{var n,i;const{row:r,col:s}=null!==(n=t.address)&&void 0!==n?n:{};if(!1===Kt(r)||!1===Kt(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const l=null==t||null===(i=t.address)||void 0===i?void 0:i.sheet,a=e(t);if(void 0!==l&&!o.has(a)){const t=DR(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,o){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void qe(`Not possible to set cell data at ${JSON.stringify(n)}`);const i=this.hot.getCellMeta(t,e);var r;return WR(o,i.type)&&(BR(o,i.dateFormat)?o=jR(o,i.dateFormat):!1===("string"==typeof(r=o)&&r.startsWith("="))&&(o=`'${o}`)),this.engine.setCellContents(n,o)}}),pn(class extends fp{constructor(){var t;super(...arguments),JE(this,t=sT),t.add(this),ZE(this,iT,{}),ZE(this,rT,null)}static get PLUGIN_KEY(){return nT}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[nT]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[nT];be(e)&&(eT(iT,this,e),Xt(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),eT(rT,this,new vl),tT(rT,this).addLocalHook("init",(()=>oT(sT,this,dT).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,tT(rT,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return oT(sT,t,uT).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>oT(sT,this,aT).call(this,t,e,o))),this.addHook("modifyColWidth",((t,e)=>oT(sT,this,lT).call(this,t,e))),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return oT(sT,t,cT).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>oT(sT,this,hT).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),eT(iT,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;const i=tT(rT,this).getValues().slice(),r=t.length>0;o&&r&&(jt(t.map((t=>this.hot.toPhysicalColumn(t))),(t=>{i[t]=!1})),n=Ft(i,((t,e,o)=>(e&&t.push(this.hot.toVisualColumn(o)),t)),[])),!1!==this.hot.runHooks("beforeUnhideColumns",e,n,o&&r)&&(o&&r&&tT(rT,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,n,o&&r,o&&n.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,n,o)&&(o&&this.hot.batchExecution((()=>{jt(t,(t=>{tT(rT,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,n,o,o&&n.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideColumns(e)}getHiddenColumns(){return Bt(tT(rT,this).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return tT(rT,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){jt(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){eT(iT,this,null),eT(rT,this,null),super.destroy()}}),pn(class extends fp{constructor(){var t;super(...arguments),fT(this,t=CT),t.add(this),gT(this,yT,{}),gT(this,bT,null)}static get PLUGIN_KEY(){return vT}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[vT]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[vT];be(e)&&(mT(yT,this,e),Xt(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),mT(bT,this,new vl),pT(bT,this).addLocalHook("init",(()=>wT(CT,this,MT).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,pT(bT,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return wT(CT,t,xT).call(t,...o)})),this.addHook("afterGetCellMeta",((t,e,o)=>wT(CT,this,RT).call(this,t,e,o))),this.addHook("modifyRowHeight",((t,e)=>wT(CT,this,ST).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return wT(CT,t,TT).call(t,...o)})),this.addHook("modifyCopyableRange",(t=>wT(CT,this,ET).call(this,t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),mT(yT,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;const i=pT(bT,this).getValues().slice(),r=t.length>0;o&&r&&(jt(t.map((t=>this.hot.toPhysicalRow(t))),(t=>{i[t]=!1})),n=Ft(i,((t,e,o)=>(e&&t.push(this.hot.toVisualRow(o)),t)),[])),!1!==this.hot.runHooks("beforeUnhideRows",e,n,o&&r)&&(o&&r&&pT(bT,this).setValues(i),this.hot.runHooks("afterUnhideRows",e,n,o&&r,o&&n.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideRows",e,n,o)&&(o&&this.hot.batchExecution((()=>{jt(t,(t=>{pT(bT,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,n,o,o&&n.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideRows(e)}getHiddenRows(){return Bt(pT(bT,this).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return pT(bT,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){jt(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){mT(yT,this,null),mT(bT,this,null),super.destroy()}}),pn(class extends fp{constructor(){var t;super(...arguments),HT(this,t=NT),t.add(this),function(t,e,o){HT(t,e),e.set(t,!1)}(this,PT)}static get PLUGIN_KEY(){return OT}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[OT]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>AT(NT,this,_T).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>AT(NT,this,DT).call(this,t,e))),super.enablePlugin())}disablePlugin(){IT(PT,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;kT(PT,this)||IT(PT,this,!0),!1!==this.hot.runHooks("beforeColumnFreeze",t,o)&&(o&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,o))}unfreezeColumn(t){const e=this.hot.getSettings(),o=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;kT(PT,this)||IT(PT,this,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",t,o)&&(o&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,o))}}),pn(class extends fp{constructor(){var t;super(...arguments),zT(this,t=hx),t.add(this),jT(this,ZT,new WT(this.hot)),jT(this,JT,new BT(this.hot)),jT(this,tx,[]),jT(this,ex,0),jT(this,ox,!1),jT(this,nx,{}),jT(this,ix,void 0),jT(this,rx,void 0),jT(this,sx,void 0),jT(this,lx,void 0),jT(this,ax,void 0)}static get PLUGIN_KEY(){return YT}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[YT]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return GT(hx,t,cx).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return GT(hx,t,dx).call(t,...o)})),this.addHook("afterScrollVertically",(()=>GT(hx,this,fx).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return GT(hx,t,px).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),et(this.hot.rootElement,KT),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ot(this.hot.rootElement,KT),this.unregisterEvents(),$T(ZT,this).destroy(),$T(JT,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const o=$T(ix,this),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,o,n);if(UT(ix,this,void 0),!1===i)return;n&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=n&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,o,n,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const o=this.countFinalIndex(t,e);return UT(ix,this,e),this.moveColumns(t,o)}isMovePossible(t,e){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isColumnOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=Ft(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getColumnsWidth(t,e){const o=this.hot.columnIndexMapper;let n=0;for(let i=t;i<=e;i+=1){const t=o.getRenderableFromVisualIndex(i);i<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[YT];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const o=[];return Qo(t,e,(t=>{o.push(t)})),o}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart($T(rx,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,n="number"==typeof o.scrollX?o.scrollX:o.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,$T(rx,this)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=$T(ZT,this).getOffset().start,a=$T(ZT,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=bt(this.hot.rootElement),i=t.innerWidth-$T(sx,this)-e;c=t.innerWidth-$T(nx,this).eventPageX-i-(void 0===o.scrollX?n:0)}else c=$T(nx,this).eventPageX-($T(sx,this)-(void 0===o.scrollX?n:0));if($T(lx,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart($T(rx,this))&&(i+=n),i+=h,$T(rx,this)<0)$T(ax,this)>0?$T(nx,this).col=0:$T(nx,this).col=t>0?t-1:t;else if($T(nx,this).TD.offsetWidth/2+i<=c){const t=$T(rx,this)>=$T(ex,this)?$T(ex,this)-1:$T(rx,this);$T(nx,this).col=t+1,i+=$T(nx,this).TD.offsetWidth}else $T(nx,this).col=$T(rx,this);let u=c,d=i;c+a+l>=r?u=r-a-l:c+l<s+h&&(u=s+h+Math.abs(l)),i>=r-1?d=r-1:0===d?d=1:void 0!==o.scrollX&&$T(rx,this)<$T(ax,this)&&(d-=$T(sx,this)<=o.scrollX?$T(sx,this):0),$T(ZT,this).setPosition(null,u),$T(JT,this).setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>GT(hx,this,ux).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>GT(hx,this,gx).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){$T(ZT,this).build(),$T(JT,this).build()}destroy(){$T(ZT,this).destroy(),$T(JT,this).destroy(),super.destroy()}}),pn(class extends fp{static get PLUGIN_KEY(){return Cx}static get PLUGIN_PRIORITY(){return 130}constructor(t){var e;super(t),wx(this,e=Wx),e.add(this),mx(this,Rx,null),mx(this,Ex,null),mx(this,Tx,[]),mx(this,xx,null),mx(this,Mx,null),mx(this,Hx,null),mx(this,kx,null),mx(this,Ix,null),mx(this,Ax,this.hot.rootDocument.createElement("DIV")),mx(this,Ox,this.hot.rootDocument.createElement("DIV")),mx(this,Px,null),mx(this,Nx,!1),mx(this,Dx,0),mx(this,Lx,null),mx(this,Vx,void 0),mx(this,Fx,void 0),et(yx(Ax,this),"manualColumnResizer"),et(yx(Ox,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Cx]}enablePlugin(){this.enabled||(vx(Vx,this,new wl),yx(Vx,this).addLocalHook("init",(()=>bx(Wx,this,Bx).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,yx(Vx,this)),this.addHook("modifyColWidth",((t,e)=>bx(Wx,this,Yx).call(this,t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>bx(Wx,this,Kx).call(this,t,e))),this.addHook("beforeColumnResize",((t,e,o)=>bx(Wx,this,Xx).call(this,t,e,o))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){vx(Fx,this,yx(Vx,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Sx,yx(Vx,this).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",Sx,t),t.value}setManualSize(t,e){const o=Math.max(e,20),n=this.hot.toPhysicalColumn(t);return yx(Vx,this).setValueAtIndex(n,o),o}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);yx(Vx,this).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;vx(Rx,this,t);const{_wt:e}=this.hot.view,o=e.wtTable.getCoords(yx(Rx,this)),n=o.col;if(n<0)return;const i=Ct(yx(Rx,this)),r=yx(Rx,this).getBoundingClientRect();let s;n<e.getSetting("fixedColumnsStart")&&(s=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(yx(Rx,this),o.row,o.col)),s||(s=e.wtOverlays.topOverlay.getRelativeCellPosition(yx(Rx,this),o.row,o.col)),vx(Ex,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),vx(Tx,this,[]);const l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();this.hot.selection.isSelected()&&l&&jt(this.hot.getSelectedRange(),(t=>{Qo(t.getTopStartCorner().col,t.getBottomEndCorner().col,(t=>{yx(Tx,this).includes(t)||yx(Tx,this).push(t)}))})),yx(Tx,this).includes(yx(Ex,this))||vx(Tx,this,[yx(Ex,this)]),vx(Ix,this,s.start-6),vx(kx,this,parseInt(r.width,10)),yx(Ax,this).style.top=`${s.top}px`,yx(Ax,this).style[this.inlineDir]=`${yx(Ix,this)+yx(kx,this)}px`,yx(Ax,this).style.height=`${i}px`,this.hot.rootElement.appendChild(yx(Ax,this))}refreshHandlePosition(){yx(Ax,this).style[this.inlineDir]=`${yx(Ix,this)+yx(xx,this)}px`}setupGuidePosition(){const t=parseInt(Ct(yx(Ax,this)),10),e=parseInt(yx(Ax,this).style.top,10)+t,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);et(yx(Ax,this),"active"),et(yx(Ox,this),"active"),yx(Ox,this).style.top=`${e}px`,this.refreshGuidePosition(),yx(Ox,this).style.height=o-t+"px",this.hot.rootElement.appendChild(yx(Ox,this))}refreshGuidePosition(){yx(Ox,this).style[this.inlineDir]=yx(Ax,this).style[this.inlineDir]}hideHandleAndGuide(){ot(yx(Ax,this),"active"),ot(yx(Ox,this),"active")}checkIfColumnHeader(t){const e=K(t,["THEAD"],this.hot.rootElement),{topOverlay:o,topInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.THEAD,n.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeColumnResize",yx(Mx,this),e,!0);void 0!==n&&vx(Mx,this,n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,yx(Mx,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",yx(Mx,this),e,!0),o&&t()};yx(Dx,this)>=2&&(yx(Tx,this).length>1?(jt(yx(Tx,this),(t=>{e(t)})),t()):jt(yx(Tx,this),(t=>{e(t,!0)}))),vx(Dx,this,0),vx(Lx,this,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>bx(Wx,this,jx).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>bx(Wx,this,zx).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>bx(Wx,this,Ux).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>bx(Wx,this,$x).call(this))),this.eventManager.addEventListener(yx(Ax,this),"contextmenu",(()=>bx(Wx,this,Gx).call(this)))}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t;super(...arguments),oM(this,t=wM),t.add(this),eM(this,uM,new Jx(this.hot)),eM(this,dM,new tM(this.hot)),eM(this,gM,[]),eM(this,fM,void 0),eM(this,pM,{}),eM(this,mM,void 0)}static get PLUGIN_KEY(){return sM}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[sM]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return rM(wM,t,vM).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return rM(wM,t,bM).call(t,...o)})),this.addHook("afterScrollHorizontally",(()=>rM(wM,this,SM).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return rM(wM,t,RM).call(t,...o)})),this.buildPluginUI(),this.registerEvents(),et(this.hot.rootElement,lM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ot(this.hot.rootElement,lM),this.unregisterEvents(),iM(uM,this).destroy(),iM(dM,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const o=iM(mM,this),n=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,o,n);if(nM(mM,this,void 0),!1===i)return;n&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=n&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,o,n,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const o=this.countFinalIndex(t,e);return nM(mM,this,e),this.moveRows(t,o)}isMovePossible(t,e){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=o));return!(n||i||r||s)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=Ft(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getRowsHeight(t,e){const o=this.hot.rowIndexMapper;let n=0;for(let i=t;i<=e;i++){const t=o.getRenderableFromVisualIndex(i);null!==t&&(n+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[sM];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:o,to:n}=t;return Qo(Math.min(o.row,n.row),Math.max(o.row,n.row),(t=>{e.push(t)})),e}refreshPositions(){const t=iM(pM,this).coords,e=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&o<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=iM(pM,this).TD,s=this.hot.rootElement,l=ut(s),a=wt(s),h=i.holder.scrollTop,c=this.hot.rootWindow!==a?a.scrollTop:0,u=l.top-c,d=iM(pM,this).eventPageY-u+h,g=i.hider.offsetHeight,f=i.TBODY.offsetTop,p=iM(uM,this).getOffset().top,m=iM(uM,this).getSize().height,w=r.offsetHeight/2,v=r.offsetHeight;let y=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const b=d>=y+w;this.isFixedRowTop(t.row)&&(y+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?iM(pM,this).row=e>0?e-1:e:b?(iM(pM,this).row=t.row+1,y+=0===t.row?v-1:v):iM(pM,this).row=t.row;let C=d,S=y;d+m+p>=g?C=g-m-p:d+p<f&&(C=f+Math.abs(p)),y>=g-1&&(S=g-1),iM(uM,this).setPosition(C),iM(dM,this).setPosition(S)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>rM(wM,this,yM).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>rM(wM,this,CM).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){iM(uM,this).build(),iM(dM,this).build()}destroy(){iM(uM,this).destroy(),iM(dM,this).destroy(),super.destroy()}}),pn(class extends fp{static get PLUGIN_KEY(){return kM}static get PLUGIN_PRIORITY(){return 30}constructor(t){var e;super(t),TM(this,e=YM),e.add(this),EM(this,AM,null),EM(this,OM,null),EM(this,PM,[]),EM(this,NM,null),EM(this,_M,null),EM(this,DM,null),EM(this,LM,null),EM(this,VM,null),EM(this,FM,this.hot.rootDocument.createElement("DIV")),EM(this,WM,this.hot.rootDocument.createElement("DIV")),EM(this,BM,!1),EM(this,jM,!1),EM(this,zM,0),EM(this,UM,null),EM(this,$M,void 0),EM(this,GM,void 0),et(MM(FM,this),"manualRowResizer"),et(MM(WM,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[kM]}enablePlugin(){this.enabled||(xM($M,this,new wl),MM($M,this).addLocalHook("init",(()=>HM(YM,this,tH).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,MM($M,this)),this.addHook("modifyRowHeight",((t,e)=>HM(YM,this,JM).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){xM(GM,this,MM($M,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",IM,MM($M,this).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",IM,t),t.value}setManualSize(t,e){const o=this.hot.toPhysicalRow(t),n=Math.max(e,Xr.DEFAULT_HEIGHT);return MM($M,this).setValueAtIndex(o,n),n}setupHandlePosition(t){xM(AM,this,t);const{view:e}=this.hot,{_wt:o}=e,n=o.wtTable.getCoords(MM(AM,this)),i=n.row;if(i<0)return;const r=bt(MM(AM,this)),s=MM(AM,this).getBoundingClientRect(),l=i<o.getSetting("fixedRowsTop"),a=i>=e.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let h;l?h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(MM(AM,this),n.row,n.col):a&&(h=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(MM(AM,this),n.row,n.col)),h||(h=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(MM(AM,this),n.row,n.col)),xM(OM,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),xM(PM,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();this.hot.selection.isSelected()&&c&&jt(this.hot.getSelectedRange(),(t=>{Qo(t.getTopStartCorner().row,t.getBottomStartCorner().row,(t=>{MM(PM,this).includes(t)||MM(PM,this).push(t)}))})),MM(PM,this).includes(MM(OM,this))||xM(PM,this,[MM(OM,this)]),xM(VM,this,h.top-6),xM(LM,this,parseInt(s.height,10)),MM(FM,this).style.top=`${MM(VM,this)+MM(LM,this)}px`,MM(FM,this).style[this.inlineDir]=`${h.start}px`,MM(FM,this).style.width=`${r}px`,this.hot.rootElement.appendChild(MM(FM,this))}refreshHandlePosition(){MM(FM,this).style.top=`${MM(VM,this)+MM(NM,this)}px`}setupGuidePosition(){const t=parseInt(bt(MM(FM,this)),10),e=parseInt(MM(FM,this).style[this.inlineDir],10)+t,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);et(MM(FM,this),"active"),et(MM(WM,this),"active"),MM(WM,this).style.top=MM(FM,this).style.top,MM(WM,this).style[this.inlineDir]=`${e}px`,MM(WM,this).style.width=o-t+"px",this.hot.rootElement.appendChild(MM(WM,this))}refreshGuidePosition(){MM(WM,this).style.top=MM(FM,this).style.top}hideHandleAndGuide(){ot(MM(FM,this),"active"),ot(MM(WM,this),"active")}checkIfRowHeader(t){const e=K(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[o.clone.wtTable.TBODY,n.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&MM(_M,this)<e?e:MM(_M,this)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&xM(_M,this,n),this.setManualSize(e,MM(_M,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),o&&t()};MM(zM,this)>=2&&(MM(PM,this).length>1?(jt(MM(PM,this),(t=>{e(t)})),t()):jt(MM(PM,this),(t=>{e(t,!0)}))),xM(zM,this,0),xM(UM,this,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>HM(YM,this,KM).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>HM(YM,this,XM).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>HM(YM,this,qM).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>HM(YM,this,QM).call(this))),this.eventManager.addEventListener(MM(FM,this),"contextmenu",(()=>HM(YM,this,ZM).call(this)))}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t;super(...arguments),PH(this,t=zH),t.add(this),NH(this,"mergedCellsCollection",null),NH(this,"autofillCalculations",null),NH(this,"selectionCalculations",null),OH(this,WH,null),OH(this,BH,{row:0,col:0}),OH(this,jH,new IH({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper}))}static get PLUGIN_KEY(){return VH}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[VH]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new hH(this),this.autofillCalculations=new uH(this),this.selectionCalculations=new gH(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,UH).call(t,...o)})),this.addHook("modifyTransformFocus",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,GH).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,YH).call(t,...o)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,KH).call(t,...o)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,XH).call(t,...o)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,JH).call(t,...o)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,JH).call(t,...o)})),this.addHook("beforeSelectionFocusSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,tk).call(t,...o)})),this.addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ek).call(t,...o)})),this.addHook("afterSelectionEnd",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ok).call(t,...o)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,qH).call(t,...o)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,$H).call(t,...o)})),this.addHook("afterRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ZH).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,QH).call(t,...o)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,nk).call(t,...o)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ik).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,rk).call(t,...o)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,sk).call(t,...o)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,lk).call(t,...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ak).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,hk).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,ck).call(t,...o)})),this.addHook("afterChange",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,uk).call(t,...o)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,dk).call(t,...o)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,gk).call(t,...o)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,fk).call(t,...o)})),this.addHook("beforeBeginEditing",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return LH(zH,t,pk).call(t,...o)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[VH];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Ne())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:o,rowspan:n}=t;for(let t=o+1;t<o+n;t++)e.push(t)})),e=[...new Set(e)],e.forEach((e=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null==t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const n=e.getRow(o);n&&(n.style.background=vt(n,"backgroundColor").replace(")",", 0.99)"),t.push(n))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=vt(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(oH.containsNegativeValues(t)?(qe(oH.NEGATIVE_VALUES_WARNING(t)),e=!1):oH.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(qe(oH.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):oH.isSingleCell(t)?(qe(oH.IS_SINGLE_CELL(t)),e=!1):oH.containsZeroSpan(t)&&(qe(oH.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(jt(t,(t=>{if(!this.validateSetting(t))return;const o=this.hot._createCellCoords(t.row,t.col),n=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=this.hot._createCellRange(o,o,n);this.mergeRange(i,!0,!0),Qo(t.row,t.row+t.rowspan-1,(o=>{Qo(t.col,t.col+t.colspan-1,(n=>{0==(o===t.row&&n===t.col)&&e.push([o,n,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e,void 0,void 0,this.pluginName)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:o}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.getTopStartCorner(),i=t.getBottomEndCorner(),r={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},s=[];let l=null;return!!this.canMergeRange(r,e)&&(this.hot.runHooks("beforeMergeCells",t,e),Qo(0,r.rowspan-1,(t=>{Qo(0,r.colspan-1,(e=>{let o=null;s[t]||(s[t]=[]),0===t&&0===e?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=o}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0),!this.mergedCellsCollection.add(r)||(o?l=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),l))}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(t);o&&(this.hot.runHooks("beforeUnmergeCells",t,e),jt(o,(t=>{this.mergedCellsCollection.remove(t.row,t.col),Qo(0,t.rowspan-1,(e=>{Qo(0,t.colspan-1,(o=>{this.hot.removeCellMeta(t.row+e,t.col+o,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+o,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(t,e,o,n){const i=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(o,n);this.unmergeRange(this.hot._createCellRange(i,i,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:FH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FH)}modifyViewportRowStart(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(be(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.row,1));if(n<t.startRow)return t.startRow=n,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(n,i);if(be(r)){const n=r.row+r.rowspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(be(r)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r.col,1));if(n<t.startColumn)return t.startColumn=n,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const r=this.mergedCellsCollection.get(i,n);if(be(r)){const n=r.col+r.colspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,o,n){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let s,l;return s=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),l=0===n?r.getNearestNotHiddenIndex(o,1):r.getNearestNotHiddenIndex(o+n-1,-1),[t>=0?i.getRenderableFromVisualIndex(s):t,o>=0?r.getRenderableFromVisualIndex(l):o]}}),pn(class extends ow{constructor(){var t,e,o;super(...arguments),t=this,o=vk,e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e="pluginKey"),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}static get PLUGIN_KEY(){return vk}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[yk]&&mk(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,Jm)),!1},runOnlyIf:()=>{var t,e;const o=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return o&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(o)&&o.isHeader()},relativeToGroup:wu,position:"before",group:bk})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bk)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];super.updateHeaderClasses(t,...o),ot(t,function(t){const e=t.className.split(" "),o=new RegExp(`^${wk}-[0-9]{1,2}$`);return e.filter((t=>o.test(t)))}(t)),!1!==this.enabled&&et(t,function(t,e,o){const n=[];return!1===o||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${wk}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}(...o))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[yk]&&mk(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==Dm(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,Jm))):this.sort(this.getColumnNextConfig(e.col)))}}),pn(class extends fp{constructor(){super(...arguments),Ck(this,"dragged",[]),Ck(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return Le()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const o=t.dragged.indexOf(e);if(-1===o)return!1;0===o?t.dragged=t.dragged.slice(0,1):1===o&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let o;return tt(e.target,"topSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):tt(e.target,"bottomSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>tt(e.target,"topSelectionHandle-HitArea")?(o.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):tt(e.target,"bottomSelectionHandle-HitArea")?(o.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:o}=this.hot;let n,i,r,s,l,a;if(0===t.dragged.length)return;const h=o.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(n=t.hot.getCoords(h),-1===n.col&&(n.col=0),i=t.hot.getSelectedRangeLast(),r=i.getWidth(),s=i.getHeight(),l=i.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(n),a=t.getCurrentRangeCoords(i,n,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,o,n,i){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)})}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:a}:h.end=e}break;case"SW-NE":switch(n){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===i&&(h={start:l,end:e})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:r}}}return h}isDragged(){return this.dragged.length>0}}),pn(class extends fp{constructor(){var t;super(...arguments),hI(this,t=vI),t.add(this),aI(this,fI,new iI),aI(this,pI,null),aI(this,mI,null),aI(this,wI,!1),lI(this,"ghostTable",new sI(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),lI(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return gI}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[gI]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||qe(Gt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>dI(vI,this,_I).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,DI).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,RI).call(t,...o)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,EI).call(t,...o)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,TI).call(t,...o)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,xI).call(t,...o)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,MI).call(t,...o)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,HI).call(t,...o)})),this.addHook("afterSelection",(()=>dI(vI,this,yI).call(this))),this.addHook("afterSelectionFocusSet",(()=>dI(vI,this,yI).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,bI).call(t,...o)})),this.addHook("afterGetColumnHeaderRenderers",(t=>dI(vI,this,II).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,OI).call(t,...o)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,PI).call(t,...o)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,CI).call(t,...o)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,SI).call(t,...o)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,kI).call(t,...o)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,AI).call(t,...o)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return dI(vI,t,NI).call(t,...o)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>dI(vI,this,yI).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>dI(vI,this,yI).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();uI(fI,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=uI(fI,this).setState(t)),this.detectedOverlappedHeaders&&qe(Gt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const o=!0===t?"hide-column":"show-column";uI(fI,this).triggerColumnModification(o,e)})),!uI(pI,this)&&this.enabled&&cI(pI,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:o,newValue:n}=t;if("replace"===e){const t=!0===n?"hide-column":"show-column";uI(fI,this).triggerColumnModification(t,o)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),uI(fI,this).clear(),uI(pI,this).unsubscribe(),cI(pI,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return uI(fI,this)}getLayersCount(){return uI(fI,this).getLayersCount()}getHeaderSettings(t,e){return uI(fI,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,o=t.wtTable.THEAD,n=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let t=0;t<e;t++){const e=o.childNodes[t];if(!e)break;const r=n.childNodes[t],s=i?i.childNodes[t]:null;for(let t=0,o=e.childNodes.length;t<o;t++)e.childNodes[t].removeAttribute("colspan"),ot(e.childNodes[t],"hiddenHeader"),r&&r.childNodes[t]&&(r.childNodes[t].removeAttribute("colspan"),ot(r.childNodes[t],"hiddenHeader")),i&&s&&s.childNodes[t]&&(s.childNodes[t].removeAttribute("colspan"),ot(s.childNodes[t],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,i)=>{var r;const{columnIndexMapper:s,view:l}=this.hot;let a=s.getVisualFromRenderableIndex(n);null===a&&(a=n),i.removeAttribute("colspan"),ot(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u}=null!==(r=uI(fI,this).getHeaderSettings(t,a))&&void 0!==r?r:{label:""};if(u||c)et(i,"hiddenHeader");else if(h>1){var d,g;const{wtOverlays:t}=l._wt,e=null===(d=t.topInlineStartCornerOverlay)||void 0===d?void 0:d.clone.wtTable.THEAD.contains(i),r=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),s=e||r?Math.min(h,o-n):h;s>1&&i.setAttribute("colspan",s)}this.hot.view.appendColHeader(a,i,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var o;const{isHidden:n,isPlaceholder:i}=null!==(o=uI(fI,this).getHeaderSettings(e,t))&&void 0!==o?o:{};return i||n?"":this.hot.getColHeader(t,e)}destroy(){cI(fI,this,null),null!==uI(pI,this)&&(uI(pI,this).unsubscribe(),cI(pI,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return uI(fI,this).getHeaderTreeNodeData(t.row,t.col)}}),pn(class extends fp{constructor(){var t;super(...arguments),XI(this,t=iA),t.add(this),qI(this,"dataManager",null),qI(this,"headersUI",null),qI(this,"collapsedRowsMap",null),KI(this,oA,!1),KI(this,nA,!1)}static get PLUGIN_KEY(){return tA}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[tA]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new bl),this.dataManager=new VI(this,this.hot),this.collapsingUI=new zI(this,this.hot),this.headersUI=new jI(this,this.hot),this.contextMenuUI=new $I(this,this.hot),this.rowMoveController=new YI(this),this.addHook("afterInit",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,vA).call(t,...o)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,yA).call(t,...o)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,lA).call(t,...o)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,aA).call(t,...o)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,hA).call(t,...o)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,sA).call(t,...o)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,dA).call(t,...o)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,uA).call(t,...o)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,gA).call(t,...o)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,fA).call(t,...o)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,pA).call(t,...o)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,mA).call(t,...o)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,cA).call(t,...o)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,wA).call(t,...o)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return JI(iA,t,rA).call(t,...o)})),this.addHook("beforeLoadData",(t=>JI(iA,this,bA).call(this,t))),this.addHook("beforeUpdateData",(t=>JI(iA,this,bA).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;const o=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return o&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(o)&&-1===o.col&&o.row>=0},group:eA,relativeToGroup:wu,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eA)}disableCoreAPIModifiers(){ZI(nA,this,!0)}enableCoreAPIModifiers(){ZI(nA,this,!1)}onModifyRowData(t){if(!QI(nA,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!QI(nA,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,o){return!(!QI(nA,this)&&!this.dataManager.isRowHighestLevel(t)&&(this.dataManager.spliceData(t,e,o),1))}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t,e,o;super(...arguments),t=this,o=void 0,e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e="storage"),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}static get PLUGIN_KEY(){return RA}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[RA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new SA(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=kA),e.add(t),EA(this,"callback",MA),EA(this,"queryMethod",HA),EA(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return xA}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[xA]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[xA];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TA(kA,t,IA).call(t,...o)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return TA(kA,t,IA).call(t,...o)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),i=this.hot.countCols(),r=[],s=this.hot;return Qo(0,n-1,(n=>{Qo(0,i-1,(i=>{const l=this.hot.getDataAtCell(n,i),a=this.hot.getCellMeta(n,i),h=a.search.callback||e,c=(a.search.queryMethod||o)(t,l,a);if(c){const t={row:n,col:i,data:l};r.push(t)}h&&h(s,n,i,l,c)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){be(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=PA),e.add(t),AA(this,"scrollbars",[]),AA(this,"clones",[]),AA(this,"lockedCollection",!1),AA(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return ke()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>OA(PA,this,NA).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>OA(PA,this,_A).call(this))),this.addHook("afterMomentumScroll",(()=>OA(PA,this,DA).call(this)))}}),pn(class extends fp{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t=this,e=VA),e.add(t),function(t,e,o){e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return LA}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[LA]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new bl),this.trimmedRowsMap.addLocalHook("init",(()=>function(t,e,o){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:o;throw new TypeError("Private element is not present on this object")}(VA,this,FA).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[LA];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),jt(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,n,o)&&(o&&this.hot.batchExecution((()=>{jt(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,n,o,o&&n.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;const i=this.trimmedRowsMap.getValues().slice(),r=t.length>0;o&&r&&(jt(t,(t=>{i[t]=!1})),n=Ft(i,((t,e,o)=>(e&&t.push(o),t)),[])),!1!==this.hot.runHooks("beforeUntrimRow",e,n,o&&r)&&(o&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,n,o&&r,o&&n.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}),pn(GA);const{prompt:YA}=window;function KA({tableRef:t}){const{tableData:e,debouncedTableData:o,colHeaders:n,colWidths:i,handleAfterChange:s,handleAfterColumnResize:l,handleAfterCreateCol:a,handleAfterCreateRow:h,handleColumnHeaderRename:c,handleAfterRowMove:d,handleColumnFreeze:g,handleColumnSort:f,getColHeader:m,insertNewRowAfter:w,insertNewRowBefore:v,insertNewColumnAfter:y,insertNewColumnBefore:b,getSelectedColumn:C}=p();return(0,r.createElement)(u.KeyboardShortcuts,{shortcuts:{"option+shift+up":()=>v(),"option+shift+down":()=>w(),"option+shift+left":()=>b(),"option+shift+right":()=>y()}},(0,r.createElement)(Ng,{ref:t,data:e,rowHeaders:!1,colHeaders:n,contextMenu:{items:{row_above:{},row_below:{},remove_row:{},col_left:{},col_right:{},remove_col:{},seperator:oy.SEPARATOR,rename:{name:"Rename this column",callback(t,e,o){const n=e[0].end.col,i=m(n),r=YA("Enter a new column name",i);r&&c(r,n)}},freeze_column:{name(){const t=C();return console.log(t),"Freeze this column"},callback(t,e,o){const n=e[0].end.col;g(n)}}}},columnSorting:!0,manualColumnFreeze:!0,wordWrap:!0,stretchH:"all",height:"auto",width:"100%",afterChange:s,afterColumnResize:l,afterRowMove:d,afterCreateCol:a,afterCreateRow:h,beforeColumnSort:f,licenseKey:"non-commercial-and-evaluation"}))}function XA(){return XA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},XA.apply(this,arguments)}function qA(t){var e=Object.create(null);return function(o){return void 0===e[o]&&(e[o]=t(o)),e[o]}}var QA=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ZA=qA((function(t){return QA.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),JA=function(){function t(t){var e=this;this._insertTag=function(t){var o;o=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,o),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var o=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{o.insertRule(t,o.cssRules.length)}catch(t){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){return t.parentNode&&t.parentNode.removeChild(t)})),this.tags=[],this.ctr=0},t}(),tO=Math.abs,eO=String.fromCharCode,oO=Object.assign;function nO(t){return t.trim()}function iO(t,e,o){return t.replace(e,o)}function rO(t,e){return t.indexOf(e)}function sO(t,e){return 0|t.charCodeAt(e)}function lO(t,e,o){return t.slice(e,o)}function aO(t){return t.length}function hO(t){return t.length}function cO(t,e){return e.push(t),t}var uO=1,dO=1,gO=0,fO=0,pO=0,mO="";function wO(t,e,o,n,i,r,s){return{value:t,root:e,parent:o,type:n,props:i,children:r,line:uO,column:dO,length:s,return:""}}function vO(t,e){return oO(wO("",null,null,"",null,null,0),t,{length:-t.length},e)}function yO(){return pO=fO>0?sO(mO,--fO):0,dO--,10===pO&&(dO=1,uO--),pO}function bO(){return pO=fO<gO?sO(mO,fO++):0,dO++,10===pO&&(dO=1,uO++),pO}function CO(){return sO(mO,fO)}function SO(){return fO}function RO(t,e){return lO(mO,t,e)}function EO(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function TO(t){return uO=dO=1,gO=aO(mO=t),fO=0,[]}function xO(t){return mO="",t}function MO(t){return nO(RO(fO-1,IO(91===t?t+2:40===t?t+1:t)))}function HO(t){for(;(pO=CO())&&pO<33;)bO();return EO(t)>2||EO(pO)>3?"":" "}function kO(t,e){for(;--e&&bO()&&!(pO<48||pO>102||pO>57&&pO<65||pO>70&&pO<97););return RO(t,SO()+(e<6&&32==CO()&&32==bO()))}function IO(t){for(;bO();)switch(pO){case t:return fO;case 34:case 39:34!==t&&39!==t&&IO(pO);break;case 40:41===t&&IO(t);break;case 92:bO()}return fO}function AO(t,e){for(;bO()&&t+pO!==57&&(t+pO!==84||47!==CO()););return"/*"+RO(e,fO-1)+"*"+eO(47===t?t:bO())}function OO(t){for(;!EO(CO());)bO();return RO(t,fO)}var PO="-ms-",NO="-moz-",_O="-webkit-",DO="comm",LO="rule",VO="decl",FO="@keyframes";function WO(t,e){for(var o="",n=hO(t),i=0;i<n;i++)o+=e(t[i],i,t,e)||"";return o}function BO(t,e,o,n){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case VO:return t.return=t.return||t.value;case DO:return"";case FO:return t.return=t.value+"{"+WO(t.children,n)+"}";case LO:t.value=t.props.join(",")}return aO(o=WO(t.children,n))?t.return=t.value+"{"+o+"}":""}function jO(t){return xO(zO("",null,null,null,[""],t=TO(t),0,[0],t))}function zO(t,e,o,n,i,r,s,l,a){for(var h=0,c=0,u=s,d=0,g=0,f=0,p=1,m=1,w=1,v=0,y="",b=i,C=r,S=n,R=y;m;)switch(f=v,v=bO()){case 40:if(108!=f&&58==sO(R,u-1)){-1!=rO(R+=iO(MO(v),"&","&\f"),"&\f")&&(w=-1);break}case 34:case 39:case 91:R+=MO(v);break;case 9:case 10:case 13:case 32:R+=HO(f);break;case 92:R+=kO(SO()-1,7);continue;case 47:switch(CO()){case 42:case 47:cO($O(AO(bO(),SO()),e,o),a);break;default:R+="/"}break;case 123*p:l[h++]=aO(R)*w;case 125*p:case 59:case 0:switch(v){case 0:case 125:m=0;case 59+c:-1==w&&(R=iO(R,/\f/g,"")),g>0&&aO(R)-u&&cO(g>32?GO(R+";",n,o,u-1):GO(iO(R," ","")+";",n,o,u-2),a);break;case 59:R+=";";default:if(cO(S=UO(R,e,o,h,c,i,l,y,b=[],C=[],u),r),123===v)if(0===c)zO(R,e,S,S,b,r,u,l,C);else switch(99===d&&110===sO(R,3)?100:d){case 100:case 108:case 109:case 115:zO(t,S,S,n&&cO(UO(t,S,S,0,0,i,l,y,i,b=[],u),C),i,C,u,l,n?b:C);break;default:zO(R,S,S,S,[""],C,0,l,C)}}h=c=g=0,p=w=1,y=R="",u=s;break;case 58:u=1+aO(R),g=f;default:if(p<1)if(123==v)--p;else if(125==v&&0==p++&&125==yO())continue;switch(R+=eO(v),v*p){case 38:w=c>0?1:(R+="\f",-1);break;case 44:l[h++]=(aO(R)-1)*w,w=1;break;case 64:45===CO()&&(R+=MO(bO())),d=CO(),c=u=aO(y=R+=OO(SO())),v++;break;case 45:45===f&&2==aO(R)&&(p=0)}}return r}function UO(t,e,o,n,i,r,s,l,a,h,c){for(var u=i-1,d=0===i?r:[""],g=hO(d),f=0,p=0,m=0;f<n;++f)for(var w=0,v=lO(t,u+1,u=tO(p=s[f])),y=t;w<g;++w)(y=nO(p>0?d[w]+" "+v:iO(v,/&\f/g,d[w])))&&(a[m++]=y);return wO(t,e,o,0===i?LO:l,a,h,c)}function $O(t,e,o){return wO(t,e,o,DO,eO(pO),lO(t,2,-2),0)}function GO(t,e,o,n){return wO(t,e,o,VO,lO(t,0,n),lO(t,n+1,-1),n)}var YO=function(t,e,o){for(var n=0,i=0;n=i,i=CO(),38===n&&12===i&&(e[o]=1),!EO(i);)bO();return RO(t,fO)},KO=new WeakMap,XO=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,o=t.parent,n=t.column===o.column&&t.line===o.line;"rule"!==o.type;)if(!(o=o.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||KO.get(o))&&!n){KO.set(t,!0);for(var i=[],r=function(t,e){return xO(function(t,e){var o=-1,n=44;do{switch(EO(n)){case 0:38===n&&12===CO()&&(e[o]=1),t[o]+=YO(fO-1,e,o);break;case 2:t[o]+=MO(n);break;case 4:if(44===n){t[++o]=58===CO()?"&\f":"",e[o]=t[o].length;break}default:t[o]+=eO(n)}}while(n=bO());return t}(TO(t),e))}(e,i),s=o.props,l=0,a=0;l<r.length;l++)for(var h=0;h<s.length;h++,a++)t.props[a]=i[l]?r[l].replace(/&\f/g,s[h]):s[h]+" "+r[l]}}},qO=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function QO(t,e){switch(function(t,e){return 45^sO(t,0)?(((e<<2^sO(t,0))<<2^sO(t,1))<<2^sO(t,2))<<2^sO(t,3):0}(t,e)){case 5103:return _O+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _O+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return _O+t+NO+t+PO+t+t;case 6828:case 4268:return _O+t+PO+t+t;case 6165:return _O+t+PO+"flex-"+t+t;case 5187:return _O+t+iO(t,/(\w+).+(:[^]+)/,_O+"box-$1$2"+PO+"flex-$1$2")+t;case 5443:return _O+t+PO+"flex-item-"+iO(t,/flex-|-self/,"")+t;case 4675:return _O+t+PO+"flex-line-pack"+iO(t,/align-content|flex-|-self/,"")+t;case 5548:return _O+t+PO+iO(t,"shrink","negative")+t;case 5292:return _O+t+PO+iO(t,"basis","preferred-size")+t;case 6060:return _O+"box-"+iO(t,"-grow","")+_O+t+PO+iO(t,"grow","positive")+t;case 4554:return _O+iO(t,/([^-])(transform)/g,"$1"+_O+"$2")+t;case 6187:return iO(iO(iO(t,/(zoom-|grab)/,_O+"$1"),/(image-set)/,_O+"$1"),t,"")+t;case 5495:case 3959:return iO(t,/(image-set\([^]*)/,_O+"$1$`$1");case 4968:return iO(iO(t,/(.+:)(flex-)?(.*)/,_O+"box-pack:$3"+PO+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_O+t+t;case 4095:case 3583:case 4068:case 2532:return iO(t,/(.+)-inline(.+)/,_O+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(aO(t)-1-e>6)switch(sO(t,e+1)){case 109:if(45!==sO(t,e+4))break;case 102:return iO(t,/(.+:)(.+)-([^]+)/,"$1"+_O+"$2-$3$1"+NO+(108==sO(t,e+3)?"$3":"$2-$3"))+t;case 115:return~rO(t,"stretch")?QO(iO(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==sO(t,e+1))break;case 6444:switch(sO(t,aO(t)-3-(~rO(t,"!important")&&10))){case 107:return iO(t,":",":"+_O)+t;case 101:return iO(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_O+(45===sO(t,14)?"inline-":"")+"box$3$1"+_O+"$2$3$1"+PO+"$2box$3")+t}break;case 5936:switch(sO(t,e+11)){case 114:return _O+t+PO+iO(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return _O+t+PO+iO(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return _O+t+PO+iO(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return _O+t+PO+t+t}return t}var ZO=[function(t,e,o,n){if(t.length>-1&&!t.return)switch(t.type){case VO:t.return=QO(t.value,t.length);break;case FO:return WO([vO(t,{value:iO(t.value,"@","@"+_O)})],n);case LO:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t,e){return(t=/(::plac\w+|:read-\w+)/.exec(t))?t[0]:t}(e)){case":read-only":case":read-write":return WO([vO(t,{props:[iO(e,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return WO([vO(t,{props:[iO(e,/:(plac\w+)/,":"+_O+"input-$1")]}),vO(t,{props:[iO(e,/:(plac\w+)/,":-moz-$1")]}),vO(t,{props:[iO(e,/:(plac\w+)/,PO+"input-$1")]})],n)}return""}))}}],JO=function(t){var e=t.key;if("css"===e){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var n,i,r=t.stylisPlugins||ZO,s={},l=[];n=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),o=1;o<e.length;o++)s[e[o]]=!0;l.push(t)}));var a,h,c=[BO,(h=function(t){a.insert(t)},function(t){t.root||(t=t.return)&&h(t)})],u=function(t){var e=hO(t);return function(o,n,i,r){for(var s="",l=0;l<e;l++)s+=t[l](o,n,i,r)||"";return s}}([XO,qO].concat(r,c));i=function(t,e,o,n){a=o,WO(jO(t?t+"{"+e.styles+"}":e.styles),u),n&&(d.inserted[e.name]=!0)};var d={key:e,sheet:new JA({key:e,container:n,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:s,registered:{},insert:i};return d.sheet.hydrate(l),d},tP={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},eP=/[A-Z]|^ms/g,oP=/_EMO_([^_]+?)_([^]*?)_EMO_/g,nP=function(t){return 45===t.charCodeAt(1)},iP=function(t){return null!=t&&"boolean"!=typeof t},rP=qA((function(t){return nP(t)?t:t.replace(eP,"-$&").toLowerCase()})),sP=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(oP,(function(t,e,o){return aP={name:e,styles:o,next:aP},e}))}return 1===tP[t]||nP(t)||"number"!=typeof e||0===e?e:e+"px"};function lP(t,e,o){if(null==o)return"";if(void 0!==o.__emotion_styles)return o;switch(typeof o){case"boolean":return"";case"object":if(1===o.anim)return aP={name:o.name,styles:o.styles,next:aP},o.name;if(void 0!==o.styles){var n=o.next;if(void 0!==n)for(;void 0!==n;)aP={name:n.name,styles:n.styles,next:aP},n=n.next;return o.styles+";"}return function(t,e,o){var n="";if(Array.isArray(o))for(var i=0;i<o.length;i++)n+=lP(t,e,o[i])+";";else for(var r in o){var s=o[r];if("object"!=typeof s)null!=e&&void 0!==e[s]?n+=r+"{"+e[s]+"}":iP(s)&&(n+=rP(r)+":"+sP(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=e&&void 0!==e[s[0]]){var l=lP(t,e,s);switch(r){case"animation":case"animationName":n+=rP(r)+":"+l+";";break;default:n+=r+"{"+l+"}"}}else for(var a=0;a<s.length;a++)iP(s[a])&&(n+=rP(r)+":"+sP(r,s[a])+";")}return n}(t,e,o);case"function":if(void 0!==t){var i=aP,r=o(t);return aP=i,lP(t,e,r)}}if(null==e)return o;var s=e[o];return void 0!==s?s:o}var aP,hP=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cP=!!r.useInsertionEffect&&r.useInsertionEffect,uP=cP||function(t){return t()},dP=(cP||r.useLayoutEffect,r.createContext("undefined"!=typeof HTMLElement?JO({key:"css"}):null));dP.Provider;var gP=r.createContext({}),fP=function(t,e,o){var n=t.key+"-"+e.name;!1===o&&void 0===t.registered[n]&&(t.registered[n]=e.styles)},pP=ZA,mP=function(t){return"theme"!==t},wP=function(t){return"string"==typeof t&&t.charCodeAt(0)>96?pP:mP},vP=function(t,e,o){var n;if(e){var i=e.shouldForwardProp;n=t.__emotion_forwardProp&&i?function(e){return t.__emotion_forwardProp(e)&&i(e)}:i}return"function"!=typeof n&&o&&(n=t.__emotion_forwardProp),n},yP=function(t){var e=t.cache,o=t.serialized,n=t.isStringTag;return fP(e,o,n),uP((function(){return function(t,e,o){fP(t,e,o);var n=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var i=e;do{t.insert(e===i?"."+n:"",i,t.sheet,!0),i=i.next}while(void 0!==i)}}(e,o,n)})),null},bP=function t(e,o){var n,i,s=e.__emotion_real===e,l=s&&e.__emotion_base||e;void 0!==o&&(n=o.label,i=o.target);var a=vP(e,o,s),h=a||wP(l),c=!h("as");return function(){var u=arguments,d=s&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==n&&d.push("label:"+n+";"),null==u[0]||void 0===u[0].raw)d.push.apply(d,u);else{d.push(u[0][0]);for(var g=u.length,f=1;f<g;f++)d.push(u[f],u[0][f])}var p,m=(p=function(t,e,o){var n,s,u,g,f=c&&t.as||l,p="",m=[],w=t;if(null==t.theme){for(var v in w={},t)w[v]=t[v];w.theme=r.useContext(gP)}"string"==typeof t.className?(n=e.registered,s=m,u=t.className,g="",u.split(" ").forEach((function(t){void 0!==n[t]?s.push(n[t]+";"):g+=t+" "})),p=g):null!=t.className&&(p=t.className+" ");var y=function(t,e,o){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var n=!0,i="";aP=void 0;var r=t[0];null==r||void 0===r.raw?(n=!1,i+=lP(o,e,r)):i+=r[0];for(var s=1;s<t.length;s++)i+=lP(o,e,t[s]),n&&(i+=r[s]);hP.lastIndex=0;for(var l,a="";null!==(l=hP.exec(i));)a+="-"+l[1];var h=function(t){for(var e,o=0,n=0,i=t.length;i>=4;++n,i-=4)e=1540483477*(65535&(e=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+(59797*(e>>>16)<<16),o=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&o)+(59797*(o>>>16)<<16);switch(i){case 3:o^=(255&t.charCodeAt(n+2))<<16;case 2:o^=(255&t.charCodeAt(n+1))<<8;case 1:o=1540483477*(65535&(o^=255&t.charCodeAt(n)))+(59797*(o>>>16)<<16)}return(((o=1540483477*(65535&(o^=o>>>13))+(59797*(o>>>16)<<16))^o>>>15)>>>0).toString(36)}(i)+a;return{name:h,styles:i,next:aP}}(d.concat(m),e.registered,w);p+=e.key+"-"+y.name,void 0!==i&&(p+=" "+i);var b=c&&void 0===a?wP(f):h,C={};for(var S in t)c&&"as"===S||b(S)&&(C[S]=t[S]);return C.className=p,C.ref=o,r.createElement(r.Fragment,null,r.createElement(yP,{cache:e,serialized:y,isStringTag:"string"==typeof f}),r.createElement(f,C))},(0,r.forwardRef)((function(t,e){var o=(0,r.useContext)(dP);return p(t,o,e)})));return m.displayName=void 0!==n?n:"Styled("+("string"==typeof l?l:l.displayName||l.name||"Component")+")",m.defaultProps=e.defaultProps,m.__emotion_real=m,m.__emotion_base=l,m.__emotion_styles=d,m.__emotion_forwardProp=a,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(e,n){return t(e,XA({},o,n,{shouldForwardProp:vP(m,n,!0)})).apply(void 0,d)},m}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){bP[t]=bP(t)}));const CP=bP.div`
	display: flex;
`,SP=bP.input`
	flex-grow: 1;
	width: 100%;
	margin: 0 10px 10px 0;
`,RP=bP.div`
	margin-top: 10px;
	background-color: #f3f3f3;
	padding: 10px;
`,EP=bP(u.__experimentalNumberControl)`
	display: flex;
	.components-base-control__field {
		display: flex;
	}
`;function TP({onFinish:t,setAttributes:e}){const[o,n]=(0,s.useState)(0),[i,l]=(0,s.useState)([]),[a,h]=(0,s.useState)(0),[c,d]=(0,s.useState)(0),[g,f]=(0,s.useState)([]);return(0,r.createElement)(u.Placeholder,{label:"Table Setup Wizard",instructions:0===a?"Enter the number of columns to start with":"Enter the names of your columns",icon:0===a?"table-row-after":"table-col-after"},0===a?(0,r.createElement)(s.Fragment,null,(0,r.createElement)(CP,null,(0,r.createElement)(EP,{isShiftStepEnabled:!0,onChange:t=>{return e=t,d(o),f(i),void n(e);var e},shiftStep:1,value:o}),(0,r.createElement)(u.Button,{isPrimary:!0,onClick:()=>h(1)},"Next")),(0,r.createElement)(RP,null,(0,r.createElement)(b,{onChange:(t,o)=>{e({data:t,colHeaders:o})}}))):(0,r.createElement)(s.Fragment,null,(0,r.createElement)(CP,null,Array.from({length:o}).map(((t,e)=>(0,r.createElement)(SP,{key:e,type:"text",value:i[e]||"",onChange:t=>((t,e)=>{const o=[...i];o[t]=e,l(o)})(e,t.target.value),tabIndex:e+1})))),(0,r.createElement)(u.Button,{isDefault:!0,onClick:()=>{n(c),l(g.slice(0,c)),h(0)}},"Back"),(0,r.createElement)(u.Button,{isPrimary:!0,onClick:()=>{t(i)}},"Finish")))}const xP=window.prcIcons,MP={from:[{type:"block",blocks:["core/table"],transform:({head:t,foot:e,body:o})=>(0,i.createBlock)("prc-block/data-table",{head:t.map((t=>t.cells.map((t=>t.content)))),body:o.map((t=>t.cells.map((t=>t.content))))})}]},HP=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"prc-block/data-table","version":"1.0.0","title":"Data Table","category":"text","description":"This block enables you to build sophisticated data tables in an easy to use interface with a familiar spreadsheet-like interface.","attributes":{"title":{"type":"string"},"caption":{"type":"string"},"data":{"type":"array","default":[]},"colWidths":{"type":"array","default":[]},"colHeaders":{"type":"array","default":[]},"frozenColumns":{"type":"array","default":[]},"cellBackgroundColor":{"type":"string"},"cellTextColor":{"type":"string"},"headerRowBackgroundColor":{"type":"string","default":"gray"},"headerRowTextColor":{"type":"string"}},"styles":[{"name":"default","label":"Default","isDefault":true},{"name":"striped","label":"Striped"}],"supports":{"anchor":true,"html":false,"align":["wide","full"],"spacing":{"margin":["top","bottom"]}},"example":{"attributes":{"colHeaders":["Country","Year","Population"],"data":[["United States","2000","1000"],["France","2000","1001"]]}},"textdomain":"data-table","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":["file:./style-index.css","file:./view.css"],"viewScript":"file:./view.js"}'),{name:kP}=HP,IP={icon:function(){return(0,r.createElement)(xP.Icon,{icon:"table-pivot"})},edit:function({attributes:t,setAttributes:e,clientId:o,isSelected:n}){const i=(0,l.useBlockProps)(),a=(0,s.useRef)(null);console.log(o);const h=0===t.colHeaders.length;return(0,r.createElement)(s.Fragment,null,h&&(0,r.createElement)("figure",{...i},(0,r.createElement)(TP,{onFinish:t=>{const o={colHeaders:t};o.data=[Array(t.length).fill("")],console.log("Finish Table Setup Wizard: Yield = ",o),e(o)},setAttributes:e})),!h&&(0,r.createElement)(m,{clientId:o,tableRef:a},(0,r.createElement)(R,null),(0,r.createElement)("figure",{...i},(0,r.createElement)(KA,{tableRef:a}),(n||t.caption)&&(0,r.createElement)(l.RichText,{tagName:"figcaption",placeholder:"Caption",value:t.caption,onChange:t=>e({caption:t})}))))},transforms:MP};(0,i.registerBlockType)(kP,{...HP,...IP})},2838:function(t){t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,o){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,o)}function o(t,n,i){return o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,o,n){var i=[null];i.push.apply(i,o);var r=new(Function.bind.apply(t,i));return n&&e(r,n.prototype),r},o.apply(null,arguments)}function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var r=Object.hasOwnProperty,s=Object.setPrototypeOf,l=Object.isFrozen,a=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,c=Object.freeze,u=Object.seal,d=Object.create,g="undefined"!=typeof Reflect&&Reflect,f=g.apply,p=g.construct;f||(f=function(t,e,o){return t.apply(e,o)}),c||(c=function(t){return t}),u||(u=function(t){return t}),p||(p=function(t,e){return o(t,n(e))});var m,w=H(Array.prototype.forEach),v=H(Array.prototype.pop),y=H(Array.prototype.push),b=H(String.prototype.toLowerCase),C=H(String.prototype.toString),S=H(String.prototype.match),R=H(String.prototype.replace),E=H(String.prototype.indexOf),T=H(String.prototype.trim),x=H(RegExp.prototype.test),M=(m=TypeError,function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return p(m,e)});function H(t){return function(e){for(var o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];return f(t,e,n)}}function k(t,e,o){var n;o=null!==(n=o)&&void 0!==n?n:b,s&&s(t,null);for(var i=e.length;i--;){var r=e[i];if("string"==typeof r){var a=o(r);a!==r&&(l(e)||(e[i]=a),r=a)}t[r]=!0}return t}function I(t){var e,o=d(null);for(e in t)!0===f(r,t,[e])&&(o[e]=t[e]);return o}function A(t,e){for(;null!==t;){var o=h(t,e);if(o){if(o.get)return H(o.get);if("function"==typeof o.value)return H(o.value)}t=a(t)}return function(t){return console.warn("fallback value for",t),null}}var O=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_=c(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),L=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),V=c(["#text"]),F=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),W=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=u(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=u(/<%[\w\W]*|[\w\W]*%>/gm),$=u(/\${[\w\W]*}/gm),G=u(/^data-[\-\w.\u00B7-\uFFFF]/),Y=u(/^aria-[\-\w]+$/),K=u(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=u(/^(?:\w+script|data):/i),q=u(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=u(/^html$/i),Z=u(/^[a-z][.\w]*(-[.\w]+)+$/i),J=function(){return"undefined"==typeof window?null:window};return function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J(),i=function(t){return e(t)};if(i.version="2.5.0",i.removed=[],!o||!o.document||9!==o.document.nodeType)return i.isSupported=!1,i;var r=o.document,s=o.document,l=o.DocumentFragment,a=o.HTMLTemplateElement,h=o.Node,u=o.Element,d=o.NodeFilter,g=o.NamedNodeMap,f=void 0===g?o.NamedNodeMap||o.MozNamedAttrMap:g,p=o.HTMLFormElement,m=o.DOMParser,H=o.trustedTypes,tt=u.prototype,et=A(tt,"cloneNode"),ot=A(tt,"nextSibling"),nt=A(tt,"childNodes"),it=A(tt,"parentNode");if("function"==typeof a){var rt=s.createElement("template");rt.content&&rt.content.ownerDocument&&(s=rt.content.ownerDocument)}var st=function(e,o){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var n=null,i="data-tt-policy-suffix";o.currentScript&&o.currentScript.hasAttribute(i)&&(n=o.currentScript.getAttribute(i));var r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+r+" could not be created."),null}}(H,r),lt=st?st.createHTML(""):"",at=s,ht=at.implementation,ct=at.createNodeIterator,ut=at.createDocumentFragment,dt=at.getElementsByTagName,gt=r.importNode,ft={};try{ft=I(s).documentMode?s.documentMode:{}}catch(t){}var pt={};i.isSupported="function"==typeof it&&ht&&void 0!==ht.createHTMLDocument&&9!==ft;var mt,wt,vt=z,yt=U,bt=$,Ct=G,St=Y,Rt=X,Et=q,Tt=Z,xt=K,Mt=null,Ht=k({},[].concat(n(O),n(P),n(N),n(D),n(V))),kt=null,It=k({},[].concat(n(F),n(W),n(B),n(j))),At=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ot=null,Pt=null,Nt=!0,_t=!0,Dt=!1,Lt=!0,Vt=!1,Ft=!0,Wt=!1,Bt=!1,jt=!1,zt=!1,Ut=!1,$t=!1,Gt=!0,Yt=!1,Kt=!0,Xt=!1,qt={},Qt=null,Zt=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Jt=null,te=k({},["audio","video","img","source","image","track"]),ee=null,oe=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ne="http://www.w3.org/1998/Math/MathML",ie="http://www.w3.org/2000/svg",re="http://www.w3.org/1999/xhtml",se=re,le=!1,ae=null,he=k({},[ne,ie,re],C),ce=["application/xhtml+xml","text/html"],ue=null,de=s.createElement("form"),ge=function(t){return t instanceof RegExp||t instanceof Function},fe=function(e){ue&&ue===e||(e&&"object"===t(e)||(e={}),e=I(e),mt=mt=-1===ce.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,wt="application/xhtml+xml"===mt?C:b,Mt="ALLOWED_TAGS"in e?k({},e.ALLOWED_TAGS,wt):Ht,kt="ALLOWED_ATTR"in e?k({},e.ALLOWED_ATTR,wt):It,ae="ALLOWED_NAMESPACES"in e?k({},e.ALLOWED_NAMESPACES,C):he,ee="ADD_URI_SAFE_ATTR"in e?k(I(oe),e.ADD_URI_SAFE_ATTR,wt):oe,Jt="ADD_DATA_URI_TAGS"in e?k(I(te),e.ADD_DATA_URI_TAGS,wt):te,Qt="FORBID_CONTENTS"in e?k({},e.FORBID_CONTENTS,wt):Zt,Ot="FORBID_TAGS"in e?k({},e.FORBID_TAGS,wt):{},Pt="FORBID_ATTR"in e?k({},e.FORBID_ATTR,wt):{},qt="USE_PROFILES"in e&&e.USE_PROFILES,Nt=!1!==e.ALLOW_ARIA_ATTR,_t=!1!==e.ALLOW_DATA_ATTR,Dt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Lt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Vt=e.SAFE_FOR_TEMPLATES||!1,Ft=!1!==e.SAFE_FOR_XML,Wt=e.WHOLE_DOCUMENT||!1,zt=e.RETURN_DOM||!1,Ut=e.RETURN_DOM_FRAGMENT||!1,$t=e.RETURN_TRUSTED_TYPE||!1,jt=e.FORCE_BODY||!1,Gt=!1!==e.SANITIZE_DOM,Yt=e.SANITIZE_NAMED_PROPS||!1,Kt=!1!==e.KEEP_CONTENT,Xt=e.IN_PLACE||!1,xt=e.ALLOWED_URI_REGEXP||xt,se=e.NAMESPACE||re,At=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(At.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ge(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(At.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(At.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Vt&&(_t=!1),Ut&&(zt=!0),qt&&(Mt=k({},n(V)),kt=[],!0===qt.html&&(k(Mt,O),k(kt,F)),!0===qt.svg&&(k(Mt,P),k(kt,W),k(kt,j)),!0===qt.svgFilters&&(k(Mt,N),k(kt,W),k(kt,j)),!0===qt.mathMl&&(k(Mt,D),k(kt,B),k(kt,j))),e.ADD_TAGS&&(Mt===Ht&&(Mt=I(Mt)),k(Mt,e.ADD_TAGS,wt)),e.ADD_ATTR&&(kt===It&&(kt=I(kt)),k(kt,e.ADD_ATTR,wt)),e.ADD_URI_SAFE_ATTR&&k(ee,e.ADD_URI_SAFE_ATTR,wt),e.FORBID_CONTENTS&&(Qt===Zt&&(Qt=I(Qt)),k(Qt,e.FORBID_CONTENTS,wt)),Kt&&(Mt["#text"]=!0),Wt&&k(Mt,["html","head","body"]),Mt.table&&(k(Mt,["tbody"]),delete Ot.tbody),c&&c(e),ue=e)},pe=k({},["mi","mo","mn","ms","mtext"]),me=k({},["foreignobject","desc","title","annotation-xml"]),we=k({},["title","style","font","a","script"]),ve=k({},P);k(ve,N),k(ve,_);var ye=k({},D);k(ye,L);var be=function(t){y(i.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=lt}catch(e){t.remove()}}},Ce=function(t,e){try{y(i.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){y(i.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!kt[t])if(zt||Ut)try{be(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Se=function(t){var e,o;if(jt)t="<remove></remove>"+t;else{var n=S(t,/^[\r\n\t ]+/);o=n&&n[0]}"application/xhtml+xml"===mt&&se===re&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var i=st?st.createHTML(t):t;if(se===re)try{e=(new m).parseFromString(i,mt)}catch(t){}if(!e||!e.documentElement){e=ht.createDocument(se,"template",null);try{e.documentElement.innerHTML=le?lt:i}catch(t){}}var r=e.body||e.documentElement;return t&&o&&r.insertBefore(s.createTextNode(o),r.childNodes[0]||null),se===re?dt.call(e,Wt?"html":"body")[0]:Wt?e.documentElement:r},Re=function(t){return ct.call(t.ownerDocument||t,t,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null,!1)},Ee=function(e){return"object"===t(h)?e instanceof h:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Te=function(t,e,o){pt[t]&&w(pt[t],(function(t){t.call(i,e,o,ue)}))},xe=function(t){var e,o;if(Te("beforeSanitizeElements",t,null),(o=t)instanceof p&&("string"!=typeof o.nodeName||"string"!=typeof o.textContent||"function"!=typeof o.removeChild||!(o.attributes instanceof f)||"function"!=typeof o.removeAttribute||"function"!=typeof o.setAttribute||"string"!=typeof o.namespaceURI||"function"!=typeof o.insertBefore||"function"!=typeof o.hasChildNodes))return be(t),!0;if(x(/[\u0080-\uFFFF]/,t.nodeName))return be(t),!0;var n=wt(t.nodeName);if(Te("uponSanitizeElement",t,{tagName:n,allowedTags:Mt}),t.hasChildNodes()&&!Ee(t.firstElementChild)&&(!Ee(t.content)||!Ee(t.content.firstElementChild))&&x(/<[/\w]/g,t.innerHTML)&&x(/<[/\w]/g,t.textContent))return be(t),!0;if("select"===n&&x(/<template/i,t.innerHTML))return be(t),!0;if(7===t.nodeType)return be(t),!0;if(Ft&&8===t.nodeType&&x(/<[/\w]/g,t.data))return be(t),!0;if(!Mt[n]||Ot[n]){if(!Ot[n]&&He(n)){if(At.tagNameCheck instanceof RegExp&&x(At.tagNameCheck,n))return!1;if(At.tagNameCheck instanceof Function&&At.tagNameCheck(n))return!1}if(Kt&&!Qt[n]){var r=it(t)||t.parentNode,s=nt(t)||t.childNodes;if(s&&r)for(var l=s.length-1;l>=0;--l)r.insertBefore(et(s[l],!0),ot(t))}return be(t),!0}return t instanceof u&&!function(t){var e=it(t);e&&e.tagName||(e={namespaceURI:se,tagName:"template"});var o=b(t.tagName),n=b(e.tagName);return!!ae[t.namespaceURI]&&(t.namespaceURI===ie?e.namespaceURI===re?"svg"===o:e.namespaceURI===ne?"svg"===o&&("annotation-xml"===n||pe[n]):Boolean(ve[o]):t.namespaceURI===ne?e.namespaceURI===re?"math"===o:e.namespaceURI===ie?"math"===o&&me[n]:Boolean(ye[o]):t.namespaceURI===re?!(e.namespaceURI===ie&&!me[n])&&!(e.namespaceURI===ne&&!pe[n])&&!ye[o]&&(we[o]||!ve[o]):!("application/xhtml+xml"!==mt||!ae[t.namespaceURI]))}(t)?(be(t),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!x(/<\/no(script|embed|frames)/i,t.innerHTML)?(Vt&&3===t.nodeType&&(e=t.textContent,e=R(e,vt," "),e=R(e,yt," "),e=R(e,bt," "),t.textContent!==e&&(y(i.removed,{element:t.cloneNode()}),t.textContent=e)),Te("afterSanitizeElements",t,null),!1):(be(t),!0)},Me=function(t,e,o){if(Gt&&("id"===e||"name"===e)&&(o in s||o in de))return!1;if(_t&&!Pt[e]&&x(Ct,e));else if(Nt&&x(St,e));else if(!kt[e]||Pt[e]){if(!(He(t)&&(At.tagNameCheck instanceof RegExp&&x(At.tagNameCheck,t)||At.tagNameCheck instanceof Function&&At.tagNameCheck(t))&&(At.attributeNameCheck instanceof RegExp&&x(At.attributeNameCheck,e)||At.attributeNameCheck instanceof Function&&At.attributeNameCheck(e))||"is"===e&&At.allowCustomizedBuiltInElements&&(At.tagNameCheck instanceof RegExp&&x(At.tagNameCheck,o)||At.tagNameCheck instanceof Function&&At.tagNameCheck(o))))return!1}else if(ee[e]);else if(x(xt,R(o,Et,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==E(o,"data:")||!Jt[t])if(Dt&&!x(Rt,R(o,Et,"")));else if(o)return!1;return!0},He=function(t){return"annotation-xml"!==t&&S(t,Tt)},ke=function(e){var o,n,r,s;Te("beforeSanitizeAttributes",e,null);var l=e.attributes;if(l){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:kt};for(s=l.length;s--;){var h=o=l[s],c=h.name,u=h.namespaceURI;if(n="value"===c?o.value:T(o.value),r=wt(c),a.attrName=r,a.attrValue=n,a.keepAttr=!0,a.forceKeepAttr=void 0,Te("uponSanitizeAttribute",e,a),n=a.attrValue,!a.forceKeepAttr&&(Ce(c,e),a.keepAttr))if(Lt||!x(/\/>/i,n)){Vt&&(n=R(n,vt," "),n=R(n,yt," "),n=R(n,bt," "));var d=wt(e.nodeName);if(Me(d,r,n)){if(!Yt||"id"!==r&&"name"!==r||(Ce(c,e),n="user-content-"+n),st&&"object"===t(H)&&"function"==typeof H.getAttributeType)if(u);else switch(H.getAttributeType(d,r)){case"TrustedHTML":n=st.createHTML(n);break;case"TrustedScriptURL":n=st.createScriptURL(n)}try{u?e.setAttributeNS(u,c,n):e.setAttribute(c,n),v(i.removed)}catch(t){}}}else Ce(c,e)}Te("afterSanitizeAttributes",e,null)}},Ie=function t(e){var o,n=Re(e);for(Te("beforeSanitizeShadowDOM",e,null);o=n.nextNode();)Te("uponSanitizeShadowNode",o,null),xe(o)||(o.content instanceof l&&t(o.content),ke(o));Te("afterSanitizeShadowDOM",e,null)};return i.sanitize=function(e){var n,s,a,c,u,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((le=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Ee(e)){if("function"!=typeof e.toString)throw M("toString is not a function");if("string"!=typeof(e=e.toString()))throw M("dirty is not a string, aborting")}if(!i.isSupported){if("object"===t(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(Ee(e))return o.toStaticHTML(e.outerHTML)}return e}if(Bt||fe(d),i.removed=[],"string"==typeof e&&(Xt=!1),Xt){if(e.nodeName){var g=wt(e.nodeName);if(!Mt[g]||Ot[g])throw M("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof h)1===(s=(n=Se("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?n=s:n.appendChild(s);else{if(!zt&&!Vt&&!Wt&&-1===e.indexOf("<"))return st&&$t?st.createHTML(e):e;if(!(n=Se(e)))return zt?null:$t?lt:""}n&&jt&&be(n.firstChild);for(var f=Re(Xt?e:n);a=f.nextNode();)3===a.nodeType&&a===c||xe(a)||(a.content instanceof l&&Ie(a.content),ke(a),c=a);if(c=null,Xt)return e;if(zt){if(Ut)for(u=ut.call(n.ownerDocument);n.firstChild;)u.appendChild(n.firstChild);else u=n;return(kt.shadowroot||kt.shadowrootmod)&&(u=gt.call(r,u,!0)),u}var p=Wt?n.outerHTML:n.innerHTML;return Wt&&Mt["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&x(Q,n.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+p),Vt&&(p=R(p,vt," "),p=R(p,yt," "),p=R(p,bt," ")),st&&$t?st.createHTML(p):p},i.setConfig=function(t){fe(t),Bt=!0},i.clearConfig=function(){ue=null,Bt=!1},i.isValidAttribute=function(t,e,o){ue||fe({});var n=wt(t),i=wt(e);return Me(n,i,o)},i.addHook=function(t,e){"function"==typeof e&&(pt[t]=pt[t]||[],y(pt[t],e))},i.removeHook=function(t){if(pt[t])return v(pt[t])},i.removeHooks=function(t){pt[t]&&(pt[t]=[])},i.removeAllHooks=function(){pt={}},i}()}()},8646:t=>{t.exports=function t(e,o,n){function i(s,l){if(!o[s]){if(!e[s]){if(r)return r(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=o[s]={exports:{}};e[s][0].call(h.exports,(function(t){return i(e[s][1][t]||t)}),h,h.exports,t,e,o,n)}return o[s].exports}for(var r=void 0,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,o){!function(t){"use strict";var o,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,r=Math.floor,s="[BigNumber Error] ",l=s+"Number primitive has more than 15 significant digits: ",a=1e14,h=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,g=1e9;function f(t){var e=0|t;return 0<t||t===e?e:e-1}function p(t){for(var e,o,n=1,i=t.length,r=t[0]+"";n<i;){for(e=t[n++]+"",o=h-e.length;o--;e="0"+e);r+=e}for(i=r.length;48===r.charCodeAt(--i););return r.slice(0,i+1||1)}function m(t,e){var o,n,i=t.c,r=e.c,s=t.s,l=e.s,a=t.e,h=e.e;if(!s||!l)return null;if(o=i&&!i[0],n=r&&!r[0],o||n)return o?n?0:-l:s;if(s!=l)return s;if(o=s<0,n=a==h,!i||!r)return n?0:!i^o?1:-1;if(!n)return h<a^o?1:-1;for(l=(a=i.length)<(h=r.length)?a:h,s=0;s<l;s++)if(i[s]!=r[s])return i[s]>r[s]^o?1:-1;return a==h?0:h<a^o?1:-1}function w(t,e,o,n){if(t<e||o<t||t!==(t<0?i(t):r(t)))throw Error(s+(n||"Argument")+("number"==typeof t?t<e||o<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function v(t){var e=t.c.length-1;return f(t.e/h)==e&&t.c[e]%2!=0}function y(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function b(t,e,o){var n,i;if(e<0){for(i=o+".";++e;i+=o);t=i+t}else if(++e>(n=t.length)){for(i=o,e-=n;--e;i+=o);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}(o=function t(e){var o,C,S,R,E,T,x,M,H,k,I=z.prototype={constructor:z,toString:null,valueOf:null},A=new z(1),O=20,P=4,N=-7,_=21,D=-1e7,L=1e7,V=!1,F=1,W=0,B={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz";function z(t,e){var o,i,s,a,u,d,g,f,p=this;if(!(p instanceof z))return new z(t,e);if(null==e){if(t instanceof z)return p.s=t.s,p.e=t.e,void(p.c=(t=t.c)?t.slice():t);if((d="number"==typeof t)&&0*t==0){if(p.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,u=t;10<=u;u/=10,a++);return p.e=a,void(p.c=[t])}f=String(t)}else{if(f=String(t),!n.test(f))return S(p,f,d);p.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}-1<(a=f.indexOf("."))&&(f=f.replace(".","")),0<(u=f.search(/e/i))?(a<0&&(a=u),a+=+f.slice(u+1),f=f.substring(0,u)):a<0&&(a=f.length)}else{if(w(e,2,j.length,"Base"),f=String(t),10==e)return Y(p=new z(t instanceof z?t:f),O+p.e+1,P);if(d="number"==typeof t){if(0*t!=0)return S(p,f,d,e);if(p.s=1/t<0?(f=f.slice(1),-1):1,z.DEBUG&&15<f.replace(/^0\.0*|\./,"").length)throw Error(l+t);d=!1}else p.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(o=j.slice(0,e),a=u=0,g=f.length;u<g;u++)if(o.indexOf(i=f.charAt(u))<0){if("."==i){if(a<u){a=g;continue}}else if(!s&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){s=!0,u=-1,a=0;continue}return S(p,String(t),d,e)}-1<(a=(f=C(f,e,10,p.s)).indexOf("."))?f=f.replace(".",""):a=f.length}for(u=0;48===f.charCodeAt(u);u++);for(g=f.length;48===f.charCodeAt(--g););if(f=f.slice(u,++g)){if(g-=u,d&&z.DEBUG&&15<g&&(c<t||t!==r(t)))throw Error(l+p.s*t);if(L<(a=a-u-1))p.c=p.e=null;else if(a<D)p.c=[p.e=0];else{if(p.e=a,p.c=[],u=(a+1)%h,a<0&&(u+=h),u<g){for(u&&p.c.push(+f.slice(0,u)),g-=h;u<g;)p.c.push(+f.slice(u,u+=h));f=f.slice(u),u=h-f.length}else u-=g;for(;u--;f+="0");p.c.push(+f)}}else p.c=[p.e=0]}function U(t,e,o,n){var i,r,s,l,a;if(null==o?o=P:w(o,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)a=p(t.c),a=1==n||2==n&&(s<=N||_<=s)?y(a,s):b(a,s,"0");else if(r=(t=Y(new z(t),e,o)).e,l=(a=p(t.c)).length,1==n||2==n&&(e<=r||r<=N)){for(;l<e;a+="0",l++);a=y(a,r)}else if(e-=s,a=b(a,r,"0"),l<r+1){if(0<--e)for(a+=".";e--;a+="0");}else if(0<(e+=r-l))for(r+1==l&&(a+=".");e--;a+="0");return t.s<0&&i?"-"+a:a}function $(t,e){for(var o,n=1,i=new z(t[0]);n<t.length;n++){if(!(o=new z(t[n])).s){i=o;break}e.call(i,o)&&(i=o)}return i}function G(t,e,o){for(var n=1,i=e.length;!e[--i];e.pop());for(i=e[0];10<=i;i/=10,n++);return(o=n+o*h-1)>L?t.c=t.e=null:t.c=o<D?[t.e=0]:(t.e=o,e),t}function Y(t,e,o,n){var s,l,c,d,g,f,p,m=t.c,w=u;if(m){t:{for(s=1,d=m[0];10<=d;d/=10,s++);if((l=e-s)<0)l+=h,c=e,p=(g=m[f=0])/w[s-c-1]%10|0;else if((f=i((l+1)/h))>=m.length){if(!n)break t;for(;m.length<=f;m.push(0));g=p=0,c=(l%=h)-h+(s=1)}else{for(g=d=m[f],s=1;10<=d;d/=10,s++);p=(c=(l%=h)-h+s)<0?0:g/w[s-c-1]%10|0}if(n=n||e<0||null!=m[f+1]||(c<0?g:g%w[s-c-1]),n=o<4?(p||n)&&(0==o||o==(t.s<0?3:2)):5<p||5==p&&(4==o||n||6==o&&(0<l?0<c?g/w[s-c]:0:m[f-1])%10&1||o==(t.s<0?8:7)),e<1||!m[0])return m.length=0,n?(e-=t.e+1,m[0]=w[(h-e%h)%h],t.e=-e||0):m[0]=t.e=0,t;if(0==l?(m.length=f,d=1,f--):(m.length=f+1,d=w[h-l],m[f]=0<c?r(g/w[s-c]%w[c])*d:0),n)for(;;){if(0==f){for(l=1,c=m[0];10<=c;c/=10,l++);for(c=m[0]+=d,d=1;10<=c;c/=10,d++);l!=d&&(t.e++,m[0]==a&&(m[0]=1));break}if(m[f]+=d,m[f]!=a)break;m[f--]=0,d=1}for(l=m.length;0===m[--l];m.pop());}t.e>L?t.c=t.e=null:t.e<D&&(t.c=[t.e=0])}return t}function K(t){var e,o=t.e;return null===o?t.toString():(e=p(t.c),e=o<=N||_<=o?y(e,o):b(e,o,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,o;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(w(o=t[e],0,g,e),O=o),t.hasOwnProperty(e="ROUNDING_MODE")&&(w(o=t[e],0,8,e),P=o),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((o=t[e])&&o.pop?(w(o[0],-g,0,e),w(o[1],0,g,e),N=o[0],_=o[1]):(w(o,-g,g,e),N=-(_=o<0?-o:o))),t.hasOwnProperty(e="RANGE"))if((o=t[e])&&o.pop)w(o[0],-g,-1,e),w(o[1],1,g,e),D=o[0],L=o[1];else{if(w(o,-g,g,e),!o)throw Error(s+e+" cannot be zero: "+o);D=-(L=o<0?-o:o)}if(t.hasOwnProperty(e="CRYPTO")){if((o=t[e])!==!!o)throw Error(s+e+" not true or false: "+o);if(o){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw V=!o,Error(s+"crypto unavailable");V=o}else V=o}if(t.hasOwnProperty(e="MODULO_MODE")&&(w(o=t[e],0,9,e),F=o),t.hasOwnProperty(e="POW_PRECISION")&&(w(o=t[e],0,g,e),W=o),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(o=t[e]))throw Error(s+e+" not an object: "+o);B=o}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(o=t[e])||/^.$|[+-.\s]|(.).*\1/.test(o))throw Error(s+e+" invalid: "+o);j=o}}return{DECIMAL_PLACES:O,ROUNDING_MODE:P,EXPONENTIAL_AT:[N,_],RANGE:[D,L],CRYPTO:V,MODULO_MODE:F,POW_PRECISION:W,FORMAT:B,ALPHABET:j}},z.isBigNumber=function(t){return t instanceof z||t&&!0===t._isBigNumber||!1},z.maximum=z.max=function(){return $(arguments,I.lt)},z.minimum=z.min=function(){return $(arguments,I.gt)},z.random=(R=9007199254740992,E=Math.random()*R&2097151?function(){return r(Math.random()*R)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,o,n,l,a,c=0,d=[],f=new z(A);if(null==t?t=O:w(t,0,g),l=i(t/h),V)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));c<l;)9e15<=(a=131072*e[c]+(e[c+1]>>>11))?(o=crypto.getRandomValues(new Uint32Array(2)),e[c]=o[0],e[c+1]=o[1]):(d.push(a%1e14),c+=2);c=l/2}else{if(!crypto.randomBytes)throw V=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(l*=7);c<l;)9e15<=(a=281474976710656*(31&e[c])+1099511627776*e[c+1]+4294967296*e[c+2]+16777216*e[c+3]+(e[c+4]<<16)+(e[c+5]<<8)+e[c+6])?crypto.randomBytes(7).copy(e,c):(d.push(a%1e14),c+=7);c=l/7}if(!V)for(;c<l;)(a=E())<9e15&&(d[c++]=a%1e14);for(l=d[--c],t%=h,l&&t&&(a=u[h-t],d[c]=r(l/a)*a);0===d[c];d.pop(),c--);if(c<0)d=[n=0];else{for(n=-1;0===d[0];d.splice(0,1),n-=h);for(c=1,a=d[0];10<=a;a/=10,c++);c<h&&(n-=h-c)}return f.e=n,f.c=d,f}),z.sum=function(){for(var t=1,e=arguments,o=new z(e[0]);t<e.length;)o=o.plus(e[t++]);return o},C=function(){var t="0123456789";function e(t,e,o,n){for(var i,r,s=[0],l=0,a=t.length;l<a;){for(r=s.length;r--;s[r]*=e);for(s[0]+=n.indexOf(t.charAt(l++)),i=0;i<s.length;i++)s[i]>o-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/o|0,s[i]%=o)}return s.reverse()}return function(n,i,r,s,l){var a,h,c,u,d,g,f,m,w=n.indexOf("."),v=O,y=P;for(0<=w&&(u=W,W=0,n=n.replace(".",""),g=(m=new z(i)).pow(n.length-w),W=u,m.c=e(b(p(g.c),g.e,"0"),10,r,t),m.e=m.c.length),c=u=(f=e(n,i,r,l?(a=j,t):(a=t,j))).length;0==f[--u];f.pop());if(!f[0])return a.charAt(0);if(w<0?--c:(g.c=f,g.e=c,g.s=s,f=(g=o(g,m,v,y,r)).c,d=g.r,c=g.e),w=f[h=c+v+1],u=r/2,d=d||h<0||null!=f[h+1],d=y<4?(null!=w||d)&&(0==y||y==(g.s<0?3:2)):u<w||w==u&&(4==y||d||6==y&&1&f[h-1]||y==(g.s<0?8:7)),h<1||!f[0])n=d?b(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(f.length=h,d)for(--r;++f[--h]>r;)f[h]=0,h||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(w=0,n="";w<=u;n+=a.charAt(f[w++]));n=b(n,c,a.charAt(0))}return n}}(),o=function(){function t(t,e,o){var n,i,r,s,l=0,a=t.length,h=e%d,c=e/d|0;for(t=t.slice();a--;)l=((i=h*(r=t[a]%d)+(n=c*r+(s=t[a]/d|0)*h)%d*d+l)/o|0)+(n/d|0)+c*s,t[a]=i%o;return l&&(t=[l].concat(t)),t}function e(t,e,o,n){var i,r;if(o!=n)r=n<o?1:-1;else for(i=r=0;i<o;i++)if(t[i]!=e[i]){r=t[i]>e[i]?1:-1;break}return r}function o(t,e,o,n){for(var i=0;o--;)t[o]-=i,i=t[o]<e[o]?1:0,t[o]=i*n+t[o]-e[o];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(n,i,s,l,c){var u,d,g,p,m,w,v,y,b,C,S,R,E,T,x,M,H,k=n.s==i.s?1:-1,I=n.c,A=i.c;if(!(I&&I[0]&&A&&A[0]))return new z(n.s&&i.s&&(I?!A||I[0]!=A[0]:A)?I&&0==I[0]||!A?0*k:k/0:NaN);for(b=(y=new z(k)).c=[],k=s+(d=n.e-i.e)+1,c||(c=a,d=f(n.e/h)-f(i.e/h),k=k/h|0),g=0;A[g]==(I[g]||0);g++);if(A[g]>(I[g]||0)&&d--,k<0)b.push(1),p=!0;else{for(T=I.length,M=A.length,k+=2,1<(m=r(c/(A[g=0]+1)))&&(A=t(A,m,c),I=t(I,m,c),M=A.length,T=I.length),E=M,S=(C=I.slice(0,M)).length;S<M;C[S++]=0);H=A.slice(),H=[0].concat(H),x=A[0],A[1]>=c/2&&x++;do{if(m=0,(u=e(A,C,M,S))<0){if(R=C[0],M!=S&&(R=R*c+(C[1]||0)),1<(m=r(R/x)))for(c<=m&&(m=c-1),v=(w=t(A,m,c)).length,S=C.length;1==e(w,C,v,S);)m--,o(w,M<v?H:A,v,c),v=w.length,u=1;else 0==m&&(u=m=1),v=(w=A.slice()).length;if(v<S&&(w=[0].concat(w)),o(C,w,S,c),S=C.length,-1==u)for(;e(A,C,M,S)<1;)m++,o(C,M<S?H:A,S,c),S=C.length}else 0===u&&(m++,C=[0]);b[g++]=m,C[0]?C[S++]=I[E]||0:(C=[I[E]],S=1)}while((E++<T||null!=C[0])&&k--);p=null!=C[0],b[0]||b.splice(0,1)}if(c==a){for(g=1,k=b[0];10<=k;k/=10,g++);Y(y,s+(y.e=g+d*h-1)+1,l,p)}else y.e=d,y.r=+p;return y}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,x=/^([^.]+)\.$/,M=/^\.([^.]+)$/,H=/^-?(Infinity|NaN)$/,k=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(t,e,o,n){var i,r=o?e:e.replace(k,"");if(H.test(r))t.s=isNaN(r)?null:r<0?-1:1,t.c=t.e=null;else{if(!o&&(r=r.replace(T,(function(t,e,o){return i="x"==(o=o.toLowerCase())?16:"b"==o?2:8,n&&n!=i?t:e})),n&&(i=n,r=r.replace(x,"$1").replace(M,"0.$1")),e!=r))return new z(r,i);if(z.DEBUG)throw Error(s+"Not a"+(n?" base "+n:"")+" number: "+e);t.c=t.e=t.s=null}},I.absoluteValue=I.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},I.comparedTo=function(t,e){return m(this,new z(t,e))},I.decimalPlaces=I.dp=function(t,e){var o,n,i;if(null!=t)return w(t,0,g),null==e?e=P:w(e,0,8),Y(new z(this),t+this.e+1,e);if(!(o=this.c))return null;if(n=((i=o.length-1)-f(this.e/h))*h,i=o[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},I.dividedBy=I.div=function(t,e){return o(this,new z(t,e),O,P)},I.dividedToIntegerBy=I.idiv=function(t,e){return o(this,new z(t,e),0,1)},I.exponentiatedBy=I.pow=function(t,e){var o,n,l,a,c,u,d,g,f=this;if((t=new z(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+K(t));if(null!=e&&(e=new z(e)),c=14<t.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!t.c||!t.c[0])return g=new z(Math.pow(+K(f),c?2-v(t):+K(t))),e?g.mod(e):g;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(n=!u&&f.isInteger()&&e.isInteger())&&(f=f.mod(e))}else{if(9<t.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||c&&24e7<=f.c[1]:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return a=f.s<0&&v(t)?-0:0,-1<f.e&&(a=1/a),new z(u?1/a:a);W&&(a=i(W/h+2))}for(d=c?(o=new z(.5),u&&(t.s=1),v(t)):(l=Math.abs(+K(t)))%2,g=new z(A);;){if(d){if(!(g=g.times(f)).c)break;a?g.c.length>a&&(g.c.length=a):n&&(g=g.mod(e))}if(l){if(0===(l=r(l/2)))break;d=l%2}else if(Y(t=t.times(o),t.e+1,1),14<t.e)d=v(t);else{if(0==(l=+K(t)))break;d=l%2}f=f.times(f),a?f.c&&f.c.length>a&&(f.c.length=a):n&&(f=f.mod(e))}return n?g:(u&&(g=A.div(g)),e?g.mod(e):a?Y(g,W,P,void 0):g)},I.integerValue=function(t){var e=new z(this);return null==t?t=P:w(t,0,8),Y(e,e.e+1,t)},I.isEqualTo=I.eq=function(t,e){return 0===m(this,new z(t,e))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(t,e){return 0<m(this,new z(t,e))},I.isGreaterThanOrEqualTo=I.gte=function(t,e){return 1===(e=m(this,new z(t,e)))||0===e},I.isInteger=function(){return!!this.c&&f(this.e/h)>this.c.length-2},I.isLessThan=I.lt=function(t,e){return m(this,new z(t,e))<0},I.isLessThanOrEqualTo=I.lte=function(t,e){return-1===(e=m(this,new z(t,e)))||0===e},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return 0<this.s},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(t,e){var o,n,i,r,s=this,l=s.s;if(e=(t=new z(t,e)).s,!l||!e)return new z(NaN);if(l!=e)return t.s=-e,s.plus(t);var c=s.e/h,u=t.e/h,d=s.c,g=t.c;if(!c||!u){if(!d||!g)return d?(t.s=-e,t):new z(g?s:NaN);if(!d[0]||!g[0])return g[0]?(t.s=-e,t):new z(d[0]?s:3==P?-0:0)}if(c=f(c),u=f(u),d=d.slice(),l=c-u){for((i=(r=l<0)?(l=-l,d):(u=c,g)).reverse(),e=l;e--;i.push(0));i.reverse()}else for(n=(r=(l=d.length)<(e=g.length))?l:e,l=e=0;e<n;e++)if(d[e]!=g[e]){r=d[e]<g[e];break}if(r&&(i=d,d=g,g=i,t.s=-t.s),0<(e=(n=g.length)-(o=d.length)))for(;e--;d[o++]=0);for(e=a-1;l<n;){if(d[--n]<g[n]){for(o=n;o&&!d[--o];d[o]=e);--d[o],d[n]+=a}d[n]-=g[n]}for(;0==d[0];d.splice(0,1),--u);return d[0]?G(t,d,u):(t.s=3==P?-1:1,t.c=[t.e=0],t)},I.modulo=I.mod=function(t,e){var n,i,r=this;return t=new z(t,e),!r.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||r.c&&!r.c[0]?new z(r):(9==F?(i=t.s,t.s=1,n=o(r,t,0,3),t.s=i,n.s*=i):n=o(r,t,0,F),(t=r.minus(n.times(t))).c[0]||1!=F||(t.s=r.s),t)},I.multipliedBy=I.times=function(t,e){var o,n,i,r,s,l,c,u,g,p,m,w,v,y,b,C=this,S=C.c,R=(t=new z(t,e)).c;if(!(S&&R&&S[0]&&R[0]))return!C.s||!t.s||S&&!S[0]&&!R||R&&!R[0]&&!S?t.c=t.e=t.s=null:(t.s*=C.s,S&&R?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=f(C.e/h)+f(t.e/h),t.s*=C.s,(c=S.length)<(p=R.length)&&(v=S,S=R,R=v,i=c,c=p,p=i),i=c+p,v=[];i--;v.push(0));for(y=a,b=d,i=p;0<=--i;){for(o=0,m=R[i]%b,w=R[i]/b|0,r=i+(s=c);i<r;)o=((u=m*(u=S[--s]%b)+(l=w*u+(g=S[s]/b|0)*m)%b*b+v[r]+o)/y|0)+(l/b|0)+w*g,v[r--]=u%y;v[r]=o}return o?++n:v.splice(0,1),G(t,v,n)},I.negated=function(){var t=new z(this);return t.s=-t.s||null,t},I.plus=function(t,e){var o,n=this,i=n.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,n.minus(t);var r=n.e/h,s=t.e/h,l=n.c,c=t.c;if(!r||!s){if(!l||!c)return new z(i/0);if(!l[0]||!c[0])return c[0]?t:new z(l[0]?n:0*i)}if(r=f(r),s=f(s),l=l.slice(),i=r-s){for((o=0<i?(s=r,c):(i=-i,l)).reverse();i--;o.push(0));o.reverse()}for((i=l.length)-(e=c.length)<0&&(o=c,c=l,l=o,e=i),i=0;e;)i=(l[--e]=l[e]+c[e]+i)/a|0,l[e]=a===l[e]?0:l[e]%a;return i&&(l=[i].concat(l),++s),G(t,l,s)},I.precision=I.sd=function(t,e){var o,n,i;if(null!=t&&t!==!!t)return w(t,1,g),null==e?e=P:w(e,0,8),Y(new z(this),t,e);if(!(o=this.c))return null;if(n=(i=o.length-1)*h+1,i=o[i]){for(;i%10==0;i/=10,n--);for(i=o[0];10<=i;i/=10,n++);}return t&&this.e+1>n&&(n=this.e+1),n},I.shiftedBy=function(t){return w(t,-c,c),this.times("1e"+t)},I.squareRoot=I.sqrt=function(){var t,e,n,i,r,s=this,l=s.c,a=s.s,h=s.e,c=O+4,u=new z("0.5");if(1!==a||!l||!l[0])return new z(!a||a<0&&(!l||l[0])?NaN:l?s:1/0);if((n=0==(a=Math.sqrt(+K(s)))||a==1/0?(((e=p(l)).length+h)%2==0&&(e+="0"),a=Math.sqrt(+e),h=f((h+1)/2)-(h<0||h%2),new z(e=a==1/0?"1e"+h:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+h)):new z(a+"")).c[0])for((a=(h=n.e)+c)<3&&(a=0);;)if(r=n,n=u.times(r.plus(o(s,r,c,1))),p(r.c).slice(0,a)===(e=p(n.c)).slice(0,a)){if(n.e<h&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Y(n,n.e+O+2,1),t=!n.times(n).eq(s));break}if(!i&&(Y(r,r.e+O+2,0),r.times(r).eq(s))){n=r;break}c+=4,a+=4,i=1}return Y(n,n.e+O+1,P,t)},I.toExponential=function(t,e){return null!=t&&(w(t,0,g),t++),U(this,t,e,1)},I.toFixed=function(t,e){return null!=t&&(w(t,0,g),t=t+this.e+1),U(this,t,e)},I.toFormat=function(t,e,o){var n;if(null==o)null!=t&&e&&"object"==typeof e?(o=e,e=null):t&&"object"==typeof t?(o=t,t=e=null):o=B;else if("object"!=typeof o)throw Error(s+"Argument not an object: "+o);if(n=this.toFixed(t,e),this.c){var i,r=n.split("."),l=+o.groupSize,a=+o.secondaryGroupSize,h=o.groupSeparator||"",c=r[0],u=r[1],d=this.s<0,g=d?c.slice(1):c,f=g.length;if(a&&(i=l,l=a,f-=a=i),0<l&&0<f){for(i=f%l||l,c=g.substr(0,i);i<f;i+=l)c+=h+g.substr(i,l);0<a&&(c+=h+g.slice(i)),d&&(c="-"+c)}n=u?c+(o.decimalSeparator||"")+((a=+o.fractionGroupSize)?u.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(o.fractionGroupSeparator||"")):u):c}return(o.prefix||"")+n+(o.suffix||"")},I.toFraction=function(t){var e,n,i,r,l,a,c,d,g,f,m,w,v=this,y=v.c;if(null!=t&&(!(c=new z(t)).isInteger()&&(c.c||1!==c.s)||c.lt(A)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+K(c));if(!y)return new z(v);for(e=new z(A),g=n=new z(A),i=d=new z(A),w=p(y),l=e.e=w.length-v.e-1,e.c[0]=u[(a=l%h)<0?h+a:a],t=!t||0<c.comparedTo(e)?0<l?e:g:c,a=L,L=1/0,c=new z(w),d.c[0]=0;f=o(c,e,0,1),1!=(r=n.plus(f.times(i))).comparedTo(t);)n=i,i=r,g=d.plus(f.times(r=g)),d=r,e=c.minus(f.times(r=e)),c=r;return r=o(t.minus(n),i,0,1),d=d.plus(r.times(g)),n=n.plus(r.times(i)),d.s=g.s=v.s,m=o(g,i,l*=2,P).minus(v).abs().comparedTo(o(d,n,l,P).minus(v).abs())<1?[g,i]:[d,n],L=a,m},I.toNumber=function(){return+K(this)},I.toPrecision=function(t,e){return null!=t&&w(t,1,g),U(this,t,e,2)},I.toString=function(t){var e,o=this,n=o.s,i=o.e;return null===i?n?(e="Infinity",n<0&&(e="-"+e)):e="NaN":(e=null==t?i<=N||_<=i?y(p(o.c),i):b(p(o.c),i,"0"):10===t?b(p((o=Y(new z(o),O+i+1,P)).c),o.e,"0"):(w(t,2,j.length,"Base"),C(b(p(o.c),i,"0"),10,t,n,!0)),n<0&&o.c[0]&&(e="-"+e)),e},I.valueOf=I.toJSON=function(){return K(this)},I._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(I[Symbol.toStringTag]="BigNumber",I[Symbol.for("nodejs.util.inspect.custom")]=I.valueOf),null!=e&&z.set(e),z}()).default=o.BigNumber=o,void 0!==e&&e.exports?e.exports=o:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=o)}(this)},{}],2:[function(t,e,o){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,o){"use strict";function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=[],n=!0,i=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(n=(s=l.next()).done)&&(o.push(s.value),!e||o.length!==e);n=!0);}catch(t){i=!0,r=t}finally{try{n||null==l.return||l.return()}finally{if(i)throw r}}return o}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),r=t("./validating"),s=t("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function c(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!r.validateFormat(e))return"ERROR: invalid format";var n=e.prefix||"",l=e.postfix||"",c=function(t,e,o){switch(e.output){case"currency":return function(t,e,o){var n=o.currentCurrency(),i=Object.assign({},h,e),r=void 0,s="",l=!!i.totalLength||!!i.forceAverage||i.average,a=e.currencyPosition||n.position,c=e.currencySymbol||n.symbol;i.spaceSeparated&&(s=" "),"infix"===a&&(r=s+c+s);var u=f({instance:t,providedFormat:e,state:o,decimalSeparator:r});return"prefix"===a&&(u=t._value<0&&"sign"===i.negative?"-".concat(s).concat(c).concat(u.slice(1)):c+s+u),a&&"postfix"!==a||(u=u+(s=l?"":s)+c),u}(t,e=p(e,i.currentCurrencyDefaultFormat()),i);case"percent":return function(t,e,o,n){var i=e.prefixSymbol,r=f({instance:n(100*t._value),providedFormat:e,state:o}),s=Object.assign({},h,e);return i?"%".concat(s.spaceSeparated?" ":"").concat(r):"".concat(r).concat(s.spaceSeparated?" ":"","%")}(t,e=p(e,i.currentPercentageDefaultFormat()),i,o);case"byte":return e=p(e,i.currentByteDefaultFormat()),b=t,S=i,R=o,E=(C=e).base||"binary",T=a[E],M=(x=u(b._value,T.suffixes,T.scale)).value,H=x.suffix,k=f({instance:R(M),providedFormat:C,state:S,defaults:S.currentByteDefaultFormat()}),I=S.currentAbbreviations(),"".concat(k).concat(I.spaced?" ":"").concat(H);case"time":return e=p(e,i.currentTimeDefaultFormat()),m=t,w=Math.floor(m._value/60/60),v=Math.floor((m._value-60*w*60)/60),y=Math.round(m._value-60*w*60-60*v),"".concat(w,":").concat(v<10?"0":"").concat(v,":").concat(y<10?"0":"").concat(y);case"ordinal":return n=t,r=e=p(e,i.currentOrdinalDefaultFormat()),l=(s=i).currentOrdinal(),c=Object.assign({},h,r),d=f({instance:n,providedFormat:r,state:s}),g=l(n._value),"".concat(d).concat(c.spaceSeparated?" ":"").concat(g);default:return f({instance:t,providedFormat:e,numbro:o})}var n,r,s,l,c,d,g,m,w,v,y,b,C,S,R,E,T,x,M,H,k,I}(t,e,o);return(c=n+c)+l}function u(t,e,o){var n=e[0],i=Math.abs(t);if(o<=i){for(var r=1;r<e.length;++r){var s=Math.pow(o,r),l=Math.pow(o,r+1);if(s<=i&&i<l){n=e[r],t/=s;break}}n===e[0]&&(t/=Math.pow(o,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function d(t){for(var e="",o=0;o<t;o++)e+="0";return e}function g(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var o=t.toString(),i=n(o.split("e"),2),r=i[0],s=i[1],l=n(r.split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(0<+s)o=a+c+d(s-c.length);else{var u=".";u=+a<0?"-0".concat(u):"0".concat(u);var g=(d(-s-1)+Math.abs(a)+c).substr(0,e);g.length<e&&(g+=d(e-g.length)),o=u+g}return 0<+s&&0<e&&(o+=".".concat(d(e))),o}(t,e):(Math.round(+"".concat(t,"e+").concat(e))/Math.pow(10,e)).toFixed(e)}function f(t){var e=t.instance,o=t.providedFormat,r=t.state,s=void 0===r?i:r,l=t.decimalSeparator,a=t.defaults,c=void 0===a?s.currentDefaults():a,u=e._value;if(0===u&&s.hasZeroFormat())return s.getZeroFormat();if(!isFinite(u))return u.toString();var d,f,p,m,w,v,y,b,C=Object.assign({},h,c,o),S=C.totalLength,R=S?0:C.characteristic,E=C.optionalCharacteristic,T=C.forceAverage,x=!!S||!!T||C.average,M=S?-1:x&&void 0===o.mantissa?0:C.mantissa,H=!S&&(void 0===o.optionalMantissa?-1===M:C.optionalMantissa),k=C.trimMantissa,I=C.thousandSeparated,A=C.spaceSeparated,O=C.negative,P=C.forceSign,N=C.exponential,_="";if(x){var D=function(t){var e=t.value,o=t.forceAverage,n=t.abbreviations,i=t.spaceSeparated,r=void 0!==i&&i,s=t.totalLength,l=void 0===s?0:s,a="",h=Math.abs(e),c=-1;if(h>=Math.pow(10,12)&&!o||"trillion"===o?(a=n.trillion,e/=Math.pow(10,12)):h<Math.pow(10,12)&&h>=Math.pow(10,9)&&!o||"billion"===o?(a=n.billion,e/=Math.pow(10,9)):h<Math.pow(10,9)&&h>=Math.pow(10,6)&&!o||"million"===o?(a=n.million,e/=Math.pow(10,6)):(h<Math.pow(10,6)&&h>=Math.pow(10,3)&&!o||"thousand"===o)&&(a=n.thousand,e/=Math.pow(10,3)),a&&(a=(r?" ":"")+a),l){var u=e.toString().split(".")[0];c=Math.max(l-u.length,0)}return{value:e,abbreviation:a,mantissaPrecision:c}}({value:u,forceAverage:T,abbreviations:s.currentAbbreviations(),spaceSeparated:A,totalLength:S});u=D.value,_+=D.abbreviation,S&&(M=D.mantissaPrecision)}if(N){var L=(f=(d={value:u,characteristicPrecision:R}).value,m=void 0===(p=d.characteristicPrecision)?0:p,v=(w=n(f.toExponential().split("e"),2))[0],y=w[1],b=+v,m&&1<m&&(b*=Math.pow(10,m-1),y=0<=(y=+y-(m-1))?"+".concat(y):y),{value:b,abbreviation:"e".concat(y)});u=L.value,_=L.abbreviation+_}var V,F,W,B=function(t,e,o,i,r){if(-1===i)return t;var s=g(e,i),l=n(s.toString().split("."),2),a=l[0],h=l[1],c=void 0===h?"":h;if(c.match(/^0+$/)&&(o||r))return a;var u=c.match(/0+$/);return r&&u?"".concat(a,".").concat(c.toString().slice(0,u.index)):s.toString()}(u.toString(),u,H,M,k);return B=function(t,e,o,n,i){var r=n.currentDelimiters(),s=r.thousands;i=i||r.decimal;var l=r.thousandsSize||3,a=t.toString(),h=a.split(".")[0],c=a.split(".")[1];return o&&(e<0&&(h=h.slice(1)),function(t,e){for(var o=[],n=0,i=t;0<i;i--)n===e&&(o.unshift(i),n=0),n++;return o}(h.length,l).forEach((function(t,e){h=h.slice(0,t+e)+s+h.slice(t+e)})),e<0&&(h="-".concat(h))),c?h+i+c:h}(B=function(t,e,o,i){var r=t,s=n(r.toString().split("."),2),l=s[0],a=s[1];if(l.match(/^-?0$/)&&o)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<i)for(var h=i-l.length,c=0;c<h;c++)r="0".concat(r);return r.toString()}(B,0,E,R),u,I,s,l),(x||N)&&(B+=_),(P||u<0)&&(V=B,W=O,B=0===(F=u)?V:0==+V?V.replace("-",""):0<F?"+".concat(V):"sign"===W?V:"(".concat(V.replace("-",""),")")),B}function p(t,e){if(!t)return e;var o=Object.keys(t);return 1===o.length&&"output"===o[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return c.apply(void 0,o.concat([t]))},getByteUnit:function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return function(t){var e=a.general;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,o.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return function(t){var e=a.binary;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,o.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return function(t){var e=a.decimal;return u(t._value,e.suffixes,e.scale).suffix}.apply(void 0,o.concat([t]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,o){"use strict";var n=t("./en-US"),i=t("./validating"),r=t("./parsing"),s={},l=void 0,a={},h=null,c={};function u(t){l=t}function d(){return a[l]}s.languages=function(){return Object.assign({},a)},s.currentLanguage=function(){return l},s.currentCurrency=function(){return d().currency},s.currentAbbreviations=function(){return d().abbreviations},s.currentDelimiters=function(){return d().delimiters},s.currentOrdinal=function(){return d().ordinal},s.currentDefaults=function(){return Object.assign({},d().defaults,c)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),d().timeFormat)},s.setDefaults=function(t){t=r.parseFormat(t),i.validateFormat(t)&&(c=t)},s.getZeroFormat=function(){return h},s.setZeroFormat=function(t){return h="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==h},s.languageData=function(t){if(t){if(a[t])return a[t];throw new Error('Unknown tag "'.concat(t,'"'))}return d()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(t))throw new Error("Invalid language data");a[t.languageTag]=t,e&&u(t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.languageTag;if(!a[t]){var o=t.split("-")[0],i=Object.keys(a).find((function(t){return t.split("-")[0]===o}));return a[i]?void u(i):void u(e)}u(t)},s.registerLanguage(n),l=n.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,o){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(o){return n=e,void o.forEach((function(e){var o=void 0;try{o=t("../languages/".concat(e))}catch(o){console.error('Unable to load "'.concat(e,'". No matching language file found.'))}o&&n.registerLanguage(o)}));var n}}}},{}],6:[function(t,e,o){"use strict";var n=t("bignumber.js");function i(t,e,o){var i=new n(t._value),r=e;return o.isNumbro(e)&&(r=e._value),r=new n(r),t._value=i.minus(r).toNumber(),t}e.exports=function(t){return{add:function(e,o){return r=o,s=t,l=new n((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new n(a),i._value=l.plus(a).toNumber(),i;var i,r,s,l,a},subtract:function(e,o){return i(e,o,t)},multiply:function(e,o){return r=o,s=t,l=new n((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new n(a),i._value=l.times(a).toNumber(),i;var i,r,s,l,a},divide:function(e,o){return r=o,s=t,l=new n((i=e)._value),a=r,s.isNumbro(r)&&(a=r._value),a=new n(a),i._value=l.dividedBy(a).toNumber(),i;var i,r,s,l,a},set:function(e,o){return n=e,r=i=o,t.isNumbro(i)&&(r=i._value),n._value=r,n;var n,i,r},difference:function(e,o){return n=o,i(s=(r=t)(e._value),n,r),Math.abs(s._value);var n,r,s}}}},{"bignumber.js":1}],7:[function(t,e,o){"use strict";function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var i=t("./globalState"),r=t("./validating"),s=t("./loading")(g),l=t("./unformatting"),a=t("./formatting")(g),h=t("./manipulating")(g),c=t("./parsing"),u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e}var e,o;return e=t,(o=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=c.parseFormat(t)),(t=a.formatOrDefault(t,i.currentCurrencyDefaultFormat())).output="currency",a.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",a.format(this,t)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&n(e.prototype,o),t}();function d(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new u(d(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof u},g.language=i.currentLanguage,g.registerLanguage=i.registerLanguage,g.setLanguage=i.setLanguage,g.languages=i.languages,g.languageData=i.languageData,g.zeroFormat=i.setZeroFormat,g.defaultFormat=i.currentDefaults,g.setDefaults=i.setDefaults,g.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,g.validate=r.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=l.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,o){"use strict";e.exports={parseFormat:function(t){var e,o,n,i,r,s,l,a,h,c,u,d,g,f,p,m,w,v,y,b,C=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(o=C,r=C,function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(s=(i=t=(n=(e=t).match(/^{([^}]*)}/))?(o.prefix=n[1],e.slice(n[0].length)):e).match(/{([^}]*)}$/))?(r.postfix=s[1],i.slice(0,-s[0].length)):i,C),l=C,(a=t.match(/[1-9]+[0-9]*/))&&(l.totalLength=+a[0]),h=C,(c=t.split(".")[0].match(/0+/))&&(h.characteristic=c[0].length),function(t,e){if(-1!==t.indexOf(".")){var o=t.split(".")[0];e.optionalCharacteristic=-1===o.indexOf("0")}}(t,C),u=C,-1!==t.indexOf("a")&&(u.average=!0),g=C,-1!==(d=t).indexOf("K")?g.forceAverage="thousand":-1!==d.indexOf("M")?g.forceAverage="million":-1!==d.indexOf("B")?g.forceAverage="billion":-1!==d.indexOf("T")&&(g.forceAverage="trillion"),function(t,e){var o=t.split(".")[1];if(o){var n=o.match(/0+/);n&&(e.mantissa=n[0].length)}}(t,C),p=C,(f=t).match(/\[\.]/)?p.optionalMantissa=!0:f.match(/\./)&&(p.optionalMantissa=!1),m=C,-1!==t.indexOf(",")&&(m.thousandSeparated=!0),w=C,-1!==t.indexOf(" ")&&(w.spaceSeparated=!0),y=C,(v=t).match(/^\+?\([^)]*\)$/)&&(y.negative="parenthesis"),v.match(/^\+?-/)&&(y.negative="sign"),b=C,t.match(/^\+/)&&(b.forceSign=!0),C)}}},{}],9:[function(t,e,o){"use strict";var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,o){var r,s,l,a=t("./globalState"),h=a.currentDelimiters(),c=a.currentCurrency().symbol,u=a.currentOrdinal(),d=a.getZeroFormat(),g=a.currentAbbreviations(),f=void 0;if("string"==typeof e)f=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var o=t.split(":");if(3!==o.length)return!1;var n=+o[0],i=+o[1],r=+o[2];return!isNaN(n)&&!isNaN(i)&&!isNaN(r)}(e,h)?(s=+(r=e.split(":"))[0],l=+r[1],+r[2]+60*l+3600*s):function(t,e){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,o){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var c="",u=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==e)return-1*t(u,o,r,s,l,a,h);for(var d=0;d<n.length;d++){var g=n[d];if((c=e.replace(g.key,""))!==e)return t(c,o,r,s,l,a,h)*g.factor}if((c=e.replace("%",""))!==e)return t(c,o,r,s,l,a,h)/100;var f=parseFloat(e);if(!isNaN(f)){var p=s(f);if(p&&"."!==p&&(c=e.replace(new RegExp("".concat(i(p),"$")),""))!==e)return t(c,o,r,s,l,a,h);var m={};Object.keys(a).forEach((function(t){m[a[t]]=t}));for(var w=Object.keys(m).sort().reverse(),v=w.length,y=0;y<v;y++){var b=w[y],C=m[b];if((c=e.replace(b,""))!==e){var S=void 0;switch(C){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return t(c,o,r,s,l,a,h)*S}}}}(function(t,e){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=t.replace(o,"");return(n=n.replace(new RegExp("([0-9])".concat(i(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,o),e,o,r,s,l,a)}(e,h,c,u,d,g,o);else{if("number"!=typeof e)return;f=e}if(void 0!==f)return f}}},{"./globalState":4}],10:[function(t,e,o){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=t("./unformatting"),r=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(r)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function a(t){return!!i.unformat(t)}function h(t,e,o){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3],r=Object.keys(t).map((function(i){if(!e[i])return console.error("".concat(o," Invalid key: ").concat(i)),!1;var r=t[i],l=e[i];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!h(r,s,"[Validate ".concat(i,"]"),!0))return!1}else if(n(r)!==l.type)return console.error("".concat(o," ").concat(i,' type mismatched: "').concat(l.type,'" expected, "').concat(n(r),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var a=l.restrictions.length,c=0;c<a;c++){var u=l.restrictions[c],d=u.restriction,g=u.message;if(!d(r,t))return console.error("".concat(o," ").concat(i," invalid value: ").concat(g)),!1}return l.restriction&&!l.restriction(r,t)?(console.error("".concat(o," ").concat(i," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(r)?(console.error("".concat(o," ").concat(i," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(r,'" provided')),!1):!(l.children&&!h(r,l.children,"[Validate ".concat(i,"]")))}));return i||r.push.apply(r,function(t){return function(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(Object.keys(e).map((function(n){var i=e[n];if("string"==typeof i&&(i={type:i}),i.mandatory){var r=i.mandatory;if("function"==typeof r&&(r=r(t)),r&&void 0===t[n])return console.error("".concat(o,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),r.reduce((function(t,e){return t&&e}),!0)}function c(t){return h(t,s,"[Validate format]")}e.exports={validate:function(t,e){var o=a(t),n=c(e);return o&&n},validateFormat:c,validateInput:a,validateLanguage:function(t){return h(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},9306:(t,e,o)=>{"use strict";var n=o(4901),i=o(6823),r=TypeError;t.exports=function(t){if(n(t))return t;throw new r(i(t)+" is not a function")}},3506:(t,e,o)=>{"use strict";var n=o(3925),i=String,r=TypeError;t.exports=function(t){if(n(t))return t;throw new r("Can't set "+i(t)+" as a prototype")}},6469:(t,e,o)=>{"use strict";var n=o(8227),i=o(2360),r=o(4913).f,s=n("unscopables"),l=Array.prototype;void 0===l[s]&&r(l,s,{configurable:!0,value:i(null)}),t.exports=function(t){l[s][t]=!0}},8551:(t,e,o)=>{"use strict";var n=o(34),i=String,r=TypeError;t.exports=function(t){if(n(t))return t;throw new r(i(t)+" is not an object")}},9617:(t,e,o)=>{"use strict";var n=o(5397),i=o(5610),r=o(6198),s=function(t){return function(e,o,s){var l=n(e),a=r(l);if(0===a)return!t&&-1;var h,c=i(s,a);if(t&&o!=o){for(;a>c;)if((h=l[c++])!=h)return!0}else for(;a>c;c++)if((t||c in l)&&l[c]===o)return t||c||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},4527:(t,e,o)=>{"use strict";var n=o(3724),i=o(4376),r=TypeError,s=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(i(t)&&!s(t,"length").writable)throw new r("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},7680:(t,e,o)=>{"use strict";var n=o(9504);t.exports=n([].slice)},4576:(t,e,o)=>{"use strict";var n=o(9504),i=n({}.toString),r=n("".slice);t.exports=function(t){return r(i(t),8,-1)}},6955:(t,e,o)=>{"use strict";var n=o(2140),i=o(4901),r=o(4576),s=o(8227)("toStringTag"),l=Object,a="Arguments"===r(function(){return arguments}());t.exports=n?r:function(t){var e,o,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=function(t,e){try{return t[e]}catch(t){}}(e=l(t),s))?o:a?r(e):"Object"===(n=r(e))&&i(e.callee)?"Arguments":n}},7740:(t,e,o)=>{"use strict";var n=o(9297),i=o(5031),r=o(7347),s=o(4913);t.exports=function(t,e,o){for(var l=i(e),a=s.f,h=r.f,c=0;c<l.length;c++){var u=l[c];n(t,u)||o&&n(o,u)||a(t,u,h(e,u))}}},6699:(t,e,o)=>{"use strict";var n=o(3724),i=o(4913),r=o(6980);t.exports=n?function(t,e,o){return i.f(t,e,r(1,o))}:function(t,e,o){return t[e]=o,t}},6980:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2278:(t,e,o)=>{"use strict";var n=o(3724),i=o(4913),r=o(6980);t.exports=function(t,e,o){n?i.f(t,e,r(0,o)):t[e]=o}},6840:(t,e,o)=>{"use strict";var n=o(4901),i=o(4913),r=o(283),s=o(9433);t.exports=function(t,e,o,l){l||(l={});var a=l.enumerable,h=void 0!==l.name?l.name:e;if(n(o)&&r(o,h,l),l.global)a?t[e]=o:s(e,o);else{try{l.unsafe?t[e]&&(a=!0):delete t[e]}catch(t){}a?t[e]=o:i.f(t,e,{value:o,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t}},9433:(t,e,o)=>{"use strict";var n=o(4475),i=Object.defineProperty;t.exports=function(t,e){try{i(n,t,{value:e,configurable:!0,writable:!0})}catch(o){n[t]=e}return e}},4606:(t,e,o)=>{"use strict";var n=o(6823),i=TypeError;t.exports=function(t,e){if(!delete t[e])throw new i("Cannot delete property "+n(e)+" of "+n(t))}},3724:(t,e,o)=>{"use strict";var n=o(9039);t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:(t,e,o)=>{"use strict";var n=o(4475),i=o(34),r=n.document,s=i(r)&&i(r.createElement);t.exports=function(t){return s?r.createElement(t):{}}},6837:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},6763:t=>{"use strict";t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},8119:(t,e,o)=>{"use strict";var n=o(9392);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},9088:(t,e,o)=>{"use strict";var n=o(4475),i=o(4576);t.exports="process"===i(n.process)},9392:t=>{"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7388:(t,e,o)=>{"use strict";var n,i,r=o(4475),s=o(9392),l=r.process,a=r.Deno,h=l&&l.versions||a&&a.version,c=h&&h.v8;c&&(i=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&s&&(!(n=s.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/))&&(i=+n[1]),t.exports=i},8727:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6193:(t,e,o)=>{"use strict";var n=o(9504),i=Error,r=n("".replace),s=String(new i("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!i.prepareStackTrace)for(;e--;)t=r(t,l,"");return t}},747:(t,e,o)=>{"use strict";var n=o(6699),i=o(6193),r=o(4659),s=Error.captureStackTrace;t.exports=function(t,e,o,l){r&&(s?s(t,e):n(t,"stack",i(o,l)))}},4659:(t,e,o)=>{"use strict";var n=o(9039),i=o(6980);t.exports=!n((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)}))},6518:(t,e,o)=>{"use strict";var n=o(4475),i=o(7347).f,r=o(6699),s=o(6840),l=o(9433),a=o(7740),h=o(2796);t.exports=function(t,e){var o,c,u,d,g,f=t.target,p=t.global,m=t.stat;if(o=p?n:m?n[f]||l(f,{}):n[f]&&n[f].prototype)for(c in e){if(d=e[c],u=t.dontCallGetSet?(g=i(o,c))&&g.value:o[c],!h(p?c:f+(m?".":"#")+c,t.forced)&&void 0!==u){if(typeof d==typeof u)continue;a(d,u)}(t.sham||u&&u.sham)&&r(d,"sham",!0),s(o,c,d,t)}}},9039:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},8745:(t,e,o)=>{"use strict";var n=o(616),i=Function.prototype,r=i.apply,s=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?s.bind(r):function(){return s.apply(r,arguments)})},6080:(t,e,o)=>{"use strict";var n=o(7476),i=o(9306),r=o(616),s=n(n.bind);t.exports=function(t,e){return i(t),void 0===e?t:r?s(t,e):function(){return t.apply(e,arguments)}}},616:(t,e,o)=>{"use strict";var n=o(9039);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},9565:(t,e,o)=>{"use strict";var n=o(616),i=Function.prototype.call;t.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},350:(t,e,o)=>{"use strict";var n=o(3724),i=o(9297),r=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,l=i(r,"name"),a=l&&"something"===function(){}.name,h=l&&(!n||n&&s(r,"name").configurable);t.exports={EXISTS:l,PROPER:a,CONFIGURABLE:h}},6706:(t,e,o)=>{"use strict";var n=o(9504),i=o(9306);t.exports=function(t,e,o){try{return n(i(Object.getOwnPropertyDescriptor(t,e)[o]))}catch(t){}}},7476:(t,e,o)=>{"use strict";var n=o(4576),i=o(9504);t.exports=function(t){if("Function"===n(t))return i(t)}},9504:(t,e,o)=>{"use strict";var n=o(616),i=Function.prototype,r=i.call,s=n&&i.bind.bind(r,r);t.exports=n?s:function(t){return function(){return r.apply(t,arguments)}}},7751:(t,e,o)=>{"use strict";var n=o(4475),i=o(4901);t.exports=function(t,e){return arguments.length<2?(o=n[t],i(o)?o:void 0):n[t]&&n[t][e];var o}},851:(t,e,o)=>{"use strict";var n=o(6955),i=o(5966),r=o(4117),s=o(6269),l=o(8227)("iterator");t.exports=function(t){if(!r(t))return i(t,l)||i(t,"@@iterator")||s[n(t)]}},81:(t,e,o)=>{"use strict";var n=o(9565),i=o(9306),r=o(8551),s=o(6823),l=o(851),a=TypeError;t.exports=function(t,e){var o=arguments.length<2?l(t):e;if(i(o))return r(n(o,t));throw new a(s(t)+" is not iterable")}},6933:(t,e,o)=>{"use strict";var n=o(9504),i=o(4376),r=o(4901),s=o(4576),l=o(655),a=n([].push);t.exports=function(t){if(r(t))return t;if(i(t)){for(var e=t.length,o=[],n=0;n<e;n++){var h=t[n];"string"==typeof h?a(o,h):"number"!=typeof h&&"Number"!==s(h)&&"String"!==s(h)||a(o,l(h))}var c=o.length,u=!0;return function(t,e){if(u)return u=!1,e;if(i(this))return e;for(var n=0;n<c;n++)if(o[n]===t)return e}}}},5966:(t,e,o)=>{"use strict";var n=o(9306),i=o(4117);t.exports=function(t,e){var o=t[e];return i(o)?void 0:n(o)}},2478:(t,e,o)=>{"use strict";var n=o(9504),i=o(8981),r=Math.floor,s=n("".charAt),l=n("".replace),a=n("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,o,n,u,d){var g=o+t.length,f=n.length,p=c;return void 0!==u&&(u=i(u),p=h),l(d,p,(function(i,l){var h;switch(s(l,0)){case"$":return"$";case"&":return t;case"`":return a(e,0,o);case"'":return a(e,g);case"<":h=u[a(l,1,-1)];break;default:var c=+l;if(0===c)return i;if(c>f){var d=r(c/10);return 0===d?i:d<=f?void 0===n[d-1]?s(l,1):n[d-1]+s(l,1):i}h=n[c-1]}return void 0===h?"":h}))}},4475:function(t,e,o){"use strict";var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof o.g&&o.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(t,e,o)=>{"use strict";var n=o(9504),i=o(8981),r=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(i(t),e)}},421:t=>{"use strict";t.exports={}},397:(t,e,o)=>{"use strict";var n=o(7751);t.exports=n("document","documentElement")},5917:(t,e,o)=>{"use strict";var n=o(3724),i=o(9039),r=o(4055);t.exports=!n&&!i((function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},7055:(t,e,o)=>{"use strict";var n=o(9504),i=o(9039),r=o(4576),s=Object,l=n("".split);t.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===r(t)?l(t,""):s(t)}:s},3167:(t,e,o)=>{"use strict";var n=o(4901),i=o(34),r=o(2967);t.exports=function(t,e,o){var s,l;return r&&n(s=e.constructor)&&s!==o&&i(l=s.prototype)&&l!==o.prototype&&r(t,l),t}},3706:(t,e,o)=>{"use strict";var n=o(9504),i=o(4901),r=o(7629),s=n(Function.toString);i(r.inspectSource)||(r.inspectSource=function(t){return s(t)}),t.exports=r.inspectSource},7584:(t,e,o)=>{"use strict";var n=o(34),i=o(6699);t.exports=function(t,e){n(e)&&"cause"in e&&i(t,"cause",e.cause)}},1181:(t,e,o)=>{"use strict";var n,i,r,s=o(8622),l=o(4475),a=o(34),h=o(6699),c=o(9297),u=o(7629),d=o(6119),g=o(421),f="Object already initialized",p=l.TypeError,m=l.WeakMap;if(s||u.state){var w=u.state||(u.state=new m);w.get=w.get,w.has=w.has,w.set=w.set,n=function(t,e){if(w.has(t))throw new p(f);return e.facade=t,w.set(t,e),e},i=function(t){return w.get(t)||{}},r=function(t){return w.has(t)}}else{var v=d("state");g[v]=!0,n=function(t,e){if(c(t,v))throw new p(f);return e.facade=t,h(t,v,e),e},i=function(t){return c(t,v)?t[v]:{}},r=function(t){return c(t,v)}}t.exports={set:n,get:i,has:r,enforce:function(t){return r(t)?i(t):n(t,{})},getterFor:function(t){return function(e){var o;if(!a(e)||(o=i(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return o}}}},4209:(t,e,o)=>{"use strict";var n=o(8227),i=o(6269),r=n("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||s[r]===t)}},4376:(t,e,o)=>{"use strict";var n=o(4576);t.exports=Array.isArray||function(t){return"Array"===n(t)}},4901:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},2796:(t,e,o)=>{"use strict";var n=o(9039),i=o(4901),r=/#|\.prototype\./,s=function(t,e){var o=a[l(t)];return o===c||o!==h&&(i(e)?n(e):!!e)},l=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",c=s.POLYFILL="P";t.exports=s},4117:t=>{"use strict";t.exports=function(t){return null==t}},34:(t,e,o)=>{"use strict";var n=o(4901);t.exports=function(t){return"object"==typeof t?null!==t:n(t)}},3925:(t,e,o)=>{"use strict";var n=o(34);t.exports=function(t){return n(t)||null===t}},6395:t=>{"use strict";t.exports=!1},788:(t,e,o)=>{"use strict";var n=o(34),i=o(4576),r=o(8227)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[r])?!!e:"RegExp"===i(t))}},757:(t,e,o)=>{"use strict";var n=o(7751),i=o(4901),r=o(1625),s=o(7040),l=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return i(e)&&r(e.prototype,l(t))}},2652:(t,e,o)=>{"use strict";var n=o(6080),i=o(9565),r=o(8551),s=o(6823),l=o(4209),a=o(6198),h=o(1625),c=o(81),u=o(851),d=o(9539),g=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,o){var m,w,v,y,b,C,S,R=o&&o.that,E=!(!o||!o.AS_ENTRIES),T=!(!o||!o.IS_RECORD),x=!(!o||!o.IS_ITERATOR),M=!(!o||!o.INTERRUPTED),H=n(e,R),k=function(t){return m&&d(m,"normal",t),new f(!0,t)},I=function(t){return E?(r(t),M?H(t[0],t[1],k):H(t[0],t[1])):M?H(t,k):H(t)};if(T)m=t.iterator;else if(x)m=t;else{if(!(w=u(t)))throw new g(s(t)+" is not iterable");if(l(w)){for(v=0,y=a(t);y>v;v++)if((b=I(t[v]))&&h(p,b))return b;return new f(!1)}m=c(t,w)}for(C=T?t.next:m.next;!(S=i(C,m)).done;){try{b=I(S.value)}catch(t){d(m,"throw",t)}if("object"==typeof b&&b&&h(p,b))return b}return new f(!1)}},9539:(t,e,o)=>{"use strict";var n=o(9565),i=o(8551),r=o(5966);t.exports=function(t,e,o){var s,l;i(t);try{if(!(s=r(t,"return"))){if("throw"===e)throw o;return o}s=n(s,t)}catch(t){l=!0,s=t}if("throw"===e)throw o;if(l)throw s;return i(s),o}},6269:t=>{"use strict";t.exports={}},6198:(t,e,o)=>{"use strict";var n=o(8014);t.exports=function(t){return n(t.length)}},283:(t,e,o)=>{"use strict";var n=o(9504),i=o(9039),r=o(4901),s=o(9297),l=o(3724),a=o(350).CONFIGURABLE,h=o(3706),c=o(1181),u=c.enforce,d=c.get,g=String,f=Object.defineProperty,p=n("".slice),m=n("".replace),w=n([].join),v=l&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),b=t.exports=function(t,e,o){"Symbol("===p(g(e),0,7)&&(e="["+m(g(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),o&&o.getter&&(e="get "+e),o&&o.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(l?f(t,"name",{value:e,configurable:!0}):t.name=e),v&&o&&s(o,"arity")&&t.length!==o.arity&&f(t,"length",{value:o.arity});try{o&&s(o,"constructor")&&o.constructor?l&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=u(t);return s(n,"source")||(n.source=w(y,"string"==typeof e?e:"")),t};Function.prototype.toString=b((function(){return r(this)&&d(this).source||h(this)}),"toString")},741:t=>{"use strict";var e=Math.ceil,o=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?o:e)(n)}},2603:(t,e,o)=>{"use strict";var n=o(655);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:n(t)}},2360:(t,e,o)=>{"use strict";var n,i=o(8551),r=o(6801),s=o(8727),l=o(421),a=o(397),h=o(4055),c=o(6119),u="prototype",d="script",g=c("IE_PROTO"),f=function(){},p=function(t){return"<"+d+">"+t+"</"+d+">"},m=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},w=function(){try{n=new ActiveXObject("htmlfile")}catch(t){}var t,e,o;w="undefined"!=typeof document?document.domain&&n?m(n):(e=h("iframe"),o="java"+d+":",e.style.display="none",a.appendChild(e),e.src=String(o),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F):m(n);for(var i=s.length;i--;)delete w[u][s[i]];return w()};l[g]=!0,t.exports=Object.create||function(t,e){var o;return null!==t?(f[u]=i(t),o=new f,f[u]=null,o[g]=t):o=w(),void 0===e?o:r.f(o,e)}},6801:(t,e,o)=>{"use strict";var n=o(3724),i=o(8686),r=o(4913),s=o(8551),l=o(5397),a=o(1072);e.f=n&&!i?Object.defineProperties:function(t,e){s(t);for(var o,n=l(e),i=a(e),h=i.length,c=0;h>c;)r.f(t,o=i[c++],n[o]);return t}},4913:(t,e,o)=>{"use strict";var n=o(3724),i=o(5917),r=o(8686),s=o(8551),l=o(6969),a=TypeError,h=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",g="writable";e.f=n?r?function(t,e,o){if(s(t),e=l(e),s(o),"function"==typeof t&&"prototype"===e&&"value"in o&&g in o&&!o[g]){var n=c(t,e);n&&n[g]&&(t[e]=o.value,o={configurable:d in o?o[d]:n[d],enumerable:u in o?o[u]:n[u],writable:!1})}return h(t,e,o)}:h:function(t,e,o){if(s(t),e=l(e),s(o),i)try{return h(t,e,o)}catch(t){}if("get"in o||"set"in o)throw new a("Accessors not supported");return"value"in o&&(t[e]=o.value),t}},7347:(t,e,o)=>{"use strict";var n=o(3724),i=o(9565),r=o(8773),s=o(6980),l=o(5397),a=o(6969),h=o(9297),c=o(5917),u=Object.getOwnPropertyDescriptor;e.f=n?u:function(t,e){if(t=l(t),e=a(e),c)try{return u(t,e)}catch(t){}if(h(t,e))return s(!i(r.f,t,e),t[e])}},8480:(t,e,o)=>{"use strict";var n=o(1828),i=o(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},3717:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},1625:(t,e,o)=>{"use strict";var n=o(9504);t.exports=n({}.isPrototypeOf)},1828:(t,e,o)=>{"use strict";var n=o(9504),i=o(9297),r=o(5397),s=o(9617).indexOf,l=o(421),a=n([].push);t.exports=function(t,e){var o,n=r(t),h=0,c=[];for(o in n)!i(l,o)&&i(n,o)&&a(c,o);for(;e.length>h;)i(n,o=e[h++])&&(~s(c,o)||a(c,o));return c}},1072:(t,e,o)=>{"use strict";var n=o(1828),i=o(8727);t.exports=Object.keys||function(t){return n(t,i)}},8773:(t,e)=>{"use strict";var o={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!o.call({1:2},1);e.f=i?function(t){var e=n(this,t);return!!e&&e.enumerable}:o},2967:(t,e,o)=>{"use strict";var n=o(6706),i=o(34),r=o(7750),s=o(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,o={};try{(t=n(Object.prototype,"__proto__","set"))(o,[]),e=o instanceof Array}catch(t){}return function(o,n){return r(o),s(n),i(o)?(e?t(o,n):o.__proto__=n,o):o}}():void 0)},4270:(t,e,o)=>{"use strict";var n=o(9565),i=o(4901),r=o(34),s=TypeError;t.exports=function(t,e){var o,l;if("string"===e&&i(o=t.toString)&&!r(l=n(o,t)))return l;if(i(o=t.valueOf)&&!r(l=n(o,t)))return l;if("string"!==e&&i(o=t.toString)&&!r(l=n(o,t)))return l;throw new s("Can't convert object to primitive value")}},5031:(t,e,o)=>{"use strict";var n=o(7751),i=o(9504),r=o(8480),s=o(3717),l=o(8551),a=i([].concat);t.exports=n("Reflect","ownKeys")||function(t){var e=r.f(l(t)),o=s.f;return o?a(e,o(t)):e}},1056:(t,e,o)=>{"use strict";var n=o(4913).f;t.exports=function(t,e,o){o in t||n(t,o,{configurable:!0,get:function(){return e[o]},set:function(t){e[o]=t}})}},7979:(t,e,o)=>{"use strict";var n=o(8551);t.exports=function(){var t=n(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},1034:(t,e,o)=>{"use strict";var n=o(9565),i=o(9297),r=o(1625),s=o(7979),l=RegExp.prototype;t.exports=function(t){var e=t.flags;return void 0!==e||"flags"in l||i(t,"flags")||!r(l,t)?e:n(s,t)}},7750:(t,e,o)=>{"use strict";var n=o(4117),i=TypeError;t.exports=function(t){if(n(t))throw new i("Can't call method on "+t);return t}},9472:(t,e,o)=>{"use strict";var n,i=o(4475),r=o(8745),s=o(4901),l=o(6763),a=o(9392),h=o(7680),c=o(2812),u=i.Function,d=/MSIE .\./.test(a)||l&&((n=i.Bun.version.split(".")).length<3||"0"===n[0]&&(n[1]<3||"3"===n[1]&&"0"===n[2]));t.exports=function(t,e){var o=e?2:1;return d?function(n,i){var l=c(arguments.length,1)>o,a=s(n)?n:u(n),d=l?h(arguments,o):[],g=l?function(){r(a,this,d)}:a;return e?t(g,i):t(g)}:t}},6119:(t,e,o)=>{"use strict";var n=o(5745),i=o(3392),r=n("keys");t.exports=function(t){return r[t]||(r[t]=i(t))}},7629:(t,e,o)=>{"use strict";var n=o(6395),i=o(4475),r=o(9433),s="__core-js_shared__",l=t.exports=i[s]||r(s,{});(l.versions||(l.versions=[])).push({version:"3.37.0",mode:n?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(t,e,o)=>{"use strict";var n=o(7629);t.exports=function(t,e){return n[t]||(n[t]=e||{})}},4495:(t,e,o)=>{"use strict";var n=o(7388),i=o(9039),r=o(4475).String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},9225:(t,e,o)=>{"use strict";var n,i,r,s,l=o(4475),a=o(8745),h=o(6080),c=o(4901),u=o(9297),d=o(9039),g=o(397),f=o(7680),p=o(4055),m=o(2812),w=o(8119),v=o(9088),y=l.setImmediate,b=l.clearImmediate,C=l.process,S=l.Dispatch,R=l.Function,E=l.MessageChannel,T=l.String,x=0,M={},H="onreadystatechange";d((function(){n=l.location}));var k=function(t){if(u(M,t)){var e=M[t];delete M[t],e()}},I=function(t){return function(){k(t)}},A=function(t){k(t.data)},O=function(t){l.postMessage(T(t),n.protocol+"//"+n.host)};y&&b||(y=function(t){m(arguments.length,1);var e=c(t)?t:R(t),o=f(arguments,1);return M[++x]=function(){a(e,void 0,o)},i(x),x},b=function(t){delete M[t]},v?i=function(t){C.nextTick(I(t))}:S&&S.now?i=function(t){S.now(I(t))}:E&&!w?(s=(r=new E).port2,r.port1.onmessage=A,i=h(s.postMessage,s)):l.addEventListener&&c(l.postMessage)&&!l.importScripts&&n&&"file:"!==n.protocol&&!d(O)?(i=O,l.addEventListener("message",A,!1)):i=H in p("script")?function(t){g.appendChild(p("script"))[H]=function(){g.removeChild(this),k(t)}}:function(t){setTimeout(I(t),0)}),t.exports={set:y,clear:b}},5610:(t,e,o)=>{"use strict";var n=o(1291),i=Math.max,r=Math.min;t.exports=function(t,e){var o=n(t);return o<0?i(o+e,0):r(o,e)}},5397:(t,e,o)=>{"use strict";var n=o(7055),i=o(7750);t.exports=function(t){return n(i(t))}},1291:(t,e,o)=>{"use strict";var n=o(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:n(e)}},8014:(t,e,o)=>{"use strict";var n=o(1291),i=Math.min;t.exports=function(t){var e=n(t);return e>0?i(e,9007199254740991):0}},8981:(t,e,o)=>{"use strict";var n=o(7750),i=Object;t.exports=function(t){return i(n(t))}},2777:(t,e,o)=>{"use strict";var n=o(9565),i=o(34),r=o(757),s=o(5966),l=o(4270),a=o(8227),h=TypeError,c=a("toPrimitive");t.exports=function(t,e){if(!i(t)||r(t))return t;var o,a=s(t,c);if(a){if(void 0===e&&(e="default"),o=n(a,t,e),!i(o)||r(o))return o;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},6969:(t,e,o)=>{"use strict";var n=o(2777),i=o(757);t.exports=function(t){var e=n(t,"string");return i(e)?e:e+""}},2140:(t,e,o)=>{"use strict";var n={};n[o(8227)("toStringTag")]="z",t.exports="[object z]"===String(n)},655:(t,e,o)=>{"use strict";var n=o(6955),i=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return i(t)}},6823:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},3392:(t,e,o)=>{"use strict";var n=o(9504),i=0,r=Math.random(),s=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++i+r,36)}},7040:(t,e,o)=>{"use strict";var n=o(4495);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(t,e,o)=>{"use strict";var n=o(3724),i=o(9039);t.exports=n&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},2812:t=>{"use strict";var e=TypeError;t.exports=function(t,o){if(t<o)throw new e("Not enough arguments");return t}},8622:(t,e,o)=>{"use strict";var n=o(4475),i=o(4901),r=n.WeakMap;t.exports=i(r)&&/native code/.test(String(r))},8227:(t,e,o)=>{"use strict";var n=o(4475),i=o(5745),r=o(9297),s=o(3392),l=o(4495),a=o(7040),h=n.Symbol,c=i("wks"),u=a?h.for||h:h&&h.withoutSetter||s;t.exports=function(t){return r(c,t)||(c[t]=l&&r(h,t)?h[t]:u("Symbol."+t)),c[t]}},4601:(t,e,o)=>{"use strict";var n=o(7751),i=o(9297),r=o(6699),s=o(1625),l=o(2967),a=o(7740),h=o(1056),c=o(3167),u=o(2603),d=o(7584),g=o(747),f=o(3724),p=o(6395);t.exports=function(t,e,o,m){var w="stackTraceLimit",v=m?2:1,y=t.split("."),b=y[y.length-1],C=n.apply(null,y);if(C){var S=C.prototype;if(!p&&i(S,"cause")&&delete S.cause,!o)return C;var R=n("Error"),E=e((function(t,e){var o=u(m?e:t,void 0),n=m?new C(t):new C;return void 0!==o&&r(n,"message",o),g(n,E,n.stack,2),this&&s(S,this)&&c(n,this,E),arguments.length>v&&d(n,arguments[v]),n}));if(E.prototype=S,"Error"!==b?l?l(E,R):a(E,R,{name:!0}):f&&w in C&&(h(E,C,w),h(E,C,"prepareStackTrace")),a(E,C),!p)try{S.name!==b&&r(S,"name",b),S.constructor=E}catch(t){}return E}}},8107:(t,e,o)=>{"use strict";var n=o(6518),i=o(8981),r=o(6198),s=o(1291),l=o(6469);n({target:"Array",proto:!0},{at:function(t){var e=i(this),o=r(e),n=s(t),l=n>=0?n:o+n;return l<0||l>=o?void 0:e[l]}}),l("at")},4114:(t,e,o)=>{"use strict";var n=o(6518),i=o(8981),r=o(6198),s=o(4527),l=o(6837);n({target:"Array",proto:!0,arity:1,forced:o(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=i(this),o=r(e),n=arguments.length;l(o+n);for(var a=0;a<n;a++)e[o]=arguments[a],o++;return s(e,o),o}})},237:(t,e,o)=>{"use strict";o(6469)("flatMap")},3514:(t,e,o)=>{"use strict";o(6469)("flat")},3609:(t,e,o)=>{"use strict";var n=o(6518),i=o(8981),r=o(6198),s=o(4527),l=o(4606),a=o(6837);n({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=i(this),o=r(e),n=arguments.length;if(n){a(o+n);for(var h=o;h--;){var c=h+n;h in e?e[c]=e[h]:l(e,c)}for(var u=0;u<n;u++)e[u]=arguments[u]}return s(e,o+n)}})},6280:(t,e,o)=>{"use strict";var n=o(6518),i=o(4475),r=o(8745),s=o(4601),l="WebAssembly",a=i[l],h=7!==new Error("e",{cause:7}).cause,c=function(t,e){var o={};o[t]=s(t,e,h),n({global:!0,constructor:!0,arity:1,forced:h},o)},u=function(t,e){if(a&&a[t]){var o={};o[t]=s(l+"."+t,e,h),n({target:l,stat:!0,constructor:!0,arity:1,forced:h},o)}};c("Error",(function(t){return function(e){return r(t,this,arguments)}})),c("EvalError",(function(t){return function(e){return r(t,this,arguments)}})),c("RangeError",(function(t){return function(e){return r(t,this,arguments)}})),c("ReferenceError",(function(t){return function(e){return r(t,this,arguments)}})),c("SyntaxError",(function(t){return function(e){return r(t,this,arguments)}})),c("TypeError",(function(t){return function(e){return r(t,this,arguments)}})),c("URIError",(function(t){return function(e){return r(t,this,arguments)}})),u("CompileError",(function(t){return function(e){return r(t,this,arguments)}})),u("LinkError",(function(t){return function(e){return r(t,this,arguments)}})),u("RuntimeError",(function(t){return function(e){return r(t,this,arguments)}}))},3110:(t,e,o)=>{"use strict";var n=o(6518),i=o(7751),r=o(8745),s=o(9565),l=o(9504),a=o(9039),h=o(4901),c=o(757),u=o(7680),d=o(6933),g=o(4495),f=String,p=i("JSON","stringify"),m=l(/./.exec),w=l("".charAt),v=l("".charCodeAt),y=l("".replace),b=l(1..toString),C=/[\uD800-\uDFFF]/g,S=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,E=!g||a((function(){var t=i("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))})),T=a((function(){return'"\\udf06\\ud834"'!==p("\udf06\ud834")||'"\\udead"'!==p("\udead")})),x=function(t,e){var o=u(arguments),n=d(e);if(h(n)||void 0!==t&&!c(t))return o[1]=function(t,e){if(h(n)&&(e=s(n,this,f(t),e)),!c(e))return e},r(p,null,o)},M=function(t,e,o){var n=w(o,e-1),i=w(o,e+1);return m(S,t)&&!m(R,i)||m(R,t)&&!m(S,n)?"\\u"+b(v(t,0),16):t};p&&n({target:"JSON",stat:!0,arity:3,forced:E||T},{stringify:function(t,e,o){var n=u(arguments),i=r(E?x:p,null,n);return T&&"string"==typeof i?y(i,C,M):i}})},3921:(t,e,o)=>{"use strict";var n=o(6518),i=o(2652),r=o(2278);n({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,o){r(e,t,o)}),{AS_ENTRIES:!0}),e}})},9978:(t,e,o)=>{"use strict";var n=o(6518),i=o(9565),r=o(9504),s=o(7750),l=o(4901),a=o(4117),h=o(788),c=o(655),u=o(5966),d=o(1034),g=o(2478),f=o(8227),p=o(6395),m=f("replace"),w=TypeError,v=r("".indexOf),y=r("".replace),b=r("".slice),C=Math.max;n({target:"String",proto:!0},{replaceAll:function(t,e){var o,n,r,f,S,R,E,T,x,M=s(this),H=0,k=0,I="";if(!a(t)){if((o=h(t))&&(n=c(s(d(t))),!~v(n,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(r=u(t,m))return i(r,t,M,e);if(p&&o)return y(c(M),t,e)}for(f=c(M),S=c(t),(R=l(e))||(e=c(e)),E=S.length,T=C(1,E),H=v(f,S);-1!==H;)x=R?c(e(S,H,f)):g(S,f,H,[],void 0,e),I+=b(f,k,H)+x,k=H+E,H=H+T>f.length?-1:v(f,S,H+T);return k<f.length&&(I+=b(f,k)),I}})},6368:(t,e,o)=>{"use strict";var n=o(6518),i=o(4475),r=o(9225).clear;n({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==r},{clearImmediate:r})},9848:(t,e,o)=>{"use strict";o(6368),o(9309)},9309:(t,e,o)=>{"use strict";var n=o(6518),i=o(4475),r=o(9225).set,s=o(9472),l=i.setImmediate?s(r,!1):r;n({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==l},{setImmediate:l})}},o={};function n(t){var i=o[t];if(void 0!==i)return i.exports;var r=o[t]={exports:{}};return e[t].call(r.exports,r,r.exports,n),r.exports}n.m=e,t=[],n.O=(e,o,i,r)=>{if(!o){var s=1/0;for(c=0;c<t.length;c++){for(var[o,i,r]=t[c],l=!0,a=0;a<o.length;a++)(!1&r||s>=r)&&Object.keys(n.O).every((t=>n.O[t](o[a])))?o.splice(a--,1):(l=!1,r<s&&(s=r));if(l){t.splice(c--,1);var h=i();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,i,r]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={57:0,350:0};n.O.j=e=>0===t[e];var e=(e,o)=>{var i,r,[s,l,a]=o,h=0;if(s.some((e=>0!==t[e]))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(a)var c=a(n)}for(e&&e(o);h<s.length;h++)r=s[h],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},o=globalThis.webpackChunkdata_table=globalThis.webpackChunkdata_table||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})();var i=n.O(void 0,[350],(()=>n(8638)));i=n.O(i)})();
//# sourceMappingURL=index.js.map