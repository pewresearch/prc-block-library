{"version":3,"file":"view.js","mappings":"2CACA,IAAIA,EAAsB,CCA1BA,EAAwB,CAACC,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDH,EAAwB,CAACS,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,ICIlF,MAAM,GAJGI,EAI8B,CAAE,WAAgB,IAAOC,EAAwE,WAAG,WAAgB,IAAOA,EAAwE,WAAG,MAAW,IAAOA,EAAmE,OAH7TC,EAAI,CAAC,EAAGhB,EAAoBiB,EAAED,EAAGF,GAAWE,ICI3C,QAAEE,EAAO,MAAEC,IAAUC,EAAAA,EAAAA,OAAM,8BAA+B,CAC/DD,MAAO,CACN,iBAACE,GACA,MAAMC,GAAMC,EAAAA,EAAAA,cAENC,EAAKF,IAAM,mBAAmBG,QAAQ,IAAK,IAGjD,OAFAC,QAAQC,IAAI,mBAAoBL,EAAKH,EAAOA,EAAMS,eAAgBJ,GAE9DA,IAAOL,EAAMS,cAKlB,GAEDV,QAAS,CACRW,wBAAyBA,KACxB,MAAM,IAAEC,IAAQP,EAAAA,EAAAA,cAGhB,OACCO,EAAIC,cACH,6DAGMD,EAAIC,cACV,+CAGKD,EAAIC,cACV,0FACA,EAEFC,6BAA8BA,KACAd,EAAQW,0BACFI,iBAAiB,KAC9CC,SAASC,IACdA,EAAKC,iBAAiB,SAAUC,IAC/B,MAAMC,EAAOH,EAAKI,aAAa,QAE/B,GAAI,IAAMD,EAAKE,QAAQ,KAAM,CAC5BH,EAAEI,iBACF,MAAMC,EAASC,SAASC,eACvBN,EAAKb,QAAQ,IAAK,KAEfiB,IACHhB,QAAQC,IAAI,SAAUe,GACtBA,EAAOG,eAAe,CAAEC,SAAU,WAAY,GAE9CC,OAAOC,QAAQC,UAAU,KAAM,KAAMX,GAEvC,IACC,GACD,EAEHY,gBAAkBC,IACjBA,EAAMV,iBACN,MAAMW,GAAUC,EAAAA,EAAAA,eACV,WAAEC,EAAU,eAAEC,GAAmBH,EACvC1B,QAAQC,IAAI,kBAAmByB,EAASD,GACxCC,EAAQG,gBAAkBH,EAAQG,cAAc,GAGlDC,UAAW,CACVC,OAAQA,KACP,MAAML,GAAUC,EAAAA,EAAAA,eACV,IAAEvB,IAAQP,EAAAA,EAAAA,cAChBL,EAAQc,+BACRN,QAAQC,IAAI,SAAUG,EAAKsB,EAASjC,GAEpC,MAAM,mBAAEuC,GAAuBN,EAC/B,IAAI,IAASM,EAAoB,CAChC,MAAM,OAAEC,GAAWxC,EAEbyC,EACLzC,EAAM0C,SAASC,MAAMC,GAAYA,EAAQvC,KAAOmC,KAChD,CAAC,EACIK,EAAmBJ,GAAaK,mBAAqB,GAE3D9C,EAAM+C,6BAA8B,EACpC/C,EAAMgD,kBAAoBH,CAC3B,GAEDI,SAAUA,KACT,MAAMhB,GAAUC,EAAAA,EAAAA,eACV,oBAAEgB,EAAmB,kBAAEC,GAAsBlB,EACnD,IAAKiB,EACJ,OAED,MAAM,IAAEvC,IAAQP,EAAAA,EAAAA,cAEVgD,EAAQzC,EAAI0C,YAClB9C,QAAQC,IAAI,WAAYG,EAAKyC,EAAOnB,EAASjC,GAI5CiC,EAAQE,cADLiB,EAAQD,GAAqBD,EAIjC,EAEDI,sBAAuBA,KACtB,IAAKtD,EAAM+C,4BACV,OAED,MAAM,IAAEpC,IAAQP,EAAAA,EAAAA,cAEVmD,EAAuBvD,EAAMgD,kBAE7BQ,EAAiB5B,OAAO6B,QAE9B,IAAIhD,EAAiB,KAGjBiD,GAAc,EAElB,MAAMC,EAAsBJ,EAAqBK,WAC/ChB,GAAYA,EAAQvC,KAAOM,GAAKN,KAE9BsD,EAAsBJ,EAAqBM,OAAS,IACvDH,EAAcH,EAAqBI,EAAsB,IAG1D,MACMG,EADkBnD,EAAIoD,wBAAwBC,IACjBR,EAC7BS,EAAsBzC,SAC1BC,eAAeiC,GAAarD,KAC3B0D,wBAAwBC,IACrBE,EAAsBD,EAAsBT,EAE9CM,EAAW,GAAKI,EAAsB,IACzCzD,EAAiBE,GAAKN,IAGnBI,IAAmBT,EAAMS,iBAC5BT,EAAMS,eAAiBA,GAGxBF,QAAQC,IAAI,WAAYG,GAAKN,GAAIyD,EAAUI,EAAoB,KD/I1D,IAACvE,EACJE","sources":["webpack://table-of-contents/webpack/bootstrap","webpack://table-of-contents/webpack/runtime/define property getters","webpack://table-of-contents/webpack/runtime/hasOwnProperty shorthand","webpack://table-of-contents/external module \"@wordpress/interactivity\"","webpack://table-of-contents/./src/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/**\n * WordPress Dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { actions, state } = store('prc-block/table-of-contents', {\n\tstate: {\n\t\t*isListItemActive() {\n\t\t\tconst elm = getElement();\n\t\t\t// set const id to elm.data-ref-value but remove the # from the beginning\n\t\t\tconst id = elm?.['data-ref-value']?.replace('#', '');\n\t\t\tconsole.log('isListItemActive', elm, state, state.currentChapter, id);\n\n\t\t\tif (id === state.currentChapter) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t},\n\tactions: {\n\t\tgetInternalChaptersList: () => {\n\t\t\tconst { ref } = getElement();\n\t\t\t// check if the first level of the list has list-items with is-top-level class\n\t\t\t// if so, return the first level of the list\n\t\t\tif (\n\t\t\t\tref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list .is-top-level'\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn ref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list'\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn ref.querySelector(\n\t\t\t\t'.wp-block-prc-block-table-of-contents__list .wp-block-prc-block-table-of-contents__list'\n\t\t\t);\n\t\t},\n\t\tinitSmoothScrollClickHandler: () => {\n\t\t\tconst internalChaptersList = actions.getInternalChaptersList();\n\t\t\tconst links = internalChaptersList.querySelectorAll('a');\n\t\t\tlinks.forEach((link) => {\n\t\t\t\tlink.addEventListener('click', (e) => {\n\t\t\t\t\tconst href = link.getAttribute('href');\n\t\t\t\t\t// If the link is a hash link, we need to smooth scroll to the hash.\n\t\t\t\t\tif (0 === href.indexOf('#')) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst target = document.getElementById(\n\t\t\t\t\t\t\thref.replace('#', '')\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tconsole.log('target', target);\n\t\t\t\t\t\t\ttarget.scrollIntoView({ behavior: 'smooth' }, true);\n\t\t\t\t\t\t\t// Add the hash to the end of the URL.\n\t\t\t\t\t\t\twindow.history.pushState(null, null, href);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonDropdownClick: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst context = getContext();\n\t\t\tconst { isDropdown, isDropdownOpen } = context;\n\t\t\tconsole.log('onDropdownClick', context, event);\n\t\t\tcontext.isDropdownOpen = !context.isDropdownOpen;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tonInit: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tactions.initSmoothScrollClickHandler();\n\t\t\tconsole.log('onInit', ref, context, state);\n\t\t\t// So long as there is one TOC block that has this enabled we will enable the watch for chapter scroll function.\n\t\t\tconst { showCurrentChapter } = context;\n\t\t\tif (true === showCurrentChapter) {\n\t\t\t\tconst { postId } = state;\n\t\t\t\t// get the object our of state.chapters with the same id as the postId\n\t\t\t\tconst thisChapter =\n\t\t\t\t\tstate.chapters.find((chapter) => chapter.id === postId) ||\n\t\t\t\t\t{};\n\t\t\t\tconst internalChapters = thisChapter?.internal_chapters || [];\n\n\t\t\t\tstate.enableWatchForChapterScroll = true;\n\t\t\t\tstate.chaptersWatchList = internalChapters;\n\t\t\t}\n\t\t},\n\t\tonResize: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { autoDropdownEnabled, autoDropdownWidth } = context;\n\t\t\tif (!autoDropdownEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { ref } = getElement();\n\t\t\t// get the width of the ref\n\t\t\tconst width = ref.offsetWidth;\n\t\t\tconsole.log('onResize', ref, width, context, state);\n\t\t\t// if the width is less than the autoDropdownWidth and autoDropdownEnabled is true\n\t\t\t// set isDropdown to true\n\t\t\tif (width < autoDropdownWidth && autoDropdownEnabled) {\n\t\t\t\tcontext.isDropdown = true;\n\t\t\t} else {\n\t\t\t\tcontext.isDropdown = false;\n\t\t\t}\n\t\t},\n\t\twatchForChapterScroll: () => {\n\t\t\tif (!state.enableWatchForChapterScroll) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { ref } = getElement();\n\t\t\t// get the internal chapters list\n\t\t\tconst internalChaptersList = state.chaptersWatchList;\n\t\t\t// get the current scroll position\n\t\t\tconst scrollPosition = window.scrollY;\n\t\t\t// get the current chapter\n\t\t\tlet currentChapter = null;\n\t\t\t// loop through the internal chapters list\n\n\t\t\tlet nextChapter = false;\n\t\t\t// get the current chapter position in the internalChaptersList by id\n\t\t\tconst currentChapterIndex = internalChaptersList.findIndex(\n\t\t\t\t(chapter) => chapter.id === ref?.id\n\t\t\t);\n\t\t\tif (currentChapterIndex < internalChaptersList.length - 1) {\n\t\t\t\tnextChapter = internalChaptersList[currentChapterIndex + 1];\n\t\t\t}\n\n\t\t\tconst chapterPosition = ref.getBoundingClientRect().top;\n\t\t\tconst distance = chapterPosition - scrollPosition;\n\t\t\tconst nextChapterPosition = document\n\t\t\t\t.getElementById(nextChapter?.id)\n\t\t\t\t?.getBoundingClientRect().top;\n\t\t\tconst nextChapterDistance = nextChapterPosition - scrollPosition;\n\n\t\t\tif (distance < 0 && nextChapterDistance > 0) {\n\t\t\t\tcurrentChapter = ref?.id;\n\t\t\t}\n\n\t\t\tif (currentChapter !== state.currentChapter) {\n\t\t\t\tstate.currentChapter = currentChapter;\n\t\t\t}\n\n\t\t\tconsole.log('scroll::', ref?.id, distance, nextChapterDistance);\n\t\t},\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","actions","state","store","isListItemActive","elm","getElement","id","replace","console","log","currentChapter","getInternalChaptersList","ref","querySelector","initSmoothScrollClickHandler","querySelectorAll","forEach","link","addEventListener","e","href","getAttribute","indexOf","preventDefault","target","document","getElementById","scrollIntoView","behavior","window","history","pushState","onDropdownClick","event","context","getContext","isDropdown","isDropdownOpen","callbacks","onInit","showCurrentChapter","postId","thisChapter","chapters","find","chapter","internalChapters","internal_chapters","enableWatchForChapterScroll","chaptersWatchList","onResize","autoDropdownEnabled","autoDropdownWidth","width","offsetWidth","watchForChapterScroll","internalChaptersList","scrollPosition","scrollY","nextChapter","currentChapterIndex","findIndex","length","distance","getBoundingClientRect","top","nextChapterPosition","nextChapterDistance"],"sourceRoot":""}