{"version":3,"file":"view.js","mappings":"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","sources":["webpack://table-of-contents/webpack/bootstrap","webpack://table-of-contents/webpack/runtime/define property getters","webpack://table-of-contents/webpack/runtime/hasOwnProperty shorthand","webpack://table-of-contents/external module \"@wordpress/interactivity\"","webpack://table-of-contents/./src/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/**\n * WordPress Dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { actions, state } = store('prc-block/table-of-contents', {\n\tstate: {},\n\tactions: {\n\t\tgetInternalChaptersList: () => {\n\t\t\tconst { ref } = getElement();\n\t\t\t// check if the first level of the list has list-items with is-top-level class\n\t\t\t// if so, return the first level of the list\n\t\t\tif (\n\t\t\t\tref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list .is-top-level'\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn ref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list'\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn ref.querySelector(\n\t\t\t\t'.wp-block-prc-block-table-of-contents__list .wp-block-prc-block-table-of-contents__list'\n\t\t\t);\n\t\t},\n\t\tinitSmoothScrollClickHandler: () => {\n\t\t\tconst internalChaptersList = actions.getInternalChaptersList();\n\t\t\tconst links = internalChaptersList.querySelectorAll('a');\n\t\t\tlinks.forEach((link) => {\n\t\t\t\tlink.addEventListener('click', (e) => {\n\t\t\t\t\tconst href = link.getAttribute('href');\n\t\t\t\t\t// If the link is a hash link, we need to smooth scroll to the hash.\n\t\t\t\t\tif (0 === href.indexOf('#')) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst target = document.getElementById(\n\t\t\t\t\t\t\thref.replace('#', '')\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\ttarget.scrollIntoView({ behavior: 'smooth' }, true);\n\t\t\t\t\t\t\t// Add the hash to the end of the URL.\n\t\t\t\t\t\t\twindow.history.pushState(null, null, href);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonDropdownClick: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst context = getContext();\n\t\t\tcontext.isDropdownOpen = !context.isDropdownOpen;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tonInit: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tactions.initSmoothScrollClickHandler();\n\n\t\t\t// So long as there is one TOC block that has this enabled we will enable the watch for chapter scroll function.\n\t\t\tconst { showCurrentChapter } = context;\n\t\t\tif (true === showCurrentChapter) {\n\t\t\t\tconst { postId } = state;\n\t\t\t\t// get the object our of state.chapters with the same id as the postId\n\t\t\t\tconst thisChapter =\n\t\t\t\t\tstate.chapters.find((chapter) => chapter.id === postId) ||\n\t\t\t\t\t{};\n\t\t\t\tconst internalChapters = thisChapter?.internal_chapters || [];\n\n\t\t\t\tstate.enableWatchForChapterScroll = true;\n\t\t\t\tstate.chaptersWatchList = internalChapters;\n\t\t\t}\n\t\t},\n\t\tonResize: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { autoDropdownEnabled, autoDropdownWidth } = context;\n\t\t\tif (!autoDropdownEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { ref } = getElement();\n\t\t\t// get the width of the ref\n\t\t\tconst width = ref.offsetWidth;\n\t\t\t// if the width is less than the autoDropdownWidth and autoDropdownEnabled is true\n\t\t\t// set isDropdown to true\n\t\t\tif (width < autoDropdownWidth && autoDropdownEnabled) {\n\t\t\t\tcontext.isDropdown = true;\n\t\t\t} else {\n\t\t\t\tcontext.isDropdown = false;\n\t\t\t}\n\t\t},\n\t\tisListItemActive: () => {\n\t\t\tconst elm = getElement();\n\t\t\tconst { ref } = elm;\n\t\t\t// set const id to elm.data-ref-value but remove the # from the beginning\n\t\t\tconst id = ref?.getAttribute('data-ref-value')?.replace('#', '');\n\n\t\t\tif (id === state.currentChapter) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twatchForChapterScroll: () => {\n\t\t\tif (!state.enableWatchForChapterScroll) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { ref } = getElement();\n\n\t\t\t// get the internal chapters list\n\t\t\tconst internalChaptersList = state.chaptersWatchList;\n\t\t\t// get the current chapter\n\t\t\tlet { currentChapter } = state;\n\t\t\t// loop through the internal chapters list\n\n\t\t\tlet nextChapter = false;\n\t\t\t// get the current chapter position in the internalChaptersList by id\n\t\t\tconst currentChapterIndex = internalChaptersList.findIndex(\n\t\t\t\t(chapter) => chapter.id === ref?.id\n\t\t\t);\n\t\t\tif (currentChapterIndex < internalChaptersList.length - 1) {\n\t\t\t\tnextChapter = internalChaptersList[currentChapterIndex + 1];\n\t\t\t}\n\n\t\t\tconst chapterPosition = ref.getBoundingClientRect().top;\n\t\t\tconst nextChapterPosition = document\n\t\t\t\t.getElementById(nextChapter?.id)\n\t\t\t\t?.getBoundingClientRect().top;\n\n\t\t\t// When we cross the threshold of the current chapter (but not the next chapter), update the current chapter.\n\t\t\tif (\n\t\t\t\tchapterPosition < 0 &&\n\t\t\t\t(nextChapterPosition > 0 || !nextChapter)\n\t\t\t) {\n\t\t\t\tcurrentChapter = ref?.id;\n\t\t\t}\n\n\t\t\tif (currentChapter !== state.currentChapter) {\n\t\t\t\tstate.currentChapter = currentChapter;\n\t\t\t}\n\t\t},\n\t\tonWindowClick: (event) => {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tif (!ref.contains(event.target) && context.isDropdown) {\n\t\t\t\tcontext.isDropdownOpen = false;\n\t\t\t}\n\t\t},\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","actions","state","store","getInternalChaptersList","ref","getElement","querySelector","initSmoothScrollClickHandler","querySelectorAll","forEach","link","addEventListener","e","href","getAttribute","indexOf","preventDefault","target","document","getElementById","replace","scrollIntoView","behavior","window","history","pushState","onDropdownClick","event","context","getContext","isDropdownOpen","callbacks","onInit","showCurrentChapter","postId","thisChapter","chapters","find","chapter","id","internalChapters","internal_chapters","enableWatchForChapterScroll","chaptersWatchList","onResize","autoDropdownEnabled","autoDropdownWidth","width","offsetWidth","isDropdown","isListItemActive","elm","currentChapter","watchForChapterScroll","internalChaptersList","nextChapter","currentChapterIndex","findIndex","length","chapterPosition","getBoundingClientRect","top","nextChapterPosition","onWindowClick","contains"],"sourceRoot":""}