!function(){var e={472:function(e,t){var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var i=typeof a;if("string"===i||"number"===i)e.push(a);else if(Array.isArray(a)){if(a.length){var s=r.apply(null,a);s&&e.push(s)}}else if("object"===i)if(a.toString===Object.prototype.toString)for(var o in a)n.call(a,o)&&a[o]&&e.push(o);else e.push(a.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,a),i.exports}a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.wp.domReady,n=a.n(t);function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var s,o,c=window.React,p="hcaptcha-api-script-id",l="hcaptchaOnLoad",h=new Promise((function(e,t){s=e,o=t})),d=function(e){var t,a;function n(t){var a;(a=e.call(this,t)||this).renderCaptcha=a.renderCaptcha.bind(r(a)),a.resetCaptcha=a.resetCaptcha.bind(r(a)),a.removeCaptcha=a.removeCaptcha.bind(r(a)),a.isReady=a.isReady.bind(r(a)),a.loadCaptcha=a.loadCaptcha.bind(r(a)),a.handleOnLoad=a.handleOnLoad.bind(r(a)),a.handleSubmit=a.handleSubmit.bind(r(a)),a.handleExpire=a.handleExpire.bind(r(a)),a.handleError=a.handleError.bind(r(a)),a.handleOpen=a.handleOpen.bind(r(a)),a.handleClose=a.handleClose.bind(r(a)),a.handleChallengeExpired=a.handleChallengeExpired.bind(r(a));var n="undefined"!=typeof hcaptcha;return a.ref=c.createRef(),a.apiScriptRequested=!1,a.state={isApiReady:n,isRemoved:!1,elementId:t.id,captchaId:""},a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,i(t,a);var d=n.prototype;return d.componentDidMount=function(){this.state.isApiReady?this.renderCaptcha():this.loadCaptcha()},d.componentWillUnmount=function(){var e=this.state.captchaId;this.isReady()&&(hcaptcha.reset(e),hcaptcha.remove(e))},d.shouldComponentUpdate=function(e,t){return this.state.isApiReady===t.isApiReady&&this.state.isRemoved===t.isRemoved},d.componentDidUpdate=function(e){var t=this;["sitekey","size","theme","tabindex","languageOverride","endpoint"].every((function(a){return e[a]===t.props[a]}))||this.removeCaptcha((function(){t.renderCaptcha()}))},d.loadCaptcha=function(){if(!this.apiScriptRequested){var e=this.props,t=e.apihost,a=e.assethost,n=e.endpoint,r=e.host,i=e.imghost;(function(e){if(void 0===e&&(e={}),document.getElementById(p))return h;window[l]=s;var t=e.apihost||"https://js.hcaptcha.com";delete e.apihost;var a=document.createElement("script");a.id=p,a.src=t+"/1/api.js?render=explicit&onload="+l,a.async=!0,a.onerror=function(e){return o("script-error")};var n=function(e){return Object.entries(e).filter((function(e){e[0];var t=e[1];return t||!1===t})).map((function(e){var t=e[0],a=e[1];return encodeURIComponent(t)+"="+encodeURIComponent(a)})).join("&")}(e);return a.src+=""!==n?"&"+n:"",document.head.appendChild(a),h})({apihost:t,assethost:a,endpoint:n,hl:e.languageOverride,host:r,imghost:i,recaptchacompat:!1===e.reCaptchaCompat?"off":null,reportapi:e.reportapi,sentry:e.sentry,custom:e.custom}).then(this.handleOnLoad).catch(this.handleError),this.apiScriptRequested=!0}},d.renderCaptcha=function(e){if(this.state.isApiReady){var t=Object.assign({"open-callback":this.handleOpen,"close-callback":this.handleClose,"error-callback":this.handleError,"chalexpired-callback":this.handleChallengeExpired,"expired-callback":this.handleExpire,callback:this.handleSubmit},this.props,{hl:this.props.hl||this.props.languageOverride,languageOverride:void 0}),a=hcaptcha.render(this.ref.current,t);this.setState({isRemoved:!1,captchaId:a},(function(){e&&e()}))}},d.resetCaptcha=function(){var e=this.state.captchaId;this.isReady()&&hcaptcha.reset(e)},d.removeCaptcha=function(e){var t=this.state.captchaId;this.isReady()&&this.setState({isRemoved:!0},(function(){hcaptcha.remove(t),e&&e()}))},d.handleOnLoad=function(){var e=this;this.setState({isApiReady:!0},(function(){e.renderCaptcha((function(){var t=e.props.onLoad;t&&t()}))}))},d.handleSubmit=function(e){var t=this.props.onVerify,a=this.state,n=a.isRemoved,r=a.captchaId;"undefined"==typeof hcaptcha||n||t(hcaptcha.getResponse(r),hcaptcha.getRespKey(r))},d.handleExpire=function(){var e=this.props.onExpire,t=this.state.captchaId;this.isReady()&&(hcaptcha.reset(t),e&&e())},d.handleError=function(e){var t=this.props.onError,a=this.state.captchaId;this.isReady()&&hcaptcha.reset(a),t&&t(e)},d.isReady=function(){var e=this.state,t=e.isApiReady,a=e.isRemoved;return t&&!a},d.handleOpen=function(){this.isReady()&&this.props.onOpen&&this.props.onOpen()},d.handleClose=function(){this.isReady()&&this.props.onClose&&this.props.onClose()},d.handleChallengeExpired=function(){this.isReady()&&this.props.onChalExpired&&this.props.onChalExpired()},d.execute=function(e){void 0===e&&(e=null);var t=this.state.captchaId;if(this.isReady())return e&&"object"!=typeof e&&(e=null),hcaptcha.execute(t,e)},d.setData=function(e){var t=this.state.captchaId;this.isReady()&&(e&&"object"!=typeof e&&(e=null),hcaptcha.setData(t,e))},d.getResponse=function(){return hcaptcha.getResponse(this.state.captchaId)},d.getRespKey=function(){return hcaptcha.getRespKey(this.state.captchaId)},d.render=function(){var e=this.state.elementId;return c.createElement("div",{ref:this.ref,id:e})},n}(c.Component),u=a(472),f=a.n(u),m=window.wp.apiFetch,y=a.n(m),v=window.wp.url;const b=!(!window.mailChimpFormConfig||!window.mailChimpFormConfig.HCAPTCHA_KEY)&&window.mailChimpFormConfig.HCAPTCHA_KEY,g=()=>{let e=document.querySelector('iframe[title="Main content of the hCaptcha challenge"]');if(e=e.parentElement.parentElement,e){const t=e.querySelector("div:last-of-type");null!==t&&(t.style={...t.style,display:"none"})}else g()};function C(t){let{className:a,input:n={style:"",className:"",type:"email",placeholder:""},button:r={wrapperClassName:"",wrapperStyle:"",style:"",className:"",text:""},form:i={segmentId:!1}}=t;const[s,o]=(0,e.useState)(!1),[c,p]=(0,e.useState)(!1),[l,h]=(0,e.useState)(!1),[u,m]=(0,e.useState)(!1),[C,R]=(0,e.useState)(null),[E,w]=(0,e.useState)(r.text),[S,x]=(0,e.useState)(!1),O=(0,e.useRef)(null),A=f()(r.className,{"is-processing":s,"is-disabled":c,"has-error":l,"has-success":u});return(0,e.useEffect)((()=>{p(!C)}),[C]),(0,e.createElement)("form",{className:a},!S&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("input",{type:n.type,placeholder:n.placeholder,style:n.style,className:n.className,onChange:e=>R(e.target.value),value:C}),(0,e.createElement)("button",{type:"submit",className:r.wrapperClassName,disabled:s||c,style:{opacity:s?.5:1,...r.wrapperStyle},onClick:e=>{e.preventDefault(),!1===c&&x(!S)}},(0,e.createElement)("span",{style:r.style,className:A},E))),S&&(0,e.createElement)(d,{sitekey:b,theme:"light",ref:O,onVerify:e=>{!1!==e&&!0!==s&&(e=>{let{onStart:t,onSuccess:a,onError:n,emailAddress:r,captchaToken:i=!1,closeCaptcha:s,interest:o=!1}=e;if(!b)return n("Invalid captcha key");if(!i)return n("We couldn't verify you're not a robot. Please try again.");t(),s();const c=r,p=document.URL;if(!(0,v.isURL)(p))return n("Invalid URL");const l=(0,v.buildQueryString)({email:c,captcha_token:i,interests:o,api_key:"mailchimp-form",origin_url:p});y()({path:`/prc-api/v2/mailchimp/subscribe/?${l}`,method:"POST"}).then((()=>a())).catch((e=>n(e)))})({onStart:()=>{o(!0),w("Processing...")},onSuccess:()=>(w("Success"),m(!0),o(!1),R(""),h(!1),!0),onError:e=>(h(!0),w("Error"),o(!1),console.log("Error!",e),!1),closeCaptcha:()=>x(!1),emailAddress:C,captchaToken:e,interest:i.segmentId})},onOpen:()=>{g()}}))}function R(e){return e?e.split(";").filter((e=>e)).reduce(((e,t)=>{const[a,n]=t.split(":");return e[a.split("-").map(((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1))).join("")]=n,e}),{}):{}}n()((()=>{document.querySelectorAll(".wp-block-prc-block-mailchimp-form").forEach((t=>{const a=t.getAttribute("class"),n=t.getAttribute("data-segment-id"),r=t.querySelector(".wp-block-prc-block-form-input-text"),i=r.getAttribute("style")||"",s=r.getAttribute("class")||"",o=t.querySelector(".wp-block-button"),c=t.querySelector(".wp-block-button__link"),p=o.getAttribute("class")||"",l=o.getAttribute("style")||"",h=c.getAttribute("style")||"",d=c.getAttribute("class")||"",u=document.createElement("div");t.parentNode.insertBefore(u,t),(0,e.render)((0,e.createElement)(C,{className:a,input:{style:R(i),className:s,type:r.getAttribute("type"),placeholder:r.getAttribute("placeholder")},button:{wrapperClassName:p,wrapperStyle:R(l),style:R(h),className:d,text:c.innerText},form:{segmentId:n}}),u),t.parentNode.removeChild(t)}))}))}()}();
//# sourceMappingURL=view.js.map