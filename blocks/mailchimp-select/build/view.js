!function(){var e={472:function(e,t){var n;!function(){"use strict";var a={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)){if(n.length){var i=r.apply(null,n);i&&e.push(i)}}else if("object"===s)if(n.toString===Object.prototype.toString)for(var o in n)a.call(n,o)&&n[o]&&e.push(o);else e.push(n.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.wp.domReady,a=n.n(t);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var o,c,l=window.React,p="hcaptcha-api-script-id",h="hcaptchaOnLoad",u=new Promise((function(e,t){o=e,c=t})),d=function(e){var t,n;function a(t){var n;(n=e.call(this,t)||this).renderCaptcha=n.renderCaptcha.bind(s(n)),n.resetCaptcha=n.resetCaptcha.bind(s(n)),n.removeCaptcha=n.removeCaptcha.bind(s(n)),n.isReady=n.isReady.bind(s(n)),n.loadCaptcha=n.loadCaptcha.bind(s(n)),n.handleOnLoad=n.handleOnLoad.bind(s(n)),n.handleSubmit=n.handleSubmit.bind(s(n)),n.handleExpire=n.handleExpire.bind(s(n)),n.handleError=n.handleError.bind(s(n)),n.handleOpen=n.handleOpen.bind(s(n)),n.handleClose=n.handleClose.bind(s(n)),n.handleChallengeExpired=n.handleChallengeExpired.bind(s(n));var a="undefined"!=typeof hcaptcha;return n.ref=l.createRef(),n.apiScriptRequested=!1,n.state={isApiReady:a,isRemoved:!1,elementId:t.id,captchaId:""},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var r=a.prototype;return r.componentDidMount=function(){this.state.isApiReady?this.renderCaptcha():this.loadCaptcha()},r.componentWillUnmount=function(){var e=this.state.captchaId;this.isReady()&&(hcaptcha.reset(e),hcaptcha.remove(e))},r.shouldComponentUpdate=function(e,t){return this.state.isApiReady===t.isApiReady&&this.state.isRemoved===t.isRemoved},r.componentDidUpdate=function(e){var t=this;["sitekey","size","theme","tabindex","languageOverride","endpoint"].every((function(n){return e[n]===t.props[n]}))||this.removeCaptcha((function(){t.renderCaptcha()}))},r.loadCaptcha=function(){if(!this.apiScriptRequested){var e=this.props,t=e.apihost,n=e.assethost,a=e.endpoint,r=e.host,s=e.imghost;(function(e){if(void 0===e&&(e={}),document.getElementById(p))return u;window[h]=o;var t=e.apihost||"https://js.hcaptcha.com";delete e.apihost;var n=document.createElement("script");n.id=p,n.src=t+"/1/api.js?render=explicit&onload="+h,n.async=!0,n.onerror=function(e){return c("script-error")};var a=function(e){return Object.entries(e).filter((function(e){e[0];var t=e[1];return t||!1===t})).map((function(e){var t=e[0],n=e[1];return encodeURIComponent(t)+"="+encodeURIComponent(n)})).join("&")}(e);return n.src+=""!==a?"&"+a:"",document.head.appendChild(n),u})({apihost:t,assethost:n,endpoint:a,hl:e.languageOverride,host:r,imghost:s,recaptchacompat:!1===e.reCaptchaCompat?"off":null,reportapi:e.reportapi,sentry:e.sentry,custom:e.custom}).then(this.handleOnLoad).catch(this.handleError),this.apiScriptRequested=!0}},r.renderCaptcha=function(e){if(this.state.isApiReady){var t=Object.assign({"open-callback":this.handleOpen,"close-callback":this.handleClose,"error-callback":this.handleError,"chalexpired-callback":this.handleChallengeExpired,"expired-callback":this.handleExpire,callback:this.handleSubmit},this.props,{hl:this.props.hl||this.props.languageOverride,languageOverride:void 0}),n=hcaptcha.render(this.ref.current,t);this.setState({isRemoved:!1,captchaId:n},(function(){e&&e()}))}},r.resetCaptcha=function(){var e=this.state.captchaId;this.isReady()&&hcaptcha.reset(e)},r.removeCaptcha=function(e){var t=this.state.captchaId;this.isReady()&&this.setState({isRemoved:!0},(function(){hcaptcha.remove(t),e&&e()}))},r.handleOnLoad=function(){var e=this;this.setState({isApiReady:!0},(function(){e.renderCaptcha((function(){var t=e.props.onLoad;t&&t()}))}))},r.handleSubmit=function(e){var t=this.props.onVerify,n=this.state,a=n.isRemoved,r=n.captchaId;"undefined"==typeof hcaptcha||a||t(hcaptcha.getResponse(r),hcaptcha.getRespKey(r))},r.handleExpire=function(){var e=this.props.onExpire,t=this.state.captchaId;this.isReady()&&(hcaptcha.reset(t),e&&e())},r.handleError=function(e){var t=this.props.onError,n=this.state.captchaId;this.isReady()&&hcaptcha.reset(n),t&&t(e)},r.isReady=function(){var e=this.state,t=e.isApiReady,n=e.isRemoved;return t&&!n},r.handleOpen=function(){this.isReady()&&this.props.onOpen&&this.props.onOpen()},r.handleClose=function(){this.isReady()&&this.props.onClose&&this.props.onClose()},r.handleChallengeExpired=function(){this.isReady()&&this.props.onChalExpired&&this.props.onChalExpired()},r.execute=function(e){void 0===e&&(e=null);var t=this.state.captchaId;if(this.isReady())return e&&"object"!=typeof e&&(e=null),hcaptcha.execute(t,e)},r.setData=function(e){var t=this.state.captchaId;this.isReady()&&(e&&"object"!=typeof e&&(e=null),hcaptcha.setData(t,e))},r.getResponse=function(){return hcaptcha.getResponse(this.state.captchaId)},r.getRespKey=function(){return hcaptcha.getRespKey(this.state.captchaId)},r.render=function(){var e=this.state.elementId;return l.createElement("div",{ref:this.ref,id:e})},a}(l.Component),f=n(472),m=n.n(f),y=window.wp.apiFetch,b=n.n(y),v=window.wp.url;const g=window.mailChimpFormConfig&&window.mailChimpFormConfig.HCAPTCHA_KEY?window.mailChimpFormConfig.HCAPTCHA_KEY:"";function C(){let e=document.querySelector('iframe[title="Main content of the hCaptcha challenge"]');if(e=e.parentElement.parentElement,e){const t=e.querySelector("div:last-of-type");null!==t&&(t.style={...t.style,display:"none"})}else C()}function E(e){return e?e.split(";").filter((e=>e)).reduce(((e,t)=>{const[n,a]=t.split(":");return e[n.split("-").map(((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1))).join("")]=a,e}),{}):{}}function R(t){let{className:n="",style:a={},input:r=null,button:s=null,value:i=null,error:o=!1,success:c=!1,processing:l=!1,disabled:p=!1,onChange:h=(()=>{}),setToken:u=(()=>{}),onSubmit:f=(()=>{})}=t;if(null===r||null===s)return null;const y=m()(s.className,{"is-processing":l,"is-disabled":p,"has-error":o,"has-success":c}),[b,v]=(0,e.useState)(s.text);(0,e.useEffect)((()=>{v(l?"Processing":o?"Error":c?"Success":s.text)}),[l,o,c]);const E=(0,e.useRef)(null);return(0,e.createElement)("div",{className:n,style:a},(0,e.createElement)("input",{className:r.className,style:r.style,type:r.type,placeholder:r.placeholder,value:i,onChange:e=>h(e.target.value)}),(0,e.createElement)(d,{sitekey:g,theme:"light",ref:E,onVerify:e=>{u(e)},onOpen:()=>{C()}}),(0,e.createElement)("button",{type:"submit",className:s.wrapperClassName,disabled:l||p,style:{opacity:l||p?.5:1,...s.wrapperStyle},onClick:e=>{e.preventDefault(),!1===p&&f()}},(0,e.createElement)("span",{style:s.style,className:y},b)))}function S(t){let{className:n,style:a,value:r,checked:s,label:i,name:o,onChange:c}=t;return(0,e.createElement)("div",{className:n,style:E(a),onClick:()=>c(r),role:"checkbox","aria-checked":s,tabIndex:"0",onKeyDown:e=>{"Enter"===e.key&&c(r)}},(0,e.createElement)("input",{type:"checkbox",name:o,value:r,checked:s}),(0,e.createElement)("label",{"aria-controls":`${o}`},i))}function w(t){let{checkboxes:n=[],selected:a=[],onChange:r}=t;const[s,i]=(0,e.useState)([]);return(0,e.useEffect)((()=>{n.forEach((e=>{const t=e.getAttribute("class")||"",n=e.getAttribute("style")||"",a=e.querySelector("label"),r=e.querySelector("input"),s={className:t,style:n,label:a.innerText,name:r.getAttribute("name"),value:r.getAttribute("value")};i((e=>[...e,s]))}))}),[n]),(0,e.createElement)(e.Fragment,null,s.map((t=>{let{className:n,style:s,label:i,name:o,value:c}=t;return(0,e.createElement)(S,{className:n,style:s,label:i,name:o,value:c,checked:a.includes(c),onChange:r})})))}function k(t){let{className:n="",checkboxes:a=[],action:s={className:"",style:{},input:null,button:null}}=t;if(!g)return console.error("Invalid captcha key"),"";const i=[],o=[];a.forEach((e=>{const t=e.querySelector("input");t.getAttribute("checked")&&i.push(t.getAttribute("value")),o.push(t.getAttribute("value"))}));const[c,l]=(0,e.useState)(i),[p,h]=(0,e.useState)(!1),[u,d]=(0,e.useState)(!1),[f,m]=(0,e.useState)(!1),[y,C]=(0,e.useState)(!1),[E,S]=(0,e.useState)(null),[k,x]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{d(0===c.length||!1===k)}),[k,c]),(0,e.createElement)("form",{className:n},(0,e.createElement)(w,{checkboxes:a,selected:c,onChange:e=>{"select-all"===e?c.length===o.length?l([]):l(o):c.includes(e)?l(c.filter((t=>t!==e))):l([...c,e])}}),(0,e.createElement)(R,r({},s,{processing:p,disabled:u,error:f,success:y,value:E,onChange:e=>{S(e)},setToken:x,onSubmit:()=>{const e=document.URL;if(!(0,v.isURL)(e))return void console.error("Invalid URL");h(!0);const t=(0,v.buildQueryString)({email:E,interests:c.join(","),captcha_token:k,api_key:"mailchimp-select",origin_url:e});b()({path:`/prc-api/v2/mailchimp/subscribe/?${t}`,method:"POST"}).then((()=>{C(!0)})).catch((e=>{console.error("Error",e),m(!0)})).finally((()=>{h(!1)}))}})))}a()((()=>{const t=document.querySelectorAll(".wp-block-prc-block-mailchimp-select");console.log("forms",t),t.forEach((t=>{const n=t.getAttribute("class"),a=t.querySelectorAll(".wp-block-prc-block-form-input-checkbox"),r=t.querySelector(".wp-block-group"),s=r.getAttribute("class")||"",i=r.querySelector(".wp-block-prc-block-form-input-text"),o=i.getAttribute("style")||"",c=i.getAttribute("class")||"",l=r.querySelector(".wp-block-button"),p=r.querySelector(".wp-block-button__link"),h=l.getAttribute("class")||"",u=l.getAttribute("style")||"",d=p.getAttribute("style")||"",f=p.getAttribute("class")||"",m=document.createElement("div");t.parentNode.insertBefore(m,t),(0,e.render)((0,e.createElement)(k,{className:n,checkboxes:a,action:{className:r.getAttribute("class")||"",style:E(s),input:{style:E(o),className:c,type:i.getAttribute("type"),placeholder:i.getAttribute("placeholder")},button:{wrapperClassName:h,wrapperStyle:E(u),style:E(d),className:f,text:p.innerText}}}),m),t.parentNode.removeChild(t)}))}))}()}();
//# sourceMappingURL=view.js.map