import*as e from"@wordpress/interactivity";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const o=(c={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},r={},t.d(r,c),r),{state:n}=(0,o.store)("prc-block/mailchimp-select",{state:{},actions:{onInputChange:e=>{const{value:t}=e.target,c=(0,o.getContext)(),{ref:r}=(0,o.getElement)(),{id:s}=r;n[s].value=t,c.emailAddress=n[s].value},onButtonClick:e=>{const t=(0,o.getContext)(),{ref:n}=(0,o.getElement)(),{id:c}=n;t.captchaHidden=!1},onCheckboxClick:e=>{"LABEL"===e.target.tagName&&e.preventDefault();const t=(0,o.getContext)(),{ref:c}=(0,o.getElement)(),r=c.querySelector("input"),{id:s}=r,{checked:i,value:l,type:a}=n[s];n[s].checked=!i;const u=t.interests.indexOf(l);u>-1?t.interests.splice(u,1):t.interests.push(l),console.log("onCheckboxClick",c,n,s,t)},onCheckboxMouseEnter:()=>{console.log("prc-block/mailchimp-select","onCheckboxMouseEnter")},onButtonMouseEnter:()=>{console.log("prc-block/mailchimp-select","onButtonMouseEnter")}},callbacks:{onInit:()=>{const{ref:e}=(0,o.getElement)(),t=(0,o.getContext)(),n=e.querySelector("input.wp-block-prc-block-form-input-text");n?.id&&(t.inputId=n?.id);const c=e.querySelector(".wp-element-button");c?.id&&(t.buttonId=c?.id),console.log("prc-block/mailchimp-select -> onInit",t)},onInputChange:()=>{const{emailAddress:e,buttonId:t}=(0,o.getContext)();n[t].isDisabled=!e||!e.includes("@")},onCaptchaVerify:()=>{const e=(0,o.getContext)(),t=e.captchaToken;if(e.captchaHidden)return;if(!t)return;console.log("onCaptchaVerify",e);const n=window.wp.apiFetch,{isURL:c,buildQueryString:r}=window.wp.url,s=document.URL;if(!c(s))return new Error("Invalid url",s);n({path:"/prc-api/v3/mailchimp/subscribe",method:"POST",data:{email:e.emailAddress,captcha_token:t,interests:e?.interests.join(","),api_key:"mailchimp-select",origin_url:s}}).then((t=>{e.isSuccess=!0,console.log("SUCCESS",t,e)})).catch((t=>{e.isError=!0,console.error("ERROR",t,e)}))},onSuccess:()=>{const e=(0,o.getContext)(),{isSuccess:t,buttonId:c,inputId:r}=e;null!==t&&(n[r].isSuccess=t,n[c].isSuccess=t,!0===t&&(n[c].text="Success"))},onError:()=>{const e=(0,o.getContext)(),{isError:t,buttonId:c,inputId:r}=e;null!==t&&(n[r].isError=t,n[c].isError=t,!0===t&&(n[c].text="Error"))}}});var c,r;
//# sourceMappingURL=view.js.map