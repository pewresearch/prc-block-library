{"version":3,"file":"view.js","mappings":"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","sources":["webpack://form-input-select/webpack/bootstrap","webpack://form-input-select/webpack/runtime/define property getters","webpack://form-input-select/webpack/runtime/hasOwnProperty shorthand","webpack://form-input-select/external module \"@wordpress/interactivity\"","webpack://form-input-select/./src/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/* eslint-disable @wordpress/no-unused-vars-before-return */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { actions } = store('prc-block/form-input-select', {\n\tactions: {\n\t\tonOpen: () => {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isOpen = true;\n\t\t},\n\t\tonClose: (event = null) => {\n\t\t\t// By default this runs on the on-blur directive on the input element\n\t\t\t// but we also use it as a shortcut to close the listbox on click,\n\t\t\t// so this is a quick check to see if we're using this as a shortcut or not.\n\t\t\tif (null !== event) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tconst context = getContext();\n\t\t\t// Because the on-blur event fires before the click event we need to slow things down a bit, 150 ms should do it\n\t\t\tlet isRunning = false;\n\t\t\tif (!isRunning) {\n\t\t\t\tisRunning = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tcontext.isOpen = false;\n\t\t\t\t\tisRunning = false;\n\t\t\t\t}, 150);\n\t\t\t}\n\t\t},\n\t\tonReset: () => {\n\t\t\tconst context = getContext();\n\t\t\tcontext.activeIndex = 0;\n\t\t\tcontext.value = '';\n\t\t\tcontext.label = '';\n\t\t\tcontext.filteredOptions = context.options;\n\t\t},\n\t\tgetOptionByValue: (value) => {\n\t\t\tconsole.log('form-input-select::getOptionByValue', value);\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\t\t\tconst selectedOption = options.find(\n\t\t\t\t(option) => option.value === value\n\t\t\t);\n\t\t\tif (!selectedOption) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// find the object in the options array that matches the value\n\t\t\t// then set the activeId to the index of that object\n\t\t\tconst index = options.findIndex(\n\t\t\t\t(option) => option.value === selectedOption.value\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tindex,\n\t\t\t\t...selectedOption,\n\t\t\t};\n\t\t},\n\t\tmoveThroughOptions: (direction, ref) => {\n\t\t\tconst context = getContext();\n\t\t\tconst { activeIndex, filteredOptions } = context;\n\t\t\tlet nextActive = null;\n\t\t\tif (activeIndex === null || isNaN(activeIndex)) {\n\t\t\t\tnextActive = 0;\n\t\t\t} else {\n\t\t\t\tnextActive = activeIndex + direction;\n\t\t\t}\n\t\t\tif (nextActive < 0) {\n\t\t\t\tnextActive = filteredOptions.length - 1;\n\t\t\t}\n\t\t\tif (nextActive >= filteredOptions.length) {\n\t\t\t\tnextActive = 0;\n\t\t\t}\n\n\t\t\t// also scroll the listbox to the active item as you go...\n\t\t\tconst listbox = ref.parentElement.parentElement.querySelector(\n\t\t\t\t'.wp-block-prc-block-form-input-select__list'\n\t\t\t);\n\t\t\tconst activeItem = listbox.querySelector(\n\t\t\t\t`[data-ref-value=\"${filteredOptions[nextActive].value}\"]`\n\t\t\t);\n\t\t\tif (activeItem) {\n\t\t\t\tactiveItem.scrollIntoView({\n\t\t\t\t\tblock: 'nearest',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfilteredOptions.forEach((option) => {\n\t\t\t\toption.isSelected = false;\n\t\t\t});\n\t\t\tfilteredOptions[nextActive].isSelected = true;\n\n\t\t\tcontext.activeIndex = nextActive;\n\t\t\tcontext.filteredOptions = filteredOptions;\n\t\t\tconsole.log(\n\t\t\t\t'form-input-select::moveThroughOptions',\n\t\t\t\tcontext,\n\t\t\t\tnextActive,\n\t\t\t\tdirection\n\t\t\t);\n\t\t},\n\t\tsetValueOnEnter: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { filteredOptions, activeIndex } = context;\n\n\t\t\tconst highlightedOption = filteredOptions[activeIndex];\n\t\t\tconsole.log('ENTER === ', {\n\t\t\t\tfilteredOptions,\n\t\t\t\tactiveIndex,\n\t\t\t\thighlightedOption,\n\t\t\t});\n\n\t\t\tactions.setNewValue(highlightedOption?.value);\n\t\t\tcontext.label = highlightedOption?.label;\n\t\t\tcontext.isOpen = false;\n\n\t\t\t// reset the filtered options\n\t\t\t// context.filteredOptions = options;\n\t\t},\n\t\tonKeyUp: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\t// The input value.\n\t\t\tconst { value } = event.target;\n\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\t\t\tconst { ref } = getElement();\n\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tactions.onReset();\n\t\t\t\tif (true === context.isOpen) {\n\t\t\t\t\tref.blur();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.keyCode === 40 && event.key === 'ArrowDown') {\n\t\t\t\tactions.moveThroughOptions(1, event.target);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (event.keyCode === 38 && event.key === 'ArrowUp') {\n\t\t\t\tactions.moveThroughOptions(-1, event.target);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (event.key === 'Enter') {\n\t\t\t\tactions.setValueOnEnter();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Search options for the value and then set the filteredOptions to any matches...\n\t\t\tconst matches = options.filter((option) => {\n\t\t\t\tconst { label } = option;\n\t\t\t\treturn label.toLowerCase().includes(value.toLowerCase());\n\t\t\t});\n\t\t\tif (matches.length) {\n\t\t\t\tcontext.filteredOptions = matches;\n\t\t\t}\n\t\t},\n\t\tonClick: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst { ref } = getElement();\n\t\t\tconst context = getContext();\n\t\t\tconst { options, option } = context;\n\n\t\t\tconst id = ref.getAttribute('aria-controls');\n\t\t\tconst val = ref.getAttribute('data-ref-value');\n\t\t\tconst { index } = actions.getOptionByValue(val);\n\t\t\tconst { label, value } = options[index];\n\n\t\t\tcontext.activeIndex = index;\n\t\t\tcontext.label = label;\n\t\t\tactions.setNewValue(value);\n\n\t\t\tconsole.log('form-input-select::onClick', {\n\t\t\t\tcontext,\n\t\t\t\toption,\n\t\t\t\toptions,\n\t\t\t\tindex,\n\t\t\t\tlabel,\n\t\t\t\tvalue,\n\t\t\t});\n\n\t\t\t// find any other isSelected and set to false and then set isSelected\n\t\t\t// on the clicked option\n\t\t\t// also, reset the filteredOptions to the original options now that we have a value\n\t\t\tconst filteredOptions = options;\n\t\t\tfilteredOptions.forEach((opt) => {\n\t\t\t\topt.isSelected = false;\n\t\t\t});\n\t\t\tfilteredOptions[index].isSelected = true;\n\t\t\tcontext.filteredOptions = filteredOptions;\n\n\t\t\tactions.onClose();\n\t\t},\n\t\tsetNewValue: (newValue) => {\n\t\t\tconst { ref } = getElement();\n\t\t\tconst context = getContext();\n\t\t\tconst { targetNamespace } = context;\n\t\t\t// if the value is not empty and the targetNamespace is not the same as the current namespace\n\t\t\t// then hoist the value up to the targetNamespace\n\t\t\tcontext.value = newValue;\n\t\t\tconsole.log('form-input-select::setNewValue():', context);\n\t\t\tif (newValue && 'prc-block/form-input-select' !== targetNamespace) {\n\t\t\t\tconst { actions: targetActions, state: targetState } =\n\t\t\t\t\tstore(targetNamespace);\n\t\t\t\tif (targetActions.onSelectChange) {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'form-input-select::onValueChange -> onSelectChange:',\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\tnewValue,\n\t\t\t\t\t\ttargetState\n\t\t\t\t\t);\n\t\t\t\t\ttargetActions.onSelectChange(newValue, ref);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetTargetProcessingState: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { targetNamespace } = context;\n\t\t\tif ('prc-block/form-input-select' !== targetNamespace) {\n\t\t\t\tconst { state: targetState } = store(targetNamespace);\n\t\t\t\tif (targetState.isProcessing) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tisProcessing: () => {\n\t\t\treturn actions.getTargetProcessingState();\n\t\t},\n\t\tisDisabled: () => {\n\t\t\treturn actions.getTargetProcessingState();\n\t\t},\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","actions","store","onOpen","getContext","isOpen","onClose","event","preventDefault","context","isRunning","setTimeout","onReset","activeIndex","value","label","filteredOptions","options","getOptionByValue","console","log","selectedOption","find","option","index","findIndex","moveThroughOptions","direction","ref","nextActive","isNaN","length","activeItem","parentElement","querySelector","scrollIntoView","block","forEach","isSelected","setValueOnEnter","highlightedOption","setNewValue","onKeyUp","target","getElement","blur","keyCode","matches","filter","toLowerCase","includes","onClick","val","getAttribute","opt","newValue","targetNamespace","targetActions","state","targetState","onSelectChange","getTargetProcessingState","isProcessing","callbacks","isDisabled"],"sourceRoot":""}