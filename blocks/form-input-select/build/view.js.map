{"version":3,"file":"view.js","mappings":"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","sources":["webpack://form-input-select/webpack/bootstrap","webpack://form-input-select/webpack/runtime/define property getters","webpack://form-input-select/webpack/runtime/hasOwnProperty shorthand","webpack://form-input-select/external module \"@wordpress/interactivity\"","webpack://form-input-select/./src/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/* eslint-disable @wordpress/no-unused-vars-before-return */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { actions } = store('prc-block/form-input-select', {\n\tactions: {\n\t\tonOpen: () => {\n\t\t\tconst context = getContext();\n\t\t\tcontext.isOpen = true;\n\t\t},\n\t\tonClose: (event = null) => {\n\t\t\t// By default this runs on the on-blur directive on the input element\n\t\t\t// but we also use it as a shortcut to close the listbox on click,\n\t\t\t// so this is a quick check to see if we're using this as a shortcut or not.\n\t\t\tif (null !== event) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\tconst context = getContext();\n\t\t\t// Because the on-blur event fires before the click event we need to slow things down a bit, 100 ms should do it\n\t\t\tlet isRunning = false;\n\t\t\tif (!isRunning) {\n\t\t\t\tisRunning = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tcontext.isOpen = false;\n\t\t\t\t\tisRunning = false;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t},\n\t\tonReset: () => {\n\t\t\tconst context = getContext();\n\t\t\tcontext.activeIndex = 0;\n\t\t\tcontext.value = '';\n\t\t\tcontext.label = '';\n\t\t\tcontext.filteredOptions = context.options;\n\t\t},\n\t\tgetOptionByValue: (value) => {\n\t\t\tconsole.log('getOptionByValue', value);\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\t\t\tconst selectedOption = options.find(\n\t\t\t\t(option) => option.value === value\n\t\t\t);\n\t\t\tif (!selectedOption) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// find the object in the options array that matches the value\n\t\t\t// then set the activeId to the index of that object\n\t\t\tconst index = options.findIndex(\n\t\t\t\t(option) => option.value === selectedOption.value\n\t\t\t);\n\t\t\treturn {\n\t\t\t\tindex,\n\t\t\t\t...selectedOption,\n\t\t\t};\n\t\t},\n\t\tmoveThroughOptions: (direction, id) => {\n\t\t\tconst context = getContext();\n\t\t\tconst { activeIndex, filteredOptions } = context;\n\t\t\tlet nextActive = null;\n\t\t\tif (activeIndex === null || isNaN(activeIndex)) {\n\t\t\t\tnextActive = 0;\n\t\t\t} else {\n\t\t\t\tnextActive = activeIndex + direction;\n\t\t\t}\n\t\t\tif (nextActive < 0) {\n\t\t\t\tnextActive = filteredOptions.length - 1;\n\t\t\t}\n\t\t\tif (nextActive >= filteredOptions.length) {\n\t\t\t\tnextActive = 0;\n\t\t\t}\n\n\t\t\tfilteredOptions.forEach((option) => {\n\t\t\t\toption.isSelected = false;\n\t\t\t});\n\t\t\tfilteredOptions[nextActive].isSelected = true;\n\n\t\t\tcontext.activeIndex = nextActive;\n\t\t\tcontext.filteredOptions = filteredOptions;\n\t\t\tconsole.log('moveThroughOptions', context, nextActive, direction);\n\t\t},\n\t\tonKeyUp: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst { value } = event.target;\n\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\t\t\tconst { ref } = getElement();\n\t\t\tconst id = ref.getAttribute('aria-controls');\n\t\t\tif (!id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tactions.onReset();\n\t\t\t\tif (true === context.isOpen) {\n\t\t\t\t\tref.blur();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.key === 'Enter') {\n\t\t\t\t// actions.setValueOnEnter(id);\n\t\t\t}\n\t\t\tif (event.keyCode === 40 && event.key === 'ArrowDown') {\n\t\t\t\tactions.moveThroughOptions(1, id);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (event.keyCode === 38 && event.key === 'ArrowUp') {\n\t\t\t\tactions.moveThroughOptions(-1, id);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// check if any of the options contain the value of the input\n\t\t\tconst matches = options.filter((option) => {\n\t\t\t\tconst { label } = option;\n\t\t\t\treturn label.toLowerCase().includes(value.toLowerCase());\n\t\t\t});\n\t\t\t// if there are matches set the filteredOptions to the matches\n\t\t\tif (matches.length) {\n\t\t\t\tcontext.filteredOptions = matches;\n\t\t\t}\n\t\t},\n\t\tonClick: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst { ref } = getElement();\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\n\t\t\tconst id = ref.getAttribute('aria-controls');\n\t\t\tconst val = ref.getAttribute('data-ref-value');\n\t\t\tconst { index, label, value } = actions.getOptionByValue(val);\n\n\t\t\tcontext.activeIndex = index;\n\t\t\tcontext.label = label;\n\t\t\tcontext.value = value;\n\n\t\t\tconsole.log('form-input-select::onClick', context, index, label, value);\n\n\t\t\t// find any other isSelected and set to false and then set isSelected\n\t\t\t// on the clicked option\n\t\t\t// also, reset the filteredOptions to the original options now that we have a value\n\t\t\tconst filteredOptions = options;\n\t\t\tfilteredOptions.forEach((option) => {\n\t\t\t\toption.isSelected = false;\n\t\t\t});\n\t\t\tfilteredOptions[index].isSelected = true;\n\t\t\tcontext.filteredOptions = filteredOptions;\n\n\t\t\tactions.onClose();\n\t\t},\n\t},\n\tcallbacks: {\n\t\tonInit: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { options } = context;\n\n\t\t\tconsole.log(\"form-input-select -> onInit\", context, options);\n\t\t},\n\t\tonValueChange: () => {\n\t\t\tconst { ref } = getElement();\n\t\t\tconst context = getContext();\n\t\t\tconst { targetNamespace, value } = context;\n\t\t\t// if the value is not empty and the targetNamespace is not the same as the current namespace\n\t\t\t// then hoist the value up to the targetNamespace\n\t\t\tif (value && 'prc-block/form-input-select' !== targetNamespace) {\n\t\t\t\tconst { actions: targetActions } = store(targetNamespace);\n\t\t\t\tif (targetActions.onSelectChange) {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'onValueChange -> onSelectChange:',\n\t\t\t\t\t\tcontext,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tref\n\t\t\t\t\t);\n\t\t\t\t\ttargetActions.onSelectChange(value, ref);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","actions","store","onOpen","getContext","isOpen","onClose","event","preventDefault","context","isRunning","setTimeout","onReset","activeIndex","value","label","filteredOptions","options","getOptionByValue","console","log","selectedOption","find","option","index","findIndex","moveThroughOptions","direction","id","nextActive","isNaN","length","forEach","isSelected","onKeyUp","target","ref","getElement","getAttribute","blur","keyCode","matches","filter","toLowerCase","includes","onClick","val","callbacks","onInit","onValueChange","targetNamespace","targetActions","onSelectChange"],"sourceRoot":""}