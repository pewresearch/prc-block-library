import*as e from"@wordpress/interactivity";var o={d:(e,t)=>{for(var c in t)o.o(t,c)&&!o.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:t[c]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const t=(s={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},i={},o.d(i,s),i),{actions:c,state:n}=(0,t.store)("prc-block/popup-controller",{state:{videos:{}},actions:{closeAll:()=>{Object.keys(n).forEach((e=>{n[e].isActive=!1}))},open:(e,o=!1)=>{const c=(0,t.getContext)(),s=c?.id;console.log("open...",o),o?n[o].isActive=!0:s?(n[s].isActive=!0,n[s].api?.play(),console.log("open",s,n[s].isActive,n)):console.log("no id",s,n)},close:(e,o=!1)=>{const c=(0,t.getContext)(),s=c?.id;o?n[o].isActive=!1:s&&(n[s].isActive=!1,console.log("stop...",n[s].api),n[s].api.controls.pause(),console.log("close",s,n[s].isActive,n))},openAndThen:e=>{const o=(0,t.getContext)(),{id:c}=o;n[c].isActive=!0,e()},closeAndThen:e=>{const o=(0,t.getContext)(),{id:c}=o;n[c].isActive=!1,e()}},callbacks:{onInit:()=>{const e=(0,t.getContext)(),{id:o}=e,c=document.querySelector(".wp-block-prc-block-popup-modal__outer"),s=document.querySelector(".wp-site-blocks");if(s.parentNode.insertBefore(c,s),!o)return;console.log("watchForVideoPress",n,e);const i=document.querySelector(`.wp-block-prc-block-popup-modal[data-controller-id="${o}"]`);if(console.log("modal",i),!i)return;if(!i.classList.contains("is-video"))return;const l=i.querySelector(".jetpack-videopress-player");if(!l)return;const r=l.querySelector("iframe");if(console.log("iframe",r),!r)return;const{VideoPressIframeApi:a}=window,p=a(r,(()=>{console.log("iframe api loaded!"),p.customize.set({shareButton:!1})}));n[o].api=p},outerWatch:()=>{console.log("outerWatch",n)},onWindowClickCloseModal:e=>{const o=(0,t.getContext)(),{id:s}=o;if(!s)return;if(!n[s]?.isActive)return;const i=(0,t.getElement)(),{ref:l}=i;console.log("onWindowClickCloseModal",i,e.target),(!l.contains(e.target)||e.target.classList.contains("wp-block-prc-block-popup-modal__outer"))&&(document.querySelector(".wp-block-prc-block-popup-modal.is-active").innerHTML.includes(e.target.innerHTML)||!0!==n[s].isActive||c.close(null,s))},onESCKey:e=>{const o=(0,t.getContext)(),{id:c}=o;c&&"Escape"===e.key&&!0===n[c].isActive&&(e.preventDefault(),n[c].isActive=!1)},isModalActive:()=>{const e=(0,t.getContext)(),o=(0,t.getElement)(),{id:c}=e;return console.log("isModalActive",n,c,o),n[c]?.isActive},isAModalActive:()=>{const e=(0,t.getElement)(),o=n;return console.log("isAModalActive",o,e),Object.keys(o).some((e=>n[e].isActive))},soundOff:()=>{const e=(0,t.getContext)(),o=(0,t.getElement)();console.log("soundOff",e,o,n)}}});var s,i;
//# sourceMappingURL=view.js.map