import*as e from"@wordpress/interactivity";var o={d:(e,t)=>{for(var c in t)o.o(t,c)&&!o.o(e,c)&&Object.defineProperty(e,c,{enumerable:!0,get:t[c]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const t=(s={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store},i={},o.d(i,s),i),{actions:c,state:n}=(0,t.store)("prc-block/popup-controller",{state:{videos:{}},actions:{play:e=>{e&&!1!==n[e].api&&n[e].api.controls.play()},pause:e=>{e&&!1!==n[e].api&&n[e].api.controls.pause()},closeAll:()=>{Object.keys(n).forEach((e=>{n[e].isActive=!1,c.pause(e)}))},open:(e,o=!1)=>{const s=(0,t.getContext)(),i=s?.id;if(console.log("open...",o),o)return n[o].isActive=!0,void c.play(o);i?(n[i].isActive=!0,c.play(i),console.log("open",i,n[i].isActive,n)):console.log("no id",i,n)},close:(e,o=!1)=>{const s=(0,t.getContext)(),i=s?.id;if(o)return n[o].isActive=!1,void c.pause(o);i&&(n[i].isActive=!1,console.log("stop...",n[i].api),c.pause(i),console.log("close",i,n[i].isActive,n))},openAndThen:e=>{const o=(0,t.getContext)(),{id:c}=o;n[c].isActive=!0,e()},closeAndThen:e=>{const o=(0,t.getContext)(),{id:c}=o;n[c].isActive=!1,e()}},callbacks:{onInit:()=>{const e=(0,t.getContext)(),{id:o}=e;window.prcPopupVideoPlayer||(window.prcPopupVideoPlayer={});const c=document.querySelector(".wp-block-prc-block-popup-modal__outer"),s=document.querySelector(".wp-site-blocks");if(s.parentNode.insertBefore(c,s),!o)return;console.log("watchForVideoPress",n,e);const i=document.querySelector(`.wp-block-prc-block-popup-modal[data-controller-id="${o}"]`);if(console.log("modal",i),!i)return;if(!i.classList.contains("is-video"))return;const l=i.querySelector(".jetpack-videopress-player");if(!l)return;const r=l.querySelector("iframe");if(console.log("iframe",r),!r)return;const{VideoPressIframeApi:a}=window,p=a(r,(()=>{console.log("iframe api loaded!"),p.customize.set({shareButton:!1})}));n[o].api=p,window.prcPopupVideoPlayer[o]=p},outerWatch:()=>{console.log("outerWatch",n)},onWindowClickCloseModal:e=>{const o=(0,t.getContext)(),{id:s}=o;if(!s)return;if(!n[s]?.isActive)return;const i=(0,t.getElement)(),{ref:l}=i;console.log("onWindowClickCloseModal",i,e.target),(!l.contains(e.target)||e.target.classList.contains("wp-block-prc-block-popup-modal__outer"))&&(document.querySelector(".wp-block-prc-block-popup-modal.is-active").innerHTML.includes(e.target.innerHTML)||!0!==n[s].isActive||c.close(null,s))},onESCKey:e=>{const o=(0,t.getContext)(),{id:s}=o;s&&"Escape"===e.key&&!0===n[s].isActive&&(e.preventDefault(),c.close(null,s))},isModalActive:()=>{const e=(0,t.getContext)(),o=(0,t.getElement)(),{id:c}=e;return console.log("isModalActive",n,c,o),n[c]?.isActive},isAModalActive:()=>{const e=(0,t.getElement)(),o=n;return console.log("isAModalActive",o,e),Object.keys(o).some((e=>n[e].isActive))},soundOff:()=>{const e=(0,t.getContext)(),o=(0,t.getElement)();console.log("soundOff",e,o,n)}}});var s,i;
//# sourceMappingURL=view.js.map